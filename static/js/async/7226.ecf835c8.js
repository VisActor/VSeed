(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["7226"],{43286:function(e,t,i){"use strict";i.d(t,{vI:()=>w,VO:()=>v});var l=i(21883),o=i.n(l),r=i(19159),n=i(7610),a=i(82904),s=i(12709),h=i(6946),d=i(84148);let u=e=>"object"==typeof e&&null!==e;var c=i(84326);let g=function(e){if(!u(e)||!(0,c.Z)(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};function p(e,t,i){var l,o;(void 0===i||(l=e[t],l===(o=i)||Number.isNaN(l)&&Number.isNaN(o)))&&(void 0!==i||t in e)||(e[t]=i)}var f=i(53908),b=i(42769);let m=(e,t)=>{var i,l;if(!(null==t?void 0:t.fields)||0===e.length)return e;let o=t.fields,r=e[0],n={},a=[];for(let t in o)if(Object.prototype.hasOwnProperty.call(o,t)){let s,h=o[t];if(!h.type){let l=r;t in r||(l=null!=(i=e.find(e=>t in e))?i:r),h.type="number"==typeof l[t]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(s={key:t,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},a.push(s)),(null==(l=h.domain)?void 0:l.length)>0)if("ordinal"===h.type){h._domainCache={},n[t]=h;let e={};h.domain.forEach((t,i)=>{e[t]=i,h._domainCache[t]=i}),s&&(s.sortIndex=e,s.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(n[t]=h)}return Object.keys(n).length>0&&(e=e.filter(e=>{for(let t in n){let i=n[t];if("ordinal"===i.type){if(!(e[t]in i._domainCache))return!1}else if(i.domain[0]>e[t]||i.domain[1]<e[t])return!1}return!0})),a.sort((e,t)=>e.index-t.index),e.sort((e,t)=>(function(e,t,i){for(let l=0;l<i.length;l++){let o=i[l],r=0;if("ordinal"===o.type?(void 0===o.sortIndex[t[o.key]]&&(o.sortIndex[t[o.key]]=o.sortIndexCount++),void 0===o.sortIndex[e[o.key]]&&(o.sortIndex[e[o.key]]=o.sortIndexCount++),r=o.sortIndex[e[o.key]]-o.sortIndex[t[o.key]]):"linear"===o.type&&(r=e[o.key]-t[o.key]),o.sortReverse&&(r=-r),0!==r)return r}return 0})(e,t,a)),e},C="_data-view-diff-rank";class v{constructor(e,t){let i;this.dataSet=e,this.options=t,this.isDataView=!0,this.target=new(o()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(e={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(t=>{this.executeTransform(t,{pushHistory:e.pushHistory,emitMessage:!1}),this.isLastTransform(t)&&this.diffLastData()}),this.isRunning=!1,!1!==e.emitMessage&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==t?void 0:t.name)?t.name:(0,b.F)("dataview"),this.name=i,(null==t?void 0:t.history)&&(this.history=t.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==t?void 0:t.fields)}parse(e,t,i=!1){var l;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),t&&(this.parseOption=t);let o=this.cloneParseData(e,t);if(null==t?void 0:t.type){let e=(null!=(l=this.dataSet.getParser(t.type))?l:this.dataSet.getParser("bytejson"))(o,t.options,this);this.rawData=o,this.parserData=e,this.history&&this.historyData.push(o,e),this.latestData=e}else this.parserData=o,this.rawData=o,this.history&&this.historyData.push(o),this.latestData=o;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(e,t=!0){if(this.isRunning=!0,e&&e.type){let i=!0;if("fields"===e.type){this._fields=e.options.fields;let t=this.transformsArr.findIndex(t=>t.type===e.type);t>=0&&(i=!1,this.transformsArr[t].options.fields=this._fields)}if(i&&this.transformsArr.push(e),t){let t=this.isLastTransform(e);this.executeTransform(e),t&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(e){return this.transformsArr[this.transformsArr.length-1]===e}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((e,t)=>{var i,l;return(null!=(i=e.level)?i:0)-(null!=(l=t.level)?l:0)})}executeTransform(e,t={pushHistory:!0,emitMessage:!0}){let{pushHistory:i,emitMessage:l}=t,o=this.dataSet.getTransform(e.type)(this.latestData,e.options);this.history&&!1!==i&&this.historyData.push(o),this.latestData=o,!1!==l&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(e){this._diffData=!0,this._diffKeys=e,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var e;if(!this._diffData||!this.latestData.forEach||!(null==(e=this._diffKeys)?void 0:e.length))return;let t=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach(e=>{e[C]=t,this._diffMap.set(this._diffKeys.reduce((t,i)=>t+e[i],""),e)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let e;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(i=>{i[C]=t,e=this._diffKeys.reduce((e,t)=>e+i[t],""),this._diffMap.get(e)?this.latestDataAUD.update.push(i):this.latestDataAUD.add.push(i),this._diffMap.set(e,i)}),this._diffMap.forEach((e,i)=>{e[C]<t&&(this.latestDataAUD.del.push(e),this._diffMap.delete(i))})}this._diffRank=t}cloneParseData(e,t){let i=!1;return e instanceof v||!0!==(null==t?void 0:t.clone)||(i=!0),i?function e(t,i,l){let o;if(!(0,d.Z)(t)||"object"!=typeof t||i&&i(t))return t;let u=(0,r.Z)(t),c=t.length;o=u?Array(c):"object"==typeof t?{}:(0,n.Z)(t)||(0,s.Z)(t)||(0,h.Z)(t)?t:(0,a.Z)(t)?new Date(+t):void 0;let g=u?void 0:Object.keys(Object(t)),p=-1;if(o)for(;++p<(g||t).length;){let r=g?g[p]:p,n=t[r];l&&l.includes(r.toString())?o[r]=n:o[r]=e(n,i,l)}return o}(e):e}parseNewData(e,t){this.parse(e,t||this.parseOption),this.reRunAllTransform()}updateRawData(e,t){let i=this.cloneParseData(e,t);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var e;return this._fields?this._fields:"dataview"===(null==(e=this.parseOption)?void 0:e.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(e,t=!1){this._fields=e&&t?function(e,...t){let i=-1,l=t.length;for(;++i<l;)!function e(t,i,l=!1,o=!1){if(i&&t!==i&&(0,d.Z)(i)&&"object"==typeof i){let n=Object(i),a=[];for(let e in n)a.push(e);let{length:s}=a,h=-1;for(;s--;){let s=a[++h];!(0,d.Z)(n[s])||"object"!=typeof n[s]||o&&(0,r.Z)(t[s])?p(t,s,n[s]):function(t,i,l,o=!1,n=!1){let a=t[l],s=i[l],h=i[l],d=!0;if((0,r.Z)(s)){if(o)h=[];else if((0,r.Z)(a))h=a;else if(null!==a&&"function"!=typeof a&&Number.isFinite(a.length)){h=Array(a.length);let e=-1,t=a.length;for(;++e<t;)h[e]=a[e]}}else g(s)?(h=null!=a?a:{},"function"!=typeof a&&"object"==typeof a||(h={})):d=!1;d&&e(h,s,o,n),p(t,l,h)}(t,i,s,l,o)}}}(e,t[i],!0);return e}({},this._fields,e):e;let i=this.transformsArr.find(e=>"fields"===e.type);!(0,f.Z)(this._fields)&&(0,f.Z)(i)?(this.dataSet.registerTransform("fields",m),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}function w(e){return e instanceof v}},42769:function(e,t,i){"use strict";i.d(t,{F:()=>o});let l=0;function o(e="dataset"){return l>1e8&&(l=0),e+"_"+l++}},74294:function(e,t,i){"use strict";i.d(t,{J:()=>c});var l=i(95950),o=i(28076),r=i(28651),n=i(19427),a=i(29411),s=i(51129),h=i(29624),d=i(23112),u=i(92875);(0,s.M)(),(0,h.k)(),(0,d.g)(),(0,u.i)();class c extends o.k{constructor(e,t){super((null==t?void 0:t.skipDefault)?e:(0,l.Z)({},c.defaultAttributes,e)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this.setAttribute("indeterminate",!1),this._dispatchEvent("checkbox_state_change",{eventType:"checkbox_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(e,t,i)=>{"interactive"in e&&this.setAttribute("pickable",e.interactive),"disabled"in e&&this.setAttribute("cursor",e.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new r.U((0,l.Z)({},this.attribute.box));let e=this.attribute.checked||this.attribute.indeterminate;e&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):e?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new n.E((0,l.Z)({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new n.E((0,l.Z)({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute("visible",!0),this._indeterminateIcon.setAttribute("visible",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!0)):(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!1))}renderText(){this._text=new a.x((0,l.Z)({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){let e=this.attribute.box.height,t=this.attribute.icon.height,i=this._text.AABBBounds.height(),l=Math.max(e,t,i),o=l/2-t/2,r=this.attribute.box.width,n=this.attribute.icon.width,a=Math.max(r,n),s=a/2-n/2,h=a+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:a/2-r/2,y:l/2-e/2}),this._checkIcon.setAttributes({x:s,y:o}),this._indeterminateIcon.setAttributes({x:s,y:o}),this._text.setAttributes({x:h,y:l/2-i/2})}initAttributes(e,t){e=(null==t?void 0:t.skipDefault)?e:(0,l.Z)({},c.defaultAttributes,e),super.initAttributes(e),this.renderGroup(),this.render()}}c.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},icon:{checkIconImage:'<svg width="200" height="200" viewBox="0 0 1024 1024" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z"></path></svg>',indeterminateIconImage:'<svg width="200" height="200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="5" d="M5 12h14"/></svg>',width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}}},66707:function(e,t,i){"use strict";i.d(t,{Y:()=>v});var l=i(95950),o=i(28076),r=i(11971),n=i(29411),a=i(51129),s=i(29624),h=i(31535),d=i(95940),u=i(96087),c=i(37967);let g=["heightLimit","lineClamp"];class p extends n.x{constructor(e){super(Object.assign(Object.assign({},e),{wrap:!0}))}_isValid(){let{text:e}=this.attribute;return(0,h.Z)(e)?!e.every(e=>null==e||""===e):null!=e&&""!==e}updateMultilineAABBBounds(e){var t,i,l,o;let r=this.getGraphicTheme(),{fontFamily:n=r.fontFamily,textAlign:a=r.textAlign,textBaseline:s=r.textBaseline,fontSize:h=r.fontSize,ellipsis:g=r.ellipsis,maxLineWidth:p,stroke:f=r.stroke,lineWidth:b=r.lineWidth,wordBreak:m=r.wordBreak,fontWeight:C=r.fontWeight,ignoreBuf:v=r.ignoreBuf,heightLimit:w=0,suffixPosition:y=r.suffixPosition,lineClamp:x}=this.attribute,_=null!=(t=(0,c.VA)(this.attribute.lineHeight,this.attribute.fontSize||r.fontSize))?t:this.attribute.fontSize||r.fontSize;if(!this.shouldUpdateShape()&&(null==(i=this.cache)?void 0:i.layoutData)){let e=this.cache.layoutData.bbox;return this._AABBBounds.set(e.xOffset,e.yOffset,e.xOffset+e.width,e.yOffset+e.height),f&&this._AABBBounds.expand(b/2),this._AABBBounds}let S=u.w.graphicUtil.textMeasure,R=new d.j(n,{fontSize:h,fontWeight:C,fontFamily:n},S),H=e.map(e=>e.toString()),A=[],M=[0,0],F=1/0;if(w>0&&(F=Math.max(Math.floor(w/_),1)),x&&(F=Math.min(F,x)),"number"==typeof p&&p!==1/0){if(p>0)for(let e=0;e<H.length;e++){let t=H[e],i=!0;if(e===F-1){let e=R.textMeasure.clipTextWithSuffix(t,R.textOptions,p,g,!1,y);A.push({str:e.str,width:e.width,ascent:0,descent:0,keepCenterInLine:!1});break}let r=R.textMeasure.clipText(t,R.textOptions,p,"break-word"===m);if(""!==t&&""===r.str){if(g){let e=R.textMeasure.clipTextWithSuffix(t,R.textOptions,p,g,!1,y);r.str=null!=(l=e.str)?l:"",r.width=null!=(o=e.width)?o:0}else r.str="",r.width=0;i=!1}if(A.push({str:r.str,width:r.width,ascent:0,descent:0,keepCenterInLine:!1}),r.str.length===t.length);else if(i){let i=t.substring(r.str.length);H.splice(e+1,0,i)}}let e=0;A.forEach(t=>{e=Math.max(e,t.width)}),M[0]=e}else{let e,t,i=0;for(let l=0,o=H.length;l<o;l++){if(l===F-1){let e=R.textMeasure.clipTextWithSuffix(H[l],R.textOptions,p,g,!1,y);A.push({str:e.str,width:e.width,ascent:0,descent:0,keepCenterInLine:!1}),i=Math.max(i,e.width);break}t=H[l],i=Math.max(i,e=R.textMeasure.measureTextWidth(t,R.textOptions,"break-word"===m)),A.push({str:t,width:e,ascent:0,descent:0,keepCenterInLine:!1})}M[0]=i}M[1]=A.length*(_+2*!v);let B={xOffset:0,yOffset:0,width:M[0],height:M[1]};R.LayoutBBox(B,a,s);let T=R.layoutWithBBox(B,A,a,s,_);return this.cache.layoutData=T,this.clearUpdateShapeTag(),this._AABBBounds.set(B.xOffset,B.yOffset,B.xOffset+B.width,B.yOffset+B.height),f&&this._AABBBounds.expand(b/2),this._AABBBounds}needUpdateTags(e){for(let t=0;t<g.length;t++){let i=g[t];if(-1!==e.indexOf(i))return!0}return super.needUpdateTags(e)}needUpdateTag(e){for(let t=0;t<g.length;t++)if(e===g[t])return!0;return super.needUpdateTag(e)}getNoWorkAnimateAttr(){return p.NOWORK_ANIMATE_ATTR}}function f(e){return new p(e)}var b=i(20672);function m(){m.__loaded||(m.__loaded=!0,b.i.RegisterGraphicCreator("wrapText",f))}m.__loaded=!1;var C=i(92875);(0,a.M)(),(0,s.k)(),m(),(0,C.i)();class v extends o.k{constructor(e,t){super((null==t?void 0:t.skipDefault)?e:(0,l.Z)({},v.defaultAttributes,e)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute("checked",!0),this._dispatchEvent("radio_checked",{eventType:"radio_checked",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(e,t,i)=>{"interactive"in e&&this.setAttribute("pickable",e.interactive),"disabled"in e&&this.setAttribute("cursor",e.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new r.w((0,l.Z)({},this.attribute.circle));let e=this.attribute.checked;e&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):e?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new n.x((0,l.Z)({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){let e=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),t=this._text.AABBBounds.height(),i=Math.max(e,t),l=i/2-e/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,o=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),r=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,n=o+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:r,y:l}),this._text.setAttributes({x:n,y:i/2-t/2})}initAttributes(e,t){e=(null==t?void 0:t.skipDefault)?e:(0,l.Z)({},v.defaultAttributes,e),super.initAttributes(e),this.renderGroup(),this.render()}}v.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}}},52812:function(e,t,i){"use strict";i.d(t,{EG:()=>u,Jj:()=>b,NP:()=>r,Nv:()=>o,VA:()=>c,bZ:()=>p,p8:()=>f,qP:()=>s,q_:()=>n,rE:()=>h,rV:()=>d,sg:()=>g,uU:()=>a});var l=i(20672);let o={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerUpOutside:"pointerupoutside",onPointerTap:"pointertap",onPointerOver:"pointerover",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerOut:"pointerout",onMouseDown:"mousedown",onMouseUp:"mouseup",onMouseUpOutside:"mouseupoutside",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onPinch:"pinch",onPinchStart:"pinchstart",onPinchEnd:"pinchend",onPan:"pan",onPanStart:"panstart",onPanEnd:"panend",onDrag:"drag",onDragStart:"dragstart",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragEnd:"dragend",onRightDown:"rightdown",onRightUp:"rightup",onRightUpOutside:"rightupoutside",onTouchStart:"touchstart",onTouchEnd:"touchend",onTouchEndOutside:"touchendoutside",onTouchMove:"touchmove",onTouchCancel:"touchcancel",onPress:"press",onPressUp:"pressup",onPressEnd:"pressend",onSwipe:"swipe",onDrop:"drop",onWeel:"wheel",onClick:"click",onDblClick:"dblclick"};function r(e){return l.i.arc(e?e.attribute:{})}function n(e){return l.i.area(e?e.attribute:{})}function a(e){return l.i.circle(e?e.attribute:{})}function s(e){return l.i.group(e?e.attribute:{})}function h(e){return l.i.glyph(e?e.attribute:{})}function d(e){return l.i.image(e?e.attribute:{})}function u(e){return l.i.line(e?e.attribute:{})}function c(e){return l.i.path(e?e.attribute:{})}function g(e){return l.i.polygon(e?e.attribute:{})}function p(e){return l.i.rect(e?e.attribute:{})}function f(e){return l.i.symbol(e?e.attribute:{})}function b(e){return l.i.text(e?e.attribute:{})}function m(e){return l.i.richtext(e?e.attribute:{})}Object.keys(o),m.Text=function(e){return Object.assign({type:"rich/text"},e)},m.Image=function(e){return Object.assign({type:"rich/image"},e)}},44787:function(e,t,i){"use strict";i.d(t,{j:()=>b});var l=i(84148),o=i(6594);function r(e,t,i=1e-10,l=1e-10){let o=i*Math.max(e,t);return Math.abs(e-t)<=Math.max(l,o)}var n=i(53908),a=i(12709),s=i(84168),h=i(17283);let d=Symbol("implicit");class u extends h.s{specified(e){var t;return e?(this._specified=Object.assign(null!=(t=this._specified)?t:{},e),this):Object.assign({},this._specified)}_getSpecifiedValue(e){if(this._specified)return this._specified[e]}constructor(){super(),this.type=s._f.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=d}clone(){let e=(new u).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&e.specified(this._specified),e}calculateVisibleDomain(e){return(0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)&&2===e.length?[this.invert(e[0]),this.invert(e[1])]:this._domain}scale(e){let t=`${e}`,i=this._getSpecifiedValue(t);if(void 0!==i)return i;let l=this._index.get(t);if(!l){if(this._unknown!==d)return this._unknown;l=this._domain.push(e),this._index.set(t,l)}let o=this._ordinalRange[(l-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(o):o}invert(e){let t=0;for(;t<this._ordinalRange.length&&this._ordinalRange[t]!==e;)t++;return this._domain[(t-1)%this._domain.length]}domain(e){if(!e)return this._domain.slice();for(let t of(this._domain=[],this._index=new Map,e)){let e=`${t}`;this._index.has(e)||this._index.set(e,this._domain.push(t))}return this}range(e){if(!e)return this._ordinalRange.slice();let t=Array.from(e);return this._ordinalRange=t,this}index(e){var t;return this._index&&null!=(t=this._index.get(`${e}`))?t:-1}}var c=i(8273),g=i(34638);function p(e,t,i,l){let o=[],r=e;for(;r<=t;)o.push(r),r+=i;return l&&o.reverse(),o}function f(e,t,i,l){let o,r;if(t=Math.floor(+t),e=Math.floor(+e),!(i=Math.floor(+i)))return[];if(e===t)return[e];if(o=t<e){let i=e;e=t,t=i}let n=(0,g.i)(1,t-e+1)(i);if(r=Math.floor((t-e+1)/n),!l)for(;Math.ceil((t-e+1)/r)>i&&n>1;)n-=1,r=Math.floor((t-e)/n);return p(e,t,r,o)}class b extends u{constructor(e){super(),this.type=s._f.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(e)}rescale(e,t){if(e)return this;this._wholeRange=null;let i=this._calculateWholeRange(this._range,t),l=super.domain().length,o=i[1]<i[0],r=i[Number(o)-0],n=i[1-Number(o)],a=(0,c.U6)(l,this._paddingInner,this._paddingOuter);return this._step=(n-r)/Math.max(1,a||1),this._round&&(this._step=Math.floor(this._step)),r+=(n-r-this._step*(l-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(r=Math.round(r),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:o,start:o?r+this._step*(l-1):r,count:l},this.generateFishEyeTransform(),this}scale(e){if(!this._bandRangeState)return;let t=`${e}`,i=this._getSpecifiedValue(t);if(void 0!==i)return i;let l=this._index.get(t);if(!l){if(this._unknown!==d)return this._unknown;l=this._domain.push(e),this._index.set(t,l)}let{count:o,start:r,reverse:n}=this._bandRangeState,a=r+(l-1)%o*(n?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(a):a}_calculateWholeRange(e,t){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let t;if((0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)&&2===e.length){let i=(0,c.BK)(e,[this._rangeFactorStart,this._rangeFactorEnd]);t=Math.abs(i[1]-i[0])}else t=Math.abs(e[1]-e[0]);let i=(0,c.at)(super.domain().length,t,this._paddingInner,this._paddingOuter,this._round);i<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):i>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=i,this._isFixed=!1)}if(this.isBandwidthFixed()){let i=(0,c.$l)(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(e[1]-e[0]),o=Math.min((e[1]-e[0])/i,1);if((0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)){if(i>0){let t=e[0]-i*this._rangeFactorStart;this._wholeRange=[t,t+i]}else{let t=e[1]+i*(1-this._rangeFactorEnd);this._wholeRange=[t-i,t]}let l=this._rangeFactorStart+o<=1,r=this._rangeFactorEnd-o>=0;"rangeFactorStart"===t&&l?this._rangeFactorEnd=this._rangeFactorStart+o:"rangeFactorEnd"===t&&r?this._rangeFactorStart=this._rangeFactorEnd-o:e[0]<=e[1]?l?this._rangeFactorEnd=this._rangeFactorStart+o:r?this._rangeFactorStart=this._rangeFactorEnd-o:(this._rangeFactorStart=0,this._rangeFactorEnd=o):r?this._rangeFactorStart=this._rangeFactorEnd-o:l?this._rangeFactorEnd=this._rangeFactorStart+o:(this._rangeFactorStart=1-o,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=o,this._wholeRange=[e[0],e[0]+i];return this._wholeRange}return super._calculateWholeRange(e)}calculateWholeRangeSize(){let e=this._calculateWholeRange(this._range);return Math.abs(e[1]-e[0])}calculateVisibleDomain(e){let t=this._domain;if((0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)&&t.length){let i=this._getInvertIndex(e[0]),l=this._getInvertIndex(e[1]);return t.slice(Math.min(i,l),Math.max(i,l)+1)}return t}domain(e,t){return e?(super.domain(e),this.rescale(t)):super.domain()}range(e,t){return e?(this._range=[(0,o.H)(e[0]),(0,o.H)(e[1])],this.rescale(t)):this._range}rangeRound(e,t){return this._range=[(0,o.H)(e[0]),(0,o.H)(e[1])],this._round=!0,this.rescale(t)}ticks(e=10){let t=this.calculateVisibleDomain(this._range);return -1===e?t:f(0,t.length-1,e,!1).map(e=>t[e])}tickData(e=10){return this.ticks(e).map((e,t)=>({index:t,tick:e,value:(this.scale(e)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(e=10){let t=this.calculateVisibleDomain(this._range);return f(0,t.length-1,e,!0).filter(e=>e<t.length).map(e=>t[e])}stepTicks(e){let t=this.calculateVisibleDomain(this._range);return(function(e,t,i){let l;if(t=Math.floor(+t),e=Math.floor(+e),i=(0,g.i)(1,t-e+1)(Math.floor(+i)),l=t<e){let i=e;e=t,t=i}return p(e,t,i,l)})(0,t.length-1,e).map(e=>t[e])}_getInvertIndex(e){let t=0,i=this.step()/2,l=this.bandwidth()/2,o=this._domain.length,n=this.range(),a=n[0]>n[n.length-1];for(t=0;t<o;t++){var s,h,d,u;let n=this.scale(this._domain[t])+l;if(0===t&&(!a&&!(e>(s=n+i)&&!r(e,s,void 0,void 0))||a&&!(e<(h=n-i)&&!r(e,h,void 0,void 0)))||t===o-1)break;if(!(e<(d=n-i)&&!r(e,d,void 0,void 0))&&!(e>(u=n+i)&&!r(e,u,void 0,void 0)))break}return t>=0&&t<=o-1?t:o-1}invert(e){return this._domain[this._getInvertIndex(e)]}padding(e,t){return void 0!==e?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(e)?Math.min.apply(null,e):e)),this._paddingInner=this._paddingOuter,this.rescale(t)):this._paddingInner}paddingInner(e,t){return void 0!==e?(this._paddingInner=Math.max(0,Math.min(1,e)),this.rescale(t)):this._paddingInner}paddingOuter(e,t){return void 0!==e?(this._paddingOuter=Math.max(0,Math.min(1,e)),this.rescale(t)):this._paddingOuter}step(){return this._step}round(e,t){return void 0!==e?(this._round=e,this.rescale(t)):this._round}align(e,t){return void 0!==e?(this._align=Math.max(0,Math.min(1,e)),this.rescale(t)):this._align}rangeFactor(e,t){return e?(super.rangeFactor(e),this.rescale(t)):super.rangeFactor()}rangeFactorStart(e,t){return(0,n.Z)(e)?super.rangeFactorStart():(super.rangeFactorStart(e),this.rescale(t,"rangeFactorStart"))}rangeFactorEnd(e,t){return(0,n.Z)(e)?super.rangeFactorEnd():(super.rangeFactorEnd(e),this.rescale(t,"rangeFactorEnd"))}bandwidth(e,t){return e?("auto"===e?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=e,this._isFixed=!0),this._userBandwidth=e,this.rescale(t)):this._bandwidth}maxBandwidth(e,t){return e?(this._maxBandwidth="auto"===e?void 0:e,this.rescale(t)):this._maxBandwidth}minBandwidth(e,t){return e?(this._minBandwidth="auto"===e?void 0:e,this.rescale(t)):this._minBandwidth}fishEye(e,t,i){return e||i?(this._fishEyeOptions=e,this._fishEyeTransform=null,this.rescale(t)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&(0,a.Z)(this._userBandwidth)}clone(){var e,t,i;return new b(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!=(e=this._userBandwidth)?e:"auto",!0).maxBandwidth(null!=(t=this._maxBandwidth)?t:"auto",!0).minBandwidth(null!=(i=this._maxBandwidth)?i:"auto")}}},17283:function(e,t,i){"use strict";i.d(t,{s:()=>a});var l=i(84148),o=i(53908),r=i(16487),n=i(8273);class a{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(e){return this._wholeRange?this._wholeRange:(0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)&&2===e.length?(this._wholeRange=(0,n.BK)(e,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):e}rangeFactor(e,t,i){return e?(2===e.length&&e.every(e=>e>=0&&e<=1)&&(this._wholeRange=null,0===e[0]&&1===e[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=e[0],this._rangeFactorEnd=e[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):(0,l.Z)(this._rangeFactorStart)&&(0,l.Z)(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(e,t){var i;return(0,o.Z)(e)?this._rangeFactorStart:(e>=0&&e<=1&&(this._wholeRange=null,0===e&&((0,o.Z)(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=e,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(e,t){var i;return(0,o.Z)(e)?this._rangeFactorEnd:(e>=0&&e<=1&&(this._wholeRange=null,0===e&&((0,o.Z)(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=e,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var e;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:t=2,radiusRatio:i=.1,radius:l}=this._fishEyeOptions,n=this.range(),a=n[0],s=n[n.length-1],h=Math.min(a,s),d=Math.max(a,s),u=(0,r.Z)(null!=(e=this._fishEyeOptions.focus)?e:0,h,d),c=(0,o.Z)(l)?(d-h)*i:l,g=Math.exp(t);g=g/(g-1)*c;let p=t/c;this._fishEyeTransform=e=>{let t=Math.abs(e-u);return t>=c?e:t<=1e-6?u:u+(e-u)*(g*(1-Math.exp(-t*p))/t*.75+.25)}}unknown(e){return arguments.length?(this._unknown=e,this):this._unknown}get(e,t){var i;return null!=(i=null==this?void 0:this[e])?i:t}}},84128:function(e,t,i){"use strict";i.d(t,{y:()=>B});var l={};i.r(l),i.d(l,{LX:()=>x});var o=i(17283),r=i(12709),n=i(19159),a=i(84148),s=i(53908),h=i(16487);function d(e,t,i){let l=(1-Math.abs(2*(i/=100)-1))*(t/=100),o=l*(1-Math.abs(e/60%2-1)),r=i-l/2,n=0,a=0,s=0;return 0<=e&&e<60?(n=l,a=o,s=0):60<=e&&e<120?(n=o,a=l,s=0):120<=e&&e<180?(n=0,a=l,s=o):180<=e&&e<240?(n=0,a=o,s=l):240<=e&&e<300?(n=o,a=0,s=l):300<=e&&e<360&&(n=l,a=0,s=o),{r:n=Math.round(255*(n+r)),g:a=Math.round(255*(a+r)),b:s=Math.round(255*(s+r))}}function u(e,t,i){e/=255;let l=Math.min(e,t/=255,i/=255),o=Math.max(e,t,i),r=o-l,n=0,a=0,s=0;return(n=Math.round(60*(n=0===r?0:o===e?(t-i)/r%6:o===t?(i-e)/r+2:(e-t)/r+4)))<0&&(n+=360),s=(o+l)/2,{h:n,s:a=+(100*(a=0===r?0:r/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}let c=/^#([0-9a-f]{3,8})$/,g={transparent:0xffffff00},p={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function f(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function b(e){return(0,r.Z)(e)?new y(e>>16,e>>8&255,255&e,1):(0,n.Z)(e)?new y(e[0],e[1],e[2]):new y(255,255,255)}function m(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function C(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let v=(e,t)=>{let i=c.exec(e);if(t||i){let e=parseInt(i[1],16),t=i[1].length;return 3===t?new y((e>>8&15)+((e>>8&15)<<4),(e>>4&15)+((e>>4&15)<<4),(15&e)+((15&e)<<4),1):6===t?b(e):8===t?new y(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):null}};class w{static Brighter(e,t=1){return 1===t?e:new w(e).brighter(t).toRGBA()}static SetOpacity(e,t=1){return 1===t?e:new w(e).setOpacity(t).toRGBA()}static getColorBrightness(e,t="hsl"){let i=e instanceof w?e:new w(e);switch(t){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3()}}static parseColorString(e){if((0,a.Z)(g[e])){var t;return t=g[e],(0,r.Z)(t)?new y(t>>>24,t>>>16&255,t>>>8&255,255&t):(0,n.Z)(t)?new y(t[0],t[1],t[2],t[3]):new y(255,255,255,1)}if((0,a.Z)(p[e]))return b(p[e]);let i=`${e}`.trim().toLowerCase(),l=v(i);if(void 0!==l)return l;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let e=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new y(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10),parseFloat(e[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let e=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),t=d(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10));return new y(t.r,t.g,t.b,parseFloat(e[3]))}}constructor(e){let t=w.parseColorString(e);t?this.color=t:(console.warn(`Warn: 传入${e}无法解析为Color`),this.color=new y(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(e){let{r:t,g:i,b:l}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(t*e))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*e))),this.color.b=Math.max(0,Math.min(255,Math.floor(l*e))),this}add(e){let{r:t,g:i,b:l}=this.color;return this.color.r+=Math.min(255,t+e.color.r),this.color.g+=Math.min(255,i+e.color.g),this.color.b+=Math.min(255,l+e.color.b),this}sub(e){return this.color.r=Math.max(0,this.color.r-e.color.r),this.color.g=Math.max(0,this.color.g-e.color.g),this.color.b=Math.max(0,this.color.b-e.color.b),this}multiply(e){let{r:t,g:i,b:l}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(t*e.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*e.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(l*e.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(e,t,i){let l=this.color.opacity,o=u(this.color.r,this.color.g,this.color.b),r=d((0,s.Z)(e)?o.h:(0,h.Z)(e,0,360),(0,s.Z)(t)?o.s:t>=0&&t<=1?100*t:t,(0,s.Z)(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new y(r.r,r.g,r.b,l),this}setRGB(e,t,i){return(0,s.Z)(e)||(this.color.r=e),(0,s.Z)(t)||(this.color.g=t),(0,s.Z)(i)||(this.color.b=i),this}setHex(e){let t=v(`${e}`.trim().toLowerCase(),!0);return null!=t?t:this}setColorName(e){let t=p[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}setScalar(e){return this.color.r=e,this.color.g=e,this.color.b=e,this}setOpacity(e=1){return this.color.opacity=e,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new w(this.color.toString())}copyGammaToLinear(e,t=2){return this.color.r=Math.pow(e.color.r,t),this.color.g=Math.pow(e.color.g,t),this.color.b=Math.pow(e.color.b,t),this}copyLinearToGamma(e,t=2){let i=t>0?1/t:1;return this.color.r=Math.pow(e.color.r,i),this.color.g=Math.pow(e.color.g,i),this.color.b=Math.pow(e.color.b,i),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.color.r=m(e.color.r),this.color.g=m(e.color.g),this.color.b=m(e.color.b),this}copyLinearToSRGB(e){return this.color.r=C(e.color.r),this.color.g=C(e.color.g),this.color.b=C(e.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class y{constructor(e,t,i,l){this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),(0,a.Z)(l)?this.opacity=isNaN(+l)?1:Math.max(0,Math.min(1,+l)):this.opacity=1}formatHex(){return`#${f(this.r)+f(this.g)+f(this.b)+(1===this.opacity?"":f(255*this.opacity))}`}formatRgb(){let e=this.opacity;return`${1===e?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===e?")":`,${e})`}`}formatHsl(){let e=this.opacity,{h:t,s:i,l:l}=u(this.r,this.g,this.b);return`${1===e?"hsl(":"hsla("}${t},${i}%,${l}%${1===e?")":`,${e})`}`}toString(){return this.formatHex()}}function x(e,t){let i=e.r,l=t.r,o=e.g,r=t.g,n=e.b,a=t.b,s=e.opacity,h=t.opacity;return e=>new y(Math.round(i*(1-e)+l*e),Math.round(o*(1-e)+r*e),Math.round(n*(1-e)+a*e),s*(1-e)+h*e)}function _(e,t){return i=>e*(1-i)+t*i}function S(e,t){return function(i){return Math.round(e*(1-i)+t*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:R}=l;function H(e,t){let i,l=typeof t;if((0,s.Z)(t)||"boolean"===l)return()=>t;if("number"===l)return _(e,t);if("string"===l){if(i=w.parseColorString(t)){let t=R(w.parseColorString(e),i);return e=>t(e).formatRgb()}return _(Number(e),Number(t))}return t instanceof y?R(e,t):t instanceof w?R(e.color,t.color):t instanceof Date?function(e,t){let i=e.valueOf(),l=t.valueOf(),o=new Date;return e=>(o.setTime(i*(1-e)+l*e),o)}(e,t):_(Number(e),Number(t))}var A=i(8273),M=i(6594),F=i(34638);class B extends o.s{constructor(e=A.yR,t=A.yR){super(),this._unknown=void 0,this.transformer=e,this.untransformer=t,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=A.yR,this._piecewise=A.Pd,this._interpolate=H}calculateVisibleDomain(e){var t;return(0,a.Z)(this._rangeFactorStart)&&(0,a.Z)(this._rangeFactorEnd)&&2===e.length?[this.invert(e[0]),this.invert(e[1])]:null!=(t=this._niceDomain)?t:this._domain}fishEye(e,t,i){return e||i?(this._fishEyeOptions=e,this._fishEyeTransform=null,this.rescale(t)):this._fishEyeOptions}scale(e){var t;if(Number.isNaN(e=Number(e))||this._domainValidator&&!this._domainValidator(e))return this._unknown;this._output||(this._output=this._piecewise((null!=(t=this._niceDomain)?t:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(e)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(e){var t;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(t=this._niceDomain)?t:this._domain).map(this.transformer),_)),this._clamp(this.untransformer(this._input(e)))}domain(e,t){var i;if(!e)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let l=Array.from(e,M.H);return this._domain=l,this.rescale(t)}range(e,t){if(!e)return this._range.slice();let i=Array.from(e);return this._range=i,this.rescale(t)}rangeRound(e,t){let i=Array.from(e);return this._range=i,this._interpolate=S,this.rescale(t)}rescale(e){var t;if(e)return this;let i=null!=(t=this._niceDomain)?t:this._domain,l=i.length,o=this._range.length,r=Math.min(l,o);if(l&&l<o&&this._forceAlign){let e=o-l+1,t=i[l-1],n=l>=2?(t-i[l-2])/e:0;for(let o=1;o<=e;o++)i[l-2+o]=t-n*(e-o);r=o}return this._autoClamp&&(this._clamp=(0,F.i)(i[0],i[r-1])),this._piecewise=r>2?A.PP:A.Pd,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(e,t,i){return arguments.length?(t?(this._autoClamp=!1,this._clamp=t):(this._autoClamp=!!e,this._clamp=e?void 0:A.yR),this.rescale(i)):this._clamp!==A.yR}interpolate(e,t){return arguments.length?(this._interpolate=e,this.rescale(t)):this._interpolate}ticks(e=10){return[]}tickData(e=10){let t=this.ticks(e);return(null!=t?t:[]).map((e,t)=>({index:t,tick:e,value:(this.scale(e)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(e,t){return e?(super.rangeFactor(e),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(e,t){return(0,s.Z)(e)?super.rangeFactorStart():(super.rangeFactorStart(e),this._output=this._input=null,this)}rangeFactorEnd(e,t){return(0,s.Z)(e)?super.rangeFactorEnd():(super.rangeFactorEnd(e),this._output=this._input=null,this)}forceAlignDomainRange(e){return arguments.length?(this._forceAlign=e,this):this._forceAlign}}},32889:function(e,t,i){"use strict";i.d(t,{f:()=>s});var l=i(84168),o=i(44264),r=i(84128);let n=e=>"function"==typeof e;var a=i(84148);class s extends r.y{constructor(){super(...arguments),this.type=l._f.Linear}clone(){return(new s).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(e=10,t){let i=this.calculateVisibleDomain(this._range);return(0,o.Z6)(i[0],i[i.length-1],e,t)}ticks(e=10,t){var i;if(n(null==t?void 0:t.customTicks))return t.customTicks(this,e);if((0,a.Z)(this._rangeFactorStart)&&(0,a.Z)(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(e,t);let l=null!=(i=this._niceDomain)?i:this._domain,r=this._domain,s=l[0],h=l[l.length-1],d=(0,o.sd)(r[0],r[r.length-1],e,t);if(!d.length)return d;if(this._domainValidator)d=d.filter(this._domainValidator);else if((d[0]!==s||d[d.length-1]!==h)&&this._niceType){let e=l.slice();if("all"===this._niceType?(e[0]=d[0],e[e.length-1]=d[d.length-1],this._niceDomain=e,this.rescale()):"min"===this._niceType&&d[0]!==s?(e[0]=d[0],this._niceDomain=e,this.rescale()):"max"===this._niceType&&d[d.length-1]!==h&&(e[e.length-1]=d[d.length-1],this._niceDomain=e,this.rescale()),"all"!==this._niceType){let t=Math.min(e[0],e[e.length-1]),i=Math.max(e[0],e[e.length-1]);d=d.filter(e=>e>=t&&e<=i)}}return d}forceTicks(e=10){let t=this.calculateVisibleDomain(this._range);return(0,o.S8)(t[0],t[t.length-1],e)}stepTicks(e){let t=this.calculateVisibleDomain(this._range);return(0,o.Hb)(t[0],t[t.length-1],e)}nice(e=10,t){var i,l;let r=this._domain,n=[];if(t){let e=(0,o.OQ)(r,t);if(n=e.niceMinMax,this._domainValidator=e.domainValidator,this._niceType=e.niceType,e.niceDomain)return this._niceDomain=e.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let t=(0,o.EL)(r.slice(),e);"min"===this._niceType?t[t.length-1]=null!=(i=n[1])?i:t[t.length-1]:"max"===this._niceType&&(t[0]=null!=(l=n[0])?l:t[0]),this._niceDomain=t,this.rescale()}return this}niceMin(e=10){this._niceType="min";let t=this._domain[this._domain.length-1],i=(0,o.EL)(this.domain(),e);return i&&(i[i.length-1]=t,this._niceDomain=i,this.rescale()),this}niceMax(e=10){this._niceType="max";let t=this._domain[0],i=(0,o.EL)(this._domain.slice(),e);return i&&(i[0]=t,this._niceDomain=i,this.rescale()),this}}},97116:function(e,t,i){"use strict";i.d(t,{n:()=>r});var l=i(44264),o=i(8273);class r{nice(e=10,t){var i,r,n,a;let s=this._domain,h=[],d=null;if(t){let e=(0,l.OQ)(s,t);if(h=e.niceMinMax,this._domainValidator=e.domainValidator,d=e.niceType,e.niceDomain)return this._niceDomain=e.niceDomain,this.rescale(),this}else d="all";if(d){let e=(0,o.kx)(s.slice(),null!=(r=null==(i=this.getNiceConfig)?void 0:i.call(this))?r:{floor:e=>Math.floor(e),ceil:e=>Math.ceil(e)});return"min"===d?e[e.length-1]=null!=(n=h[1])?n:e[e.length-1]:"max"===d&&(e[0]=null!=(a=h[0])?a:e[0]),this._niceDomain=e,this.rescale(),this}return this}niceMin(){let e=this._domain[this._domain.length-1];this.nice();let t=this._domain.slice();return this._domain&&(t[t.length-1]=e,this._niceDomain=t,this.rescale()),this}niceMax(){let e=this._domain[0];this.nice();let t=this._domain.slice();return this._domain&&(t[0]=e,this._niceDomain=t,this.rescale()),this}}},37352:function(e,t,i){"use strict";i.d(t,{Y:()=>d});var l=i(44264),o=i(84128),r=i(84168),n=i(8273),a=i(94904),s=i(97116);function h(e=Number.EPSILON){return t=>Math.max(t,e)}class d extends o.y{constructor(){super((0,n.J7)(10),(0,n.ye)(10)),this.type=r._f.Log,this._limit=h(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return(new d).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(e){var t;if(e)return this;super.rescale();let i=(0,n.J7)(this._base),l=(0,n.ye)(this._base);return(null!=(t=this._niceDomain)?t:this._domain)[0]<0?(this._logs=e=>-i(-e),this._pows=e=>-l(-e),this._limit=function(e=Number.EPSILON){return t=>Math.min(t,-e)}(),this.transformer=n.op,this.untransformer=n.ge):(this._logs=i,this._pows=l,this._limit=h(),this.transformer=this._logs,this.untransformer=l),this}scale(e){var t;if(Number.isNaN(e=Number(e))||this._domainValidator&&!this._domainValidator(e))return this._unknown;this._output||(this._output=this._piecewise((null!=(t=this._niceDomain)?t:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._limit(this._clamp(e))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(e,t){return arguments.length?(this._base=e,this.rescale(t)):this._base}tickFormat(){return n.yR}d3Ticks(e=10,t){let i=this.domain(),o=this._limit(i[0]),r=this._limit(i[i.length-1]);return(0,l.e3)(o,r,e,this._base,this.transformer,this.untransformer,t)}ticks(e=10){let t=this.calculateVisibleDomain(this._range);return(0,l.jb)(this._limit(t[0]),this._limit(t[t.length-1]),e,this._base,this.transformer,this.untransformer)}forceTicks(e=10){let t=this.calculateVisibleDomain(this._range);return(0,l.RX)(t[0],t[t.length-1],e,this.transformer,this.untransformer)}stepTicks(e){let t=this.calculateVisibleDomain(this._range);return(0,l.RX)(this._limit(t[0]),this._limit(t[t.length-1]),e,this.transformer,this.untransformer)}getNiceConfig(){return{floor:e=>this._pows(Math.floor(this._logs(this._limit(e)))),ceil:e=>Math.abs(e)>=1?Math.ceil(e):this._pows(Math.ceil(this._logs(this._limit(e))))}}}(0,a.jB)(d,s.n)},25777:function(e,t,i){"use strict";i.d(t,{g:()=>h});var l=i(94904),o=i(32889),r=i(84168),n=i(44264),a=i(8273),s=i(97116);class h extends o.f{constructor(){super((0,a.QG)(1),(0,a.Xw)(1)),this.type=r._f.Symlog,this._const=1}clone(){return(new h).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(e,t){return arguments.length?(this._const=e,this.transformer=(0,a.QG)(e),this.untransformer=(0,a.Xw)(e),this.rescale(t)):this._const}d3Ticks(e=10,t){let i=this.domain(),l=i[0],o=i[i.length-1];return(0,n.e3)(l,o,e,this._const,this.transformer,this.untransformer,t)}ticks(e=10){let t=this.calculateVisibleDomain(this._range);return(0,n.jb)(t[0],t[t.length-1],e,this._const,this.transformer,this.untransformer)}forceTicks(e=10){let t=this.calculateVisibleDomain(this._range);return(0,n.RX)(t[0],t[t.length-1],e,this.transformer,this.untransformer)}stepTicks(e){let t=this.calculateVisibleDomain(this._range);return(0,n.RX)(t[0],t[t.length-1],e,this.transformer,this.untransformer)}}(0,l.jB)(h,s.n)},84168:function(e,t,i){"use strict";var l,o;i.d(t,{_f:()=>l}),(o=l||(l={})).Identity="identity",o.Linear="linear",o.Log="log",o.Pow="pow",o.Sqrt="sqrt",o.Symlog="symlog",o.Time="time",o.Quantile="quantile",o.Quantize="quantize",o.Threshold="threshold",o.Ordinal="ordinal",o.Point="point",o.Band="band";let r={};Object.values(l).forEach(e=>{r[e]=!0})},44264:function(e,t,i){"use strict";i.d(t,{sd:()=>p,Hb:()=>C,e3:()=>x,jb:()=>_,EL:()=>v,RX:()=>S,OQ:()=>w,S8:()=>m,Z6:()=>u});var l=i(84148);let o=e=>{let t=null,i=null;return(...l)=>(t&&l.every((e,i)=>e===t[i])||(t=l,i=e(...l)),i)};var r=i(12709),n=i(8273);let a=Math.sqrt(50),s=Math.sqrt(10),h=Math.sqrt(2),d=(e,t,i)=>{let o=1,r=e,n=Math.floor((t-1)/2),a=Math.abs(e);return e>=0&&e<=Number.MIN_VALUE?r=0:e<0&&e>=-Number.MIN_VALUE?r=-(t-1):!i&&a<1?o=f(a).step:(i||a>1)&&(r=Math.floor(e)-n*o),o>0?(e>0?r=Math.max(r,0):e<0&&(r=Math.min(r,-(t-1)*o)),(function(e,t,i){(0,l.Z)(t)||(t=e,e=0),(0,l.Z)(i)||(i=1);let o=-1,r=0|Math.max(0,Math.ceil((t-e)/i)),n=Array(r);for(;++o<r;)n[o]=e+o*i;return n})(0,t).map(e=>r+e*o)):e>0?c(0,-(t-1)/o,o):c((t-1)/o,0,o)},u=o((e,t,i,l)=>{let o,r,n,a,s=-1;if(i*=1,(e*=1)==(t*=1)||Math.abs(e-t)<=Number.MIN_VALUE&&i>0)return[e];if((o=t<e)&&(r=e,e=t,t=r),!isFinite(a=b(e,t,i).step))return[];if(a>0){let i=Math.round(e/a),l=Math.round(t/a);for(i*a<e&&++i,l*a>t&&--l,n=Array(r=l-i+1);++s<r;)n[s]=(i+s)*a}else if(a<0&&(null==l?void 0:l.noDecimals)){a=1;let i=Math.ceil(e),l=Math.floor(t);if(!(i<=l))return[];for(n=Array(r=l-i+1);++s<r;)n[s]=i+s}else{let i=Math.round(e*(a=-a)),l=Math.round(t*a);for(i/a<e&&++i,l/a>t&&--l,n=Array(r=l-i+1);++s<r;)n[s]=(i+s)/a}return o&&n.reverse(),n}),c=(e,t,i)=>{let l,o,r=-1;if(i>0){let n=Math.floor(e/i),a=Math.ceil(t/i);for((n+1)*i<e&&++n,(a-1)*i>t&&--a,o=Array(l=a-n+1);++r<l;)o[r]=(n+r)*i}else{let n=Math.floor(e*(i=-i)),a=Math.ceil(t*i);for((n+1)/i<e&&++n,(a-1)/i>t&&--a,o=Array(l=a-n+1);++r<l;)o[r]=(n+r)/i}return o},g=(e,t,i)=>{let l,o=e[0],r=e[e.length-1],n=t-e.length;if(r<=0){let t=[];for(l=n;l>=1;l--)t.push(o-l*i);return t.concat(e)}if(o>=0){for(l=1;l<=n;l++)e.push(r+l*i);return e}let a=[],s=[];for(l=1;l<=n;l++)l%2==0?a=[o-Math.floor(l/2)*i].concat(a):s.push(r+Math.ceil(l/2)*i);return a.concat(e).concat(s)},p=o((e,t,i,l)=>{let o,r,n;if(i*=1,(e*=1)==(t*=1)||Math.abs(e-t)<=Number.MIN_VALUE&&i>0)return d(e,i,null==l?void 0:l.noDecimals);(o=t<e)&&(n=e,e=t,t=n);let a=b(e,t,i),s=a.step;if(!isFinite(s))return[];if(s>0){let l=1,{power:o,gap:n}=a,h=10===n?2*10**o:+(10**o);for(;l<=5&&(r=c(e,t,s)).length>i+1&&i>2;)s+=h,l+=1;i>2&&r.length<i-1&&(r=g(r,i,s))}else(null==l?void 0:l.noDecimals)&&s<0&&(s=1),r=c(e,t,s);return o&&r.reverse(),r}),f=e=>{let t=Math.floor(Math.log(e)/Math.LN10),i=e/10**t,l=1;return i>=a?l=10:i>=s?l=5:i>=h&&(l=2),t>=0?{step:l*10**t,gap:l,power:t}:{step:-(10**-t)/l,gap:l,power:t}};function b(e,t,i){return f((t-e)/Math.max(0,i))}function m(e,t,i){let l;if(i*=1,(e*=1)==(t*=1)&&i>0)return[e];if(i<=0||0==(l=(t-e)/Math.max(1,i-1))||!isFinite(l))return[];let o=Array(i);for(let t=0;t<i;t++)o[t]=e+t*l;return o}function C(e,t,i){let l,o,r=-1;if(i*=1,(o=(t*=1)<(e*=1))&&(l=e,e=t,t=l),!isFinite(i)||t-e<=i)return[e];let n=Math.floor((t-e)/i+1),a=Array(n);for(;++r<n;)a[r]=e+r*i;return o&&a.reverse(),a}function v(e,t=10){let i,l,o=0,r=e.length-1,n=e[o],a=e[r],s=10;for(a<n&&(l=n,n=a,a=l,l=o,o=r,r=l);s-- >0;){if((l=b(n,a,t).step)===i)return e[o]=n,e[r]=a,e;if(l>0)n=Math.floor(n/l)*l,a=Math.ceil(a/l)*l;else{if(!(l<0))break;n=Math.ceil(n*l)/l,a=Math.floor(a*l)/l}i=l}}function w(e,t){let i=(0,r.Z)(t.forceMin),l=(0,r.Z)(t.forceMax),o=null,n=[],a=null,s=i&&l?e=>e>=t.forceMin&&e<=t.forceMax:i?e=>e>=t.forceMin:l?e=>e<=t.forceMax:null;return i?n[0]=t.forceMin:(0,r.Z)(t.min)&&t.min<=Math.min(e[0],e[e.length-1])&&(n[0]=t.min),l?n[1]=t.forceMax:(0,r.Z)(t.max)&&t.max>=Math.max(e[0],e[e.length-1])&&(n[1]=t.max),(0,r.Z)(n[0])&&(0,r.Z)(n[1])?((a=e.slice())[0]=n[0],a[a.length-1]=n[1]):o=(0,r.Z)(n[0])||(0,r.Z)(n[1])?(0,r.Z)(n[0])?"max":"min":"all",{niceType:o,niceDomain:a,niceMinMax:n,domainValidator:s}}let y=(e,t,i)=>1>Math.abs(t-e)?+i.toFixed(1):Math.round(+i),x=o((e,t,i,l,o,r,n)=>{let a=e,s=t,h=s<a;h&&([a,s]=[s,a]);let d,u,c=o(a),g=o(s),f=[];if(!(l%1)&&g-c<i){if(c=Math.floor(c),g=Math.ceil(g),a>0){for(;c<=g;++c)for(d=1;d<l;++d)if(!((u=c<0?d/r(-c):d*r(c))<a)){if(u>s)break;f.push(u)}}else for(;c<=g;++c)for(d=l-1;d>=1;--d)if(!((u=c>0?d/r(-c):d*r(c))<a)){if(u>s)break;f.push(u)}2*f.length<i&&(f=p(a,s,i))}else f=p(c,g,Math.min(g-c,i)).map(r);return f=f.filter(e=>0!==e),(null==n?void 0:n.noDecimals)&&(f=Array.from(new Set(f.map(e=>Math.floor(e))))),h?f.reverse():f}),_=o((e,t,i,l,o,r)=>{let a=[],s={},h=o(e),d=o(t),u=[];if(Number.isInteger(l))u=p(h,d,i);else{let e=(d-h)/(i-1);for(let t=0;t<i;t++)u.push(h+t*e)}return u.forEach(i=>{let o=r(i),h=Number.isInteger(l)?y(e,t,o):y(e,t,(0,n.ok)(o)),d=y(e,t,(0,n.uT)(h,[e,t]));s[d]||isNaN(d)||!(u.length>1)||(s[d]=1,a.push(d))}),a}),S=o((e,t,i,l,o)=>m(l(e),l(t),i).map(e=>(0,n.ok)(o(e))));o((e,t,i,l,o)=>C(l(e),l(t),i).map(e=>(0,n.ok)(o(e))))},8273:function(e,t,i){"use strict";i.d(t,{Pd:()=>g,U6:()=>p,yR:()=>o,J7:()=>h,at:()=>b,op:()=>r,kx:()=>v,BK:()=>m,PP:()=>C,Xw:()=>u,uT:()=>y,$l:()=>f,ge:()=>n,ok:()=>w,ye:()=>s,QG:()=>d});var l=i(53908);function o(e){return e}let r=e=>-Math.log(-e),n=e=>-Math.exp(-e),a=e=>isFinite(e)?Math.pow(10,e):e<0?0:e,s=e=>10===e?a:e===Math.E?Math.exp:t=>Math.pow(e,t),h=e=>e===Math.E?Math.log:10===e?Math.log10:2===e?Math.log2:(e=Math.log(e),t=>Math.log(t)/e),d=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),u=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e;function c(e,t){if(e=Number(e),t=Number(t)-e)return i=>(i-e)/t;let i=Number.isNaN(t)?NaN:.5;return()=>i}function g(e,t,i){let l,o,r=e[0],n=e[1],a=t[0],s=t[1];return n<r?(l=c(n,r),o=i(s,a)):(l=c(r,n),o=i(a,s)),e=>o(l(e))}function p(e,t,i){let l;return l=1===e?e+2*i:e-t+2*i,e?l>0?l:1:0}function f(e,t,i,l){return 1===i&&(i=0),p(e,i,l)*(t/(1-i))}function b(e,t,i,l,o){let r=t/Math.max(1,p(e,i,l)||1);o&&(r=Math.floor(r));let n=r*(1-i);return o&&(n=Math.round(n)),n}function m(e,t){let i=(e[1]-e[0])/(t[1]-t[0]),l=e[0]-i*t[0];return[l,i+l]}function C(e,t,i){let o=Math.min(e.length,t.length)-1,r=Array(o),n=Array(o),a=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<o;)r[a]=c(e[a],e[a+1]),n[a]=i(t[a],t[a+1]);return function(t){let i=function(e,t,i=0,o){for((0,l.Z)(o)&&(o=e.length);i<o;){var r;let l=i+o>>>1;((r=e[l])<t?-1:r>t?1:r>=t?0:NaN)>0?o=l:i=l+1}return i}(e,t,1,o)-1;return n[i](r[i](t))}}let v=(e,t)=>{let i=e.slice(),l=0,o=i.length-1,r=i[l],n=i[o];return n<r&&([l,o]=[o,l],[r,n]=[n,r]),i[l]=t.floor(r),i[o]=t.ceil(n),i},w=(e,t=!1)=>{let i=Math.floor(Math.log10(e)),l=e/Math.pow(10,i);return(t?l<1.5?1:l<3?2:l<7?5:10:l<=1?1:l<=2?2:l<=5?5:10)*Math.pow(10,i)},y=(e,t)=>{let i,l;return t[0]<t[1]?(i=t[0],l=t[1]):(i=t[1],l=t[0]),Math.min(Math.max(e,i),l)}},75747:function(e,t,i){"use strict";i.d(t,{z:()=>R});var l=i(21264),o=i(2714),r=i(53372),n=i(77597),a=i(9284),s=i(50071),h=i(56616),d=i(42365),u=i(19465),c=i(43735),g=i(58977),p=i(83847),f=i(70656),b=i(20901),m=i(90251),C=i(61768),v=i(43221),w=i(75025),y=i(50173),x=i(66209),_=i(51235),S=i(62727);(0,y.R2)(),(0,y.Eg)(),(0,y.I)(),(0,y.FD)(),(0,y._t)(),(0,y.Mh)(),(0,y.ph)(),(0,x.LQ)(),(0,x.yR)(),(0,x.pk)(),(0,x.m4)(),(0,x.Jy)(),(0,x.dB)(),(0,x.ge)(),(0,x.au)();class R extends h.D{constructor(e,t){var i,l,r,n,s,h,d,g,m,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P;let I,E;super(e,t),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},(t=this.options).layout&&Object.assign(t,t.layout),this.internalProps.columns=(0,u.Z)(t.columns),this.internalProps.rows=(0,u.Z)(t.rows),this.internalProps.indicators=(0,f.u)(t.indicators),this.internalProps.columnTree=!t.indicatorsAsCol||(null==(i=t.columns)?void 0:i.length)||t.columnTree?(0,u.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(l=t.rows)?void 0:l.length)||t.rowTree?(0,u.Z)(t.rowTree):[],this.internalProps.records=t.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=null!=(s=null!=(n=null==(r=t.resize)?void 0:r.columnResizeType)?n:t.columnResizeType)?s:"column",this.internalProps.rowResizeType=null!=(g=null!=(d=null==(h=t.resize)?void 0:h.rowResizeType)?d:t.rowResizeType)?g:"row",this.internalProps.dataConfig={isPivotChart:!0},this._axes=(0,c.Z)(t.axes)?t.axes:[],t.columnTree&&(!1!==t.indicatorsAsCol&&(this.internalProps.columnTree=(0,v.VN)(this.internalProps.columnTree,t.indicators)),I=new b.KO(null!=(m=this.internalProps.columnTree)?m:[],this.layoutNodeId)),t.rowTree&&(!1===t.indicatorsAsCol&&(this.internalProps.rowTree=(0,v.VN)(this.internalProps.rowTree,t.indicators)),E=new b.KO(null!=(y=this.internalProps.rowTree)?y:[],this.layoutNodeId));let D=(null==(x=null==E?void 0:E.dimensionKeys)?void 0:x.count)?E.dimensionKeys.valueArr():null!=(S=null==(_=t.rows)?void 0:_.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?S:[],W=(null==(R=null==I?void 0:I.dimensionKeys)?void 0:R.count)?I.dimensionKeys.valueArr():null!=(A=null==(H=t.columns)?void 0:H.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?A:[],O=null!=(F=null==(M=t.indicators)?void 0:M.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.indicatorKey),e),[]))?F:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(W,D),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,D,W,O,this.internalProps.indicators,null==(B=t.indicatorsAsCol)||B,t.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,C.eW)(this.internalProps.indicators)){let e=t=>{t.forEach(t=>{var i;(null==(i=t.children)?void 0:i.length)?e(t.children):t.children=[{dimensionKey:"axis",value:""}]})};(null==(T=this.dataset.rowHeaderTree)?void 0:T.length)?e(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,v.VN)(this.dataset.colHeaderTree,t.indicators)),t.rowTree||!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,v.VN)(this.dataset.rowHeaderTree,t.indicators)),I=new b.KO(null!=(z=this.dataset.colHeaderTree)?z:[],this.layoutNodeId),E=new b.KO(null!=(L=this.dataset.rowHeaderTree)?L:[],this.layoutNodeId),this.internalProps.layoutMap=new o.z(this,this.dataset,I,E),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),t.title){let e=w.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(k=this.internalProps.emptyTip)||k.resetVisible();else{let e=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(P=this.internalProps.emptyTip)||P.resetVisible()}setTimeout(()=>{this.fireListeners(p.B.INITIALIZED,null)},0)}static get EVENT_TYPE(){return r.Z}get pivotChartAxes(){return this._axes}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(e,t){let i=super._canResizeColumn(e,t);if(i&&!this.internalProps.layoutMap.indicatorsAsCol){let t=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)return!1}return i}updateOption(e){var t,i,l,r,n,s,h,d,g,p,m,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P;let I,E,D=this.internalProps;super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,u.Z)(e.columns),this.internalProps.rows=(0,u.Z)(e.rows),this.internalProps.indicators=(null==(t=e.indicators)?void 0:t.length)?(0,f.u)(e.indicators):[],this.internalProps.columnTree=!e.indicatorsAsCol||(null==(i=e.columns)?void 0:i.length)||e.columnTree?(0,u.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(l=e.rows)?void 0:l.length)||e.rowTree?(0,u.Z)(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],D.columnResizeType=null!=(s=null!=(n=null==(r=e.resize)?void 0:r.columnResizeType)?n:e.columnResizeType)?s:"column",D.rowResizeType=null!=(g=null!=(d=null==(h=e.resize)?void 0:h.rowResizeType)?d:e.rowResizeType)?g:"row",D.dataConfig={isPivotChart:!0},this._axes=(0,c.Z)(e.axes)?e.axes:[],e.columnTree&&(!1!==e.indicatorsAsCol&&(this.internalProps.columnTree=(0,v.VN)(this.internalProps.columnTree,e.indicators)),I=new b.KO(null!=(p=this.internalProps.columnTree)?p:[],this.layoutNodeId)),e.rowTree&&(!1===e.indicatorsAsCol&&(this.internalProps.rowTree=(0,v.VN)(this.internalProps.rowTree,e.indicators)),E=new b.KO(null!=(m=this.internalProps.rowTree)?m:[],this.layoutNodeId));let W=(null==(y=null==E?void 0:E.dimensionKeys)?void 0:y.count)?E.dimensionKeys.valueArr():null!=(_=null==(x=e.rows)?void 0:x.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?_:[],O=(null==(S=null==I?void 0:I.dimensionKeys)?void 0:S.count)?I.dimensionKeys.valueArr():null!=(H=null==(R=e.columns)?void 0:R.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?H:[],G=null!=(M=null==(A=e.indicators)?void 0:A.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.indicatorKey),e),[]))?M:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(O,W),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,W,O,G,this.internalProps.indicators,null==(F=e.indicatorsAsCol)||F,null!=(B=e.records)?B:this.internalProps.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,C.eW)(this.internalProps.indicators)){let e=t=>{t.forEach(t=>{var i;(null==(i=t.children)?void 0:i.length)?e(t.children):t.children=[{dimensionKey:"axis",value:""}]})};(null==(T=this.dataset.rowHeaderTree)?void 0:T.length)?e(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,v.VN)(this.dataset.colHeaderTree,e.indicators)),e.rowTree||!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,v.VN)(this.dataset.rowHeaderTree,e.indicators)),I=new b.KO(null!=(z=this.dataset.colHeaderTree)?z:[],this.layoutNodeId),E=new b.KO(null!=(L=this.dataset.rowHeaderTree)?L:[],this.layoutNodeId),D.layoutMap=new o.z(this,this.dataset,I,E),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,D.releaseList&&(D.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),D.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){let t=w.F.getComponent("title");this.internalProps.title=new t(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(k=this.internalProps.emptyTip)||k.resetVisible();else{let e=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(P=this.internalProps.emptyTip)||P.resetVisible()}return new Promise(e=>{setTimeout(e,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,i,l,o,r,n,a;let{layoutMap:s}=this.internalProps;s&&(this.colCount=null!=(e=s.colCount)?e:0,this.rowCount=null!=(t=s.rowCount)?t:0,this.internalProps.frozenColCount=null!=(i=s.rowHeaderLevelCount)?i:0,this.frozenRowCount=Math.max(s.headerLevelCount,null!=(l=this.options.frozenRowCount)?l:0),this.bottomFrozenRowCount!==(null!=(o=null==s?void 0:s.bottomFrozenRowCount)?o:0)&&(this.bottomFrozenRowCount=null!=(r=null==s?void 0:s.bottomFrozenRowCount)?r:0),this.rightFrozenColCount!==(null!=(n=null==s?void 0:s.rightFrozenColCount)?n:0)&&(this.rightFrozenColCount=null!=(a=null==s?void 0:s.rightFrozenColCount)?a:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,i){}syncHierarchyState(e,t){var i,l;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=null!=(i=t.hierarchyState)?i:(null==t?void 0:t.children)?e.hierarchyState:void 0,null==(l=null==t?void 0:t.children)||l.forEach((t,i)=>{var l;(null==(l=null==e?void 0:e.children)?void 0:l[i])&&t&&this.syncHierarchyState(e.children[i],t)}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){let{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){let{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getCellValue(e,t,i){var l,o,r;if(!i){let i=this.getCustomMergeValue(e,t);if(i)return i}if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){let i,r=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);return null==r||r.forEach(e=>{let t=this.internalProps.layoutMap.getIndicatorInfo(e);t&&(i=t)}),null!=(o=null!=(l=null==i?void 0:i.title)?l:null==i?void 0:i.indicatorKey)?o:""}let{title:i,fieldFormat:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r(i,e,t,this):i}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=l.colHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"col",index:t}),null!=(l=e.indicatorKey)?l:e.value}),r=l.rowHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"row",index:t}),null!=(l=e.indicatorKey)?l:e.value}),n=this.dataset.getAggregator(r,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,i);return n.value?n.value():void 0}let{fieldFormat:n}=this.internalProps.layoutMap.getBody(e,t),a=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e),h=null==(r=this.records[a])?void 0:r[s];return"function"==typeof n?n(h,e,t,this):h}getCellOriginValue(e,t){var i,l,o;if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){let o,r=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);return null==r||r.forEach(e=>{let t=this.internalProps.layoutMap.getIndicatorInfo(e);t&&(o=t)}),null!=(l=null!=(i=null==o?void 0:o.title)?i:null==o?void 0:o.indicatorKey)?l:""}let{title:o}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof o?o():o}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=l.colHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"col",index:t}),null!=(l=e.indicatorKey)?l:e.value}),r=l.rowHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"row",index:t}),null!=(l=e.indicatorKey)?l:e.value}),n=this.dataset.getAggregator(r,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,i);return n.value?n.value():void 0}let r=this.getBodyIndexByRow(t),n=this.getBodyIndexByCol(e);return null==(o=this.records[r])?void 0:o[n]}getCellRawValue(e,t){return this.getCellOriginValue(e,t)}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)&&this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=l.colHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"col",index:t}),null!=(l=e.indicatorKey)?l:e.value}),r=l.rowHeaderPaths.map((e,t)=>{var l;return e.indicatorKey&&(i={position:"row",index:t}),null!=(l=e.indicatorKey)?l:e.value});return this.dataset.getAggregator(r,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,i).records}}getCellRawRecord(e,t){return this.getCellOriginRecord(e,t)}getPivotSortState(e,t){if(!this.pivotSortState)return;let i=this.getCellRange(e,t);for(let e=0;e<this.pivotSortState.length;e++){let{col:t,row:l,order:o}=this.pivotSortState[e];if((0,n._Z)(i,t,l))return o}}_moveHeaderPosition(e,t){var i,l,o,r;let n=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(n){if("column"===n.moveType){if((null==(l=null==(i=this.options.records)?void 0:i[0])?void 0:l.constructor)===Array)for(let e=0;e<this.internalProps.records.length;e++){let t=this.internalProps.records[e].splice(n.sourceIndex-this.rowHeaderLevelCount,n.sourceSize);t.unshift(n.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[e],t)}this.colWidthsMap.adjustOrder(n.sourceIndex,n.targetIndex,n.sourceSize),this.setMinMaxLimitWidth()}else if("row"===n.moveType){if((null==(r=null==(o=this.options.records)?void 0:o[0])?void 0:r.constructor)===Array){let e=this.internalProps.records.splice(n.sourceIndex-this.columnHeaderLevelCount,n.sourceSize);e.unshift(n.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,e)}this.rowHeightsMap.adjustOrder(n.sourceIndex,n.targetIndex,n.sourceSize)}return n}return null}toggleHierarchyState(e,t,i=!0){}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return null==(i=this._getHeaderLayoutMap(e,t))?void 0:i.hierarchyState}getMenuInfo(e,t,i){let l=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:l[l.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}_generateCollectValuesConfig(e,t){var i,l,o,r,n,a,h,d,u,c,g,p,f,b,C,v,w;e=e.filter(e=>e!==m.ek),t=t.filter(e=>e!==m.ek);let y=this.internalProps.indicators,x={};for(let m=0,S=null==y?void 0:y.length;m<S;m++)if("string"!=typeof y[m]&&y[m].chartSpec){if("pie"===(null==(i=y[m].chartSpec)?void 0:i.type)||"rose"===(null==(l=y[m].chartSpec)?void 0:l.type)||"radar"===(null==(o=y[m].chartSpec)?void 0:o.type)||"gauge"===(null==(r=y[m].chartSpec)?void 0:r.type)||"wordCloud"===(null==(n=y[m].chartSpec)?void 0:n.type))continue;let S=y[m],R=S.chartSpec;if(!1===this.options.indicatorsAsCol)if(!1!==(null==R?void 0:R.stack)&&("bar"===(null==R?void 0:R.type)||"area"===(null==R?void 0:R.type))&&(R.stack=!0),x[S.indicatorKey]={by:t,range:!0,sumBy:(null==R?void 0:R.stack)&&e.concat(null==R?void 0:R.xField)},R.series)R.series.forEach(i=>{var l,o,r,n,a,h,d,u,c,g,p,f,b,m;let C="string"==typeof i.xField?i.xField:i.xField[0];x[C]={by:e,type:"horizontal"!==i.direction?"xField":void 0,range:(0,_.Wm)(i,this._axes,"horizontal"===i.direction,!0),sortBy:"horizontal"!==i.direction?null!=(n=null==(r=null==(o=null==(l=null==i?void 0:i.data)?void 0:l.fields)?void 0:o[C])?void 0:r.domain)?n:null==(d=null==(h=null==(a=null==R?void 0:R.data)?void 0:a.fields)?void 0:h[C])?void 0:d.domain:void 0};let v=i.yField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),x[v]={by:t,range:(0,_.Wm)(i,this._axes,"horizontal"===i.direction,!1),sumBy:i.stack&&e.concat(null==i?void 0:i.xField),sortBy:"horizontal"===i.direction?null!=(p=null==(g=null==(c=null==(u=null==i?void 0:i.data)?void 0:u.fields)?void 0:c[v])?void 0:g.domain)?p:null==(m=null==(b=null==(f=null==R?void 0:R.data)?void 0:f.fields)?void 0:b[v])?void 0:m.domain:void 0,extendRange:(0,s.FJ)(R.markLine)}});else{let i="string"==typeof R.xField?R.xField:R.xField[0];x[i]={by:e,type:"horizontal"!==R.direction?"xField":void 0,range:(0,_.Wm)(R,this._axes,"horizontal"===R.direction,!0),sortBy:"horizontal"!==R.direction?null==(d=null==(h=null==(a=null==R?void 0:R.data)?void 0:a.fields)?void 0:h[i])?void 0:d.domain:void 0},!1!==(null==R?void 0:R.stack)&&("bar"===(null==R?void 0:R.type)||"area"===(null==R?void 0:R.type))&&(R.stack=!0);let l=R.yField;x[l]={by:t,range:"horizontal"!==R.direction,sumBy:R.stack&&e.concat(null==R?void 0:R.xField),sortBy:"horizontal"===R.direction?null==(g=null==(c=null==(u=null==R?void 0:R.data)?void 0:u.fields)?void 0:c[l])?void 0:g.domain:void 0,extendRange:(0,s.FJ)(R.markLine)}}else{let i=y[m];if(!1!==(null==R?void 0:R.stack)&&("bar"===(null==R?void 0:R.type)||"area"===(null==R?void 0:R.type))&&(R.stack=!0),x[i.indicatorKey]={by:e,range:!0,sumBy:(null==R?void 0:R.stack)&&t.concat(null==R?void 0:R.yField)},R.series)R.series.forEach(i=>{var l,o,r,n,a,h,d,u,c,g,p,f,b,m;let C="string"==typeof i.yField?i.yField:i.yField[0];x[C]={by:t,type:"horizontal"===i.direction?"yField":void 0,range:(0,_.Wm)(i,this._axes,"horizontal"===i.direction,!1),sortBy:"horizontal"===i.direction?null!=(n=null==(r=null==(o=null==(l=null==i?void 0:i.data)?void 0:l.fields)?void 0:o[C])?void 0:r.domain)?n:null==(d=null==(h=null==(a=null==R?void 0:R.data)?void 0:a.fields)?void 0:h[C])?void 0:d.domain:void 0};let v=i.xField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),x[v]={by:e,range:(0,_.Wm)(i,this._axes,"horizontal"===i.direction,!0),sumBy:i.stack&&t.concat(null==i?void 0:i.yField),sortBy:"horizontal"!==i.direction?null!=(p=null==(g=null==(c=null==(u=null==i?void 0:i.data)?void 0:u.fields)?void 0:c[v])?void 0:g.domain)?p:null==(m=null==(b=null==(f=null==R?void 0:R.data)?void 0:f.fields)?void 0:b[v])?void 0:m.domain:void 0,extendRange:(0,s.FJ)(R.markLine)}});else{let i="string"==typeof R.yField?R.yField:R.yField[0];x[i]={by:t,type:"horizontal"===R.direction?"yField":void 0,range:(0,_.Wm)(R,this._axes,"horizontal"===R.direction,!1),sortBy:"horizontal"===R.direction?null==(b=null==(f=null==(p=null==R?void 0:R.data)?void 0:p.fields)?void 0:f[i])?void 0:b.domain:void 0},!1!==(null==R?void 0:R.stack)&&("bar"===(null==R?void 0:R.type)||"area"===(null==R?void 0:R.type))&&(R.stack=!0);let l=R.xField;x[l]={by:e,range:(0,_.Wm)(R,this._axes,"horizontal"===R.direction,!0),sumBy:R.stack&&t.concat(null==R?void 0:R.yField),sortBy:"horizontal"!==R.direction?null==(w=null==(v=null==(C=null==R?void 0:R.data)?void 0:C.fields)?void 0:v[l])?void 0:w.domain:void 0,extendRange:(0,s.FJ)(R.markLine)}}}}return x}_generateAggregationRules(){var e;let t=[];return null==(e=this.internalProps.indicators)||e.forEach(e=>{var i,o;if("string"==typeof e)t.push({indicatorKey:e,field:e,aggregationType:l.E.RECORD});else if(null==(i=e.chartSpec)?void 0:i.series){let i=[];null==(o=e.chartSpec)||o.series.forEach(e=>{let t=!1===this.options.indicatorsAsCol?e.yField:e.xField;-1===i.indexOf(t)&&i.push(t)}),t.push({indicatorKey:e.indicatorKey,field:i,aggregationType:l.E.RECORD})}else{let i=!1===this.options.indicatorsAsCol?e.chartSpec.yField:e.chartSpec.xField;t.push({indicatorKey:e.indicatorKey,field:null!=i?i:e.indicatorKey,aggregationType:l.E.RECORD})}}),t}setCustomStateNameToSpec(){var e;let t=e=>{var t,i,l,o,r,n,a,s,h,d;(null==(i=null==(t=e.bar)?void 0:t.state)?void 0:i.selected)&&(e.bar.state.vtable_selected=e.bar.state.selected,e.bar.state.vtable_selected_reverse=e.bar.state.selected_reverse,delete e.bar.state.selected,delete e.bar.state.selected_reverse),(null==(o=null==(l=e.point)?void 0:l.state)?void 0:o.selected)&&(e.point.state.vtable_selected=e.point.state.selected,e.point.state.vtable_selected_reverse=e.point.state.selected_reverse,delete e.point.state.selected,delete e.point.state.selected_reverse),(null==(n=null==(r=e.line)?void 0:r.state)?void 0:n.selected)&&(e.line.state.vtable_selected=e.line.state.selected,e.line.state.vtable_selected_reverse=e.line.state.selected_reverse,delete e.line.state.selected,delete e.line.state.selected_reverse),(null==(s=null==(a=e.area)?void 0:a.state)?void 0:s.selected)&&(e.area.state.vtable_selected=e.area.state.selected,e.area.state.vtable_selected_reverse=e.area.state.selected_reverse,delete e.area.state.selected,delete e.area.state.selected_reverse),(null==(d=null==(h=e.pie)?void 0:h.state)?void 0:d.selected)&&(e.pie.state.vtable_selected=e.pie.state.selected,e.pie.state.vtable_selected_reverse=e.pie.state.selected_reverse,delete e.pie.state.selected,delete e.pie.state.selected_reverse)};null==(e=this.internalProps.indicators)||e.forEach(e=>{if(e.chartSpec){let i=e.chartSpec;i.series?i.series.forEach(e=>{t(e)}):t(i)}})}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),(0,d.RW)(this.scenegraph),(0,d.zO)(this.scenegraph),this.render()}clearChartCacheImage(e,t){(0,g.Z)(e)&&(0,g.Z)(t)?(0,d.KP)(e,t,this.scenegraph):(0,d.RW)(this.scenegraph)}getLegendSelected(){var e;let t=[];return null==(e=this.internalProps.legends)||e.forEach(e=>{let i=e.legendComponent._getSelectedLegends().map(e=>e.label);t.push(...i)}),t}setLegendSelected(e){var t;null==(t=this.internalProps.legends)||t.forEach(t=>{t.legendComponent.setSelected(e)})}getChartDatumPosition(e,t){let{chartInstance:i,bounds:l}=this.getChartInstance(t);if(i){let t=i.convertDatumToPosition(e);return t?{x:Math.round(t.x+l.x1),y:Math.round(t.y+l.y1)}:null}return null}getCellAddressByRecord(e){let t=[],i=[],l={},o=[];for(let r in this.dataset.dataConfig.aggregationRules.forEach(e=>{if("string"==typeof e.field)l[e.field]=e.indicatorKey,o.push(e.field);else for(let t=0;t<e.field.length;t++)l[e.field[t]]=e.indicatorKey,o.push(e.field[t])}),e)this.dataset.rows.indexOf(r)>=0&&t.push({dimensionKey:r,value:e[r]}),this.dataset.columns.indexOf(r)>=0&&i.push({dimensionKey:r,value:e[r]}),o.indexOf(r)>=0&&(this.dataset.indicatorsAsCol?i.push({indicatorKey:l[r]}):t.push({indicatorKey:l[r]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:t,colHeaderPaths:i,cellLocation:"body"})}getChartInstance(e){var t,i,l,o,r;let n=this.getCellAddressByHeaderPaths(e);if(n){let e,a=this.getCellRelativeRect(n.col,n.row),s=this.scenegraph.getCell(n.col,n.row),h=null==(t=null==s?void 0:s.getChildren())?void 0:t[0];if(h.attribute.chartInstance){e=h.attribute.chartInstance;let{dataId:t,data:n,axes:a,spec:s}=h.attribute,d=h.getViewBox();null==a||a.forEach((t,i)=>{var l,o,r,n,a;"linear"===t.type?e.updateModelSpecSync({type:"axes",index:i},{min:null!=(o=null==(l=t.range)?void 0:l.min)?o:0,max:null!=(n=null==(r=t.range)?void 0:r.max)?n:0,tick:{tickMode:null==(a=t.tick)?void 0:a.tickMode}},!0):"band"===t.type&&e.updateModelSpec({type:"axes",index:i},{domain:t.domain.slice(0)},!0)}),e.updateViewBox({x1:0,x2:d.x2-d.x1,y1:0,y2:d.y2-d.y1},!1,!1);let u=e.getStage(),c=h.globalTransMatrix.clone(),g=h.stage.window.getViewBoxTransform();if(c.multiply(g.a,g.b,g.c,g.d,g.e,g.f),u.window.setViewBoxTransform&&u.window.setViewBoxTransform(c.a,c.b,c.c,c.d,c.e,c.f),"string"==typeof t)e.updateDataSync(t,null!=n?n:[]);else{let a=[];for(let r in t){let h=t[r],d=s.series.find(e=>{var t;return(null==(t=null==e?void 0:e.data)?void 0:t.id)===r});a.push({id:r,values:h?null!=(i=null==n?void 0:n.filter(e=>e.hasOwnProperty(h)))?i:[]:null!=n?n:[],fields:null==(l=null==d?void 0:d.data)?void 0:l.fields}),e.updateFullDataSync||e.updateDataSync(r,h?null!=(o=null==n?void 0:n.filter(e=>e.hasOwnProperty(h)))?o:[]:null!=n?n:[])}null==(r=e.updateFullDataSync)||r.call(e,a)}this.render()}return{chartInstance:e,bounds:a.bounds}}return{}}activateChartInstance(e){var t,i,l,o,r;let n=this.getCellAddressByHeaderPaths(e);if(n){let e=n.col,a=n.row,s=this.scenegraph.getCell(e,a),h=null==(t=null==s?void 0:s.getChildren())?void 0:t[0],d=this.scenegraph.activateChart(e,a),{dataId:u,data:c,axes:g,spec:p}=h.attribute,f=h.getViewBox();null==g||g.forEach((e,t)=>{var i,l,o,r,n;"linear"===e.type?d.updateModelSpecSync({type:"axes",index:t},{min:null!=(l=null==(i=e.range)?void 0:i.min)?l:0,max:null!=(r=null==(o=e.range)?void 0:o.max)?r:0,tick:{tickMode:null==(n=e.tick)?void 0:n.tickMode}},!0):"band"===e.type&&d.updateModelSpec({type:"axes",index:t},{domain:e.domain.slice(0)},!0)}),d.updateViewBox({x1:0,x2:f.x2-f.x1,y1:0,y2:f.y2-f.y1},!1,!1);let b=d.getStage();b.needRender=!0;let m=h.globalTransMatrix.clone(),C=h.stage.window.getViewBoxTransform().clone();if(C.multiply(m.a,m.b,m.c,m.d,m.e,m.f),b.window.setViewBoxTransform(C.a,C.b,C.c,C.d,C.e,C.f),"string"==typeof u)d.updateDataSync(u,null!=c?c:[]);else{let e=[];for(let t in u){let r=u[t],n=p.series.find(e=>{var i;return(null==(i=null==e?void 0:e.data)?void 0:i.id)===t});e.push({id:t,values:r?null!=(i=null==c?void 0:c.filter(e=>e.hasOwnProperty(r)))?i:[]:null!=c?c:[],fields:null==(l=null==n?void 0:n.data)?void 0:l.fields}),d.updateFullDataSync||d.updateDataSync(t,r?null!=(o=null==c?void 0:c.filter(e=>e.hasOwnProperty(r)))?o:[]:null!=c?c:[])}null==(r=d.updateFullDataSync)||r.call(d,e)}return d}}replaceChartCacheImage(e,t){var i;let l=this.getCellAddressByHeaderPaths(e);if(l){let e=this.scenegraph.getCell(l.col,l.row),o=null==(i=null==e?void 0:e.getChildren())?void 0:i[0];(0,S.Up)(t.getStage(),o)}}_getDimensionSortArray(){var e,t;if(null==(t=null==(e=this.options)?void 0:e.axes)?void 0:t.length){let e=this.options.indicatorsAsCol?"left":"bottom",t=this.options.axes.find(t=>t.orient===e);if(t&&(0,c.Z)(t.domain))return t.domain}}setRecords(e){var t,i;let l,r;this.internalProps.layoutMap.release(),(0,S.H6)();let n={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e;let a=this.options,s=this.internalProps;this.dataset.setRecords(e),l=a.columnTree?s.layoutMap.columnDimensionTree:new b.KO(null!=(t=this.dataset.colHeaderTree)?t:[],this.layoutNodeId),r=a.rowTree?s.layoutMap.rowDimensionTree:new b.KO(null!=(i=this.dataset.rowHeaderTree)?i:[],this.layoutNodeId),s.layoutMap=new o.z(this,this.dataset,l,r),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(n.col,n.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let e=0;e<i.length;e++){let t=i[e];if("string"!=typeof t&&(t.customLayout||t.headerCustomLayout||t.customRender||t.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}}},80363:function(e,t,i){"use strict";i.d(t,{U:()=>n,f:()=>o});var l=i(77597);let o={},r={};function n(){return(0,l.l7)(r,o)}},79229:function(e,t,i){"use strict";i.d(t,{UP:()=>p,b8:()=>g,$M:()=>u,iR:()=>d,Zu:()=>c,sG:()=>f});var l=i(91212),o=i(29753),r=i(8287),n=i(58853),a=i(16369),s=i(47755);let h={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},d="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",u=14,c={FONT_FAMILY:d,LABEL_FONT_SIZE:14,MAP_LABEL_FONT_SIZE:10,TITLE_FONT_SIZE:18,AXIS_TICK_SIZE:4},g={domainLine:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:c.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:c.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:c.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:c.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function p(e){var t,i;return(null==(i=null==(t=null==e?void 0:e.colorScheme)?void 0:t.default)?void 0:i.palette)?(0,l.Z)({},g,{tick:{style:{stroke:e.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:e.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:e.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:e.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):g}function f(e){var t,i,d,u,c,g,p,f,b,m,C,v,w;let y=(0,l.Z)({},e),x,_=null!=(i=null==(t=y.title)?void 0:t.angle)?i:0;"left"!==y.orient&&"right"!==y.orient||(null==(d=y.title)?void 0:d.autoRotate)&&(0,o.Z)(y.title.angle)&&(_="left"===y.orient?-90:90,x=h[y.orient]);let S=function(e,t){if(!e||!(0,r.Z)(e))return e;let i={};return Object.keys(e).forEach(l=>{let o=e[l],r=!1;t.forEach(e=>{((0,n.Z)(e)&&e===l||e instanceof RegExp&&l.match(e))&&(r=!0)}),r||(i[l]=o)}),i}(y.label,["style","formatMethod","state"]);return{orient:y.orient,select:y.select,hover:y.hover,line:(0,s.lc)(y.domainLine),label:Object.assign({style:(0,s.h_)(y.label.style),formatMethod:y.label.formatMethod?(e,t,i)=>y.label.formatMethod(t.rawValue,t):null,state:(0,s.Zv)(y.label.state)},S),tick:{visible:y.tick.visible,length:y.tick.tickSize,inside:y.tick.inside,alignWithLabel:y.tick.alignWithLabel,style:(0,s.h_)(y.tick.style),state:(0,s.Zv)(y.tick.state),dataFilter:y.tick.dataFilter},subTick:{visible:y.subTick.visible,length:y.subTick.tickSize,inside:y.subTick.inside,count:y.subTick.tickCount,style:(0,s.h_)(y.subTick.style),state:(0,s.Zv)(y.subTick.state)},grid:{type:"line",visible:y.grid.visible,alternateColor:y.grid.alternateColor,alignWithLabel:y.grid.alignWithLabel,style:(0,s.h_)(y.grid.style)},subGrid:{type:"line",visible:y.subGrid.visible,alternateColor:y.subGrid.alternateColor,style:(0,s.h_)(y.subGrid.style)},title:{visible:y.title.visible,position:y.title.position,space:y.title.space,autoRotate:!1,angle:_?(0,a.M4)(_):null,textStyle:(0,l.Z)({},x,(0,s.h_)(y.title.style)),padding:y.title.padding,shape:{visible:null==(u=y.title.shape)?void 0:u.visible,space:null==(c=y.title.shape)?void 0:c.space,style:(0,s.h_)(null==(g=y.title.shape)?void 0:g.style)},background:{visible:null==(p=y.title.background)?void 0:p.visible,style:(0,s.h_)(null==(f=y.title.background)?void 0:f.style)},state:{text:(0,s.Zv)(y.title.state),shape:(0,s.Zv)(null==(b=y.title.shape)?void 0:b.state),background:(0,s.Zv)(null==(m=y.title.background)?void 0:m.state)}},panel:{visible:null==(C=y.background)?void 0:C.visible,style:(0,s.h_)(null==(v=y.background)?void 0:v.style),state:(0,s.Zv)(null==(w=y.background)?void 0:w.state)}}}},50173:function(e,t,i){"use strict";i.d(t,{Mh:()=>e9,Eg:()=>e6,ph:()=>e7,FD:()=>e4,_t:()=>e8,R2:()=>e3,I:()=>e5});var l,o,r=i(75025),n=i(51235),a=i(91212),s=i(33657),h=i(29753),d=i(16369),u=i(7210),c=i(79229);function g(e){return"bottom"===e||"top"===e}var p=i(44787),f=i(43735);class b{constructor(){this._scale=new p.j,this._scales=[this._scale]}valueToPosition(e){return this._scale.scale(e)}getPosition(e){let t=0,i=this._scale;if(1===this._scales.length||1===e.length)t=this.valueToPosition(e[0]);else{let l=Math.min(e.length,this._scales.length);for(let i=0;i<l;i++)t+=this._scales[i].scale(e[i]);i=this._scales[l-1]}return{position:t,bandScale:i}}calcScales(e,t){var i,l;let{bandPadding:o,paddingInner:r,paddingOuter:n}=this,a=(0,f.Z)(o),s=(0,f.Z)(r),h=(0,f.Z)(n);for(let d=0;d<this._scales.length;d++){let u=a?o[d]:o,c=s?r[d]:r,g=h?n[d]:n;this._scales[d].paddingInner(null!=(i=null!=c?c:u)?i:e,!0).paddingOuter(null!=(l=null!=g?g:u)?l:t)}}dataToPosition(e,t={}){var i;if(0===e.length||0===this._scales.length)return 0;let{position:l,bandScale:o}=this.getPosition(e);return l+o.bandwidth()*(null!=(i=t.bandPosition)?i:.5)}updateScaleDomain(e){for(let t=0;t<this._scales.length;t++)this._scales[t].domain(e)}updateRange(e){let[t,i]=this._scale.range();e[0]===t&&e[1]===i||this._scale.range(e)}}var m=i(21883),C=i.n(m),v=i(12709);let w="undefined"!=typeof console;function y(e,t,i){let l=[t].concat([].slice.call(i));w&&console[e].apply(console,l)}(l=o||(o={}))[l.None=0]="None",l[l.Error=1]="Error",l[l.Warn=2]="Warn",l[l.Info=3]="Info",l[l.Debug=4]="Debug";class x{static getInstance(e,t){return x._instance&&(0,v.Z)(e)?x._instance.level(e):x._instance||(x._instance=new x(e,t)),x._instance}static setInstance(e){return x._instance=e}static setInstanceLevel(e){x._instance?x._instance.level(e):x._instance=new x(e)}static clearInstance(){x._instance=null}constructor(e=o.None,t){this._onErrorHandler=[],this._level=e,this._method=t}addErrorHandler(e){this._onErrorHandler.find(t=>t===e)||this._onErrorHandler.push(e)}removeErrorHandler(e){let t=this._onErrorHandler.findIndex(t=>t===e);t<0||this._onErrorHandler.splice(t,1)}callErrorHandler(...e){this._onErrorHandler.forEach(t=>t(...e))}canLogInfo(){return this._level>=o.Info}canLogDebug(){return this._level>=o.Debug}canLogError(){return this._level>=o.Error}canLogWarn(){return this._level>=o.Warn}level(e){return arguments.length?(this._level=+e,this):this._level}error(...e){var t;return this._level>=o.Error&&(this._onErrorHandler.length?this.callErrorHandler(...e):y(null!=(t=this._method)?t:"error","ERROR",e)),this}warn(...e){return this._level>=o.Warn&&y(this._method||"warn","WARN",e),this}info(...e){return this._level>=o.Info&&y(this._method||"log","INFO",e),this}debug(...e){return this._level>=o.Debug&&y(this._method||"log","DEBUG",e),this}}x._instance=null;var _=i(42769);class S{constructor(e){var t;let i;this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(C()),i=(null==e?void 0:e.name)?e.name:(0,_.F)("dataset"),this.name=i,this._logger=null!=(t=null==e?void 0:e.logger)?t:x.getInstance()}setLogger(e){this._logger=e}getDataView(e){return this.dataViewMap[e]}setDataView(e,t){var i;this.dataViewMap[e]&&(null==(i=this._logger)||i.error(`Error: dataView ${e} 之前已存在，请重新命名`)),this.dataViewMap[e]=t}removeDataView(e){this.dataViewMap[e]=null,delete this.dataViewMap[e]}registerParser(e,t){var i;this.parserMap[e]&&(null==(i=this._logger)||i.warn(`Warn: transform ${e} 之前已注册，执行覆盖逻辑`)),this.parserMap[e]=t}removeParser(e){this.parserMap[e]=null,delete this.parserMap[e]}getParser(e){return this.parserMap[e]||this.parserMap.default}registerTransform(e,t){var i;this.transformMap[e]&&(null==(i=this._logger)||i.warn(`Warn: transform ${e} 之前已注册，执行覆盖逻辑`)),this.transformMap[e]=t}removeTransform(e){this.transformMap[e]=null,delete this.transformMap[e]}getTransform(e){return this.transformMap[e]}multipleDataViewAddListener(e,t,i){this._callMap||(this._callMap=new Map);let l=this._callMap.get(i);l||(l=()=>{e.some(e=>e.isRunning)||i()}),e.forEach(e=>{e.target.addListener(t,l)}),this._callMap.set(i,l)}allDataViewAddListener(e,t){this.multipleDataViewAddListener(Object.values(this.dataViewMap),e,t)}multipleDataViewRemoveListener(e,t,i){if(this._callMap){let l=this._callMap.get(i);l&&e.forEach(e=>{e.target.removeListener(t,l)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(e){e.forEach(e=>{var t;return null==(t=this.getDataView(e.name))?void 0:t.markRunning()}),e.forEach(e=>{var t;return null==(t=this.getDataView(e.name))?void 0:t.parseNewData(e.data,e.options)})}multipleDataViewUpdateInRawData(e){e.forEach(e=>{var t;return null==(t=this.getDataView(e.name))?void 0:t.markRunning()}),e.forEach(e=>{var t;return null==(t=this.getDataView(e.name))?void 0:t.updateRawData(e.data,e.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}var R=i(43286),H=i(83143),A=i(29685),M=i(80133),F=i(19288),B=i(37922);let T=(e,t)=>{if((0,H.z2)(e.type))return(0,A.m)(e,t);if((0,H.lK)(e.type)){if("cartesian"===t.coordinateType)return(0,M.U)(e,t);if("polar"===t.coordinateType&&"angle"===t.axisOrientType)return(0,F.t)(e,t)}return(0,B.KV)(e.domain())};var z=i(37352),L=i(25777),k=i(32889),P=i(18585),I=i(45269);let E=Math.sqrt(50),D=Math.sqrt(10),W=Math.sqrt(2);class O{constructor(e){this._extend={},this.type=null!=e?e:"linear",this._scale="log"===e?new z.Y:"symlog"===e?new L.g:new k.f,this._scales=[this._scale]}setExtraAttrFromSpec(e,t,i,l,o,r){this.nice=!1,this.zero=t,this.zero&&(i.min=Math.min(i.min,0),i.max=Math.max(i.max,0)),this.domain=i,this.expand=l,"log"===this.type?this._scale.base(null!=o?o:10):"symlog"===this.type&&this._scale.constant(null!=r?r:10)}transformScaleDomain(){"symlog"===this.type||"log"===this.type||this.setScaleNice()}setScaleNice(){"log"===this.type?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var e,t,i,l,o,r;(0,h.Z)(null==(e=this.domain)?void 0:e.min)&&(0,h.Z)(null==(t=this.domain)?void 0:t.max)?this.nice&&this._scale.nice():(0,P.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(l=this.domain)?void 0:l.max)?this.nice&&this._scale.niceMax():(0,h.Z)(null==(o=this.domain)?void 0:o.min)&&(0,P.Z)(null==(r=this.domain)?void 0:r.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var e,t,i,l,o,r,n,a;let s=null!=(t=null!=(e=this.forceTickCount)?e:this.tickCount)?t:10;"accurateFirst"===this.niceType&&(s=Math.max(10,s)),(0,h.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(l=this.domain)?void 0:l.max)?this.nice&&this._scale.nice(s):(0,P.Z)(null==(o=this.domain)?void 0:o.min)&&(0,h.Z)(null==(r=this.domain)?void 0:r.max)?this.nice&&this._scale.niceMax(s):(0,h.Z)(null==(n=this.domain)?void 0:n.min)&&(0,P.Z)(null==(a=this.domain)?void 0:a.max)?this.nice&&this._scale.niceMin(s):this.nice&&this._scale.nice(s)}dataToPosition(e){return this.valueToPosition(e[0])}valueToPosition(e){return this._scale.scale(e)}computeLinearDomain(e){let t=[];return e.forEach(e=>{let{min:i,max:l}=e;t[0]=void 0===t[0]?i:Math.min(t[0],i),t[1]=void 0===t[1]?l:Math.max(t[1],l)}),this.expandDomain(t),this.includeZero(t),this.setDomainMinMax(t),t}expandDomain(e){if(!this.expand)return;let t=e[0],i=e[e.length-1];(0,P.Z)(this.expand.min)&&(e[0]=t-(i-t)*this.expand.min),(0,P.Z)(this.expand.max)&&(e[e.length-1]=i+(i-t)*this.expand.max)}niceDomain(e){if((0,P.Z)(e[0])||(0,P.Z)(e[1])||"linear"!==this.type)return e;if(1e-12>=Math.abs((0,I.iH)(e)-(0,I.CE)(e))){let t=e[0],i=t>=0?1:-1;if((t=Math.abs(t))<1)e[0]=0,e[1]=1;else{let i=t/5,l=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,l);i=(o>=E?10:o>=D?5:o>=W?2:1)*Math.pow(10,l),e[0]=0,e[1]=10*i}i<0&&(e.reverse(),e[0]*=-1,e[1]*=-1)}return e}niceMinMax(){var e,t,i,l,o,r,n,a;if(this.nice){let s=null!=(t=null!=(e=this.forceTickCount)?e:this.tickCount)?t:10;"accurateFirst"===this.niceType&&(s=Math.max(10,s)),(0,h.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(l=this.domain)?void 0:l.max)?this._scale.nice(s):(0,P.Z)(null==(o=this.domain)?void 0:o.min)&&(0,h.Z)(null==(r=this.domain)?void 0:r.max)?this._scale.niceMax(s):(0,h.Z)(null==(n=this.domain)?void 0:n.min)&&(0,P.Z)(null==(a=this.domain)?void 0:a.max)?this._scale.niceMin(s):this._scale.nice(s)}}includeZero(e){this.zero&&(e[0]=Math.min(e[0],0),e[e.length-1]=Math.max(e[e.length-1],0))}setExtendDomain(e,t){if(void 0===t)return void delete this._extend[e];this._extend[e]=t;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this.nice),this.niceMinMax()}extendDomain(e){let t,i=e.length-1,l=e[0]-e[i]>0,o=l?i:0,r=l?0:i;for(let i in this._extend)(t=this._extend[i])>e[r]&&(e[r]=t),t<e[o]&&(e[o]=t)}setDomainMinMax(e){if(!this.domain)return;let{min:t,max:i}=this.domain;(0,P.Z)(t)&&(e[0]=t),(0,P.Z)(i)&&(e[1]=i)}setZero(e){this.zero!==e&&(this.zero=e,this.updateScaleDomain())}updateScaleDomain(){let e=this.computeDomain([this.domain]);this.updateScaleDomainByModel(e)}computeDomain(e){return this.computeLinearDomain(e)}updateScaleDomainByModel(e){e=null!=e?e:this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this.nice),this.niceMinMax()}updateRange(e){let[t,i]=this._scale.range();e[0]===t&&e[1]===i||this._scale.range(e)}}var G=i(43572);function N(e,t){var i;let l=t.option;(0,G.Z)(e)||(null==(i=null==l?void 0:l.label)?void 0:i.flush)&&function(e,t){let{width:i,height:l}=t.getLayoutRect(),o=g(t.orient),r=!0===t.option.inverse,n=e[0],a=(0,I.Z$)(e);if(o)if(r){let e=n.AABBBounds.x2,t=a.AABBBounds.x1;e>i&&n.setAttributes({x:i,textAlign:"right"}),t<0&&a.setAttributes({x:0,textAlign:"left"})}else{let e=n.AABBBounds.x1,t=a.AABBBounds.x2;e<0&&n.setAttributes({x:0,textAlign:"left"}),t>i&&a.setAttributes({x:i,textAlign:"right"})}else if(r){let e=n.AABBBounds.y1,t=a.AABBBounds.y2;e<0&&n.setAttributes({y:0,textBaseline:"top"}),t>l&&a.setAttributes({y:l,textBaseline:"bottom"})}else{let e=n.AABBBounds.y2,t=a.AABBBounds.y1;e>l&&n.setAttributes({y:l,textBaseline:"bottom"}),t<0&&a.setAttributes({y:0,textBaseline:"top"})}}(e,t)}let Z=e=>e;class K{constructor(e,t,i,l,o){var r,n,s,h,d;let u;(this.x=0,this.y=0,this.padding=l,this.table=o,this.orient=null!=(r=e.orient)?r:"left",this.type=null!=(n=e.type)?n:"band",this.option=(0,a.Z)({},(0,c.UP)(e.__vtableChartTheme),(h=this.orient,d=o.theme,"left"===h?u=d.axisStyle.leftAxisStyle:"right"===h?u=d.axisStyle.rightAxisStyle:"top"===h?u=d.axisStyle.topAxisStyle:"bottom"===h&&(u=d.axisStyle.bottomAxisStyle),(0,a.Z)({},d.axisStyle.defaultAxisStyle,u)),function(e,t,i){let l,o;if(!i)return{};let r=i.axis;return"linear"===t||"log"===t||"symlog"===t?l=i.axisLinear:"band"===t&&(l=i.axisBand),"top"===e||"bottom"===e?o=i.axisX:"left"!==e&&"right"!==e||(o=i.axisY),(0,a.Z)({},r,l,o)}(this.orient,this.type,e.__vtableChartTheme),e),"left"===this.orient||"right"===this.orient)?(this.width=t,this.height=i-l[0]-l[2]-0,this.y=l[0]+0):("top"===this.orient||"bottom"===this.orient)&&(this.width=t-l[1]-l[3]-0,this.height=i,this.x=l[3]+0),this.visible=null==(s=e.visible)||s,this.inverse="inverse"in e&&!!e.inverse,"band"===e.type&&(this.data=e.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){let e=this.option;"band"===this.type||"point"===this.type?(this.scale=new b,this.scale.bandPadding=e.bandPadding,this.scale.paddingInner=e.paddingInner,this.scale.paddingOuter=e.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):"linear"!==this.type&&"time"!==this.type&&"log"!==this.type&&"symlog"!==this.type||(this.scale=new O(this.type),this.scale.setExtraAttrFromSpec(e.nice,e.zero,e.range,e.expand,e.base,e.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){var e,t,i,l;this.table._vDataSet||(this.table._vDataSet=new S),e=this.table._vDataSet,t="scale",e.getParser(t)||e.registerParser(t,Z),i=this.table._vDataSet,l="ticks",i.getTransform(l)||i.registerTransform(l,T);let o=this.option.label||{},r=this.option.tick||{},n=new R.VO(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:!1!==this.option.sampling,tickCount:r.tickCount,forceTickCount:r.forceTickCount,tickStep:r.tickStep,tickMode:r.tickMode,noDecimals:r.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:o.style,labelFormatter:o.formatMethod,labelGap:o.minGap,labelLastVisible:o.lastVisible,labelFlush:o.flush}},!1);this.tickData=n,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){let e=(0,c.sG)(this.option),t=this.getUpdateAttribute();t.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component=new u.$((0,a.Z)({disableTriggerEvent:this.table.options.disableInteraction},e,t)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(e,t){this.width=e-("top"===this.orient||"bottom"===this.orient?this.padding[1]+this.padding[3]:0),this.height=t-("left"===this.orient||"right"===this.orient?this.padding[2]+this.padding[0]:0),this.updateScaleRange(),this.computeData();let i=(0,c.sG)(this.option),l=this.getUpdateAttribute();l.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component.setAttributes((0,a.Z)({},i,l)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){!function(e,t){let i=e.find(e=>"axis-label-container-layer-0"===e.name,!0),l=e.find(e=>"axis-label-container-layer-1"===e.name,!0);N(i?i.getChildren():[],t),N(l?l.getChildren():[],t)}(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){var e;this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;let{width:t,height:i}=this.getLayoutRect(),l=g(this.orient),o="left"===(e=this.orient)||"right"===e,r={x:0,y:0},n=0;l?(r={x:t,y:0},n=t):o&&(r={x:0,y:i},n=i);let a="top"===this.orient||"bottom"===this.orient?i:t;return{start:{x:0,y:0},end:r,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(l)},items:this.getLabelItems(n),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(e){return[this.tickData.latestData.map(t=>({id:t.value,label:t.value,value:0===e?0:this.scale.dataToPosition([t.value])/e,rawValue:t.value})).filter(e=>e.value>=0&&e.value<=1)]}updateScaleRange(){var e,t,i,l,o,r,n,a;let h=null!=(t=null==(e=this.option.innerOffset)?void 0:e.right)?t:0,d=null!=(l=null==(i=this.option.innerOffset)?void 0:i.left)?l:0,u=null!=(r=null==(o=this.option.innerOffset)?void 0:o.top)?r:0,c=null!=(a=null==(n=this.option.innerOffset)?void 0:n.bottom)?a:0,{width:p,height:f}=this.getLayoutRect(),b=this.option.inverse||!1,m=[0,0];g(this.orient)?(0,s.Z)(p)&&(m=b?[p-h,d]:[d,p-h]):(0,s.Z)(f)&&(m=b?[u,f-c]:[f-c,u]),this.scale.updateRange(m)}setLayoutStartPosition(e){let{x:t,y:i}=e;return(0,s.Z)(t)&&(t+=Number("left"===this.orient)*this.getLayoutRect().width),(0,s.Z)(i)&&(i+=Number("top"===this.orient)*this.getLayoutRect().height),{x:t,y:i}}_getTitleLimit(e){var t,i,l;if(this.option.title.visible&&(0,h.Z)(null==(t=this.option.title.style)?void 0:t.maxLineWidth)){let t=(null==(i=this.option.title.style)?void 0:i.angle)||0;if((null==(l=this.option.title)?void 0:l.autoRotate)&&(0,h.Z)(this.option.title.angle)&&(t="left"===this.option.orient?-90:90),e){let e=this.getLayoutRect().width,i=Math.abs(Math.cos((0,d.M4)(t)));return i<1e-6?1/0:e/i}let o=this.getLayoutRect().height,r=Math.abs(Math.sin((0,d.M4)(t)));return r<1e-6?1/0:o/r}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}var V=i(70506),j=i(58853);function U(e,t){var i,l,o,r,n,s,h,d,u,g,p,b,m,C,v,w,y,x;let _=(0,a.Z)({},c.b8,e),S=0;!1!==_.tick.visible&&(S=null!=(i=_.tick.width)?i:4);let R=0;if(_.label.visible){if("band"===_.type)_.domain.forEach(e=>{var i,l,o,r,n,a,s,h,d,u,g,p,f,b,m,C;_.label.formatMethod&&(e=_.label.formatMethod(e));let{width:v,height:w}=t.measureText(e,{fontSize:null!=(o=null==(l=null==(i=_.label)?void 0:i.style)?void 0:l.fontSize)?o:c.$M,fontWeight:null!=(a=null==(n=null==(r=_.label)?void 0:r.style)?void 0:n.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=_.label)?void 0:s.style)?void 0:h.fontFamily)?d:c.iR}),y=(null==(g=null==(u=_.label)?void 0:u.style)?void 0:g.maxLineWidth)||1/0,x=(null!=(b=null==(f=null==(p=_.label)?void 0:p.style)?void 0:f.angle)?b:0)+90*("vertical"===(null==(C=null==(m=_.label)?void 0:m.style)?void 0:C.direction));R=Math.max(R,J(Math.min(v,y),w,x).width)});else{let i;if((null==(l=e.sync)?void 0:l.tickAlign)&&(0,V.Z)(null==(o=e.tick)?void 0:o.tickMode))i=e.tick.tickMode();else if((0,f.Z)(e.__ticksForVTable))i=e.__ticksForVTable;else{let e=_.range,t=Math.abs(e.min)>1?Math.round(e.min):e.min,l=Math.abs(e.max)>1?Math.round(e.max):e.max;i=[X(t),X(l)]}i.forEach(e=>{var i,l,o,r,n,a,s,h,d,u,g,p,f,b,m,C;_.label.formatMethod&&(e=_.label.formatMethod(e));let{width:v,height:w}=t.measureText(e,{fontSize:null!=(o=null==(l=null==(i=_.label)?void 0:i.style)?void 0:l.fontSize)?o:c.$M,fontWeight:null!=(a=null==(n=null==(r=_.label)?void 0:r.style)?void 0:n.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=_.label)?void 0:s.style)?void 0:h.fontFamily)?d:c.iR}),y=(null==(g=null==(u=_.label)?void 0:u.style)?void 0:g.maxLineWidth)||1/0,x=(null!=(b=null==(f=null==(p=_.label)?void 0:p.style)?void 0:f.angle)?b:0)+90*("vertical"===(null==(C=null==(m=_.label)?void 0:m.style)?void 0:C.direction));R=Math.max(R,J(Math.min(v,y),w,x).width)})}R+=null!=(r=_.label.space)?r:4}let H=0;if(_.title.visible&&(0,j.Z)(_.title.text)){let{width:i,height:l}=t.measureText(_.title.text,{fontSize:null!=(h=null==(s=null==(n=_.title)?void 0:n.style)?void 0:s.fontSize)?h:c.$M,fontWeight:null!=(g=null==(u=null==(d=_.title)?void 0:d.style)?void 0:u.fontWeight)?g:"normal",fontFamily:null!=(m=null==(b=null==(p=_.title)?void 0:p.style)?void 0:b.fontFamily)?m:c.iR}),o=J(Math.min(i,(null==(v=null==(C=_.label)?void 0:C.style)?void 0:v.maxLineWidth)||1/0),l,null==(y=null==(w=_.title)?void 0:w.style)?void 0:y.angle);H=(("left"===e.orient||"right"===e.orient)&&_.title.autoRotate?o.height:o.width)+(null!=(x=_.title.space)?x:4)}return Math.ceil(S+R+H+1)}function $(e,t){var i,l,o,r,n,s,h,d,u,g,p,b,m,C,v,w,y,x;let _=(0,a.Z)({},c.b8,e),S=0;!1!==_.tick.visible&&(S=null!=(i=_.tick.width)?i:4);let R=0;if(_.label.visible){if("band"===_.type)_.domain.forEach(e=>{var i,l,o,r,n,a,s,h,d,u,g,p,f,b,m,C;_.label.formatMethod&&(e=_.label.formatMethod(e));let{width:v,height:w}=t.measureText(e,{fontSize:null!=(o=null==(l=null==(i=_.label)?void 0:i.style)?void 0:l.fontSize)?o:c.$M,fontWeight:null!=(a=null==(n=null==(r=_.label)?void 0:r.style)?void 0:n.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=_.label)?void 0:s.style)?void 0:h.fontFamily)?d:c.iR}),y=(null==(g=null==(u=_.label)?void 0:u.style)?void 0:g.maxLineWidth)||1/0,x=(null!=(b=null==(f=null==(p=_.label)?void 0:p.style)?void 0:f.angle)?b:0)+90*("vertical"===(null==(C=null==(m=_.label)?void 0:m.style)?void 0:C.direction));R=Math.max(R,J(Math.min(v,y),w,x).height)});else{let i;if((null==(l=e.sync)?void 0:l.tickAlign)&&(0,V.Z)(null==(o=e.tick)?void 0:o.tickMode))i=e.tick.tickMode();else if((0,f.Z)(e.__ticksForVTable))i=e.__ticksForVTable;else{let e=_.range,t=Math.abs(e.min)>1?Math.round(e.min):e.min,l=Math.abs(e.max)>1?Math.round(e.max):e.max;i=[X(t),X(l)]}i.forEach(e=>{var i,l,o,r,n,a,s,h,d,u,g,p,f,b,m,C;_.label.formatMethod&&(e=_.label.formatMethod(e));let{width:v,height:w}=t.measureText(e,{fontSize:null!=(o=null==(l=null==(i=_.label)?void 0:i.style)?void 0:l.fontSize)?o:c.$M,fontWeight:null!=(a=null==(n=null==(r=_.label)?void 0:r.style)?void 0:n.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=_.label)?void 0:s.style)?void 0:h.fontFamily)?d:c.iR}),y=(null==(g=null==(u=_.label)?void 0:u.style)?void 0:g.maxLineWidth)||1/0,x=(null!=(b=null==(f=null==(p=_.label)?void 0:p.style)?void 0:f.angle)?b:0)+90*("vertical"===(null==(C=null==(m=_.label)?void 0:m.style)?void 0:C.direction));R=Math.max(R,J(Math.min(v,y),w,x).height)})}R+=null!=(r=_.label.space)?r:4}let H=0;if(_.title.visible&&_.title.text){let{width:i,height:l}=t.measureText(_.title.text,{fontSize:null!=(h=null==(s=null==(n=_.title)?void 0:n.style)?void 0:s.fontSize)?h:c.$M,fontWeight:null!=(g=null==(u=null==(d=_.title)?void 0:d.style)?void 0:u.fontWeight)?g:"normal",fontFamily:null!=(m=null==(b=null==(p=_.title)?void 0:p.style)?void 0:b.fontFamily)?m:c.iR}),o=J(Math.min(i,(null==(v=null==(C=_.label)?void 0:C.style)?void 0:v.maxLineWidth)||1/0),l,null==(y=null==(w=_.title)?void 0:w.style)?void 0:y.angle);H=(("bottom"===e.orient||"top"===e.orient)&&_.title.autoRotate?o.width:o.height)+(null!=(x=_.title.space)?x:4)}return S+R+H+1}function X(e){return"number"!=typeof e&&(e=Number(e)),Number(e.toPrecision(1)).toString()}function J(e,t,i=0){let l=i*Math.PI/180,o=-e/2,r=-t/2,n=e/2,a=-t/2,s=e/2,h=t/2,d=-e/2,u=t/2,c={x:o*Math.cos(l)-r*Math.sin(l),y:o*Math.sin(l)+r*Math.cos(l)},g={x:n*Math.cos(l)-a*Math.sin(l),y:n*Math.sin(l)+a*Math.cos(l)},p={x:s*Math.cos(l)-h*Math.sin(l),y:s*Math.sin(l)+h*Math.cos(l)},f={x:d*Math.cos(l)-u*Math.sin(l),y:d*Math.sin(l)+u*Math.cos(l)},b=Math.min(c.x,g.x,p.x,f.x),m=Math.max(c.x,g.x,p.x,f.x),C=Math.min(c.y,g.y,p.y,f.y);return{width:m-b,height:Math.max(c.y,g.y,p.y,f.y)-C}}var Y=i(95950),q=i(28076),Q=i(19427),ee=i(29411),et=i(51129),ei=i(23112),el=i(92875);(0,et.M)(),(0,ei.g)(),(0,el.i)();class eo extends q.k{constructor(e,t){super((null==t?void 0:t.skipDefault)?e:(0,Y.Z)({},eo.defaultAttributes,e))}render(){this.removeAllChild(!0),this.renderIcon(),this.renderText(),this.layout()}renderIcon(){this._emptyTipIcon=new Q.E((0,Y.Z)({image:this.attribute.icon.image},this.attribute.icon)),this.appendChild(this._emptyTipIcon)}renderText(){this._text=new ee.x((0,Y.Z)({wrap:!0},this.attribute.text)),this.appendChild(this._text)}layout(){let e=this.attribute.icon.height,t=this._text.AABBBounds.height(),i=this.attribute.icon.width,{width:l,height:o,spaceBetweenTextAndIcon:r}=this.attribute;this._emptyTipIcon.setAttribute("x",l/2-i/2),this._emptyTipIcon.setAttribute("y",o/2-e/2-t/2-r/2),this._text.setAttribute("x",l/2),this._text.setAttribute("textAlign","center"),this._text.setAttribute("y",o/2+e/2+r/2),this._text.setAttribute("textBaseline","middle")}}eo.defaultAttributes={spaceBetweenTextAndIcon:20,text:{text:"no data",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",pickable:!1},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100,pickable:!1}};var er=i(8611),en=i(22295);class ea{constructor(e,t){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100}},this.isReleased=!1,this.table=t,this._emptyTipOption=Object.assign(this._emptyTipOption,!0===e?{}:e),(0,P.Z)(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(e){if(this._emptyTipComponent)(0,er.X)(e,this._cacheAttrs)||this._emptyTipComponent.setAttributes(e);else{let t=new eo(e);t.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(t),this._emptyTipComponent=t,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",e=>{let t=new en.FB;this._emptyTipComponent.forEachChildren(e=>{t.union(e.globalAABBBounds)}),t.contains(e.x,e.y)&&this.table.fireListeners("empty_tip_click",e)}),this._emptyTipComponent.on("dblclick",e=>{let t=new en.FB;this._emptyTipComponent.forEachChildren(e=>{t.union(e.globalAABBBounds)}),t.contains(e.x,e.y)&&this.table.fireListeners("empty_tip_dblclick",e)})}resize(){var e;if(!this._emptyTipComponent)return;let{leftHeaderWidth:t,topHeaderHeight:i,width:l,height:o}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+t,y:this.table.tableY+i,width:l,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(e=this._emptyTipOption.textStyle)?void 0:e.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&0!==this.table.recordsCount||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){let e=this.table.transpose||!1===this.table.options.indicatorsAsCol?this.table.getFrozenColsWidth():0,t=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:e,topHeaderHeight:t,width:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-e-this.table.getTheme().scrollStyle.width,height:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-t-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var e;let{leftHeaderWidth:t,topHeaderHeight:i,width:l,height:o}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+t,y:this.table.tableY+i,width:l,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(e=this._emptyTipOption.textStyle)?void 0:e.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var es=i(19465);let eh=(e,t,i)=>{let l=(0,j.Z)(t)?t.split("."):t;for(let t=0;t<l.length;t++)e=e?e[l[t]]:void 0;return void 0===e?i:e};var ed=i(88666),eu=i(43483),ec=i(41253),eg=i(47755),ep=function(e,t){var i={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>t.indexOf(l)&&(i[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(l=Object.getOwnPropertySymbols(e);o<l.length;o++)0>t.indexOf(l[o])&&Object.prototype.propertyIsEnumerable.call(e,l[o])&&(i[l[o]]=e[l[o]])}return i};let ef={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};var eb=i(83847),em=i(37811);class eC{constructor(e,t){var i,l,o,r;this.table=t,this.option=(0,es.Z)(e),this.orient=null!=(i=e.orient)?i:"left",this.visible=null==(l=e.visible)||l,this.position=null!=(o=e.position)?o:"middle",this.selectedData=null!=(r=e.defaultSelected)?r:null,this.createComponent(),this.initEvent()}createComponent(){let e=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),t=new ed.W((0,a.Z)({},e,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));t.name="legend",this.legendComponent=t,!1===this.visible&&(t.setAttributes({visible:!1,visibleAll:!1}),t.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(t),this.adjustTableSize(e)}resize(){this.legendComponent&&!1!==this.visible&&(this.legendComponent.setAttributes({maxWidth:this.table.tableNoFrameWidth,maxHeight:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(e){var t,i;if(!this.legendComponent||!1===this.visible)return;let l=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(l<=0||o<=0)return;let r=this.table.tableNoFrameWidth,n=this.table.tableNoFrameHeight,a=(0,em.u)(null!=(i=null!=(t=e.padding)?t:this.option.padding)?i:10),s=0,h=0;"left"===this.orient?(s=a[3],h=0,l+=a[1]+a[3]):"top"===this.orient?(s=0,h=a[0],o+=a[0]+a[2]):"right"===this.orient?(s=r-l-a[1],h=0,l+=a[1]+a[3]):"bottom"===this.orient&&(s=0,h=n-o-a[2],o+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,g=0;"horizontal"===d?c="middle"===u?(r-l)/2:"end"===u?r-l-a[1]:a[3]:g="middle"===u?(n-o)/2:"end"===u?n-o-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:g,x:s,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l),this.table.tableX+=Math.ceil(l)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(e){var t,i;let l="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",o=function(e,t){let i=(0,a.Z)({},ef,e),{title:l={},item:o={},pager:r={},background:n={},type:s,id:h,visible:d,orient:u,position:c,data:g,filter:p,regionId:f,regionIndex:b,seriesIndex:m,seriesId:C,padding:v}=i,w=ep(i,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return l.visible&&(w.title=(0,eg.qi)(l)),(0,G.Z)(o.focusIconStyle)||(0,eg.h_)(o.focusIconStyle),(0,eg.ro)(o.shape),(0,eg.ro)(o.label),(0,eg.ro)(o.value),(0,eg.ro)(o.background),(0,ec.hU)(o.maxWidth)&&(o.maxWidth=Number(o.maxWidth.substring(0,o.maxWidth.length-1))*t.width/100),(0,ec.hU)(o.width)&&(o.width=Number(o.width.substring(0,o.width.length-1))*t.width/100),(0,ec.hU)(o.height)&&(o.height=Number(o.height.substring(0,o.height.length-1))*t.width/100),w.item=o,(0,G.Z)(r.textStyle)||(0,eg.h_)(r.textStyle),(0,eg.ro)(r.handler),w.pager=r,n.visible&&!(0,G.Z)(n.style)&&((0,a.Z)(w,n.style),(0,P.Z)(n.padding)&&(w.padding=n.padding)),w}(this.option,e),r=(0,em.u)(null!=(i=null!=(t=o.padding)?t:this.option.padding)?i:10);return Object.assign({layout:l,items:this.getLegendItems(),maxWidth:e.width-r[1]-r[3],maxHeight:e.height-r[0]-r[2]},o)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(eu.dk.legendItemClick,e=>{let t=eh(e,"detail.currentSelected");this.table.fireListeners(eb.B.LEGEND_ITEM_CLICK,{model:this,value:t,event:e})}),this.legendComponent.addEventListener(eu.dk.legendItemHover,e=>{let t=eh(e,"detail");this.table.fireListeners(eb.B.LEGEND_ITEM_HOVER,{model:this,value:t,event:e})}),this.legendComponent.addEventListener(eu.dk.legendItemUnHover,e=>{let t=eh(e,"detail");this.table.fireListeners(eb.B.LEGEND_ITEM_UNHOVER,{model:this,value:t,event:e})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",e=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var ev=i(38724),ew=i(95548),ey=function(e,t){var i={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>t.indexOf(l)&&(i[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(l=Object.getOwnPropertySymbols(e);o<l.length;o++)0>t.indexOf(l[o])&&Object.prototype.propertyIsEnumerable.call(e,l[o])&&(i[l[o]]=e[l[o]])}return i};let ex={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},e_={horizontal:Object.assign(Object.assign({},ex),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},ex),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},eS={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},ex),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},ex)};class eR{constructor(e,t){var i,l,o,r;this.table=t,this.option=(0,es.Z)(e),this.orient=null!=(i=e.orient)?i:"left",this.visible=null==(l=e.visible)||l,this.position=null!=(o=e.position)?o:"middle",this.selectedData=null!=(r=e.defaultSelected)?r:null,this.createComponent(),this.initEvent()}createComponent(){let e,t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});(e="color"===this.option.type?new ev.e((0,a.Z)({},t,{slidable:!0})):new ew.D((0,a.Z)({},t,{slidable:!0}))).name="legend",this.legendComponent=e,!1===this.visible&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&!1!==this.visible&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(e){var t,i;if(!this.legendComponent||!1===this.visible)return;let l=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(l<=0||o<=0)return;let r=this.table.tableNoFrameWidth,n=this.table.tableNoFrameHeight,a=(0,em.u)(null!=(i=null!=(t=e.padding)?t:this.option.padding)?i:10),s=0,h=0;"left"===this.orient?(s=a[3],h=0,l+=a[1]+a[3]):"top"===this.orient?(s=0,h=a[0],o+=a[0]+a[2]):"right"===this.orient?(s=r-l-a[1],h=0,l+=a[1]+a[3]):"bottom"===this.orient&&(s=0,h=n-o-a[2],o+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,g=0;"horizontal"===d?c="middle"===u?(r-l)/2:"end"===u?r-l-a[1]:a[3]:g="middle"===u?(n-o)/2:"end"===u?n-o-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:g,x:s,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l),this.table.tableX+=Math.ceil(l)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(e){let t="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",i="horizontal"===t?"bottom":this.orient;return Object.assign(Object.assign({},function(e,t){let i=(0,a.Z)({},("color"===e.type?e_:eS)["bottom"===e.orient||"top"===e.orient?"horizontal":"vertical"],e),{title:l={},handler:o={},rail:r={},track:n={},startText:s,endText:h,handlerText:d,sizeBackground:u,background:c={},type:g,id:p,visible:f,orient:b,position:m,data:C,defaultSelected:v,field:w,filter:y,regionId:x,regionIndex:_,seriesIndex:S,seriesId:R,padding:H}=i,A=ey(i,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return l.visible&&(A.title=(0,eg.qi)(l)),A.showHandler=!1!==o.visible,(0,G.Z)(o.style)||(A.handlerStyle=(0,eg.h_)(o.style)),(0,P.Z)(r.width)&&(A.railWidth=r.width),(0,P.Z)(r.height)&&(A.railHeight=r.height),(0,G.Z)(r.style)||(A.railStyle=(0,eg.h_)(r.style)),(0,G.Z)(n.style)||(A.trackStyle=(0,eg.h_)(n.style)),A.startText=(0,eg.ro)(s),A.endText=(0,eg.ro)(h),A.handlerText=(0,eg.ro)(d),(0,G.Z)(u)||(A.sizeBackground=(0,eg.h_)(u)),c.visible&&!(0,G.Z)(c.style)&&((0,a.Z)(A,c.style),(0,P.Z)(c.padding)&&(A.padding=c.padding)),A}(this.option,0)),{layout:t,align:i,min:this.option.min,max:this.option.max,value:this.option.value,["color"===this.option.type?"colors":"sizeRange"]:"color"===this.option.type?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",e=>{let t=eh(e,"detail.value");this.table.fireListeners(eb.B.LEGEND_CHANGE,{model:this,value:t,event:e}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function eH(e,t){return"color"===e.type||"size"===e.type?new eR(e,t):new eC(e,t)}class eA{constructor(e){this._table=e}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(e,t,i){return this._getMenuElement().bindToCell(this._table,e,t,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(e,t){return this._getMenuElement().pointInMenuElement(e,t)}getRootElement(){return this._getMenuElement().rootElement}}var eM=i(1847),eF=i(48459);let eB="vtable__menu-element",eT=`${eB}--hidden`,ez=`${eB}--shown`;class eL{constructor(e){var t,i,l;this._handler=new eM.b,this._rootElement=(0,eF.a)("div",[eB,eT]),this._rootElement.addEventListener("wheel",e=>{e.stopPropagation()}),null==(t=this._rootElement)||t.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),this._rootElement.classList.contains(eT))return;let{col:i,row:l,dropDownIndex:o,menuKey:r,text:n,hasChildren:a}=t.target;if("number"!=typeof o||a)return void t.stopPropagation();let s=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(i,l):e.getHeaderField(i,l),h=e._dropDownMenuIsHighlight(i,l,o);e.fireListeners(eb.B.DROPDOWN_MENU_CLICK,{col:i,row:l,field:s,menuKey:r,text:n,highlight:h,cellLocation:e.getCellLocation(i,l),event:t}),e.fireListeners(eb.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(eb.B.HIDE_MENU,null),t.stopPropagation()}),null==(l=this._rootElement)||l.addEventListener("mousemove",e=>{this._rootElement.classList.contains(eT)||e.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let e=this._rootElement;(null==e?void 0:e.parentElement)&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(e,t,i,l){let o=this._rootElement;if(this._menuInstanceInfo=l,null==o||o.classList.remove(ez),null==o||o.classList.add(eT),this._canBindToCell(e,t,i)){if(o.innerHTML="",o.appendChild(l.content),this._bindCell(e,t,i,l.position,l.referencePosition))return null==o||o.classList.add(ez),null==o||o.classList.remove(eT),!0}else this.unbindFromCell();return!1}unbindFromCell(){let e=this._rootElement;this._menuInstanceInfo=void 0,(null==e?void 0:e.parentElement)&&(e.classList.remove(ez),e.classList.add(eT))}_canBindToCell(e,t,i){var l;let o=e.getCellRangeRelativeRect({col:t,row:i}),r=null!=(l=e.internalProps.menu.parentElement)?l:e.getElement(),{top:n,bottom:a,left:s,right:h}=o;if(e.isFrozenCell(t,i))return!0;if(a<e.getFrozenRowsHeight()||h<e.getFrozenColsWidth()||s>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||n>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=r;return!(d<n)&&!(u<s)}_bindCell(e,t,i,l,o){var r;let n=this._rootElement,a=null!=(r=e.internalProps.menu.parentElement)?r:e.getElement(),{width:s,height:h,left:d,top:u}=a.getBoundingClientRect();if(n){let t,i;n.parentElement!==a&&a.appendChild(n),n.style.left="0px",n.style.maxWidth=`${.8*s}px`;let r=n.clientWidth,c=n.clientHeight;l&&(t=l.x,i=l.y),o&&(t=o.rect.right-r,i=o.rect.bottom),i+c>h&&(i=h-c,t+=r-2),i<0&&(i/=2);let g=0,p=0;if(e.getElement()!==a){let{left:t,top:i}=e.getElement().getBoundingClientRect();g=i-u,p=t-d}return n.style.top=`${i+g}px`,t<0?t=0:t+r>s&&(t=s-r),n.style.left=`${t+p}px`,!0}return!1}pointInMenuElement(e,t){let{x:i,y:l,width:o,height:r}=this._rootElement.getBoundingClientRect();return e>i-5&&e<i+o+5&&t>l-5&&t<l+r+5}}var ek=i(27421);class eP extends eA{createMenuElementInternal(){return new ek.F(this._table)}}class eI extends eA{createMenuElementInternal(){return new eL(this._table)}}var eE=i(77597);let eD={"dropdown-menu":function(e){return new eP(e)},"context-menu":function(e){return new eP(e)},container:e=>new eI(e)};class eW{constructor(e){this._table=e,this._menuInstances={},this._bindTableEvent(e)}release(){let e=this._menuInstances;for(let t in e)e[t].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(e,t,i,l){var o;let r=this._attachInfo,n=this._getMenuInstanceInfo(e,t,i,l);if(!r||n&&r.instance===n.instance||(null==(o=r.instance)||o.unbindMenuElement(),this._attachInfo=null),!n)return;let{instance:a,info:s}=n;if(a&&a.bindMenuElement(e,t,s)){let i=this._table.getCellRange(e,t);this._attachInfo={range:i,instance:a}}}_unbindFromCell(){let e=this._attachInfo;if(!e)return;let{instance:t}=e;null==t||t.unbindMenuElement(),this._attachInfo=null}_isBindToCell(e,t){let i=this._attachInfo;return!!i&&(0,eE._Z)(i.range,e,t)}pointInMenuElement(e,t){if(!this._attachInfo)return!1;let{instance:i}=this._attachInfo;return i.pointInMenuElement(e,t)}_bindTableEvent(e){e.on(eb.B.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,"dropdown-menu")}),e.on(eb.B.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),e.on(eb.B.CONTEXTMENU_CELL,t=>{var i,l,o,r;if("html"===(null==(i=e.internalProps.menu)?void 0:i.renderMode)){let i=e._getMouseAbstractPoint(t.event),n=null;i.inTable&&"function"==typeof(null==(l=e.internalProps.menu)?void 0:l.contextMenuItems)?n=e.internalProps.menu.contextMenuItems(e.getHeaderField(t.col,t.row),t.row,t.col,e):i.inTable&&Array.isArray(null==(o=e.internalProps.menu)?void 0:o.contextMenuItems)&&(n=null==(r=e.internalProps.menu)?void 0:r.contextMenuItems),this._bindToCell(t.col,t.row,"context-menu",{content:n,position:{x:i.x,y:i.y}})}})}_getMenuInstanceInfo(e,t,i,l){let o=this._table,r=this._menuInstances,n=function(e,t,i,l,o){var r,n;let{lineHeight:a,textBaseline:s,textStick:h}=e._getCellStyle(t,i),d=e.getCellRangeRelativeRect(e.getCellRange(t,i));h&&(d=e.getVisibleCellRangeRelativeRect({col:t,row:i}));let{left:u,right:c,bottom:g,top:p,width:f,height:b}=d;if(e.isHeader(t,i)&&({left:u,right:c,bottom:g,top:p,width:f,height:b}=e.internalProps.headerHelper.getDropDownIconRect(d,a,s||"middle")),null==o?void 0:o.content)return{type:l,position:o.position,referencePosition:null!=(r=o.referencePosition)?r:{rect:{left:u,right:c,top:p,bottom:g,width:f,height:b}},content:o.content};if("dropdown-menu"===l){let o=e.globalDropDownMenu,r=e._getHeaderLayoutMap(t,i);o=null!=(n=r.dropDownMenu)?n:o;let a=r.pivotInfo;return"function"==typeof o&&(o=o({row:i,col:t,table:e})),{type:l,referencePosition:{rect:{left:u,right:c,top:p,bottom:g,width:f,height:b}},content:o,pivotInfo:a}}return null}(o,e,t,i,l);return n?{instance:r&&r[i]||r&&(r[i]=eD[i](o)),type:i,info:n}:null}containElement(e){var t;for(let i in this._menuInstances)if(null==(t=this._menuInstances[i].getRootElement())?void 0:t.contains(e))return!0;return!1}}var eO=i(5845);class eG{constructor(e,t){this.isReleased=!1,this.table=t,this._titleOption=(0,a.Z)({orient:"top"},e),!1!==e.visible&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(e){if(this._titleComponent)(0,er.X)(e,this._cacheAttrs)||this._titleComponent.setAttributes(e);else{let t=new eO.D(e);t.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(t),this._titleComponent=t}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var e,t,i,l,o;if(!this._titleComponent)return;let r=(0,em.u)(null!=(e=this._titleOption.padding)?e:10),n=null!=(t=this._titleOption.width)?t:("adaptive"===this.table.widthMode?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-r[1]-r[3],a=null!=(i=this._titleOption.height)?i:("adaptive"===this.table.heightMode?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-r[0]-r[2];this._titleComponent.setAttributes({x:(null!=(l=this._titleOption.x)?l:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(o=this._titleOption.y)?o:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?n:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?a:this._titleOption.height,textStyle:Object.assign({width:n},this._titleOption.textStyle),subtextStyle:Object.assign({width:n},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(e){var t,i,l,o;let r=isFinite(null==(t=this._titleComponent)?void 0:t.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,n=isFinite(null==(i=this._titleComponent)?void 0:i.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;"left"===this._titleOption.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):"top"===this._titleOption.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this._titleOption.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):"bottom"===this._titleOption.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n)),this._cacheAttrs=e,"right"!==this._titleOption.orient&&"bottom"!==this._titleOption.orient||this._titleComponent.setAttributes({x:(null!=(l=this._titleOption.x)?l:"right"===this._titleOption.orient)?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:(null!=(o=this._titleOption.y)?o:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var e,t,i,l,o,r,n,a,s,h,d;let u=this._titleOption.text||this._titleOption.subtext?10:0,c=(0,em.u)(null!=(e=this._titleOption.padding)?e:u),g=null!=(t=this._titleOption.width)?t:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-c[1]-c[3],p=null!=(i=this._titleOption.height)?i:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-c[0]-c[2];return{text:null!=(l=this._titleOption.text)?l:"",subtext:null!=(o=this._titleOption.subtext)?o:"",x:(null!=(r=this._titleOption.x)?r:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?g:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?p:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:null!=(a=this._titleOption.align)?a:"left",verticalAlign:null!=(s=this._titleOption.verticalAlign)?s:"top",textStyle:Object.assign({width:g},this._titleOption.textStyle),subtextStyle:Object.assign({width:g},this._titleOption.subtextStyle),dx:null!=(h=this._titleOption.dx)?h:0,dy:null!=(d=this._titleOption.dy)?d:0}}getComponentGraphic(){return this._titleComponent}}class eN{constructor(e){this._table=e}release(){var e,t;this.unbindTooltipElement(),this._tooltipElement&&(null==(t=(e=this._tooltipElement).release)||t.call(e)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(e,t,i,l){return this._getTooltipElement().bindToCell(this._table,e,t,i,l)}moveTooltipElement(e,t,i,l){this._getTooltipElement().move(this._table,e,t,i,l)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(e,t,i,l,o){this._getTooltipElement()._locate(this._table,e,t,i,l,o)}}var eZ=i(12348),eK=i(27180),eV=i(28071);!function(){if("node"===eK.X.mode)return;let e=document.createElement("style");e.id="vtable-tooltip-styleSheet",e.textContent="\n@keyframes vtable__bubble-tooltip-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__bubble-tooltip-element {\n	position: absolute;\n	\n	// pointer-events: none;\n	//user-select: none;\n	max-width: 300px;\n	z-index: 99999;\n\n	background: #FFFFFF;\n    border: 1px solid #E6E8ED;\n    box-sizing: border-box;\n    border-radius: 4px;\n    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);\n    color: #141414;\n    font-size: 13px;\n}\n.vtable__bubble-tooltip-element--hidden {\n	opacity: 0;\n  pointer-events: none;\n	user-select: none;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n}\n.vtable__bubble-tooltip-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;\n}\n.vtable__bubble-tooltip-element__content {\n	/* font-size: .75rem; */\n	padding: 6px 8px;\n	min-height: 1em;\n	line-height: 1.5;\n	width: 100%;\n	display: block;\n	white-space: pre-wrap;\n	margin: 0;\n	box-sizing: border-box;\n	overflow: auto;\n	word-wrap: break-word;\n	position: relative;\n	background-color: #FFF;\n	z-index: 2;\n	border-radius: 4px;\n}\n/*  WebKit Microsoft Edge（新版）： */\n.vtable__bubble-tooltip-element__content::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/*  Opera Firefox  */\n.vtable__bubble-tooltip-element__content > scrollbar-track {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/* Internet Explorer 11 和 Microsoft Edge（旧版） */\n.vtable__bubble-tooltip-element__content > scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n.vtable__bubble-tooltip-element__triangle {\n	/* font-size: .75rem; */\n	position: absolute;\n	width: 10px;\n	height: 10px;\n	display: block;\n	transform: rotate(45deg);\n    transform-origin: 50% 50% 0;\n	z-index: 1;\n	background-color: #FFF;\n	border: 1px solid #E6E8ED;\n}\n",document.head.appendChild(e)}();let ej="vtable__bubble-tooltip-element",eU=`${ej}__content`,e$=`${ej}__triangle`,eX=`${ej}--hidden`,eJ=`${ej}--shown`;class eY{constructor(){this._handler=new eM.b;let e=this._rootElement=(0,eF.a)("div",[ej,eX]),t=(0,eF.a)("div",[eU]),i=(0,eF.a)("span",[e$]);e.appendChild(i),e.appendChild(t),this._messageElement=e.querySelector(`.${eU}`)||void 0,this._triangleElement=e.querySelector(`.${e$}`)||void 0,e.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),e.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),t.addEventListener("wheel",e=>{e.stopPropagation()}),t.addEventListener("copy",e=>{(0,eV.Ed)(t)&&e.stopPropagation()})}bindToCell(e,t,i,l,o){var r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_;this._disappearDelay=null==l?void 0:l.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);let S=this._rootElement,R=this._messageElement,H=this._triangleElement;if(null==S||S.classList.remove(eJ),null==S||S.classList.add(eX),this._canBindToCell(e,t,i)){if(R.setAttribute("style",""),H.setAttribute("style",""),(null==l?void 0:l.className)&&S.classList.add(l.className),(null==(r=null==l?void 0:l.style)?void 0:r.bgColor)&&(R.style.backgroundColor=null==(n=null==l?void 0:l.style)?void 0:n.bgColor),(null==(a=null==l?void 0:l.style)?void 0:a.bgColor)&&(H.style.backgroundColor=null==(s=null==l?void 0:l.style)?void 0:s.bgColor),H.style.display=!0===(null==(h=null==l?void 0:l.style)?void 0:h.arrowMark)?"block":"none",(null==(d=null==l?void 0:l.style)?void 0:d.fontSize)&&(R.style.fontSize=(null!=(c=null==(u=null==l?void 0:l.style)?void 0:u.fontSize)?c:12)+"px"),(null==(g=null==l?void 0:l.style)?void 0:g.fontFamily)&&(R.style.fontFamily=null==(p=null==l?void 0:l.style)?void 0:p.fontFamily),(null==(f=null==l?void 0:l.style)?void 0:f.color)&&(R.style.color=null==(b=null==l?void 0:l.style)?void 0:b.color),(null==(m=null==l?void 0:l.style)?void 0:m.padding)&&(R.style.padding=`${null==(C=null==l?void 0:l.style)?void 0:C.padding.join("px ")}px`),(null==(v=null==l?void 0:l.style)?void 0:v.maxHeight)&&(R.style.maxHeight=`${null==(w=null==l?void 0:l.style)?void 0:w.maxHeight}px`),(null==(y=null==l?void 0:l.style)?void 0:y.maxWidth)&&(R.style.maxWidth=`${null==(x=null==l?void 0:l.style)?void 0:x.maxWidth}px`),R&&(R.textContent=null==l?void 0:l.content),this._bindToCell(e,t,i,null==l?void 0:l.position,null==l?void 0:l.referencePosition,o,null==(_=null==l?void 0:l.style)?void 0:_.arrowMark))return null==S||S.classList.add(eJ),null==S||S.classList.remove(eX),!0}else this.unbindFromCell();return!1}release(){var e,t;this.unbindFromCell();let i=this._rootElement;(null==i?void 0:i.parentElement)&&i.parentElement.removeChild(i),null==(t=null==(e=this._handler)?void 0:e.release)||t.call(e),delete this._rootElement,delete this._messageElement}move(e,t,i,l,o){let r=this._rootElement;this._canBindToCell(e,t,i)?(this._bindToCell(e,t,i,null==l?void 0:l.position,null==l?void 0:l.referencePosition,o),null==r||r.classList.add(eJ),null==r||r.classList.remove(eX)):this.unbindFromCell()}unbindFromCell(){var e;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{let e=this._rootElement;(null==e?void 0:e.parentElement)&&(e.classList.remove(eJ),e.classList.add(eX))},null!=(e=this._disappearDelay)?e:0);else{let e=this._rootElement;(null==e?void 0:e.parentElement)&&(e.classList.remove(eJ),e.classList.add(eX))}}_canBindToCell(e,t,i){let l=e.getCellRangeRelativeRect({col:t,row:i}),o=e.getElement(),{bottom:r,left:n,right:a,top:s}=l;if(e.isFrozenCell(t,i))return!0;if(r<e.getFrozenRowsHeight()||a<e.getFrozenColsWidth()||n>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||s>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:h,offsetWidth:d}=o;return!(s>h)&&!(n>d)}_bindToCell(e,t,i,l,o,r,n){let a=this._rootElement,s=e.getCellRangeRelativeRect({col:t,row:i}),h=e.internalProps.tooltip.parentElement,d=e.internalProps.element.offsetWidth,{width:u}=s;if(a){let s,c;a.parentElement!==h&&h.appendChild(a),a.style.left="0px";let g=Math.min(.8*d,4*u);a.style.maxWidth=`${g}px`;let p=a.clientWidth,f=a.clientHeight;if(!l&&!o)return!1;{let a=this.getComputedPosition(e,t,i,l,o,r,n);c=a.x,s=a.y}a.style.left=`${c}px`,a.style.top=`${s}px`,(0,eV.tq)()&&(a.style.fontSize="11px");let{x1:b,x2:m,y1:C,y2:v}=e.stateManager.menu.bounds,w=c,y=s;return!(e.stateManager.menu.isShow&&b<w+p&&m>w&&v>y&&C<w+f)}return!1}getComputedPosition(e,t,i,l,o,r,n){var a;let s,h,d=this._rootElement,u=e.getCellRangeRelativeRect({col:t,row:i}),{x:c,y:g}=e.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:p,height:f,x:b,y:m}=e.internalProps.element.getBoundingClientRect(),{width:C}=u,v=Math.min(.8*p,4*C);d.style.maxWidth=`${v}px`;let w=d.clientWidth,y=d.clientHeight,x=6*!!n;if(l)h=l.x,s=l.y+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(o){let e=null!=(a=o.placement)?a:eZ.u.bottom,t=o.rect.left+o.rect.width/2,i=o.rect.top+o.rect.height/2,l=o.rect.top,n=o.rect.bottom,d=o.rect.left,u=o.rect.right,c=0,g=()=>{++c>=4||(this.removeStyleFromTriangle(),e===eZ.u.top?(h=t-w/2,s=l-y-x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",r&&s<0&&(e=eZ.u.right,g())):e===eZ.u.bottom?(h=t-w/2,s=n+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",r&&s+y>f&&(e=eZ.u.left,g())):e===eZ.u.left?(s=i-y/2,h=d-w-x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",r&&h<0&&(e=eZ.u.top,g())):e===eZ.u.right&&(s=i-y/2,h=u+x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",r&&h+w>p&&(e=eZ.u.bottom,g())))};g()}return r&&(h<0?h=0:h+d.offsetWidth>p&&(h=p-d.offsetWidth)),{x:h+b-c,y:s+m-g}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(e,t,i,l,o,r){let n=this.getComputedPosition(e,t,i,l,o,r),a=n.x,s=n.y;this._rootElement.style.left=`${a}px`,this._rootElement.style.top=`${s}px`}}class eq extends eN{createTooltipElementInternal(){return new eY}}let eQ={"bubble-tooltip":function(e){return new eq(e)}};class e0{constructor(e,t){this._table=e,this._tooltipInstances={},this._bindTableEvent(e),this.confine=t}release(){var e,t;let i=this._tooltipInstances;for(let l in i)null==(t=null==(e=i[l])?void 0:e.release)||t.call(e);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(e,t,i){var l;let o=this._attachInfo,r=this._getTooltipInstanceInfo(e,t);if(!o||r&&o.instance===r||(null==(l=o.instance)||l.unbindTooltipElement(),this._attachInfo=null),r&&r&&r.bindTooltipElement(e,t,i,this.confine)){let l=this._table.getCellRange(e,t);this._attachInfo={range:l,instance:r,tooltipOptions:i}}}_move(e,t,i){let l=this._attachInfo;if(!l||!(0,eE._Z)(l.range,e,t))return;let{instance:o}=l;null==o||o.moveTooltipElement(e,t,i,this.confine)}moveToPosition(e,t,i,l){let o=this._attachInfo;if(!o||!(0,eE._Z)(o.range,e,t))return;let{instance:r}=o;this._attachInfo.tooltipOptions.position=i,this._attachInfo.tooltipOptions.referencePosition=l,null==r||r.locateTooltipElement(e,t,i,l,this.confine)}_unbindFromCell(){let e=this._attachInfo;if(!e)return;let{instance:t}=e;null==t||t.unbindTooltipElement(),this._attachInfo=null}_isBindCell(e,t){let i=this._attachInfo;return!!i&&(0,eE._Z)(i.range,e,t)}_bindTableEvent(e){e.on(eb.B.MOUSEENTER_CELL,t=>{if((0,eV.tq)())return;let{x1:i,x2:l,y1:o,y2:r}=e.stateManager.menu.bounds;if(e.stateManager.menu.isShow&&"number"==typeof t.x&&"number"==typeof t.y&&t.x>i&&t.x<l&&t.y>o&&t.y<r)return;let{col:n,row:a}=t;this.showTooltip(n,a)}),e.on(eb.B.MOUSEMOVE_CELL,t=>{var i,l;if(!(0,eV.tq)()){if(null==(l=null==(i=this._attachInfo)?void 0:i.tooltipOptions)?void 0:l.referencePosition){let i=this._attachInfo.tooltipOptions.referencePosition,{event:l}=t,{left:o,right:r,top:n,bottom:a}=i.rect,s=e._getMouseAbstractPoint(l);s.inTable&&s.x>=o-5&&s.x<=r+5&&s.y>=n-5&&s.y<=a+5||this._unbindFromCell()}this._attachInfo&&e.stateManager.menu.isShow&&this._bindToCell(t.col,t.row)}}),e.on(eb.B.MOUSELEAVE_CELL,e=>{this._unbindFromCell()}),e.on(eb.B.SELECTED_CELL,e=>{this._isBindCell(e.col,e.row)&&this._unbindFromCell()}),e.on(eb.B.MOUSELEAVE_TABLE,e=>{this._unbindFromCell()}),e.on(eb.B.SCROLL,e=>{this._unbindFromCell()})}showTooltip(e,t){var i,l,o;let r,n=this._table,a=n.getHeaderDescription(e,t);if(a){let l=n.getCellRangeRelativeRect({col:e,row:t});r={content:a,referencePosition:{placement:n.internalProps.tooltip.position,rect:l},disappearDelay:null!=(i=n.internalProps.tooltip.overflowTextTooltipDisappearDelay)?i:0,style:n.theme.tooltipStyle}}else if((0,V.Z)(null==(l=n.internalProps.tooltip)?void 0:l.isShowOverflowTextTooltip)?n.internalProps.tooltip.isShowOverflowTextTooltip(e,t,n):n.internalProps.tooltip.isShowOverflowTextTooltip){let i=n.getCellOverflowText(e,t),l=n.getCellRangeRelativeRect({col:e,row:t});i&&(r={content:a?`${a}
  ${i}`:i,referencePosition:{placement:n.internalProps.tooltip.position,rect:l},disappearDelay:null!=(o=n.internalProps.tooltip.overflowTextTooltipDisappearDelay)?o:0,style:n.theme.tooltipStyle})}r?this._bindToCell(e,t,r):this._unbindFromCell()}_getTooltipInstanceInfo(e,t){let i=this._table,l=this._tooltipInstances;return l&&l["bubble-tooltip"]||l&&(l["bubble-tooltip"]=eQ["bubble-tooltip"](i))}isBinded(e){var t;return JSON.stringify(e)===JSON.stringify(null==(t=this._attachInfo)?void 0:t.tooltipOptions)}}var e1=i(94160),e2=i(31852);let e3=()=>{r.F.registerComponent("axis",K),r.F.registerFunction("computeAxisComponentWidth",U),r.F.registerFunction("computeAxisComponentHeight",$),r.F.registerFunction("getAxisConfigInPivotChart",n.hZ)},e6=()=>{r.F.registerComponent("emptyTip",ea)},e5=()=>{r.F.registerFunction("createLegend",eH)},e4=()=>{r.F.registerComponent("menuHandler",eW)},e8=()=>{r.F.registerComponent("title",eG)},e9=()=>{r.F.registerComponent("tooltipHandler",e0)},e7=()=>{(0,e1.Hp)(),(0,e2.d)()}},27421:function(e,t,i){"use strict";i.d(t,{o:()=>R,F:()=>H});var l=i(1847),o=i(48459),r=i(27180),n=i(83847),a=i(77597),s=i(18585),h=i(90251);!function(){if("node"===r.X.mode)return;let e=document.createElement("style");e.id="vtable-menu-styleSheet",e.textContent="\n@keyframes vtable__menu-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__menu-element {\n	position: absolute;\n	box-sizing: border-box;\n	border-radius: 4px;\n	background-color: #fff;\n	padding: 6px 0;\n	/* pointer-events: none; */\n	user-select: none;\n	color: #000;\n	max-width: 300px;\n	z-index: 99999;\n	border: #CCC 0.5px solid;\n	cursor: default;\n	width: max-content;\n	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);\n  max-height: 100%;\n  overflow-y: auto;\n}\n.vtable__menu-element--hidden {\n	opacity: 0;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n	z-index: -9999;\n}\n.vtable__menu-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__menu-element--shown-animation 150ms ease-out;\n}\n.vtable__menu-element__content {\n	font-family: Roboto;\n	font-size: 12px;\n	overflow: hidden;\n	display: inline-block;\n	/* height: 100%; */\n	line-height: 30px;\n}\n.vtable__menu-element__item {\n	height: 32px;\n	padding: 0px 12px;\n	cursor: pointer;\n	position: relative;\n	display: flex;\n	align-items: center;\n	justify-content: flex-start;\n}\n.vtable__menu-element__item:hover {\n	background-color: rgba(27, 31, 35, 0.06);\n}\n.vtable__menu-element__icon{\n	/* vertical-align: top; */\n	display: flex;\n	/* line-height: 30px; */\n	margin-right: 6px;\n}\n.vtable__menu-element__no-event {\n	pointer-events: none;\n}\n.vtable__menu-element--select {\n	color: #2E68CF;\n}\n.vtable__menu-element--normal {\n	color: rgba(20, 20, 20, 0.9);;\n}\n.vtable__menu-element__item-disabled {\n    color: rgba(0, 0, 0, 0.25);\n    cursor: not-allowed;\n	  background-color: #fff;\n}\n.vtable__menu-element__item-disabled:hover {\n	  background-color: #fff;\n}\n.vtable__menu-element__split {\n	height: 0px;\n	border: 1px solid rgb(209, 213, 218);\n	margin: 5px 0;\n}\n.vtable__menu-element__title {\n	color: rgb(149, 149, 149);\n}\n.vtable__menu-element__arrow {\n	position: absolute;\n	right: 3px;\n	font-weight: bold;\n	margin-top: 1px;\n}\n.vtable__menu-element__item-text {\n	margin-right: 15px;\n}\n",document.head.appendChild(e)}();let d="vtable__menu-element",u=`${d}__item`,c=`${d}__content`,g=`${d}--hidden`,p=`${d}--shown`,f=`${d}--normal`,b=`${d}--select`,m=`${d}__icon`,C=`${d}__split`,v=`${d}__title`,w=`${d}__arrow`,y=`${d}__no-event`,x=`${d}__item-text`,_=`${d}__item-disabled`;function S(){return(0,o.a)("div",[d,g])}function R(e,t,i,l,o,r){let n=e.getCellRange(l,o);for(let l=0;l<t.length;l++){let o=t[l],{col:r,row:h}=o,{field:d,menuKey:u}=o;if("number"!=typeof r||"number"!=typeof h)if(e.isPivotTable()&&(Array.isArray(d),1)){let t=e.internalProps.layoutMap.getPivotCellAdress(d);if(!t)continue;r=t.col,h=t.row}else{let t=e.internalProps.layoutMap.getHeaderCellAddressByField(d);if(!t)continue;r=t.col,h=t.row}if((0,s.Z)(r)&&(0,s.Z)(h)&&(0,a._Z)(n,r,h)&&i===u)return!0}return!1}class H{constructor(e){var t,i,o,r,a,s,h,d,u,c,f;this._handler=new l.b,this._rootElement=S(),this._secondElement=S(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",e=>{e.stopPropagation()}),null==(t=this._rootElement)||t.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("contextmenu",e=>{e.stopPropagation(),e.preventDefault()}),null==(o=this._rootElement)||o.addEventListener("touchend",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(_)||this._rootElement.classList.contains(g))return;let{col:i,row:l,dropDownIndex:o,menuKey:r,text:a,hasChildren:s}=t.target;if("number"!=typeof o||s)return void t.stopPropagation();let h=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(i,l):e.getHeaderField(i,l),d=e._dropDownMenuIsHighlight(i,l,o);e.fireListeners(n.B.DROPDOWN_MENU_CLICK,{col:i,row:l,field:h,menuKey:r,text:a,highlight:d,cellLocation:e.getCellLocation(i,l),event:t}),e.fireListeners(n.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(n.B.HIDE_MENU,null),t.stopPropagation()}),null==(r=this._rootElement)||r.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(_)||this._rootElement.classList.contains(g))return;let{col:i,row:l,dropDownIndex:o,menuKey:r,text:a,hasChildren:s}=t.target;if("number"!=typeof o||s)return void t.stopPropagation();let h=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(i,l):e.getHeaderField(i,l),d=e._dropDownMenuIsHighlight(i,l,o);e.fireListeners(n.B.DROPDOWN_MENU_CLICK,{col:i,row:l,field:h,menuKey:r,text:a,highlight:d,cellLocation:e.getCellLocation(i,l),event:t}),e.fireListeners(n.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(n.B.HIDE_MENU,null),t.stopPropagation()}),null==(a=this._rootElement)||a.addEventListener("mousemove",t=>{var i,l;if(this._rootElement.classList.contains(g))return;t.stopPropagation();let{hasChildren:o,dropDownIndex:r,col:n,row:a,sub:s}=t.target;if(o){this._showChildrenIndex=r;let l=this._secondElement;null==l||l.classList.remove(g),null==l||l.classList.add(p),l.innerHTML="";let o=null==(i=this._menuInstanceInfo.content[r])?void 0:i.children;for(let t=0;t<o.length;t++){let i=o[t],r=A(i,!!e.stateManager.menu.dropDownMenuHighlight&&R(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof i?(null==i?void 0:i.menuKey)||(null==i?void 0:i.text):i,n,a,t));r.col=n,r.row=a,r.dropDownIndex=t,"string"==typeof i?(r.text=i,r.menuKey=i):"object"==typeof i&&(r.text=i.text,r.menuKey=i.menuKey||i.text),r.sub=!0,r.sub=!0,l.appendChild(r)}let s=t.target.getBoundingClientRect();this._bindSecondElement(e,n,a,s.right,s.top)}else if(o&&this._showChildrenIndex===r){let e=this._secondElement;null==e||e.classList.remove(g),null==e||e.classList.add(p)}else!s&&(null==(l=this._secondElement)?void 0:l.classList.contains(p))&&setTimeout(()=>{if(!0!==this._mouseEnterSecondElement){this._showChildrenIndex=-1;let e=this._secondElement;null==e||e.classList.remove(p),null==e||e.classList.add(g)}},300)}),null==(s=this._secondElement)||s.addEventListener("wheel",e=>{e.stopPropagation()}),null==(h=this._secondElement)||h.addEventListener("mousemove",e=>{this._rootElement.classList.contains(g)||e.stopPropagation()}),null==(d=this._secondElement)||d.addEventListener("mouseenter",e=>{this._mouseEnterSecondElement=!0}),null==(u=this._secondElement)||u.addEventListener("mouseleave",e=>{this._mouseEnterSecondElement=!1}),null==(c=this._secondElement)||c.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(f=this._secondElement)||f.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(_)||this._secondElement.classList.contains(g))return;let{col:i,row:l,dropDownIndex:o,menuKey:r,text:a,hasChildren:s}=t.target;if("number"!=typeof o||s)return void t.stopPropagation();let h=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(i,l):e.getHeaderField(i,l),d=!1;this._menuInstanceInfo.content.forEach((t,o)=>{if("object"==typeof t&&t.children&&t.children.length)for(let o=0;o<t.children.length;o++){let n=t.children[o];if(R(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof n?null==n?void 0:n.menuKey:n,i,l,-1)&&r===("object"==typeof n?null==n?void 0:n.menuKey:n))return void(d=!0)}}),e.fireListeners(n.B.DROPDOWN_MENU_CLICK,{col:i,row:l,field:h,cellHeaderPaths:e.isPivotTable()?e.getCellHeaderPaths(i,l):void 0,menuKey:r,text:a,highlight:d,cellLocation:e.getCellLocation(i,l),event:t}),e.fireListeners(n.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(n.B.HIDE_MENU,null),t.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let e=this._rootElement;(null==e?void 0:e.parentElement)&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(e,t,i,l){var o,r;let n=this._rootElement,a=this._secondElement;if(this._menuInstanceInfo=l,null==n||n.classList.remove(p),null==n||n.classList.add(g),null==a||a.classList.remove(p),null==a||a.classList.add(g),this._canBindToCell(e,t,i)){if(n.innerHTML="",Array.isArray(l.content)){let a=l.content;for(let l=0;o=l<(null==a?void 0:a.length),o;l++){let o=a[l],s=!!e.stateManager.menu.dropDownMenuHighlight&&R(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof o?(null==o?void 0:o.menuKey)||(null==o?void 0:o.text):o,t,i,l);if(e.stateManager.menu.dropDownMenuHighlight&&"object"==typeof o&&Array.isArray(o.children)&&o.children.length)for(let l=0;l<o.children.length;l++){let r=o.children[l];if(R(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof r?(null==r?void 0:r.menuKey)||(null==r?void 0:r.text):r,t,i,l)){s=!0;break}}let h=A(o,s);h.col=t,h.row=i,h.dropDownIndex=l,"string"==typeof o?(h.text=o,h.menuKey=o):"object"==typeof o&&(h.text=o.text,h.menuKey=o.menuKey||o.text,(null==(r=o.children)?void 0:r.length)&&(h.hasChildren=!0)),n.appendChild(h)}}if(this._bindToCell(e,t,i,l.position,l.referencePosition))return null==n||n.classList.add(p),null==n||n.classList.remove(g),!0}else this.unbindFromCell();return!1}unbindFromCell(){let e=this._rootElement,t=this._secondElement;this._menuInstanceInfo=void 0,(null==e?void 0:e.parentElement)&&(e.classList.remove(p),e.classList.add(g)),(null==t?void 0:t.parentElement)&&(t.classList.remove(p),t.classList.add(g))}_canBindToCell(e,t,i){var l;let o=e.getCellRangeRelativeRect({col:t,row:i}),r=null!=(l=e.internalProps.menu.parentElement)?l:e.getElement(),{top:n,bottom:a,left:s,right:h}=o;if(e.isFrozenCell(t,i))return!0;if(a<e.getFrozenRowsHeight()||h<e.getFrozenColsWidth()||s>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||n>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=r;return!(d<n)&&!(u<s)}_bindToCell(e,t,i,l,o){var r;let n=this._rootElement,a=null!=(r=e.internalProps.menu.parentElement)?r:e.getElement(),{width:s,height:h,left:d,top:u}=a.getBoundingClientRect();if(n){let t,i;n.parentElement!==a&&a.appendChild(n),n.style.left="0px",n.style.maxWidth=`${.8*s}px`;let r=n.offsetWidth,c=n.offsetHeight;l?(t=l.x,i=l.y):o&&(t=o.rect.right-r,i=o.rect.bottom);let g=a.getBoundingClientRect(),p=g.width/a.offsetWidth,f=g.height/a.offsetHeight;i*f+c>h&&(i=(h-c)/f),i<0&&(i/=2);let b=0,m=0;if(e.getElement()!==a){let{left:t,top:i}=e.getElement().getBoundingClientRect();b=i-u,m=t-d}return n.style.top=`${i+b}px`,t<0?t=0:t*p+r>s&&(t=(s-r)/p),n.style.left=`${t+m}px`,!0}return!1}_bindSecondElement(e,t,i,l,o){var r;let n=this._secondElement,a=this._rootElement,s=null!=(r=e.internalProps.menu.parentElement)?r:e.getElement(),{width:h,height:d,left:u,top:c}=s.getBoundingClientRect(),{x:g,y:p,width:f,height:b}=a.getBoundingClientRect();if(n){n.parentElement!==s&&s.appendChild(n),n.style.left="0px",n.style.maxWidth=`${.8*h}px`;let e=n.clientWidth,t=n.clientHeight,i=o-4-c;i+t>d&&(i=i-t+n.firstElementChild.clientHeight+4),n.style.top=`${i}px`;let r=l-u;return r+e>h?r=r-e-f:r+=4,n.style.left=`${r}px`,!0}return!1}pointInMenuElement(e,t){let{x:i,y:l,width:o,height:r}=this._rootElement.getBoundingClientRect();if(e>i-5&&e<i+o+5&&t>l-5&&t<l+r+5)return!0;let n=this._secondElement;if(n){let{x:i,y:l,width:o,height:r}=n.getBoundingClientRect();if(e>i-5&&e<i+o+5&&t>l-5&&t<l+r+5)return!0}return!1}}function A(e,t){var i,l,r;let n=(0,o.a)("div",[u,t?b:f]);if("object"==typeof e&&e.disabled&&n.classList.add(_),"string"==typeof e){let t=(0,o.a)("span",[c,y,x]);t.innerHTML=e,n.appendChild(t)}else if("object"==typeof e){let a=null!=(i=e.type)?i:"item";if("split"===a)return null==n||n.classList.add(C),n;if(null==(l=null==e?void 0:e.icon)?void 0:l.svg)if(h.tP.test(e.icon.svg)){let t=new Image;e.icon.width?t.style.width=e.icon.width.toString()+"px":t.style.width="16px",e.icon.height?t.style.height=e.icon.height.toString()+"px":t.style.height="16px",t.src=e.icon.svg,n.appendChild(t)}else{let i=(0,o.a)("span",[m,y]);i.innerHTML=t&&e.selectedIcon&&e.selectedIcon.svg?e.selectedIcon.svg:e.icon.svg,e.icon.width&&i.children[0].setAttribute("width",e.icon.width.toString()),e.icon.height&&i.children[0].setAttribute("height",e.icon.height.toString()),n.appendChild(i)}let s=(0,o.a)("span",[c,y,x]);if(s.innerHTML=e.text,n.appendChild(s),"title"===a)null==n||n.classList.add(y,v);else if(null==(r=null==e?void 0:e.children)?void 0:r.length){let e=(0,o.a)("span",[c,y,w]);e.innerHTML=t?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',n.appendChild(e)}}return n}},57752:function(e,t,i){"use strict";i.d(t,{D:()=>o,Z:()=>r});var l=i(53068);function o(e){return{rootContainer:new l.ZA({}),renderDefault:!0}}class r{constructor(e){this.table=e,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(e,t){return t?this.headerCustomLayoutFuncCache.has(e):this.customLayoutFuncCache.has(e)}setReactCreateGraphic(e,t,i){i?this.headerCustomLayoutFuncCache.set(e,t):this.customLayoutFuncCache.set(e,t)}setReactRemoveGraphic(e,t,i){i?this.headerReactRemoveGraphicCache.set(e,t):this.reactRemoveGraphicCache.set(e,t)}setReactRemoveAllGraphic(e,t,i){i?this.headerReactRemoveAllGraphicCache.set(e,t):this.reactRemoveAllGraphicCache.set(e,t)}updateCustomCell(e,t){let i=this.table;if("autoWidth"===i.widthMode&&i.scenegraph.recalculateColWidths(),(i.isAutoRowHeight()||"auto"===i.internalProps.defaultRowHeight&&!t||"auto"===i.internalProps.defaultHeaderRowHeight&&t)&&i.scenegraph.recalculateRowHeights(),i.isPivotTable()){let l=function(e,t,i){let l=+!!t.internalProps.rowSeriesNumber,o=[],r=t.internalProps.layoutMap;if(i){let{headerObjects:t}=r,i=[];for(let l=0;l<t.length;l++){let o=t[l];o&&o.define.componentId===e&&i.push(o.id)}for(let e=0;e<i.length;e++){let t=i[e],l=r.getHeaderCellAdressById(t),n=r.getCellRange(l.col,l.row);o.push(n)}}else{let t,{columnObjects:i,indicatorsAsCol:n}=r;for(let l=0;l<i.length;l++)if(i[l].define.componentId===e){t=l;break}if(n)for(let e=r.rowHeaderLevelCount+t;e<r.colCount;e+=i.length){let t={start:{col:e+l,row:r.columnHeaderLevelCount},end:{col:e+l,row:r.rowCount-1}};o.push(t)}else for(let e=r.columnHeaderLevelCount+t;e<r.rowCount;e+=i.length){let t={start:{col:r.rowHeaderLevelCount+l,row:e},end:{col:r.colCount-1,row:e}};o.push(t)}}return o}(e,i,t);for(let e=0;e<l.length;e++){let t=l[e];for(let e=t.start.col;e<=t.end.col;e++)for(let l=t.start.row;l<=t.end.row;l++)i.scenegraph.updateCellContent(e,l)}}else{let l=function(e,t,i){let l=+!!t.internalProps.rowSeriesNumber;if(i){let i,l=t.internalProps.layoutMap,{headerObjects:o}=t.internalProps.layoutMap;for(let t=0;t<o.length;t++){let l=o[t];if(l.define.componentId===e){i=l.id;break}}let r=l.getHeaderCellAdressById(i);return l.getCellRange(r.col,r.row)}let{columnObjects:o}=t.internalProps.layoutMap;for(let i=0;i<o.length;i++)if(o[i].define.componentId===e)return{start:{col:l+i,row:t.columnHeaderLevelCount},end:{col:l+i,row:t.rowCount-1}};return{start:{col:0,row:0},end:{col:t.colCount-1,row:t.rowCount-1}}}(e,i,t);for(let e=l.start.col;e<=l.end.col;e++)for(let t=l.start.row;t<=l.end.row;t++)i.scenegraph.updateCellContent(e,t)}i.scenegraph.renderSceneGraph()}getCustomLayoutFunc(e,t){var i;if(this.table.isHeader(e,t)){let{componentId:l}=this.table.getHeaderDefine(e,t);return null!=(i=this.headerCustomLayoutFuncCache.get(l))?i:o}let{componentId:l}=this.table.getBodyColumnDefine(e,t);return this.customLayoutFuncCache.get(l)||o}removeCustomCell(e,t){let i;if(this.table.isHeader(e,t)){let{componentId:l}=this.table.getHeaderDefine(e,t);i=this.headerReactRemoveGraphicCache.get(l)}else{let{componentId:l}=this.table.getBodyColumnDefine(e,t);i=this.reactRemoveGraphicCache.get(l)}i&&i(e,t)}clearCache(){this.reactRemoveAllGraphicCache.forEach(e=>{e()}),this.headerReactRemoveAllGraphicCache.forEach(e=>{e()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t)}),this.headerCustomLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t,!0)})}}},47755:function(e,t,i){"use strict";i.d(t,{Zv:()=>h,h_:()=>a,lc:()=>d,qi:()=>n,ro:()=>s});var l=i(43572),o=i(91212),r=i(16369);function n(e){var t,i;let r=Object.assign({},e);return(0,l.Z)(e.style)||(r.textStyle=a(e.style)),(0,l.Z)(e.textStyle)||(0,o.Z)(r.textStyle,a(e.textStyle)),(null==(t=e.shape)?void 0:t.style)&&a(r.shape.style),(null==(i=e.background)?void 0:i.style)&&a(r.background.style),r}function a(e){return(0,l.Z)(e)||e.angle&&(e.angle=(0,r.M4)(e.angle)),e}function s(e={}){return(0,l.Z)(e.style)||(e.style=a(e.style)),(0,l.Z)(e.state)||Object.keys(e.state).forEach(t=>{(0,l.Z)(e.state[t])||(e.state[t]=a(e.state[t]))}),e}function h(e){return(0,l.Z)(e)?null:(Object.keys(e).forEach(t=>{(0,l.Z)(e[t])||(e[t]=a(e[t]))}),e)}function d(e){return s(e),s(e.startSymbol),s(e.endSymbol),e}},56616:function(e,t,i){"use strict";let l,o,r,n,a,s,h,d,u,c,g,p;i.d(t,{D:()=>lU});var f,b,m=i(18585),C=i(31150);let v={CHANGE_STYLE:"change_style"};class w extends C.R{static get EVENT_TYPE(){return v}static get DEFAULT(){return l||(l=new w)}constructor(e={},t={}){var i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z;super(),this._defaultPadding=[10,16,10,16],this._textAlign=null!=(i=null==e?void 0:e.textAlign)?i:null==t?void 0:t.textAlign,this._textBaseline=null!=(l=null==e?void 0:e.textBaseline)?l:null==t?void 0:t.textBaseline,this._color=null!=(o=null==e?void 0:e.color)?o:null==t?void 0:t.color,this._strokeColor=null!=(r=null==e?void 0:e.strokeColor)?r:null==t?void 0:t.strokeColor,this._fontSize=null!=(n=e.fontSize)?n:null==t?void 0:t.fontSize,this._fontFamily=null!=(a=e.fontFamily)?a:null==t?void 0:t.fontFamily,this._fontWeight=null!=(s=e.fontWeight)?s:null==t?void 0:t.fontWeight,this._fontVariant=null!=(h=e.fontVariant)?h:null==t?void 0:t.fontVariant,this._fontStyle=null!=(d=e.fontStyle)?d:null==t?void 0:t.fontStyle,this._padding=null!=(c=null!=(u=null==e?void 0:e.padding)?u:null==t?void 0:t.padding)?c:this._defaultPadding,this._borderColor=null!=(g=null==e?void 0:e.borderColor)?g:null==t?void 0:t.borderColor,this._textOverflow=null!=(p=null==e?void 0:e.textOverflow)?p:null==t?void 0:t.textOverflow,this._textStick=null!=(b=null!=(f=e.textStick)?f:null==t?void 0:t.textStick)&&b,this._textStickBaseOnAlign=null!=(C=null!=(m=e.textStickBaseOnAlign)?m:null==t?void 0:t.textStickBaseOnAlign)&&C,this._bgColor=null!=(v=null==e?void 0:e.bgColor)?v:null==t?void 0:t.bgColor,this._lineHeight=null!=(w=null==e?void 0:e.lineHeight)?w:null==t?void 0:t.lineHeight,this._underline=null!=(y=null==e?void 0:e.underline)?y:null==t?void 0:t.underline,this._underlineColor=null!=(x=null==e?void 0:e.underlineColor)?x:null==t?void 0:t.underlineColor,this._underlineDash=null!=(_=null==e?void 0:e.underlineDash)?_:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(S=null==e?void 0:e.underlineOffset)?S:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(R=null==e?void 0:e.lineThrough)?R:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(H=null==e?void 0:e.lineThroughColor)?H:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(A=null==e?void 0:e.lineThroughDash)?A:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(M=null==e?void 0:e.linkColor)?M:null==t?void 0:t.linkColor,this._cursor=null!=(F=e.cursor)?F:null==t?void 0:t.cursor,this._borderLineWidth=null!=(B=e.borderLineWidth)?B:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(T=e.borderLineDash)?T:null==t?void 0:t.borderLineDash,this._marked=null!=(z=e.marked)?z:null==t?void 0:t.marked}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get padding(){return this._padding}set padding(e){this._padding=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}get marked(){return this._marked}set marked(e){this._marked=e}clone(){return new w(this,null)}}class y extends w{static get DEFAULT(){return o||(o=new y)}constructor(e={},t={},i={}){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S;super(e,t),this._size=(null!=(o=null!=(l=null==e?void 0:e.size)?l:null==t?void 0:t.size)?o:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(n=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?n:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(s=null==(a=null==e?void 0:e.checkboxStyle)?void 0:a.defaultFill)?s:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(d=null==(h=null==e?void 0:e.checkboxStyle)?void 0:h.defaultStroke)?d:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(u=null==e?void 0:e.checkboxStyle)?void 0:u.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(p=null==(g=null==e?void 0:e.checkboxStyle)?void 0:g.checkedFill)?p:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(b=null==(f=null==e?void 0:e.checkboxStyle)?void 0:f.checkedStroke)?b:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(C=null==(m=null==e?void 0:e.checkboxStyle)?void 0:m.disableCheckedFill)?C:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(w=null==(v=null==e?void 0:e.checkboxStyle)?void 0:v.disableCheckedStroke)?w:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(x=null==(y=null==e?void 0:e.checkboxStyle)?void 0:y.checkIconImage)?x:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(_=null==e?void 0:e.checkboxStyle)?void 0:_.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new y(e,this)}clone(){return new y(this)}}class x extends w{static get DEFAULT(){return r||(r=new x)}constructor(e={},t={},i={}){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H;super(e,t),this._size=(null!=(o=null!=(l=null==e?void 0:e.size)?l:null==t?void 0:t.size)?o:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(n=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?n:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=(null!=(s=null!=(a=null==e?void 0:e.spaceBetweenRadio)?a:null==t?void 0:t.spaceBetweenRadio)?s:null==i?void 0:i.spaceBetweenRadio)||2,this._innerRadius=null!=(d=null==(h=null==e?void 0:e.radioStyle)?void 0:h.innerRadius)?d:null==i?void 0:i.innerRadius,this._outerRadius=null!=(c=null==(u=null==e?void 0:e.radioStyle)?void 0:u.outerRadius)?c:null==i?void 0:i.outerRadius,this._defaultFill=null!=(p=null==(g=null==e?void 0:e.radioStyle)?void 0:g.defaultFill)?p:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(b=null==(f=null==e?void 0:e.radioStyle)?void 0:f.defaultStroke)?b:null==i?void 0:i.defaultStroke,this._disableFill=null!=(C=null==(m=null==e?void 0:e.radioStyle)?void 0:m.disableFill)?C:null==i?void 0:i.disableFill,this._checkedFill=null!=(w=null==(v=null==e?void 0:e.radioStyle)?void 0:v.checkedFill)?w:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(x=null==(y=null==e?void 0:e.radioStyle)?void 0:y.checkedStroke)?x:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(S=null==(_=null==e?void 0:e.radioStyle)?void 0:_.disableCheckedFill)?S:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(H=null==(R=null==e?void 0:e.radioStyle)?void 0:R.disableCheckedStroke)?H:null==i?void 0:i.disableCheckedStroke}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(e){this._spaceBetweenRadio=e}get innerRadius(){return this._innerRadius}set innerRadius(e){this._innerRadius=e}get outerRadius(){return this._outerRadius}set outerRadius(e){this._outerRadius=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}getStyle(e){return new x(e,this)}clone(){return new x(this)}}class _ extends w{static get DEFAULT(){return n||(n=new _)}constructor(e={},t={},i={}){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w;super(e,t),this._spaceBetweenTextAndCircle=(null!=(o=null!=(l=null==e?void 0:e.spaceBetweenTextAndCircle)?l:null==t?void 0:t.spaceBetweenTextAndCircle)?o:null==i?void 0:i.spaceBetweenTextAndCircle)||6,this._circleRadius=(null!=(n=null==(r=null==e?void 0:e.switchStyle)?void 0:r.circleRadius)?n:null==i?void 0:i.circleRadius)||8,this._boxWidth=(null!=(s=null==(a=null==e?void 0:e.switchStyle)?void 0:a.boxWidth)?s:null==i?void 0:i.boxWidth)||40,this._boxHeight=(null!=(d=null==(h=null==e?void 0:e.switchStyle)?void 0:h.boxHeight)?d:null==i?void 0:i.boxHeight)||24,this._checkedFill=(null!=(c=null==(u=null==e?void 0:e.switchStyle)?void 0:u.checkedFill)?c:null==i?void 0:i.checkedFill)||"#165DFF",this._uncheckedFill=(null!=(p=null==(g=null==e?void 0:e.switchStyle)?void 0:g.uncheckedFill)?p:null==i?void 0:i.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=(null!=(b=null==(f=null==e?void 0:e.switchStyle)?void 0:f.disableCheckedFill)?b:null==i?void 0:i.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=(null!=(C=null==(m=null==e?void 0:e.switchStyle)?void 0:m.disableUncheckedFill)?C:null==i?void 0:i.disableUncheckedFill)||"#f2f3f5",this._circleFill=(null!=(w=null==(v=null==e?void 0:e.switchStyle)?void 0:v.circleFill)?w:null==i?void 0:i.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(e){this._spaceBetweenTextAndCircle=e}get circleRadius(){return this._circleRadius}set circleRadius(e){this._circleRadius=e}get boxWidth(){return this._boxWidth}set boxWidth(e){this._boxWidth=e}get boxHeight(){return this._boxHeight}set boxHeight(e){this._boxHeight=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(e){this._uncheckedFill=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(e){this._disableUncheckedFill=e}get circleFill(){return this._circleFill}set circleFill(e){this._circleFill=e}getStyle(e){return new _(e,this)}clone(){return new _(this)}}class S extends w{static get DEFAULT(){return a||(a=new S)}constructor(e={},t={},i={}){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S;super(e,t),this._buttonColor=(null!=(o=null==(l=null==e?void 0:e.buttonStyle)?void 0:l.buttonColor)?o:null==i?void 0:i.buttonColor)||"#165DFF",this._buttonBorderColor=(null!=(n=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonBorderColor)?n:null==i?void 0:i.buttonBorderColor)||"#165DFF",this._buttonLineWidth=(null!=(s=null==(a=null==e?void 0:e.buttonStyle)?void 0:a.buttonLineWidth)?s:null==i?void 0:i.buttonLineWidth)||1,this._buttonBorderRadius=(null!=(d=null==(h=null==e?void 0:e.buttonStyle)?void 0:h.buttonBorderRadius)?d:null==i?void 0:i.buttonBorderRadius)||2,this._buttonHoverColor=(null!=(c=null==(u=null==e?void 0:e.buttonStyle)?void 0:u.buttonHoverColor)?c:null==i?void 0:i.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=(null!=(p=null==(g=null==e?void 0:e.buttonStyle)?void 0:g.buttonHoverBorderColor)?p:null==i?void 0:i.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=null!=(b=null==(f=null==e?void 0:e.buttonStyle)?void 0:f.buttonTextHoverColor)?b:null==i?void 0:i.buttonTextHoverColor,this._buttonDisableColor=(null!=(C=null==(m=null==e?void 0:e.buttonStyle)?void 0:m.buttonDisableColor)?C:null==i?void 0:i.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=(null!=(w=null==(v=null==e?void 0:e.buttonStyle)?void 0:v.buttonDisableBorderColor)?w:null==i?void 0:i.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=null!=(x=null==(y=null==e?void 0:e.buttonStyle)?void 0:y.buttonTextDisableColor)?x:null==i?void 0:i.buttonTextDisableColor,this._buttonPadding=(null!=(S=null==(_=null==e?void 0:e.buttonStyle)?void 0:_.buttonPadding)?S:null==i?void 0:i.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(e){this._buttonColor=e}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(e){this._buttonBorderColor=e}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(e){this._buttonLineWidth=e}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(e){this._buttonBorderRadius=e}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(e){this._buttonHoverColor=e}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(e){this._buttonHoverBorderColor=e}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(e){this._buttonTextHoverColor=e}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(e){this._buttonDisableColor=e}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(e){this._buttonDisableBorderColor=e}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(e){this._buttonTextDisableColor=e}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(e){this._buttonTextHoverBorderColor=e}get buttonPadding(){return this._buttonPadding}set buttonPadding(e){this._buttonPadding=e}getStyle(e){return new S(e,this)}clone(){return new S(this)}}let{EVENT_TYPE:R}=w;function H(e,t,i,l=w,o,r){var n,a,s,h;return e||t?e instanceof w?e:"function"==typeof e?H(e(i),t,i,l,o,r):(e||(e={}),o&&!(0,m.Z)(e.autoWrapText)&&(e.autoWrapText=!0),l===y?new y(null!=e?e:{},null!=t?t:{},null!=(n=r.checkboxStyle)?n:{}):l===x?new x(null!=e?e:{},null!=t?t:{},null!=(a=r.radioStyle)?a:{}):l===_?new _(null!=e?e:{},null!=t?t:{},null!=(s=r.switchStyle)?s:{}):l===S?new S(null!=e?e:{},null!=t?t:{},null!=(h=r.buttonStyle)?h:{}):new l(null!=e?e:{},null!=t?t:{})):l.DEFAULT}var A=i(27180),M=i(97811),F=i(12348),B=i(5021),T=i(77597),z=i(83847),L=i(1847),k=i(89445),P=i(14116),I=i(28071),E=i(28399),D=i(59480),W=i(93279),O=i(91925),G=i(3607),N=i(27695),Z=i(13224),K=i(75025),V=i(50071),j=i(31604),U=i(74431),$=i(17097),X=i(60232),J=i(58977);function Y(e){return!!("cell"===e.role&&(0,J.Z)(e.mergeStartCol)&&(0,J.Z)(e.mergeStartRow)&&(0,J.Z)(e.mergeEndCol)&&(0,J.Z)(e.mergeEndRow))}var q=i(37811),Q=i(49277),ee=i(9649),et=i(96762);function ei(e,t,i,l){l||e.table._setRowHeight(t,e.table.getRowHeight(t)+i,!0);for(let l=0;l<e.table.colCount;l++){var o,r,n,a,s,h,d;let u=e.getCell(l,t);if("empty"===u.role)continue;let c=(0,Z.Z)(e.table,l,t);c&&c.start.col!==l||(o=e,r=u,n=l,a=t,s=u.attribute.height+i,h=i,d=e.table.isHeader(l,t),r&&el(o,r,n,a,s,h,d),e.updateCellContentWhileResize(l,t))}let u=0,c=0;t<e.table.frozenRowCount?(u=t+1,c=e.table.frozenRowCount-1):t>=e.table.rowCount-e.table.bottomFrozenRowCount?(u=t+1,c=e.table.rowCount-1):(u=t+1,c=Math.min(e.proxy.rowEnd,e.table.rowCount-e.table.bottomFrozenRowCount-1));for(let t=0;t<e.table.colCount;t++)for(let l=u;l<=c;l++){let o=e.highPerformanceGetCell(t,l);"cell"===o.role&&o.setAttribute("y",o.attribute.y+i)}}function el(e,t,i,l,o,r,n){var a,s,h,d,u;if(t.attribute.height===o&&!t.needUpdateHeight)return;t.needUpdateHeight=!1,t.setAttribute("height",o);let c=null==(a=e.table.getCellRawRecord(i,l))?void 0:a.vtableMerge,g=!!e.table.getCustomMerge(i,l),p=c||g?"text":e.table.isHeader(i,l)?null!=(s=e.table._getHeaderLayoutMap(i,l).headerType)?s:"text":null!=(h=e.table.getBodyColumnType(i,l))?h:"text";if("progressbar"===p){let n,a=e.table.getBodyColumnDefine(i,l),s=e.table._getCellStyle(i,l),h=e.table.getCellValue(i,l),d=e.table.getCellOriginValue(i,l),u=(0,q.u)((0,X.WJ)("padding",s,i,l,e.table));(null==a?void 0:a.mergeCell)&&(n=e.table.getCellRange(i,l));let c=K.F.getFunction("createProgressBarCell")(a,s,t.attribute.width,h,d,i,l,u,e.table,n),g=t.getChildByName("progress-bar");t.insertBefore(c,g),t.removeChild(g),g.removeAllChild(),g.release(),eo(t,o,r,e.table.isAutoRowHeight(l),!0,e.table)}else if("sparkline"===p){t.removeAllChild();let o=e.table._getCellStyle(i,l),r=(0,q.u)((0,X.WJ)("padding",o,i,l,e.table));K.F.getFunction("createSparkLineCellGroup")(t,t.parent,t.attribute.x,t.attribute.y,i,l,t.attribute.width,t.attribute.height,r,e.table,(0,V.RT)(o,e.table,i,l,X.WJ).theme,!1)}else if("image"===p||"video"===p)(0,U.km)(t,i,l,0,r,e.table);else if("axis"===(null==(d=t.firstChild)?void 0:d.name))null==(u=t.firstChild)||u.originAxis.resize(t.attribute.width,t.attribute.height);else{let n=!0,a=t.getChildByName(j.FH)||t.getChildByName(j.cd);if(a){let o;t.removeChild(a);let r=(0,$.l7)(i,l,t,e.table);if(r)for(let t=r.start.row;t<=r.end.row;t++){if(t===l)continue;let o=e.getCell(i,t),r=o.getChildByName(j.FH)||o.getChildByName(j.cd);r.removeAllChild(),o.removeChild(r),(0,$.l7)(i,t,o,e.table)}else{let r,a,s=e.table.getCellLocation(i,l),{vtableMerge:h}=e.table.getCellRawRecord(i,l)||{};if(h&&e.table.internalProps.groupTitleCustomLayout)a=e.table.internalProps.groupTitleCustomLayout;else if("body"!==s){let t=e.table.getHeaderDefine(i,l);r=null==t?void 0:t.headerCustomRender,a=null==t?void 0:t.headerCustomLayout}else{let t=e.table.getBodyColumnDefine(i,l);r=(null==t?void 0:t.customRender)||e.table.customRender,a=null==t?void 0:t.customLayout}if((r||a)&&Y(t))for(let i=t.mergeStartCol;i<=t.mergeEndCol;i++)for(let o=t.mergeStartRow;o<=t.mergeEndRow;o++)o!==l&&e.updateCellContent(i,o);if(a||r){let s=e.table._getCellStyle(i,l),h=(0,q.u)((0,X.WJ)("padding",s,i,l,e.table)),d=t.attribute.width,u=t.attribute.height;Y(t)&&(d=e.table.getColsWidth(t.mergeStartCol,t.mergeEndCol),u=e.table.getRowsHeight(t.mergeStartRow,t.mergeEndRow));let c=(0,j.ws)(a,r,i,l,d,u,!1,e.table.isAutoRowHeight(l),h,Y(t)?{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}}:void 0,e.table);o=c.elementsGroup,n=c.renderDefault}t.childrenCount>0&&o?t.insertBefore(o,t.firstChild):o&&t.appendChild(o)}}eo(t,o,r,e.table.isAutoRowHeight(l),n,e.table)}}function eo(e,t,i,l,o,r){if(Y(e)){t=0;for(let i=e.mergeStartRow;i<=e.mergeEndRow;i++)t+=r.getRowHeight(i);let{colStart:n,colEnd:a,rowStart:s,rowEnd:h}=(0,et.e)(e,r.scenegraph);for(let d=n;d<=a;d++)for(let a=s;a<=h;a++){let h=r.scenegraph.getCell(d,a);if("cell"!==h.role)continue;if(h.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})}),o){let e=r._getCellStyle(n,s),o=(0,q.u)((0,X.WJ)("padding",e,d,a,r));(0,Q.Zl)(h,t,i,l,o,e.textAlign,e.textBaseline,r)}let u=r.getRowHeight(a),c=r.getColWidth(d);h.contentHeight=t;let{widthChange:g}=(0,$.NQ)(h,c,u,{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}},r);g&&(h.needUpdateWidth=!0)}}else{let o=r._getCellStyle(e.col,e.row),n=(0,q.u)((0,X.WJ)("padding",o,e.col,e.row,r));(0,Q.Zl)(e,t,i,l,n,o.textAlign,o.textBaseline,r)}}var er=i(81668);function en(e,t,i,l){var o,r,n,a,s,h,d;let u=!1,c=null!=(o=null==e?void 0:e.attribute.width)?o:0;if(null==e||e.setAttribute("width",c+t),null==e||e.forEachChildren((e,o)=>{if(function(e,t,i,l,o,r,n,a,s){var h,d,u,c,g,p,f;if(t.attribute.width===r&&!t.needUpdateWidth)return!1;if(t.needUpdateWidth=!1,t.setAttribute("width",r),!t)return!1;let b=e.table.isAutoRowHeight(l),m=null==(h=e.table.getCellRawRecord(i,l))?void 0:h.vtableMerge,C=!!e.table.getCustomMerge(i,l),v=m||C?"text":e.table.isHeader(i,l)?null!=(d=e.table._getHeaderLayoutMap(i,l).headerType)?d:"text":null!=(u=e.table.getBodyColumnType(i,l))?u:"text",w=!1;if("progressbar"===v){let o,a=e.table.getBodyColumnDefine(i,l),s=e.table._getCellStyle(i,l),h=e.table.getCellValue(i,l),d=e.table.getCellOriginValue(i,l),u=(0,q.u)((0,X.WJ)("padding",s,i,l,e.table));(null==a?void 0:a.mergeCell)&&(o=e.table.getCellRange(i,l));let c=K.F.getFunction("createProgressBarCell")(a,s,t.attribute.width,h,d,i,l,u,e.table,o),g=t.getChildByName("progress-bar");t.insertBefore(c,g),t.removeChild(g),g.removeAllChild(),g.release();let p=ea(t,r,n,b,!0,e.table);w=w||p}else if("sparkline"===v){t.removeAllChild();let o=e.table._getCellStyle(i,l),r=(0,q.u)((0,X.WJ)("padding",o,i,l,e.table));K.F.getFunction("createSparkLineCellGroup")(t,t.parent,t.attribute.x,t.attribute.y,i,l,t.attribute.width,t.attribute.height,r,e.table,(0,V.RT)(o,e.table,i,l,X.WJ).theme,!1)}else if("image"===v||"video"===v)(0,U.km)(t,i,l,n,0,e.table);else if("axis"===(null==(c=t.firstChild)?void 0:c.name)){let o=e.table.internalProps.layoutMap.getAxisConfigInPivotChart(i,l),r=e.table._getCellStyle(i,l),n=(0,q.u)((0,X.WJ)("padding",r,i,l,e.table));if(o){let i=new(K.F.getComponent("axis"))(o,t.attribute.width,t.attribute.height,null!=(g=o.__vtablePadding)?g:n,e.table);t.clear(),t.appendChild(i.component),i.overlap()}}else if("axis"===(null==(p=t.firstChild)?void 0:p.name))null==(f=t.firstChild)||f.originAxis.resize(t.attribute.width,t.attribute.height);else{let o=!0,a=t.getChildByName(j.FH)||t.getChildByName(j.cd);if(a){let r;t.removeChild(a);let n=(0,$.l7)(i,l,t,e.table);if(n)for(let t=n.start.col;t<=n.end.col;t++){if(t===i)continue;let o=e.getCell(t,l),r=o.getChildByName(j.FH)||o.getChildByName(j.cd);r.removeAllChild(),o.removeChild(r),(0,$.l7)(t,l,o,e.table)}else{let n,a,s=e.table.getCellLocation(i,l),{vtableMerge:h}=e.table.getCellRawRecord(i,l)||{};if(h&&e.table.internalProps.groupTitleCustomLayout)a=e.table.internalProps.groupTitleCustomLayout;else if("body"!==s){let t=e.table.getHeaderDefine(i,l);n=null==t?void 0:t.headerCustomRender,a=null==t?void 0:t.headerCustomLayout}else{let t=e.table.getBodyColumnDefine(i,l);n=(null==t?void 0:t.customRender)||e.table.customRender,a=null==t?void 0:t.customLayout}if((n||a)&&Y(t)){for(let l=t.mergeStartCol;l<=t.mergeEndCol;l++)if(l!==i)for(let i=t.mergeStartRow;i<=t.mergeEndRow;i++)e.updateCellContent(l,i)}if(a||n){let s=e.table._getCellStyle(i,l),h=(0,q.u)((0,X.WJ)("padding",s,i,l,e.table)),d=t.attribute.width,u=t.attribute.height;Y(t)&&(d=e.table.getColsWidth(t.mergeStartCol,t.mergeEndCol),u=e.table.getRowsHeight(t.mergeStartRow,t.mergeEndRow));let c=(0,j.ws)(a,n,i,l,d,u,!1,e.table.isAutoRowHeight(l),h,Y(t)?{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}}:void 0,e.table);r=c.elementsGroup,o=c.renderDefault,w=!0}t.childrenCount>0&&r?t.insertBefore(r,t.firstChild):r&&t.appendChild(r)}}let s=ea(t,r,n,b,o,e.table);w=w||s}return s||(s=e.table._getCellStyle(i,l).autoWrapText),!(!b||!s)&&w}(l,e,e.col,e.row,0,c+t,t,"row-body"!==i||(e.col,l.table.rowHeaderLevelCount),l.table.internalProps.autoWrapText)){let t=(0,Z.Z)(l.table,e.col,e.row);if(t&&t.end.row-t.start.row)for(let e=t.start.row;e<=t.end.row;e++)es(l,e);else es(l,e.row);u=!0}}),u){let e,t,o,u=0;for(let c=0;c<l.table.colCount;c++){if("col-corner"===i?(o=0,e=l.getColGroup(c,!0),t=null!=(r=l.colHeaderGroup.attribute.height)?r:0):"row-body"===i?(o=l.table.frozenRowCount,e=l.getColGroup(c,!1),t=null!=(n=l.bodyGroup.attribute.height)?n:0):"bottom"===i?(o=l.table.rowCount-l.table.bottomFrozenRowCount,e=l.getColGroupInBottom(c),t=null!=(a=l.bottomFrozenGroup.attribute.height)?a:0):"left-bottom"===i?(o=l.table.rowCount-l.table.bottomFrozenRowCount,e=l.getColGroupInLeftBottomCorner(c),t=null!=(s=l.leftBottomCornerGroup.attribute.height)?s:0):"right-top"===i?(o=0,e=l.getColGroupInRightTopCorner(c),t=null!=(h=l.rightTopCornerGroup.attribute.height)?h:0):"right-bottom"===i&&(o=l.table.rowCount-l.table.bottomFrozenRowCount,e=l.getColGroupInRightBottomCorner(c),t=null!=(d=l.rightBottomCornerGroup.attribute.height)?d:0),!e)continue;let g=0;e.forEachChildren(e=>{var t;e.setAttribute("y",g),g+=null!=(t=l.table.getRowHeight(e.row))?t:0}),u=g}l.updateContainerHeight(o,u-t);for(let e=0;e<l.table.frozenColCount;e++){let t=l.getColGroupInLeftBottomCorner(e),i=0;null==t||t.forEachChildren(e=>{e.setAttribute("y",i),i+=l.table.getRowHeight(e.row)})}for(let e=l.table.colCount-l.table.rightFrozenColCount;e<l.table.colCount;e++){let t=l.getColGroupInRightBottomCorner(e),i=0;null==t||t.forEachChildren(e=>{e.setAttribute("y",i),i+=l.table.getRowHeight(e.row)})}for(let e=l.table.frozenColCount;e<l.table.colCount-l.table.rightFrozenColCount;e++){let t=l.getColGroupInBottom(e),i=0;null==t||t.forEachChildren(e=>{e.setAttribute("y",i),i+=l.table.getRowHeight(e.row)})}}}function ea(e,t,i,l,o,r){if(Y(e)){t=0;let n=!1;for(let i=e.mergeStartCol;i<=e.mergeEndCol;i++)t+=r.getColWidth(i);let a=0;for(let t=e.mergeStartRow;t<=e.mergeEndRow;t++)a+=r.getRowHeight(t);let{colStart:s,colEnd:h,rowStart:d,rowEnd:u}=(0,et.e)(e,r.scenegraph);for(let c=s;c<=h;c++)for(let h=d;h<=u;h++){if(c===e.col&&h!==e.row)continue;let u=r.scenegraph.getCell(c,h);if("cell"!==u.role)continue;u.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})});let g=!1;if(o){let e=r._getCellStyle(s,d),o=(0,q.u)((0,X.WJ)("padding",e,c,h,r)),n=e.textAlign,p=e.textBaseline;g=(0,Q.qs)(u,t,a,i,l,o,n,p,r.scenegraph);let f=(0,er.L)(u.col,u.row,r);if(f){let e=u.getChildByName("text"),t=u.getChildByName("expand")||u.getChildByName("collapse");"icon-left"!==(null==t?void 0:t.role)&&e&&e.setAttribute("dx",f)}}let p=r.getRowHeight(h),f=r.getColWidth(c);u.contentWidth=t;let{heightChange:b}=(0,$.NQ)(u,f,p,{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}},r);b&&(u.needUpdateHeight=!0),n=n||g}return n}let n=r._getCellStyle(e.col,e.row),a=(0,q.u)((0,X.WJ)("padding",n,e.col,e.row,r)),s=n.textAlign,h=n.textBaseline;return(0,Q.qs)(e,t,r.getRowHeight(e.row),i,l,a,s,h,r.scenegraph)}function es(e,t){let i=Math.round((0,ee.P)(t,0,e.table.colCount-1,e.table));e.table._setRowHeight(t,i,!0);for(let n=0;n<e.table.colCount;n++){var l,o,r;let a=e.highPerformanceGetCell(n,t);"empty"!==a.role&&(l=n,o=i-a.attribute.height,r=e.table.isHeader(n,t),a&&el(e,a,l,t,i,o,r))}}var eh=i(73208),ed=i(29411),eu=i(28651),ec=i(53068),eg=i(29609),ep=i(38512),ef=i(1669);(f=b||(b={})).dropDown="dropDown",f.contextmenu="contextmenu",f.custom="custom";let eb={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};class em{constructor(e){this._table=e,this._menuInstance=new ep.Z({x:0,y:0,fill:eb.bgColor,stroke:eb.borderColor,cornerRadius:eb.cornerRadius,lineWidth:eb.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:b.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(e){e.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(e,t,i,l,o,r){if(o===b.dropDown&&this.checkDropDownMenuChange(i,l)){let e=this.getMenuInfo(i,l,o);if(!e)return;let{menuInfo:t,highlightIndex:r}=e;this.updateMenuInfo(i,l,o,t,r),this.updateMenuInstance(t,r)}else if(o===b.contextmenu&&this.checkContextMenuChange(e,t)){let e=this.getMenuInfo(i,l,o);if(!e)return;let{menuInfo:t,highlightIndex:r}=e;this.updateMenuInfo(i,l,o,t,r),this.updateMenuInstance(t,r)}this.updatePosition(e-this._table.scenegraph.x,t-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(e,t,i,l,o){this._menuInfo.col=e,this._menuInfo.row=t,this._menuInfo.type=i,this._menuInfo.menuInfo=l,this._menuInfo.highlightIndex=o}checkDropDownMenuChange(e,t){let{type:i,col:l,row:o}=this._menuInfo;return i!==b.dropDown||e!==l||t!==o}checkContextMenuChange(e,t){var i;let{type:l,menuInfo:o}=this._menuInfo;return l!==b.contextmenu||o!==(null==(i=this._table.internalProps.menu)?void 0:i.contextMenuItems)}updateMenuInstance(e,t){this._menuInstance.removeAllChild();let i=eb.menuPadding,l=eb.menuPadding,o=0;e.forEach((e,r)=>{var n,a;let s,h,d=t===r;"string"==typeof e?h=e:"object"==typeof e&&(h=e.text,s=d?e.selectedIcon:e.icon);let u=new ep.Z({y:i,x:l,height:eb.lineHeight,fill:eb.bgColor});u.role="menu-item",this._menuInstance.appendChild(u),u.stateProxy=e=>"hover"===e?{fill:eb.hoverBgColor}:{fill:eb.bgColor},u.addEventListener("pointerenter",e=>{u.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),u.addEventListener("pointerleave",e=>{u.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});let c=new ed.x({x:eb.menuItemPadding,y:eb.menuItemPadding,fill:d?eb.highlightColor:eb.color,text:h,textBaseline:"top",fontSize:eb.fontSize,fontFamily:eb.fontFamily,pickable:!1,maxLineWidth:eb.maxLineWidth,ellipsis:"…"});if(u.addChild(c),s){c.AABBBounds.height();let e=null!=(n=s.width)?n:16,t=null!=(a=s.height)?a:16,i=new ef.J({x:eb.menuItemPadding,y:(eb.lineHeight-t)/2,width:e,height:t,image:s.svg,pickable:!1});i.role="menu-icon",u.insertBefore(i,c),c.setAttribute("x",e+eb.menuItemPadding)}o=Math.max(u.AABBBounds.width(),o),i+=eb.lineHeight}),this._menuInstance.setAttributes({width:o+2*eb.menuItemPadding+2*eb.menuPadding,height:i+eb.menuPadding}),this._menuInstance.forEachChildren(e=>{e.setAttribute("width",o+2*eb.menuItemPadding)})}updatePosition(e,t){this._menuInstance.setAttributes({x:this._menuInfo.type===b.dropDown?e-this._menuInstance.attribute.width:e,y:t}),this._menuInfo.x=b.dropDown?e-this._menuInstance.attribute.width:e,this._menuInfo.y=t}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(e,t,i){var l;if(i===b.dropDown){let i=this._table.globalDropDownMenu;"function"==typeof(i=this._table._getHeaderLayoutMap(e,t).dropDownMenu)&&(i=i({row:t,col:e,table:this._table}));let l=-1;if(Array.isArray(i)){for(let o=0;o<i.length;o++)if(this._table._dropDownMenuIsHighlight(e,t,o)){l=o;break}}return{menuInfo:i,highlightIndex:l}}if(i===b.contextmenu){let i,o=null==(l=this._table.internalProps.menu)?void 0:l.contextMenuItems;if(Array.isArray(o))i=o;else if("function"==typeof o){let{field:l}=this._table.isHeader(e,t)?this._table.getHeaderDefine(e,t):this._table.getBodyColumnDefine(e,t);i=o(l,t,e)}return{menuInfo:i,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",e=>{let{target:t}=e;if(t&&"menu-item"===t.role){let i=Object.assign(this.getEventInfo(t),this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type));i.event=e.nativeEvent,this._table.fireListeners(z.B.DROPDOWN_MENU_CLICK,i)}})}getEventInfo(e){let t=e.parent,i=0;t.forEachChildren((t,l)=>t===e&&(i=l-1,!0));let l="string"==typeof this._menuInfo.menuInfo[i]?this._menuInfo.menuInfo[i]:this._menuInfo.menuInfo[i].text,o="string"==typeof this._menuInfo.menuInfo[i]?l:this._menuInfo.menuInfo[i].menuKey||l;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:i,highlight:i===this._menuInfo.highlightIndex,text:l,menuKey:o}}get bounds(){return this._menuInstance.globalAABBBounds}}var eC=i(4234);let ev=eC.U2();class ew{constructor(){let e=ev.drillDown;this.icon=new ef.J({x:-1e3,y:-1e3,image:e.svg,width:e.width,height:e.height,dx:-e.width/2,dy:-e.height/2,visible:!1,funcType:e.funcType,cursor:e.cursor}),this.icon.role="icon-drill"}appand(e){e.appendChild(this.icon)}update(e,t,i,l,o,r){if(!e||l&&o)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void r.updateNextFrame();let n=ev.drillDown,a=ev.drillUp;this.icon.setAttributes({x:t,y:i,image:l?n.svg:a.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),r.updateNextFrame()}}var ey=i(14861);class ex{constructor(e){let t=e.theme.dragHeaderSplitLine.lineWidth,i=e.theme.dragHeaderSplitLine.lineColor,l=e.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=(0,ey.t)({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:i}),this.columnMoverLine=(0,eh.W)({visible:!1,pickable:!1,stroke:i,lineWidth:t,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=(0,eu.f)({visible:!1,pickable:!1,fill:l,x:0,y:0,width:0,height:0}),this.table=e}appand(e){e.appendChild(this.columnMoverLabel),e.appendChild(this.columnMoverLine),e.appendChild(this.columnMoverBack)}show(e,t,i){let l=this.table.getCellLocation(e,t),o=(0,Z.Z)(this.table,e,t);o&&(e=o.start.col,t=o.start.row);let r=0,n=0,a=0,s=0,h=0,d=0,u=0,c=0,g=Math.PI,p=[];return"columnHeader"===l?(r=this.table.getColsWidth(0,e-1)-this.table.stateManager.scroll.horizontalBarPos,n=this.table.getRowsHeight(0,this.table.frozenRowCount-1),s=this.table.tableNoFrameHeight,a=o?this.table.getColsWidth(o.start.col,o.end.col):this.table.getColWidth(e),h=r-i,u=r+a,c=2,p.push({x:0,y:0}),p.push({x:0,y:this.table.tableNoFrameHeight})):("rowHeader"===l||this.table.internalProps.layoutMap.isSeriesNumberInBody(e,t))&&(n=this.table.getRowsHeight(0,t-1)-this.table.stateManager.scroll.verticalBarPos,r=this.table.getColsWidth(0,this.table.frozenColCount-1),a=this.table.tableNoFrameWidth,s=o?this.table.getRowsHeight(o.start.row,o.end.row):this.table.getRowHeight(t),d=n-i,u=2,c=n+s,g=Math.PI/2,p.push({x:0,y:0}),p.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:r-h,y:n-d,width:a,height:s,dx:h,dy:d}),this.columnMoverLine.setAttributes({x:u,y:c,visible:!0,points:p}),this.columnMoverLabel.setAttributes({visible:!0,x:u,y:c,angle:g}),{backX:r-h,lineX:u,backY:n-d,lineY:c}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(e,t,i,l){"number"==typeof e&&"number"==typeof t?(this.columnMoverLabel.setAttribute("x",t),this.columnMoverLine.setAttribute("x",t),this.columnMoverBack.setAttribute("x",e)):"number"==typeof i&&"number"==typeof l&&(this.columnMoverLabel.setAttribute("y",l),this.columnMoverLine.setAttribute("y",l),this.columnMoverBack.setAttribute("y",i))}updateStyle(){let e=this.table.theme.dragHeaderSplitLine.lineWidth,t=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:t}),this.columnMoverLine.setAttributes({stroke:t,lineWidth:e}),this.columnMoverBack.setAttributes({fill:i})}}function e_(e,t,i){if(i)return Math.min(t.tableNoFrameWidth,t.getAllColsWidth())-t.getColsWidth(e,t.colCount-1);let l=t.getColsWidth(0,e);return e>=t.frozenColCount&&(l-=t.scrollLeft),l}function eS(e,t,i){if(i)return Math.min(t.tableNoFrameWidth,t.getAllRowsHeight())-t.getRowsHeight(e,t.rowCount-1);let l=t.getRowsHeight(0,e);return e>=t.frozenRowCount&&(l-=t.scrollTop),l}class eR{constructor(e){var t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v;this.table=e;let w=this.table.theme;this.createScrollBar();let y=null==(t=w.columnResize)?void 0:t.lineColor,x=null==(i=w.columnResize)?void 0:i.lineWidth,_=null==(l=w.columnResize)?void 0:l.bgColor,S=null==(o=w.columnResize)?void 0:o.width,R=null==(n=null==(r=w.columnResize)?void 0:r.labelVisible)||n,H=null==(a=w.columnResize)?void 0:a.labelColor,A=null==(s=w.columnResize)?void 0:s.labelFontSize,M=null==(h=w.columnResize)?void 0:h.labelFontFamily,F=null==(d=w.columnResize)?void 0:d.labelBackgroundFill,B=null==(u=w.columnResize)?void 0:u.labelBackgroundCornerRadius;this.labelVisible=R,this.columnResizeLine=(0,eh.W)({visible:!1,pickable:!1,stroke:y,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=(0,eh.W)({visible:!1,pickable:!1,stroke:_,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let T=(0,ed.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:A,fill:H,fontFamily:M,text:"",textBaseline:"top",dx:16,dy:-A/2}),z=(0,eu.f)({visible:!1,pickable:!1,fill:F,x:0,y:0,width:5*A*.8,height:A+8,cornerRadius:B,dx:12,dy:-A/2-4});this.columnResizeLabel=(0,ec.sS)({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(z),this.columnResizeLabel.appendChild(T),this.rowResizeLine=(0,eh.W)({visible:!1,pickable:!1,stroke:y,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=(0,eh.W)({visible:!1,pickable:!1,stroke:_,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let L=(0,ed.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:A,fill:H,fontFamily:M,text:"",textBaseline:"top",dx:16,dy:-A/2}),k=(0,eu.f)({visible:!1,pickable:!1,fill:F,x:0,y:0,width:5*A*.8,height:A+8,cornerRadius:B,dx:12,dy:-A/2-4});this.rowResizeLabel=(0,ec.sS)({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(k),this.rowResizeLabel.appendChild(L),this.cellMover=new ex(this.table);let P=null==(g=null==(c=w.frozenColumnLine)?void 0:c.shadow)?void 0:g.width,I=null==(f=null==(p=w.frozenColumnLine)?void 0:p.shadow)?void 0:f.startColor,E=null==(m=null==(b=w.frozenColumnLine)?void 0:b.shadow)?void 0:m.endColor,D=null==(v=null==(C=w.frozenColumnLine)?void 0:C.shadow)?void 0:v.visible;this.frozenShadowLine=(0,eu.f)({visible:"always"===D,pickable:!1,x:0,y:0,width:P,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:I,offset:0},{color:E,offset:1}]}}),this.rightFrozenShadowLine=(0,eu.f)({visible:"always"===D,pickable:!1,x:0,y:0,width:P,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:E,offset:0},{color:I,offset:1}]}}),this.menu=new em(this.table),this.drillIcon=new ew}addToGroup(e){e.addChild(this.frozenShadowLine),e.addChild(this.rightFrozenShadowLine),e.addChild(this.columnResizeBgLine),e.addChild(this.columnResizeLine),e.addChild(this.columnResizeLabel),e.addChild(this.rowResizeBgLine),e.addChild(this.rowResizeLine),e.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(e.addChild(this.hScrollBar),e.addChild(this.vScrollBar)):(e.stage.defaultLayer.addChild(this.hScrollBar),e.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(e),this.drillIcon.appand(e),this.cellMover.appand(e)}createScrollBar(){var e,t,i,l,o,r;let n,a=this.table.theme,s=null==(e=a.scrollStyle)?void 0:e.scrollRailColor,h=null==(t=a.scrollStyle)?void 0:t.scrollSliderColor,d=null==(i=a.scrollStyle)?void 0:i.scrollSliderCornerRadius,u=null==(l=a.scrollStyle)?void 0:l.width,c=null==(o=a.scrollStyle)?void 0:o.horizontalPadding,g=null==(r=a.scrollStyle)?void 0:r.verticalPadding;n=(0,m.Z)(d)?{cornerRadius:d,fill:h}:{fill:h},this.hScrollBar=new eg.B({direction:"horizontal",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:this.table.tableNoFrameWidth,height:u,padding:c,railStyle:{fill:s},sliderStyle:n,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new eg.B({direction:"vertical",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:u,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:g,railStyle:{fill:s},sliderStyle:n,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var e,t,i,l,o,r,n;let a=this.table.stateManager.scroll.horizontalBarPos,s=this.table.stateManager.scroll.verticalBarPos,h=this.table.theme,d=null==(e=h.scrollStyle)?void 0:e.width,u=null==(t=h.scrollStyle)?void 0:t.visible,c=null!=(l=null==(i=h.scrollStyle)?void 0:i.horizontalVisible)?l:u,g=null!=(r=null==(o=h.scrollStyle)?void 0:o.verticalVisible)?r:u,p=Math.ceil(this.table.scenegraph.tableGroup.attribute.width),f=Math.ceil(this.table.scenegraph.tableGroup.attribute.height),b=this.table.getAllRowsHeight(),m=this.table.getAllColsWidth(),C=this.table.getFrozenRowsHeight(),v=this.table.getFrozenColsWidth(),w=this.table.getBottomFrozenRowsHeight(),y=this.table.getRightFrozenColsWidth(),x=+(null!=(n=this.table.options.customConfig)&&!!n._disableColumnAndRowSizeRound);if(m>p+x){let e=Math.min(f,b),t=Math.max(.05,(p-v)/(m-v)),i=this.table.theme.scrollStyle.hoverOn,l=0;l=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(i?d:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:e-(i?d:-this.table.scenegraph.tableGroup.attribute.y),this.hScrollBar.setAttributes({x:v+(i?0:this.table.scenegraph.tableGroup.attribute.x),y:l,width:p-v-y,range:[0,t],visible:"always"===c});let o=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:o.x1,y:o.y1},"always"===c&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:0,visible:!1});if(b>f+x){let e=Math.min(p,m),t=Math.max(.05,(f-C)/(b-C)),i=0,l=this.table.theme.scrollStyle.hoverOn;i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(l?d:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:e-(l?d:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:i,y:C+(l?0:this.table.scenegraph.tableGroup.attribute.y),height:f-C-w,range:[0,t],visible:"always"===g});let o=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:o.x1,y:o.y1},"always"===g&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),height:0,visible:!1});this.table.stateManager.setScrollLeft(a),this.table.stateManager.setScrollTop(s)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(e,t,i){let l=e_(e,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:l,y:t}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(e)}px`))}updateResizeCol(e,t,i){let l=e_(e,this.table,i);this.columnResizeLine.setAttributes({x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:l,y:t}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(e))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(e,t,i){let l=eS(e,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:l,x:t}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(e)}px`))}updateResizeRow(e,t,i){let l=eS(e,this.table,i);this.rowResizeLine.setAttributes({y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:l,x:t}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(e))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(e,t,i){return this.cellMover.show(e,t,i)}updateMoveCol(e,t,i,l){this.cellMover.update(e,t,i,l)}setFrozenColumnShadow(e,t){var i,l;let o=e_(e,this.table,t);e<0||"always"!==(null==(l=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:l.visible)?this.frozenShadowLine.setAttributes({visible:!1,x:o,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:o,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(e){var t,i;let l=e_(e,this.table,!0);e>=this.table.colCount||"always"!==(null==(i=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:i.visible)?this.rightFrozenShadowLine.setAttributes({visible:!1,x:l-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:l-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var e,t,i,l,o;let r=null==(t=null==(e=this.table.theme.frozenColumnLine)?void 0:e.shadow)?void 0:t.visible;"scrolling"===(null!=(o=null==(l=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:l.visible)?o:r)&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var e,t,i,l,o;let r=null==(t=null==(e=this.table.theme.frozenColumnLine)?void 0:e.shadow)?void 0:t.visible;"scrolling"===(null!=(o=null==(l=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:l.visible)?o:r)&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var e;let t=this.table.theme.scrollStyle.visible,i=null!=(e=this.table.theme.scrollStyle.verticalVisible)?e:t;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var e;let t=this.table.theme.scrollStyle.visible,i=null!=(e=this.table.theme.scrollStyle.verticalVisible)?e:t;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var e;let t=this.table.theme.scrollStyle.visible,i=null!=(e=this.table.theme.scrollStyle.horizontalVisible)?e:t;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var e;let t=this.table.theme.scrollStyle.visible,i=null!=(e=this.table.theme.scrollStyle.horizontalVisible)?e:t;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(e){let t=this.vScrollBar.attribute.range,i=t[1]-t[0],l=e*(1-i);this.vScrollBar.setAttribute("range",[l,l+i]);let o=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:o.x1,y:o.y1}}updateHorizontalScrollBarPos(e){let t=this.hScrollBar.attribute.range,i=t[1]-t[0],l=e*(1-i);this.hScrollBar.setAttribute("range",[l,l+i]);let o=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:o.x1,y:o.y1}}updateStyle(){var e,t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,C,v,w,y,x,_;let S,R=this.table.theme,H=null==(e=R.scrollStyle)?void 0:e.scrollRailColor,A=null==(t=R.scrollStyle)?void 0:t.scrollSliderColor,M=null==(i=R.scrollStyle)?void 0:i.scrollSliderCornerRadius,F=null==(l=R.scrollStyle)?void 0:l.width,B=null==(o=R.scrollStyle)?void 0:o.horizontalPadding,T=null==(r=R.scrollStyle)?void 0:r.verticalPadding;S=(0,m.Z)(M)?{cornerRadius:M,fill:A}:{fill:A},this.hScrollBar.setAttributes({height:F,padding:B,railStyle:{fill:H},sliderStyle:S}),this.vScrollBar.setAttributes({width:F,padding:T,railStyle:{fill:H},sliderStyle:S});let z=null==(n=R.columnResize)?void 0:n.lineColor,L=null==(a=R.columnResize)?void 0:a.lineWidth,k=null==(s=R.columnResize)?void 0:s.bgColor,P=null==(h=R.columnResize)?void 0:h.width;this.columnResizeLine.setAttributes({stroke:z,lineWidth:L}),this.columnResizeBgLine=(0,eh.W)({stroke:k,lineWidth:P});let I=null==(d=R.columnResize)?void 0:d.labelColor,E=null==(u=R.columnResize)?void 0:u.labelFontSize,D=null==(c=R.columnResize)?void 0:c.labelFontFamily,W=null==(g=R.columnResize)?void 0:g.labelBackgroundFill,O=null==(p=R.columnResize)?void 0:p.labelBackgroundCornerRadius,G=null==(b=null==(f=R.columnResize)?void 0:f.labelVisible)||b;this.labelVisible=G,this.columnResizeLabel.lastChild.setAttributes({fontSize:E,fill:I,fontFamily:D,dy:-E/2}),this.columnResizeLabel.firstChild.setAttributes({fill:W,width:5*E*.8,height:E+8,cornerRadius:O,dy:-E/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:E,fill:I,fontFamily:D,dy:-E/2}),this.rowResizeLabel.firstChild.setAttributes({fill:W,width:5*E*.8,height:E+8,cornerRadius:O,dy:-E/2-4});let N=null==(v=null==(C=R.frozenColumnLine)?void 0:C.shadow)?void 0:v.width,Z=null==(y=null==(w=R.frozenColumnLine)?void 0:w.shadow)?void 0:y.startColor,K=null==(_=null==(x=R.frozenColumnLine)?void 0:x.shadow)?void 0:_.endColor;this.frozenShadowLine.setAttributes({width:N,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:Z,offset:0},{color:K,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:N,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:K,offset:0},{color:Z,offset:1}]}}),this.cellMover.updateStyle()}}var eH=i(43735);function eA(e,t,i,l,o){var r,n,a,s,h,d;if(!t)return;let u="table"===i,{shadowBlur:c,shadowOffsetX:g,shadowOffsetY:p,shadowColor:f,cornerRadius:b,borderColor:m,borderLineWidth:C,borderLineDash:v}=t,w=!1,y={},x={pickable:!1};c&&u&&(x.shadowBlur=c,x.shadowOffsetX=g,x.shadowOffsetY=p,x.shadowColor=f,x.stroke=!0,x.stroke=f,x.lineWidth=1,w=!0),C&&(x.stroke=!0,x.fill=!1,x.stroke=eF(null!=m?m:"#E1E4E8",l,C),x.lineWidth=C,v&&(x.lineDash=v),x.lineCap="butt"),Array.isArray(m)&&(x.strokeArrayColor=(0,q.u)(m)),Array.isArray(C)&&(x.strokeArrayWidth=(0,q.u)(C),x.lineWidth=1),b&&(x.cornerRadius=b,y.cornerRadius=b);let _=x.strokeArrayWidth?x.strokeArrayWidth[0]:null!=(r=x.lineWidth)?r:0,S=x.strokeArrayWidth?x.strokeArrayWidth[1]:null!=(n=x.lineWidth)?n:0,R=x.strokeArrayWidth?x.strokeArrayWidth[2]:null!=(a=x.lineWidth)?a:0,H=x.strokeArrayWidth?x.strokeArrayWidth[3]:null!=(s=x.lineWidth)?s:0;if(e.setAttributes(y),!o)if(x.stroke)if(x.x=H/2,x.y=_/2,x.pickable=!1,u){let i,l;if(b)if(Array.isArray(b)){let e=(0,q.u)(b);x.cornerRadius=e,y.cornerRadius=e,e[0]&&(e[0]=e[0]+Math.min(H,_)/2),e[1]&&(e[1]=e[1]+Math.min(_,S)/2),e[2]&&(e[2]=e[2]+Math.min(S,R)/2),e[3]&&(e[3]=e[3]+Math.min(R,H)/2)}else if((0,eH.Z)(C)){let e=[];x.cornerRadius=e,y.cornerRadius=e,e[0]=b+Math.min(H,_)/2,e[1]=b+Math.min(_,S)/2,e[2]=b+Math.min(S,R)/2,e[3]=b+Math.min(R,H)/2}else x.cornerRadius=b+(null!=(h=x.lineWidth)?h:0)/2,y.cornerRadius=b+(null!=(d=x.lineWidth)?d:0)/2;if(t.innerBorder?(x.x=e.attribute.x+H/2,x.y=e.attribute.y+_/2,x.width=e.attribute.width-H/2-S/2,x.height=e.attribute.height-_/2-R/2):(x.x=e.attribute.x-H/2,x.y=e.attribute.y-_/2,x.width=e.attribute.width+H/2+S/2,x.height=e.attribute.height+_/2+R/2),w){x.fill="white",x.notAdjustPos=!0,(l=(0,ec.sS)(x)).name="table-border-rect",i=(0,eu.f)({x:H/2,y:_/2,width:e.attribute.width,height:e.attribute.height,fill:"red",cornerRadius:e.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),l.addChild(i);let t=(0,eu.f)({x:H/2,y:_/2,width:e.attribute.width,height:e.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});l.addChild(t)}else(l=(0,eu.f)(x)).name="table-border-rect";t.innerBorder&&!w?e.parent.insertAfter(l,e):e.parent.insertBefore(l,e),e.border=l}else{x.width=e.attribute.width-H/2-S/2,x.height=e.attribute.height-_/2-R/2;let t=(0,eu.f)(x);t.name="border-rect",e.addChild(t),e.border=t}else{let t=(0,eu.f)({fill:!1,stroke:!1,pickable:!1,lineWidth:0});t.name="border-rect",e.addChild(t),e.border=t}}function eM(e,t,i){var l;if(!t)return;let{borderColor:o}=t;null==(l=e.border)||l.setAttribute("stroke",eF(o,i))}function eF(e,t,i){let l=!0;return!t&&!(0,eH.Z)(i)||(0,eH.Z)(e)?t?l=t:t||(0,eH.Z)(e)?(0,eH.Z)(e)&&(l=!0):l=e:l=(null!=t?t:i).map(t=>!!t&&e),l}function eB(e){var t,i,l,o;if(!e.border)return;let r=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[0]:null!=(t=e.border.attribute.lineWidth)?t:0,n=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[1]:null!=(i=e.border.attribute.lineWidth)?i:0,a=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[2]:null!=(l=e.border.attribute.lineWidth)?l:0,s=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[3]:null!=(o=e.border.attribute.lineWidth)?o:0;e.border.setAttributes({borderLeft:s,borderTop:r,borderRight:n,borderBottom:a,width:e.attribute.width-s/2-n/2,height:e.attribute.height-r/2-a/2}),"group"===e.border.type&&e.border.firstChild.setAttributes({width:e.attribute.width,height:e.attribute.height})}function eT(e,t){e.setAttribute("cornerRadius",t),e.border&&e.border.setAttribute("cornerRadius",t)}var ez=i(14364),eL=i(33359),ek=i(90552),eP=i(65719),eI=i(67653),eE=i(43722),eD=i(50614),eW=i(46560),eO=i(17783),eG=i(22672),eN=i(62727);let eZ=Symbol.for("ChartRender");Symbol.for("ChartRenderContribution");let eK=class extends eD.Y{constructor(){super(...arguments),this.numberType=eG.e}drawShape(e,t,i,l,o,r,n,a){var s,h,d,u;let c=(0,eW.gh)(e,null==r?void 0:r.theme).group,{dataId:g,data:p,spec:f}=e.attribute,{width:b=c.width,height:m=c.height}=(e.getViewBox(),e.attribute),{table:C}=e.getRootNode(),{active:v,cacheCanvas:w,activeChartInstance:y}=e;if(!v&&w)(0,eH.Z)(w)?w.forEach(e=>{let{x:i,y:l,width:o,height:r,canvas:n}=e;t.drawImage(n,i,l,o,r)}):t.drawImage(w,i,l,b,m);else if(y){if(C.options.specFormat){let t=C.options.specFormat(e.attribute.spec,y,e);if(t.needFormatSpec&&t.spec){let e=t.spec;y.updateSpecSync(e)}}let t=e.getViewBox();y.updateViewBox({x1:0,x2:t.x2-t.x1,y1:0,y2:t.y2-t.y1},!1,!1);let i=y.getStage();i.needRender=!0;let l=e.globalTransMatrix.clone(),o=e.stage.window.getViewBoxTransform().clone();if(o.multiply(l.a,l.b,l.c,l.d,l.e,l.f),i.window.setViewBoxTransform(o.a,o.b,o.c,o.d,o.e,o.f),"string"==typeof g)y.updateDataSync(g,null!=p?p:[]);else{let e=[];for(let t in g){let i=g[t],l=f.series.find(e=>{var i;return(null==(i=null==e?void 0:e.data)?void 0:i.id)===t});e.push({id:t,values:i?null!=(s=null==p?void 0:p.filter(e=>e.hasOwnProperty(i)))?s:[]:null!=p?p:[],fields:null==(h=null==l?void 0:l.data)?void 0:h.fields}),y.updateFullDataSync||y.updateDataSync(t,i?null!=(d=null==p?void 0:p.filter(e=>e.hasOwnProperty(i)))?d:[]:null!=p?p:[])}null==(u=y.updateFullDataSync)||u.call(y,e)}}else C.internalProps.renderChartAsync?(-1===eN.A8.indexOf(`${e.parent.col}+${e.parent.row}`)&&(eN.A8.push(`${e.parent.col}+${e.parent.row}`),eN.LO.push(e)),(0,eN.a5)()||(0,eN.eO)(C)):(0,eN.pF)(e)}draw(e,t,i,l){this._draw(e,{},!1,i,l)}};eK=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([(0,eO.b)()],eK);var eV=i(33760),ej=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};let eU=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{shape:g}=e.attribute;if("circle"===g){let{width:o=s.width,height:r=s.height}=e.attribute;t.beginPath(),t.arc(i+o/2,l+r/2,Math.min(o,r)/2,0,2*Math.PI),t.closePath(),t.save(),t.clip()}}};eU=ej([(0,eO.b)()],eU);let e$=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{shape:g}=e.attribute;"circle"===g&&t.restore()}};e$=ej([(0,eO.b)()],e$);let eX=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{isGif:g}=e.attribute;g&&e.playing&&(e.attribute.opacity=0)}};eX=ej([(0,eO.b)()],eX);let eJ=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{isGif:g}=e.attribute;g&&e.playing&&(e.attribute.opacity=1,t.globalAlpha=e.attribute.opacity,e.renderFrame(t,i,l))}};eJ=ej([(0,eO.b)()],eJ);var eY=i(24806),eq=i(23149);function eQ(e,t,i,l){var o;let r,{highlightInRange:n,disableHeader:a,ranges:s}=e.select,h=1===s.length&&((o=null==s?void 0:s[0]).start.col!==o.end.col||o.start.row!==o.end.row)&&n;if(h?1===(null==s?void 0:s.length)&&s[0].start&&s[0].end:1===(null==s?void 0:s.length)&&s[0].end.col===s[0].start.col&&s[0].end.row===s[0].start.row){if(e.table.isHeader(t,i)&&a)return;(r=h?function(e,t,i){let l,{highlightScope:o,cellPos:r,ranges:n}=e.select,a=n[0],s=Math.min(a.start.col,a.end.col),h=Math.max(a.start.col,a.end.col),d=Math.min(a.start.row,a.end.row),u=Math.max(a.start.row,a.end.row);return o===B.p.single&&r.col===t&&r.row===i?l="cellBgColor":o===B.p.column&&t>=s&&t<=h?l=(0,T._Z)(n[0],t,i)?"cellBgColor":"inlineColumnBgColor":o===B.p.row&&i>=d&&i<=u?l=(0,T._Z)(n[0],t,i)?"cellBgColor":"inlineRowBgColor":o===B.p.cross&&((0,T._Z)(n[0],t,i)?l="cellBgColor":t>=s&&t<=h?l="inlineColumnBgColor":i>=d&&i<=u&&(l="inlineRowBgColor")),l}(e,t,i):function(e,t,i){let l,{highlightScope:o,cellPos:r}=e.select;return o===B.p.single&&r.col===t&&r.row===i?l="cellBgColor":o===B.p.column&&r.col===t?l=r.col===t&&r.row===i?"cellBgColor":"inlineColumnBgColor":o===B.p.row&&r.row===i?l=r.col===t&&r.row===i?"cellBgColor":"inlineRowBgColor":o===B.p.cross&&(r.col===t&&r.row===i?l="cellBgColor":r.col===t?l="inlineColumnBgColor":r.row===i&&(l="inlineRowBgColor")),l}(e,t,i))&&e0(e.table,t,i)&&(r=void 0)}else if("replace"===e.table.theme.selectionStyle.selectionFillMode)for(let e=0;e<s.length;e++){let l=s[e],o=Math.min(l.start.col,l.end.col),n=Math.max(l.start.col,l.end.col),a=Math.min(l.start.row,l.end.row),h=Math.max(l.start.row,l.end.row);if(o<=t&&a<=i&&n>=t&&h>=i){r="cellBgColor";break}}return r}function e0(e,t,i){var l,o;let r=null==(l=e.options.select)?void 0:l.disableSelect;if("function"==typeof r?r(t,i,e):r)return!0;if(e.isHeader(t,i)){let l=null==(o=e.options.select)?void 0:o.disableHeaderSelect;if(l)return!0;let r=e.getHeaderDefine(t,i);if(l=null==r?void 0:r.disableHeaderSelect)return!0}else{let l=e.getBodyColumnDefine(t,i),o=null==l?void 0:l.disableSelect;if("function"==typeof o?o(t,i,e):o)return!0}return!1}var e1=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};let e2=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{stroke:g=s.stroke,strokeArrayWidth:p=s.strokeArrayWidth,strokeArrayColor:f=s.strokeArrayColor}=e.attribute;g&&(Array.isArray(p)||Array.isArray(f))&&(c.doStroke=!1)}};e2=e1([(0,eO.b)()],e2);let e3=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u){var c,g;let{stroke:p=s.stroke,strokeArrayColor:f=s.strokeArrayColor,strokeArrayWidth:b=s.strokeArrayWidth,lineWidth:m=s.lineWidth,strokeColor:C=s.stroke,cornerRadius:v=s.cornerRadius}=e.attribute,w,y,{width:x=s.width,height:_=s.height}=e.attribute;if(p&&(Array.isArray(b)||0!==m)&&(Array.isArray(f)||Array.isArray(b))){if("number"==typeof m&&1&m||Array.isArray(b)&&b.some(e=>1&e)){let t=e.stage.table;if(!t)return;let o="bottom-right"===(null==(c=null==t?void 0:t.theme)?void 0:c.cellBorderClipDirection);if(o){if(i=Math.floor(i)-.5,l=Math.floor(l)-.5,"cell"===e.role){let t=e.col,o=e.row;0===t&&(i+=1),0===o&&(l+=1)}}else i=Math.floor(i)+.5,l=Math.floor(l)+.5;(null==(g=t.options.customConfig)?void 0:g._disableColumnAndRowSizeRound)&&(x=Math.round(x),_=Math.round(_));let{width:r,height:n}=to(e,Math.ceil(x),Math.ceil(_),o);w=r,y=n}else w=Math.ceil(x),y=Math.ceil(_);0===v||(0,eH.Z)(v)&&v.every(e=>0===e)?e5(e,t,i,l,s,p,b||m,f||C,w,y):(t.beginPath(),(0,eY.U)(t,i,l,w,y,v,!0,[,,,,].fill(0).map((o,r)=>(o,n,a,h)=>{ts(r,o,n,a,h,e,t,i,l,s,p,b||m,f||C,w,y)})),t.stroke())}}};function e6(e){let t;if(!Array.isArray(e))return{isSplitDraw:!1,width:e};for(let i=0;i<e.length;i++){let l=e[i];if(l)if(t){if(l!==t)return{isSplitDraw:!0}}else t=l}return{isSplitDraw:!1,width:t}}function e5(e,t,i,l,o,r,n,a,s,h,d,u){var c,g,p,f;let b=e6(n),m=!Array.isArray(n),C=!Array.isArray(r),v=Array.isArray(u),w=Array.isArray(a)||b.isSplitDraw;t.setStrokeStyle(e,e.attribute,i,l,o);let{lineDash:y=o.lineDash}=e.attribute,x=!1;y.length&&y.some(e=>Array.isArray(e))&&(x=!0),t.beginPath(),t.moveTo(i,l);let _=(C||r[0])&&(m||n[0]),S=(C||r[1])&&(m||n[1]),R=(C||r[2])&&(m||n[2]),H=(C||r[3])&&(m||n[3]);if(_){let e=(m?b.width:n[0])/2,o=(m?b.width:n[0])/2;v&&Array.isArray(u[0])?(t.moveTo(i-e+(s+e+o)*u[0][0],l),t.lineTo(i-e+(s+e+o)*(u[0][1]-u[0][0]),l),t.moveTo(i+s+o,l)):(t.moveTo(i-e,l),t.lineTo(i+s+o,l)),(w||x)&&(a&&a[0]?t.strokeStyle=a[0]:a&&!a[0]&&(t.strokeStyle="transparent"),m||(t.lineWidth=n[0]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,x&&t.setLineDash(null!=(c=y[0])?c:[]),t.stroke(),t.beginPath(),t.moveTo(i+s,l))}else t.moveTo(i+s,l);if(S){let e=(m?b.width:n[1])/2,o=(m?b.width:n[1])/2;v&&Array.isArray(u[1])?(t.moveTo(i+s,l-e+h*u[1][0]),t.lineTo(i+s,l-e+(h+e+o)*(u[1][1]-u[1][0])),t.moveTo(i+s,l+h+o)):(t.moveTo(i+s,l-e),t.lineTo(i+s,l+h+o)),(w||x)&&(a&&a[1]?t.strokeStyle=a[1]:a&&!a[1]&&(t.strokeStyle="transparent"),m||(t.lineWidth=n[1]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,x&&t.setLineDash(null!=(g=y[1])?g:[]),t.stroke(),t.beginPath(),t.moveTo(i+s,l+h))}else t.moveTo(i+s,l+h);if(R){let e=(m?b.width:n[2])/2,o=(m?b.width:n[2])/2;v&&Array.isArray(u[2])?(t.moveTo(i-e+(s+e+o)*u[2][0],l+h),t.lineTo(i-e+(s+e+o)*(u[2][1]-u[2][0]),l+h),t.moveTo(i-e,l+h)):(t.moveTo(i-e,l+h),t.lineTo(i+s+o,l+h)),(w||x)&&(a&&a[2]?t.strokeStyle=a[2]:a&&!a[2]&&(t.strokeStyle="transparent"),m||(t.lineWidth=n[2]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,x&&t.setLineDash(null!=(p=y[2])?p:[]),t.stroke(),t.beginPath(),t.moveTo(i,l+h))}else t.moveTo(i,l+h);if(H){let e=(m?b.width:n[3])/2,o=(m?b.width:n[3])/2;v&&Array.isArray(u[3])?(t.moveTo(i,l-e+(h+e+o)*u[3][0]),t.lineTo(i,l-e+(h+e+o)*(u[3][1]-u[3][0])),t.moveTo(i,l-e)):(t.moveTo(i,l-e),t.lineTo(i,l+h+o)),(w||x)&&(a&&a[3]?t.strokeStyle=a[3]:a&&!a[3]&&(t.strokeStyle="transparent"),m||(t.lineWidth=n[3]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,x&&t.setLineDash(null!=(f=y[3])?f:[]),t.stroke(),t.beginPath(),t.moveTo(i,l))}else t.moveTo(i,l);w||x||(!m&&b.width&&(t.lineWidth=b.width),t.stroke()),t.lineDashOffset=0,t.setLineDash([])}e3=e1([(0,eO.b)()],e3);let e4=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){var g;let{lineDash:p=s.lineDash,stroke:f=s.stroke,strokeArrayColor:b=s.strokeArrayColor,strokeArrayWidth:m=s.strokeArrayWidth}=e.attribute;f&&Array.isArray(p)&&p.length&&(null==(g=p[0])?void 0:g.length)&&!Array.isArray(b)&&!Array.isArray(m)&&(c.doStroke=!1)}};e4=e1([(0,eO.b)()],e4);let e8=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u){var c,g,p,f,b,m,C;let{lineDash:v=s.lineDash,stroke:w=s.stroke,strokeArrayColor:y=s.strokeArrayColor,strokeArrayWidth:x=s.strokeArrayWidth,lineWidth:_=s.lineWidth}=e.attribute;if(!w||!(Array.isArray(v)&&v.length&&(null==(c=v[0])?void 0:c.length))||Array.isArray(y)||Array.isArray(x))return;let S=e.stage.table;if(!S)return;let R=(0,eH.Z)(v[0])?1===(C=v).length?[C[0],C[0],C[0],C[0]]:2===C.length?[C[0],C[1],C[0],C[1]]:C:[v,v,v,v],H,A,{width:M=s.width,height:F=s.height}=e.attribute;if((null==(g=S.options.customConfig)?void 0:g._disableColumnAndRowSizeRound)?(M=Math.round(M),F=Math.round(F)):(M=Math.ceil(M),F=Math.ceil(F)),1&_){let t="bottom-right"===S.theme.cellBorderClipDirection;t?(i=Math.floor(i)-.5,l=Math.floor(l)-.5,"cell"===e.role&&(0===e.col&&(i+=1),0===e.row&&(l+=1))):(i=Math.floor(i)+.5,l=Math.floor(l)+.5);let{width:o,height:r}=to(e,Math.ceil(M+0),Math.ceil(F+0),t);H=o,A=r}else H=Math.ceil(M),A=Math.ceil(F);t.setStrokeStyle(e,e.attribute,i,l,s),t.beginPath(),t.moveTo(i,l),t.lineTo(i+H,l),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash(null!=(p=R[0])?p:[]),t.stroke(),t.beginPath(),t.moveTo(i+H,l),t.lineTo(i+H,l+A),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash(null!=(f=R[1])?f:[]),t.stroke(),t.beginPath(),t.moveTo(i,l+A),t.lineTo(i+H,l+A),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash(null!=(b=R[2])?b:[]),t.stroke(),t.beginPath(),t.moveTo(i,l),t.lineTo(i,l+A),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash(null!=(m=R[3])?m:[]),t.stroke(),t.lineDashOffset=0,t.setLineDash([])}};e8=e1([(0,eO.b)()],e8);let e9=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{lineWidth:g=s.lineWidth,stroke:p=s.stroke,lineDash:f=s.lineDash,strokeArrayWidth:b=s.strokeArrayWidth,strokeArrayColor:m=s.strokeArrayColor,notAdjustPos:C}=e.attribute;!0!==C&&p&&Array.isArray(f)&&!f.length&&!Array.isArray(m)&&!Array.isArray(b)&&1&g&&(c.doStroke=!1)}};e9=e1([(0,eO.b)()],e9);let e7=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u){var c,g;let{lineWidth:p=s.lineWidth,stroke:f=s.stroke,lineDash:b=s.lineDash,strokeArrayWidth:m=s.strokeArrayWidth,strokeArrayColor:C=s.strokeArrayColor,notAdjustPos:v,cornerRadius:w=s.cornerRadius}=e.attribute,{width:y=s.width,height:x=s.height}=e.attribute;if(!0!==v&&f&&Array.isArray(b)&&!b.length&&!Array.isArray(C)&&!Array.isArray(m)&&1&p){let o=e.stage.table;if(!o)return;(null==(c=o.options.customConfig)?void 0:c._disableColumnAndRowSizeRound)&&(y=Math.round(y),x=Math.round(x)),t.beginPath();let r="bottom-right"===(null==(g=null==o?void 0:o.theme)?void 0:g.cellBorderClipDirection);r?(i=Math.floor(i)-.5,l=Math.floor(l)-.5,"cell"===e.role&&(0===e.col&&(i+=1),0===e.row&&(l+=1))):(i=Math.floor(i)+.5,l=Math.floor(l)+.5);let{width:n,height:a}=to(e,Math.ceil(y),Math.ceil(x),r);w?(0,eY.U)(t,i,l,n+0,a+0,w):t.rect(i,l,n,a),t.setStrokeStyle(e,e.attribute,i,l,s),t.stroke()}}};e7=e1([(0,eO.b)()],e7);let te=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){if("cell"===e.role){let t=e.stage.table;if(t){let i=function(e,t){var i,l,o,r,n,a,s,h,d,u,c;let g,p;if("cell"===e.role&&(0,m.Z)(e.mergeStartCol)&&(0,m.Z)(e.mergeStartRow)&&(0,m.Z)(e.mergeEndCol)&&(0,m.Z)(e.mergeEndRow)){let{colStart:i,colEnd:l,rowStart:o,rowEnd:r}=(0,et.e)(e,t.scenegraph);for(let n=i;n<=l;n++)for(let i=o;i<=r;i++){let l=eQ(t.stateManager,n,i,e);!l||g&&"cellBgColor"!==l||(g=l)}}else"cell"===e.role&&(g=eQ(t.stateManager,e.col,e.row,e));if(!g)return;let f=t.internalProps.layoutMap;return f.isCornerHeader(e.col,e.row)?p=(null==(i=t.theme.cornerHeaderStyle)?void 0:i.select)||(null==(l=t.theme.headerStyle)?void 0:l.select):f.isColumnHeader(e.col,e.row)?p=null==(o=t.theme.headerStyle)?void 0:o.select:f.isRowHeader(e.col,e.row)?p=null==(r=t.theme.rowHeaderStyle)?void 0:r.select:f.isBottomFrozenRow(e.col,e.row)?p=(null==(n=t.theme.bottomFrozenStyle)?void 0:n.select)||(t.isListTable()?null==(a=t.theme.bodyStyle)?void 0:a.select:null==(s=t.theme.headerStyle)?void 0:s.select):f.isRightFrozenColumn(e.col,e.row)?p=(null==(h=t.theme.rightFrozenStyle)?void 0:h.select)||(t.isListTable()?null==(d=t.theme.bodyStyle)?void 0:d.select:null==(u=t.theme.rowHeaderStyle)?void 0:u.select):t.isHeader(e.col,e.row)||(p=null==(c=t.theme.bodyStyle)?void 0:c.select),(0,X.WJ)(g,p,e.col,e.row,t)}(e,t);if(i)e.attribute._vtableHightLightFill=i;else if(t.stateManager.interactionState!==B.F.scrolling){let i=(0,eq.J)(e,t);i&&(e.attribute._vtableHightLightFill=i)}}}}};te=e1([(0,eO.b)()],te);let tt=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u){if(e.attribute._vtableHightLightFill){if(d);else if(n){let o=e.attribute.fill;e.attribute.fill=e.attribute._vtableHightLightFill,t.setCommonStyle(e,e.attribute,i,l,s),t.fill(),e.attribute.fill=o,e.attribute._vtableHightLightFill=void 0}}}};tt=e1([(0,eO.b)()],tt);let ti=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){var g,p,f,b,m,C;let v=e.stage.table;v&&("body"===e.role?tl(t,-(null!=(g=e.attribute.x)?g:0)+v.getFrozenColsWidth(),-(null!=(p=e.attribute.y)?p:0)+v.getFrozenRowsHeight(),e.parent.attribute.width-v.getFrozenColsWidth()-v.getRightFrozenColsWidth(),e.parent.attribute.height-v.getFrozenRowsHeight()-v.getBottomFrozenRowsHeight()):"row-header"===e.role?tl(t,0,-(null!=(f=e.attribute.y)?f:0)+v.getFrozenRowsHeight(),v.getFrozenColsWidth(),e.parent.attribute.height-v.getFrozenRowsHeight()-v.getBottomFrozenRowsHeight()):"col-header"===e.role?tl(t,-(null!=(b=e.attribute.x)?b:0)+v.getFrozenColsWidth(),0,e.parent.attribute.width-v.getFrozenColsWidth()-v.getRightFrozenColsWidth(),v.getFrozenRowsHeight()):"right-frozen"===e.role?tl(t,0,-(null!=(m=e.attribute.y)?m:0)+v.getFrozenRowsHeight(),v.getRightFrozenColsWidth(),e.parent.attribute.height-v.getFrozenRowsHeight()-v.getBottomFrozenRowsHeight()):"bottom-frozen"===e.role?tl(t,-(null!=(C=e.attribute.x)?C:0)+v.getFrozenColsWidth(),0,e.parent.attribute.width-v.getFrozenColsWidth()-v.getRightFrozenColsWidth(),v.getBottomFrozenRowsHeight()):"corner-header"===e.role?tl(t,0,0,v.getFrozenColsWidth(),v.getFrozenRowsHeight()):"corner-right-top-header"===e.role?tl(t,0,0,v.getRightFrozenColsWidth(),v.getFrozenRowsHeight()):"corner-right-bottom-header"===e.role?tl(t,0,0,v.getRightFrozenColsWidth(),v.getBottomFrozenRowsHeight()):"corner-left-bottom-header"===e.role&&tl(t,0,0,v.getFrozenColsWidth(),v.getBottomFrozenRowsHeight()))}};function tl(e,t,i,l,o){e.beginPath();let r=e.applyedMatrix;Math.abs(r.f)>0x1000000||Math.abs(r.g)>0x1000000?e.rect(t-0x1000000,i-0x1000000,l+0x2000000,o+0x2000000):e.rect(t,i,l,o)}function to(e,t,i,l){var o,r;let n=e.stage.table;if(!n)return{width:t,height:i};if("cell"===e.role){let a=e.col,s=e.row,h=(0,Z.Z)(n,a,s);h&&(a=h.end.col,s=h.end.row),l?(0===a&&(t-=1),0===s&&(i-=1)):((a===n.colCount-1||a===n.frozenColCount-1&&n.scrollLeft||(null==(o=n.containerFit)?void 0:o.width)&&n.rightFrozenColCount&&a===n.colCount-n.rightFrozenColCount-1)&&(t-=1),(s===n.rowCount-1||s===n.frozenRowCount-1&&n.scrollTop||(null==(r=n.containerFit)?void 0:r.height)&&n.bottomFrozenRowCount&&s===n.rowCount-n.bottomFrozenRowCount-1)&&(i-=1))}else"corner-frozen"===e.role&&(n.scrollLeft&&!l&&(t-=1),n.scrollTop&&!l&&(i-=1));return{width:t,height:i}}ti=e1([(0,eO.b)()],ti);var tr=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};let tn=class{constructor(){this.time=eV.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){let{stroke:g=s.stroke,strokeArrayWidth:p=s.strokeArrayWidth,strokeArrayColor:f=s.strokeArrayColor}=e.attribute;g&&(Array.isArray(g)||Array.isArray(p)||Array.isArray(f))&&(c.doStroke=!1)}};tn=tr([(0,eO.b)()],tn);let ta=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u){let{width:c=s.width,height:g=s.height,stroke:p=s.stroke,strokeArrayColor:f=s.strokeArrayColor,strokeArrayWidth:b=s.strokeArrayWidth,lineWidth:m=s.lineWidth,strokeColor:C=s.stroke,cornerRadius:v=s.cornerRadius}=e.attribute;p&&(Array.isArray(b)||0!==m)&&(Array.isArray(p)||Array.isArray(f)||Array.isArray(b))&&("border-rect"!==e.name&&"table-border-rect"!==e.name&&("number"==typeof m&&1&m||Array.isArray(b)&&b.some(e=>1&e))&&(i=Math.floor(i)+.5,l=Math.floor(l)+.5),0===v||(0,eH.Z)(v)&&v.every(e=>0===e)?e5(e,t,i,l,s,p,b||m,f||C,"table-border-rect"!==e.name?Math.ceil(c+0):c+0,"table-border-rect"!==e.name?Math.ceil(g+0):g+0):(t.beginPath(),(0,eY.U)(t,i,l,c,g,v,!0,[,,,,].fill(0).map((o,r)=>(o,n,a,h)=>{ts(r,o,n,a,h,e,t,i,l,s,p,b||m,f||C,Math.ceil(c+0),Math.ceil(g+0))})),t.stroke()))}};function ts(e,t,i,l,o,r,n,a,s,h,d,u,c,g,p){var f,b,m,C;let v=e6(u),w=!Array.isArray(u),y=!Array.isArray(d),x=Array.isArray(c)||v.isSplitDraw;n.stroke(),n.setStrokeStyle(r,r.attribute,a,s,h);let{lineDash:_=h.lineDash}=r.attribute,S=!1;_.length&&_.some(e=>Array.isArray(e))&&(S=!0),n.beginPath(),n.moveTo(a,s);let R=(y||d[0])&&(w||u[0]),H=(y||d[1])&&(w||u[1]),A=(y||d[2])&&(w||u[2]),M=(y||d[3])&&(w||u[3]);R&&0===e?(w?v.width:u[0],w?v.width:u[0],n.moveTo(t,i),n.lineTo(l,o),(x||S)&&(c&&c[0]?n.strokeStyle=c[0]:c&&!c[0]&&(n.strokeStyle="transparent"),w||(n.lineWidth=u[0]),n.lineDashOffset=n.currentMatrix.e/n.currentMatrix.a,S&&n.setLineDash(null!=(f=_[0])?f:[]),n.stroke(),n.beginPath())):0===e&&n.moveTo(a+g,s),H&&1===e?(w?v.width:u[1],w?v.width:u[1],n.moveTo(t,i),n.lineTo(l,o),(x||S)&&(c&&c[1]?n.strokeStyle=c[1]:c&&!c[1]&&(n.strokeStyle="transparent"),w||(n.lineWidth=u[1]),n.lineDashOffset=n.currentMatrix.f/n.currentMatrix.d,S&&n.setLineDash(null!=(b=_[1])?b:[]),n.stroke(),n.beginPath(),n.moveTo(a+g,s+p))):1===e&&n.moveTo(a+g,s+p),A&&2===e?(w?v.width:u[2],w?v.width:u[2],n.moveTo(t,i),n.lineTo(l,o),(x||S)&&(c&&c[2]?n.strokeStyle=c[2]:c&&!c[2]&&(n.strokeStyle="transparent"),w||(n.lineWidth=u[2]),n.lineDashOffset=n.currentMatrix.e/n.currentMatrix.a,S&&n.setLineDash(null!=(m=_[2])?m:[]),n.stroke(),n.beginPath(),n.moveTo(a,s+p))):2===e&&n.moveTo(a,s+p),M&&3===e?(w?v.width:u[3],w?v.width:u[3],n.moveTo(t,i),n.lineTo(l,o),(x||S)&&(c&&c[3]?n.strokeStyle=c[3]:c&&!c[3]&&(n.strokeStyle="transparent"),w||(n.lineWidth=u[3]),n.lineDashOffset=n.currentMatrix.f/n.currentMatrix.d,S&&n.setLineDash(null!=(C=_[3])?C:[]),n.stroke(),n.beginPath(),n.moveTo(a,s))):3===e&&n.moveTo(a,s),n.closePath(),x||S||(!w&&v.width&&(n.lineWidth=v.width),n.stroke()),n.lineDashOffset=0,n.setLineDash([]),n.beginPath()}ta=tr([(0,eO.b)()],ta);var th=i(19427),td=i(50871);let tu,tc=class{constructor(){this.order=1,this.interceptors=[new tg]}afterDrawItem(e,t,i,l,o){for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].afterDrawItem&&this.interceptors[r].afterDrawItem(e,t,i,l,o))return!0;return!1}beforeDrawItem(e,t,i,l,o){if((!e.in3dMode||i.in3dInterceptor)&&!e.shadowRoot&&!(e.baseGraphic||e.attribute.globalZIndex||e.interactiveGraphic))return!1;for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].beforeDrawItem&&this.interceptors[r].beforeDrawItem(e,t,i,l,o))return!0;return!1}};tc=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([(0,eO.b)()],tc);class tg{constructor(){this.order=1}afterDrawItem(e,t,i,l,o){return"image"===e.type&&this.drawItem(e,t,i,l,o),!1}drawItem(e,t,i,l,o){let{image:r,gif:n}=e.attribute;if(n&&e.playing||!r||!e.resources)return!1;let a=e.resources.get(r);if(!a||"loading"!==a.state)return!1;if(!tu){let e=eC.U2(),t=e.loading_pic.svg,i=e.loading_pic.width,l=e.loading_pic.height;tu=(0,th.B)({width:i,height:l,image:t})}let{image:s}=tu.attribute;if(!r||!tu.resources)return!1;let h=tu.resources.get(s);if("success"!==h.state)return!1;let{context:d}=i;d.highPerformanceSave(),e.parent&&d.setTransformFromMatrix(e.parent.globalTransMatrix,!0),e.glyphHost&&e.glyphHost.parent&&d.setTransformFromMatrix(e.glyphHost.parent.globalTransMatrix,!0);let u=e.AABBBounds,{width:c,height:g}=(0,td.f)(h.data.width,h.data.height,u.width(),u.height());return d.drawImage(h.data,u.x1+(u.width()-c)/2,u.y1+(u.height()-g)/2,c,g),d.highPerformanceRestore(),!0}}var tp=i(37967),tf=i(58539),tb=i(58853),tm=i(85021);let tC=class{constructor(){this.time=eV.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,l,o,r,n,a,s,h,d,u,c){var g,p;let{text:f,underline:b=s.underline,lineThrough:m=s.lineThrough,direction:C=s.direction,whiteSpace:v=s.whiteSpace,fontSize:w=s.fontSize,verticalMode:y=s.verticalMode,ellipsis:x=s.ellipsis,textAlign:_=s.textAlign,textBaseline:S=s.textBaseline,x:R=s.x,y:H=s.y}=e.attribute,A=!1;if(Array.isArray(e)){let t=null==(g=e.cache)?void 0:g.layoutData;x&&t&&t.lines.every(e=>""===e.str)&&(A=!0)}else{let{cache:t}=e;x&&t&&""===t.clipedText&&0===t.clipedWidth&&(A=!0)}if(!A)return;let M=(0,tb.Z)(x)?x:"...",F=null!=(p=(0,tp.VA)(e.attribute.lineHeight,w))?p:w,B=0;F!==w&&("top"===S?B=(F-w)/2:"middle"===S||"bottom"===S&&(B=-(F-w)/2)),r&&(u?u(t,e.attribute,s):a&&(t.setStrokeStyle(e,e.attribute,R-i,H-l,s),t.strokeText(M,R,H+B))),o&&(d?d(t,e.attribute,s):n&&(t.setCommonStyle(e,e.attribute,R-i,H-l,s),t.fillText(M,R,H+B),this.drawUnderLine(b,m,e,R,H+B,0,s,t,M)))}drawUnderLine(e,t,i,l,o,r,n,a,s){if(t+e<=0)return;let{textAlign:h=n.textAlign,textBaseline:d=n.textBaseline,fontSize:u=n.fontSize,fontFamily:c=n.fontFamily,fontWeight:g=n.fontWeight,fontStyle:p=n.fontStyle,fill:f=n.fill,opacity:b=n.opacity,underlineOffset:m=n.underlineOffset,underlineDash:C=n.underlineDash,fillOpacity:v=n.fillOpacity}=i.attribute;if(!e&&!t)return;let w=tm.QC.measureTextWidth(s,{fontSize:u,fontFamily:c,fontWeight:g,fontStyle:p}),y=(0,tf.js)(h,w),x=(0,tf.nV)(d,u,u),_={lineWidth:0,stroke:f,opacity:b,strokeOpacity:v};if(e){_.lineWidth=e,a.setStrokeStyle(i,_,l,o,n),a.setLineDash(C),a.beginPath();let t=o+x+u+m;a.moveTo(l+y,t,r),a.lineTo(l+y+w,t,r),a.stroke()}if(t){_.lineWidth=t,a.setStrokeStyle(i,_,l,o,n),a.beginPath();let e=o+x+u/2;a.moveTo(l+y,e,r),a.lineTo(l+y+w,e,r),a.stroke()}}};tC=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([(0,eO.b)()],tC);let tv=class{constructor(){this.type="chart",this.numberType=eG.e}contains(e,t,i){return!!e.AABBBounds.containsPoint(t)}};tv=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([(0,eO.b)()],tv);let tw=new ez.n((e,t,i,l)=>{i(eL.d4)?l(eL.d4).to(tn).inSingletonScope():(e(tn).toSelf().inSingletonScope(),e(ek.d5).toService(tn)),i(eL.Er)?l(eL.Er).to(ta).inSingletonScope():(e(ta).toSelf().inSingletonScope(),e(ek.d5).toService(ta)),e(eK).toSelf().inSingletonScope(),e(eZ).to(eK),e(eP.uz).to(eK),e(tv).toSelf().inSingletonScope(),e(eI.EL).toService(tv),e(eU).toSelf().inSingletonScope(),e(ek.JO).toService(eU),e(e$).toSelf().inSingletonScope(),e(ek.JO).toService(e$),e(eX).toSelf().inSingletonScope(),e(ek.JO).toService(eX),e(eJ).toSelf().inSingletonScope(),e(ek.JO).toService(eJ),e(te).toSelf().inSingletonScope(),e(ek.jd).toService(te),e(tt).toSelf().inSingletonScope(),e(ek.jd).toService(tt),e(e3).toSelf().inSingletonScope(),e(ek.jd).toService(e3),e(e2).toSelf().inSingletonScope(),e(ek.jd).toService(e2),e(e4).toSelf().inSingletonScope(),e(ek.jd).toService(e4),e(e8).toSelf().inSingletonScope(),e(ek.jd).toService(e8),e(e9).toSelf().inSingletonScope(),e(ek.jd).toService(e9),e(e7).toSelf().inSingletonScope(),e(ek.jd).toService(e7),e(ti).toSelf().inSingletonScope(),e(ek.jd).toService(ti),e(tc).toSelf().inSingletonScope(),e(eE.xL).toService(tc),e(tC).toSelf().inSingletonScope(),e(ek.$K).toService(tC)});var ty=i(78958);let tx=new ep.Z({});tx.role="empty";var t_=i(60740);function tS(e,t,i,l,o,r,n,a,s){var h,d;let u,c,g,p=0;e.lastChild&&e.lastChild.row===l-1?p=e.lastChild.attribute.y+e.lastChild.attribute.height:e.colHeight&&(p=e.colHeight);for(let f=l;f<=o;f++){let o=f,b,m,C,v,w=a.getCellLocation(t,o),y=a.getCellValue(t,o),x=i,_=a.getRowHeight(o),S=!1;if(a.internalProps.customMergeCell){let e=a.getCustomMerge(t,o);if(e){let{range:t,text:i,style:n,customLayout:s,customRender:h}=e;if(m=(b=t).start.col!==b.end.col||b.start.row!==b.end.row){let e=tH(b,r,a,l>b.start.row);x=e.cellWidth,_=e.cellHeight}y=i,C=n,(s||h)&&(v=(0,j.ws)(s,h,t.start.col,t.start.row,a.getColsWidth(t.start.col,t.end.col),a.getRowsHeight(t.start.row,t.end.row),!1,a.isAutoRowHeight(o),[0,0,0,0],b,a)),S=!0}}let R,H=t,A=o;b&&(H=b.start.col,A=b.start.row),!a.isPivotTable()&&("columnHeader"===w||"cornerHeader"===w)&&o>=a.columnHeaderLevelCount&&(w="body"),R=!a.isPivotTable()&&a.isSeriesNumberInBody(t,o)?a.getBodyColumnDefine(H,A):"body"!==w?a.getHeaderDefine(H,A):a.getBodyColumnDefine(H,A);let M="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(t,o),F=a.internalProps.layoutMap.isSeriesNumber(t,o),B="body"!==w||((null==R?void 0:R.dragOrder)||!!(null==R?void 0:R.icon)||!!(null==R?void 0:R.tree))&&!(M&&F);if(!b&&(a.internalProps.enableTreeNodeMerge||"body"!==w||(null==R?void 0:R.mergeCell))&&(m=(b=a.getCellRange(t,o)).start.col!==b.end.col||b.start.row!==b.end.row)){let e=tH(b,r,a,l>b.start.row);x=e.cellWidth,_=e.cellHeight}let z=!1;if(a.internalProps.enableTreeNodeMerge&&m){let e=a.getCellRawRecord(b.start.col,b.start.row),{vtableMergeName:i,vtableMerge:l}=null!=e?e:{};z=l,l&&(B=!0,a.internalProps.groupTitleCustomLayout&&(v=(0,j.ws)(a.internalProps.groupTitleCustomLayout,void 0,b.start.col,b.start.row,a.getColsWidth(b.start.col,b.end.col),a.getRowsHeight(b.start.row,b.end.row),!1,a.isAutoRowHeight(o),[0,0,0,0],b,a)),a.internalProps.groupTitleFieldFormat?y=a.internalProps.groupTitleFieldFormat(e,t,o,a):void 0!==i&&(y=i))}let L=z||S?"text":null!=(d=a.isHeader(t,o)?null!=(h=a._getHeaderLayoutMap(t,o).headerType)?h:"text":a.getBodyColumnType(t,o))?d:"text";if((0,T.tI)(y)){(function(e,t,i,l,o,r,n){let a=new ep.Z({x:0,y:l,width:o,height:r});a.role="cell",a.col=e,a.row=t,n.addChild(a)})(t,o,0,p,x,_,e),(0,t_.K)(y,a,tR.bind(null,{type:L,value:y,define:R,table:a,col:t,row:o,colWidth:i,cellWidth:x,cellHeight:_,columnGroup:e,y:p,customStyle:C,mayHaveIcon:B,cellLocation:w,range:b,customResult:v,defaultRowHeight:n})),e.updateColumnRowNumber(o);let l=a.getRowHeight(o);e.updateColumnHeight(l),p+=l}else{let l=C||a._getCellStyle(b?b.start.col:t,b?b.start.row:o),r=(0,V.RT)(l,a,b?b.start.col:t,b?b.start.row:o,X.WJ).theme;r.group.cornerRadius=(0,V.xv)(t,o,a),r.group.width=i,r.group.height=Array.isArray(n)?n[o]:n,r._vtable.padding&&(u=r._vtable.padding),r.text.textAlign&&(c=r.text.textAlign),r.text.textBaseline&&(g=r.text.textBaseline),"body"===w||r.group.fill||(r.group.fill="#fff");let s=(0,$.kE)(L,y,R,a,t,o,i,x,_,e,p,u,c,g,B,r,b,v);if(e.updateColumnRowNumber(o),m){let i=a.getRowHeight(o),{width:l}=(a.getColWidth(t),s.attribute),{height:r}=s.attribute;s.contentWidth=l,s.contentHeight=r,(0,$.pZ)(b,l,r,u,c,g,a),e.updateColumnHeight(i),p+=i}else e.updateColumnHeight(_),p+=_}if(s&&o>s)break}return e.setAttribute("width",i),{width:i,height:p}}function tR(e){let t,i,l,{type:o,value:r,define:n,table:a,col:s,row:h,colWidth:d,cellWidth:u,cellHeight:c,columnGroup:g,y:p,cellLocation:f,mayHaveIcon:b,customStyle:m,range:C,customResult:v,defaultRowHeight:w}=e,y=m||a._getCellStyle(C?C.start.col:s,C?C.start.row:h),x=(0,V.RT)(y,a,C?C.start.col:s,C?C.start.row:h,X.WJ).theme;x.group.cornerRadius=(0,V.xv)(s,h,a),x.group.width=d,x.group.height=Array.isArray(w)?w[h]:w,x._vtable.padding&&(t=x._vtable.padding),x.text.textAlign&&(i=x.text.textAlign),x.text.textBaseline&&(l=x.text.textBaseline),"body"===f||x.group.fill||(x.group.fill="#fff"),(0,$.kE)(o,r,n,a,s,h,d,u,c,g,p,t,i,l,b,x,C,v)}function tH(e,t,i,l){let o=0,r=0,n=t.get(`${e.start.col},${e.start.row};${e.end.col},${e.end.row}`);if(!n||l){for(let t=e.start.col;t<=e.end.col;t++)o+=i.getColWidth(t);for(let t=e.start.row;t<=e.end.row;t++)r+=i.getRowHeight(t);t.set(`${e.start.col},${e.start.row};${e.end.col},${e.end.row}`,{cellWidth:o,cellHeight:r})}else o=n.cellWidth,r=n.cellHeight;return{cellWidth:o,cellHeight:r}}function tA(e,t,i,l,o,r,n,a,s,h){if(l>o||r>n)return;let{layoutMap:d,defaultHeaderRowHeight:u,defaultColWidth:c}=s.internalProps,g=s.defaultRowHeight,p=0,f=0;for(let d=l;d<=o;d++){let l=d,o=s.getColWidth(l),c=new ep.Z({x:t+p,y:i,width:o,height:0,clip:!1,pickable:!1});c.role="column",c.col=d,e.addChild(c);let{width:b,height:m}=tS(c,l,o,r,n,s.scenegraph.mergeMap,"columnHeader"===a&&(0,J.Z)(u)?u:g,s,h);p+=b,f=Math.max(f,m)}e.setAttribute("width",p),e.setAttribute("height",f)}function tM(e){let t=e.firstChild;for(;t&&"group"!==t.type;)t=t._next;return t}function tF(e){let t=e.lastChild;for(;t&&"group"!==t.type;)t=t._prev;return t}function tB(e,t,i,l="left"){for(let o=e;o<=t;o++){let e=i.scenegraph.getColGroup(o);e&&tT(e,i,l);let t=i.scenegraph.getColGroup(o,!0);t&&tT(t,i,l);let r=i.scenegraph.getColGroupInBottom(o);r&&tT(r,i,l)}let o=Math.min(i.scenegraph.proxy.colLimit,i.scenegraph.proxy.bodyRightCol-i.scenegraph.proxy.bodyLeftCol+1),r=i.getColsWidth(i.frozenColCount,i.frozenColCount+o),n=i.getColsWidth(i.frozenColCount,i.colCount-1);i.scenegraph.proxy.xLimitLeft=r/2,i.scenegraph.proxy.xLimitRight=n-r/2}function tT(e,t,i="left"){if("left"===i){let i,l=function(e){let t=e._prev;for(;t&&"group"!==t.type;)t=t._prev;return t}(e);i=l?l.attribute.x+t.getColWidth(e._prev.col):t.getColsWidth(t.frozenColCount,e.col-1),e.setAttribute("x",i)}else{let i,l=function(e){let t=e._next;for(;t&&"group"!==t.type;)t=t._next;return t}(e);i=l?l.attribute.x-t.getColWidth(e.col):t.getColsWidth(t.frozenColCount,e.col-1),e.setAttribute("x",i)}}var tz=function(e,t,i,l){return new(i||(i=Promise))(function(o,r){function n(e){try{s(l.next(e))}catch(e){r(e)}}function a(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,a)}s((l=l.apply(e,t||[])).next())})};function tL(e,t,i,l,o,r){return tz(this,void 0,void 0,function*(){if("left"===t&&r.colEnd+e>r.bodyRightCol?e=r.bodyRightCol-r.colEnd:"right"===t&&r.colStart-e<r.bodyLeftCol&&(e=r.colStart-r.bodyLeftCol),0!==e)if(e<0&&(t="left"===t?"right":"left",e=-e),e<r.colEnd-r.colStart){let o="left"===t?r.colStart:r.colEnd-e+1,n="left"===t?r.colStart+e-1:r.colEnd,a="left"===t?r.colEnd+1:r.colStart-e,s="left"===t?r.colEnd+e:r.colStart-1;(0,ty.rj)(r.table,a,s),function(e,t,i,l){for(let o=e;o<=t;o++)l.table.scenegraph.bodyGroup.childrenCount>0&&"group"===l.table.scenegraph.bodyGroup.firstChild.type&&tI(l.table.scenegraph.bodyGroup,i,l),l.table.scenegraph.colHeaderGroup.childrenCount>0&&"group"===l.table.scenegraph.colHeaderGroup.firstChild.type&&tI(l.table.scenegraph.colHeaderGroup,i,l),l.table.scenegraph.bottomFrozenGroup.childrenCount>0&&"group"===l.table.scenegraph.bottomFrozenGroup.firstChild.type&&tI(l.table.scenegraph.bottomFrozenGroup,i,l)}(o,n,t,r),r.colStart="left"===t?r.colStart+e:r.colStart-e,r.colEnd="left"===t?r.colEnd+e:r.colEnd-e,tE(a,s,r),tB(a,s,r.table,t);let h=l-((r.table.scenegraph.getColGroup(i)||r.table.scenegraph.getColGroup(i,!0)).attribute.x+r.table.getFrozenColsWidth()+r.table.scenegraph.proxy.deltaX);r.table.scenegraph.proxy.deltaX+=h,r.currentCol="left"===t?r.currentCol+e:r.currentCol-e,r.totalCol=Math.max(0,Math.min(r.table.colCount-1,"left"===t?r.totalCol+e:r.totalCol-e)),r.referenceCol=r.colStart+Math.floor((r.colEnd-r.colStart)/2),r.colUpdatePos=a,r.colUpdateDirection=t,r.table.scenegraph.updateNextFrame()}else{var o,n,a,s;let i="left"===t?r.colStart+e:r.colStart-e,l="left"===t?r.colEnd+e:r.colEnd-e;(0,ty.rj)(r.table,i,l),o=r.table.getColsWidth(r.bodyLeftCol,i-1),n=e,a=t,(s=r).table.scenegraph.colHeaderGroup.forEachChildren((e,t)=>{"group"===e.type&&tk(e,"left"===a?e.col+n:e.col-n,0===t?o:e._prev.attribute.x+s.table.getColWidth(e._prev.col))}),s.table.scenegraph.bottomFrozenGroup.forEachChildren((e,t)=>{"group"===e.type&&tk(e,"left"===a?e.col+n:e.col-n,0===t?o:e._prev.attribute.x+s.table.getColWidth(e._prev.col))}),s.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{"group"===e.type&&tk(e,"left"===a?e.col+n:e.col-n,0===t?o:e._prev.attribute.x+s.table.getColWidth(e._prev.col))}),r.colStart=i,r.colEnd=l,tE(i,l,r),tB(i,l,r.table,l>r.bodyRightCol-(r.colEnd-r.colStart+1)?"right":"left"),r.currentCol="left"===t?r.currentCol+e:r.currentCol-e,r.totalCol=Math.max(0,Math.min(r.table.colCount-1,"left"===t?r.totalCol+e:r.totalCol-e)),r.referenceCol=r.colStart+Math.floor((r.colEnd-r.colStart)/2),r.colUpdatePos=r.colStart,r.colUpdateDirection=l>r.bodyRightCol-(r.colEnd-r.colStart+1)?"right":"left",r.table.scenegraph.updateNextFrame()}})}function tk(e,t,i){e.col=t,e.forEachChildren(e=>{e.col=t,e.needUpdate=!0}),e.setAttribute("x",i),e.needUpdate=!0}function tP(e,t){if(!e)return;let i=e.firstChild;for(;i;)i=t.updateCellGroupContent(i)._next;e.needUpdate=!1,e.setAttribute("width",t.table.getColWidth(e.col))}function tI(e,t,i){if("left"===t){let t=tM(e),l=tF(e);tk(t,l.col+1,l.attribute.x+i.table.getColWidth(l.col)),e.appendChild(t),e.border&&e.appendChild(e.border)}else{let t=tF(e),l=tM(e);tk(t,l.col-1,l.attribute.x-i.table.getColWidth(l.col-1)),e.insertBefore(t,e.firstChild)}}function tE(e,t,i){for(let l=e;l<=t;l++){let e=i.table.scenegraph.getColGroup(l,!0);e&&tP(e,i);let t=i.table.scenegraph.getColGroupInBottom(l);t&&tP(t,i);let o=i.table.scenegraph.getColGroupInRightTopCorner(l);o&&tP(o,i);let r=i.table.scenegraph.getColGroupInRightBottomCorner(l);r&&tP(r,i);let n=i.table.scenegraph.getColGroup(l);n&&function(e,t){if(!e)return;let i=t.screenTopRow,l=Math.max(t.bodyTopRow,i-t.screenRowCount),o=Math.min(t.bodyBottomRow,i+2*t.screenRowCount,t.table.rowCount-1);for(let i=l;i<=o;i++){let l=t.highPerformanceGetCell(e.col,i,!0);t.updateCellGroupContent(l)}t.rowUpdatePos=t.rowStart,e.needUpdate=!1,e.setAttribute("width",t.table.getColWidth(e.col))}(n,i)}tD(i.table.scenegraph.colHeaderGroup),tD(i.table.scenegraph.bottomFrozenGroup),tD(i.table.scenegraph.bodyGroup),i.progress()}function tD(e){var t,i;let l=tF(e);if(l&&(e.setAttribute("width",l.attribute.x+l.attribute.width),e.border)){let o=e.border;o.setAttribute("width",l.attribute.x+l.attribute.width-(null!=(t=o.attribute.borderLeft)?t:0)/2-(null!=(i=o.attribute.borderRight)?i:0)/2)}}function tW(e,t,i,l,o,r="up",n){var a,s;if("up"===r)for(let r=e;r<=t;r++)for(let e=i;e<=l;e++){let t,i=o.scenegraph.highPerformanceGetCell(r,e,!0);if("cell"===i.role&&i.row){if(i._prev)t=(null==(a=i._prev)?void 0:a.attribute.y)+o.getRowHeight(i._prev.row);else if(n){let i=l===o.rowCount-o.bottomFrozenRowCount-1?l:l+1;if(t=o.scenegraph.highPerformanceGetCell(r,i,!0).attribute.y,(0,m.Z)(t))for(let l=e;l<i;l++)t-=o.getRowHeight(l)}else t=tO(i.row,o);(0,m.Z)(t)&&i.setAttribute("y",t)}}else for(let r=e;r<=t;r++)for(let e=l;e>=i;e--){let t,l=o.scenegraph.highPerformanceGetCell(r,e,!0);if("cell"===l.role&&l.row){if(l._next)t=(null==(s=l._next)?void 0:s.attribute.y)-o.getRowHeight(l.row);else if(n){let l=i<=o.frozenRowCount?o.frozenRowCount:i-1;t=i<=o.frozenRowCount?0:o.scenegraph.highPerformanceGetCell(r,l,!0).attribute.y;for(let i=l;i<e;i++)t+=o.getRowHeight(i)}else t=tO(l.row,o);(0,m.Z)(t)&&l.setAttribute("y",t)}}let h=Math.min(o.scenegraph.proxy.rowLimit,o.scenegraph.proxy.bodyBottomRow-o.scenegraph.proxy.bodyTopRow+1),d=o.getRowsHeight(o.frozenRowCount,o.frozenRowCount+h),u=o.getRowsHeight(o.frozenRowCount,o.rowCount-1);o.scenegraph.proxy.yLimitTop=d/2,o.scenegraph.proxy.yLimitBottom=u-d/2}function tO(e,t){return e<t.frozenRowCount?t.getRowsHeight(0,e-1):e>=t.rowCount-t.bottomFrozenRowCount?t.getRowsHeight(t.rowCount-t.bottomFrozenRowCount,e-1):t.getRowsHeight(t.frozenRowCount,e-1)}var tG=function(e,t,i,l){return new(i||(i=Promise))(function(o,r){function n(e){try{s(l.next(e))}catch(e){r(e)}}function a(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,a)}s((l=l.apply(e,t||[])).next())})};function tN(e,t,i,l,o,r){return tG(this,void 0,void 0,function*(){if("up"===t&&r.rowEnd+e>r.bodyBottomRow?e=r.bodyBottomRow-r.rowEnd:"down"===t&&r.rowStart-e<r.bodyTopRow&&(e=r.rowStart-r.bodyTopRow),0!==e)if(e<0&&(t="up"===t?"down":"up",e=-e),e<r.rowEnd-r.rowStart){let l,o,n="up"===t?r.rowStart:r.rowEnd-e+1,a="up"===t?r.rowStart+e-1:r.rowEnd,s="up"===t?r.rowEnd+1:r.rowStart-e,h="up"===t?r.rowEnd+e:r.rowStart-1;r.table.isAutoRowHeight(n)?(l=s,o=h):(l=Math.max(r.bodyTopRow,i-r.screenRowCount),o=Math.min(r.bodyBottomRow,i+2*r.screenRowCount,r.table.rowCount-1)),(0,ee.Y)(r.table,l,o,!1),function(e,t,i,l){for(let o=0;o<l.table.frozenColCount;o++){let r=l.table.scenegraph.getColGroup(o);if(r)for(let o=e;o<=t;o++)tZ(r,i,l)}for(let o=l.table.colCount-l.table.rightFrozenColCount;o<l.table.colCount;o++){let r=l.table.scenegraph.getColGroup(o);if(r)for(let o=e;o<=t;o++)tZ(r,i,l)}for(let o=l.bodyLeftCol;o<=l.bodyRightCol;o++){let r=l.table.scenegraph.getColGroup(o);if(r)for(let o=e;o<=t;o++)tZ(r,i,l)}}(n,a,t,r),r.rowStart="up"===t?r.rowStart+e:r.rowStart-e,r.rowEnd="up"===t?r.rowEnd+e:r.rowEnd-e;let d=tK(l,o,r,!0);r.table.isAutoRowHeight(n)&&(tW(r.bodyLeftCol,r.bodyRightCol,l,o,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0),tW(0,r.table.frozenColCount-1,l,o,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0),tW(r.table.colCount-r.table.rightFrozenColCount,r.table.colCount-1,l,o,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0)),r.currentRow="up"===t?r.currentRow+e:r.currentRow-e,r.totalRow=Math.max(0,Math.min(r.bodyBottomRow,"up"===t?r.totalRow+e:r.totalRow-e,r.table.rowCount-1)),r.referenceRow=r.rowStart+Math.floor((r.rowEnd-r.rowStart)/2),r.table.isAutoRowHeight(n)&&d?r.rowUpdatePos=Math.min(r.rowUpdatePos,r.rowEnd+1):r.rowUpdatePos=Math.min(r.rowUpdatePos,s),r.rowUpdateDirection=t,r.table.scenegraph.updateNextFrame(),yield r.progress()}else{let l,o,n="up"===t?r.rowStart+e:r.rowStart-e,a=Math.min(r.table.rowCount-1,"up"===t?r.rowEnd+e:r.rowEnd-e),s=r.table.getRowsHeight(r.bodyTopRow,n-1);r.table.isAutoRowHeight(n)?(l=n,o=a):(l=Math.max(r.bodyTopRow,i-r.screenRowCount),o=Math.min(r.bodyBottomRow,i+2*r.screenRowCount,r.table.rowCount-1)),(0,ee.Y)(r.table,l,o,!1),function(e,t,i,l){for(let o=0;o<l.table.frozenColCount;o++){let r=l.table.scenegraph.getColGroup(o);null==r||r.forEachChildren((o,r)=>{l.updateCellGroupPosition(o,"up"===i?o.row+t:o.row-t,0===r?e:o._prev.attribute.y+l.table.getRowHeight(o._prev.row))})}for(let o=l.table.colCount-l.table.rightFrozenColCount;o<l.table.colCount;o++){let r=l.table.scenegraph.getColGroup(o);null==r||r.forEachChildren((o,r)=>{l.updateCellGroupPosition(o,"up"===i?o.row+t:o.row-t,0===r?e:o._prev.attribute.y+l.table.getRowHeight(o._prev.row))})}for(let o=l.bodyLeftCol;o<=l.bodyRightCol;o++){let r=l.table.scenegraph.getColGroup(o);null==r||r.forEachChildren((o,r)=>{l.updateCellGroupPosition(o,"up"===i?o.row+t:o.row-t,0===r?e:o._prev.attribute.y+l.table.getRowHeight(o._prev.row))})}}(s,e,t,r),r.rowStart=n,r.rowEnd=a;let h=tK(l,o,r,!0);r.table.isAutoRowHeight(n)&&(tW(r.bodyLeftCol,r.bodyRightCol,l,o,r.table,a>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up"),tW(0,r.table.frozenColCount-1,l,o,r.table,a>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up"),tW(r.table.colCount-r.table.rightFrozenColCount,r.table.colCount-1,l,o,r.table,a>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up")),r.currentRow="up"===t?r.currentRow+e:r.currentRow-e,r.totalRow=Math.max(0,Math.min(r.bodyBottomRow,"up"===t?r.totalRow+e:r.totalRow-e,r.table.rowCount-1)),r.referenceRow=r.rowStart+Math.floor((r.rowEnd-r.rowStart)/2),r.table.isAutoRowHeight(n)&&h?r.rowUpdatePos=r.rowEnd+1:r.rowUpdatePos=r.rowStart,r.rowUpdateDirection=a>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",r.table.scenegraph.updateNextFrame(),yield r.progress()}})}function tZ(e,t,i){if(e.childrenCount>=1)if("up"===t){let t=e.firstChild;i.updateCellGroupPosition(t,e.lastChild.row+1,e.lastChild.attribute.y+i.table.getRowHeight(e.lastChild.row)),e.appendChild(t)}else{let t=e.lastChild;i.updateCellGroupPosition(t,e.firstChild.row-1,e.firstChild.attribute.y-i.table.getRowHeight(t.row)),e.insertBefore(t,e.firstChild)}}function tK(e,t,i,l=!1){for(let l=0;l<i.table.frozenColCount;l++)for(let o=e;o<=t;o++){let e=i.highPerformanceGetCell(l,o,!0);i.updateCellGroupContent(e)}for(let l=i.table.colCount-i.table.rightFrozenColCount;l<i.table.colCount;l++)for(let o=e;o<=t;o++){let e=i.highPerformanceGetCell(l,o);i.updateCellGroupContent(e)}let o=i.bodyLeftCol,r=i.bodyRightCol,n=!0;if(l){let e=i.screenLeftCol;o=Math.max(i.bodyLeftCol,e-i.screenColCount),r=Math.min(i.bodyRightCol,e+2*i.screenColCount),o===i.bodyLeftCol&&r===i.bodyRightCol||(n=!1)}for(let l=o;l<=r;l++)for(let o=e;o<=t;o++){let e=i.highPerformanceGetCell(l,o);i.updateCellGroupContent(e)}return tV(i.table.scenegraph.rowHeaderGroup),tV(i.table.scenegraph.rightFrozenGroup),tV(i.table.scenegraph.bodyGroup),i.table.scenegraph.updateNextFrame(),n}function tV(e){var t,i;let l=tF(e);if(!l)return;let o=tF(l);if(o&&(e.setAttribute("height",o.attribute.y+o.attribute.height),e.border)){let l=e.border;l.setAttribute("height",o.attribute.y+o.attribute.height-(null!=(t=l.attribute.borderTop)?t:0)/2-(null!=(i=l.attribute.borderBottom)?i:0)/2)}}function tj(e){let{changedCells:t}=e.internalProps.stick;return t.forEach(t=>{e.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{e.setAttributes({dx:t.dx,dy:t.dy})})}),t.clear(),t}function tU(e){let t=tj(e),{scrollTop:i,scrollLeft:l,frozenRowCount:o,frozenColCount:r}=e,n=e.getFrozenRowsHeight(),a=e.getFrozenColsWidth(),{row:s}=e.getRowAt(i+n+1),{col:h}=e.getColAt(l+a+1),d=Math.max(s,e.frozenRowCount),u=Math.max(h,e.frozenColCount),c=e.getAllRowsHeight()>e.tableNoFrameHeight?e.getRowAt(i+e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()-1).row:e.rowCount-e.bottomFrozenRowCount-1,g=e.getAllColsWidth()>e.tableNoFrameWidth?e.getColAt(l+e.tableNoFrameWidth-e.getRightFrozenColsWidth()-1).col:e.colCount-e.rightFrozenColCount-1;if(!(g<0||c<0)){for(let i=0;i<o&&!(g<u);i++)[u,g].forEach(l=>{let o=e._getCellStyle(l,i);(null==o?void 0:o.textStick)&&"vertical"!==(null==o?void 0:o.textStick)&&tJ(e.scenegraph.getCell(l,i),a+e.tableX,e.tableNoFrameWidth-e.getRightFrozenColsWidth()+e.tableX,t,null==o?void 0:o.textStickBaseOnAlign,e)});for(let i=0;i<r&&!(c<d);i++)[d,c].forEach(l=>{let o=e._getCellStyle(i,l);(null==o?void 0:o.textStick)&&"horizontal"!==(null==o?void 0:o.textStick)&&t$(e.scenegraph.getCell(i,l),n+e.tableY,e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()+e.tableY,t,null==o?void 0:o.textStickBaseOnAlign,e)});for(let i=u;i<=g&&!(c<d);i++)[d,c].forEach(l=>{let o=e._getCellStyle(i,l);(null==o?void 0:o.textStick)&&"horizontal"!==(null==o?void 0:o.textStick)&&t$(e.scenegraph.getCell(i,l),n+e.tableY,e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()+e.tableY,t,null==o?void 0:o.textStickBaseOnAlign,e)});for(let i=d;i<=c&&!(g<u);i++)[u,g].forEach(l=>{let o=e._getCellStyle(l,i);(null==o?void 0:o.textStick)&&"vertical"!==(null==o?void 0:o.textStick)&&tJ(e.scenegraph.getCell(l,i),a+e.tableX,e.tableNoFrameWidth-e.getRightFrozenColsWidth()+e.tableX,t,null==o?void 0:o.textStickBaseOnAlign,e)})}}function t$(e,t,i,l,o,r){if((0,J.Z)(e.mergeStartCol)&&(0,J.Z)(e.mergeStartRow)&&(0,J.Z)(e.mergeEndCol)&&(0,J.Z)(e.mergeEndRow)){let{colStart:n,colEnd:a,rowStart:s,rowEnd:h}=(0,et.e)(e,r.scenegraph);for(let e=n;e<=a;e++)for(let n=s;n<=h;n++){let a=r.scenegraph.getCell(e,n);"cell"===a.role&&tX(a,t,i,l,o)}}else tX(e,t,i,l,o)}function tX(e,t,i,l,o){var r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y;let x=e.getChildByName("text",!0)||e.getChildByName("image",!0);if(!x)return;if("image"===x.type){let{image:e}=x.attribute;if(!e||!x.resources||"success"!==x.resources.get(e).state)return}let _=null!=(r=x.textBaseline)?r:"top";x.AABBBounds.width();let S=x.globalAABBBounds.y1,R=x.globalAABBBounds.y2;if("middle"===_&&o){let o=e.globalAABBBounds.y1+(null!=(a=null==(n=e.firstChild)?void 0:n.attribute.dy)?a:0),r=o+(null!=(h=null!=(s=e.contentHeight)?s:e.attribute.height)?h:0);if(o<t||r>i){let n=Math.max(o,t),a=Math.min(r,i),s=x.globalTransMatrix.f-(a+n)/2+x.AABBBounds.height()/2;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(u=null==(d=e.firstChild)?void 0:d.attribute.dx)?u:0,dy:null!=(g=null==(c=e.firstChild)?void 0:c.attribute.dy)?g:0}),e.forEachChildren(e=>{var t;e.setAttribute("dy",(null!=(t=e.attribute.dy)?t:0)-s+2)})}}else if(S<t){let i=S-t;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(f=null==(p=e.firstChild)?void 0:p.attribute.dx)?f:0,dy:null!=(m=null==(b=e.firstChild)?void 0:b.attribute.dy)?m:0}),e.forEachChildren(e=>{var t;e.setAttribute("dy",(null!=(t=e.attribute.dy)?t:0)-i+2)})}else if(R>i){let t=R-i;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(v=null==(C=e.firstChild)?void 0:C.attribute.dx)?v:0,dy:null!=(y=null==(w=e.firstChild)?void 0:w.attribute.dy)?y:0}),e.forEachChildren(e=>{var i;e.setAttribute("dy",(null!=(i=e.attribute.dy)?i:0)-t)})}}function tJ(e,t,i,l,o,r){if((0,J.Z)(e.mergeStartCol)&&(0,J.Z)(e.mergeStartRow)&&(0,J.Z)(e.mergeEndCol)&&(0,J.Z)(e.mergeEndRow)){let{colStart:n,colEnd:a,rowStart:s,rowEnd:h}=(0,et.e)(e,r.scenegraph);for(let e=n;e<=a;e++)for(let n=s;n<=h;n++){let a=r.scenegraph.getCell(e,n);"cell"===a.role&&tY(a,t,i,l,o)}}else tY(e,t,i,l,o)}function tY(e,t,i,l,o){var r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x;let _=e.getChildByName("text",!0)||e.getChildByName("image",!0);if(!_)return;if("image"===_.type){let{image:e}=_.attribute;if(!e||!_.resources||"success"!==_.resources.get(e).state)return}let S=null!=(n=null!=(r=_.attribute.textAlign)?r:_.textAlign)?n:"left";_.AABBBounds.width();let R=_.globalAABBBounds.x1,H=_.globalAABBBounds.x2;if("center"===S&&o){let o=e.globalAABBBounds.x1+(null!=(s=null==(a=e.firstChild)?void 0:a.attribute.dx)?s:0),r=o+(null!=(d=null!=(h=e.contentWidth)?h:e.attribute.width)?d:0);if(o<t||r>i){let n=Math.max(o,t),a=Math.min(r,i),s=_.globalTransMatrix.e-(a+n)/2;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(c=null==(u=e.firstChild)?void 0:u.attribute.dx)?c:0,dy:null!=(p=null==(g=e.firstChild)?void 0:g.attribute.dy)?p:0}),e.forEachChildren(e=>{var t;e.setAttribute("dx",(null!=(t=e.attribute.dx)?t:0)-s+2)})}}else if(R<t){let i=R-t;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(b=null==(f=e.firstChild)?void 0:f.attribute.dx)?b:0,dy:null!=(C=null==(m=e.firstChild)?void 0:m.attribute.dy)?C:0}),e.forEachChildren(e=>{var t;e.setAttribute("dx",(null!=(t=e.attribute.dx)?t:0)-i+2)})}else if(H>i){let t=H-i;l.has(`${e.col}-${e.row}`)||l.set(`${e.col}-${e.row}`,{col:e.col,row:e.row,dx:null!=(w=null==(v=e.firstChild)?void 0:v.attribute.dx)?w:0,dy:null!=(x=null==(y=e.firstChild)?void 0:y.attribute.dy)?x:0}),e.forEachChildren(e=>{var i;e.setAttribute("dx",(null!=(i=e.attribute.dx)?i:0)-t)})}}function tq(e){var t,i;let l=e.internalProps.layoutMap.headerObjects,o=e.internalProps.layoutMap.columnObjects;for(let e=0;e<l.length;e++){let i=l[e];if(i&&(null==(t=i.style)?void 0:t.textStick))return!0}for(let e=0;e<o.length;e++){let t=o[e];if(t&&(null==(i=t.style)?void 0:i.textStick))return!0}return!!(e.theme.headerStyle.textStick||e.theme.rowHeaderStyle.textStick||e.theme.bodyStyle.textStick)}var tQ=function(e,t,i,l){return new(i||(i=Promise))(function(o,r){function n(e){try{s(l.next(e))}catch(e){r(e)}}function a(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,a)}s((l=l.apply(e,t||[])).next())})};class t0{constructor(e){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=e,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*e.tableNoFrameWidth/e.defaultColWidth))):this.table.isAutoRowHeight(e.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight)):("autoWidth"===this.table.widthMode||(this.rowLimit=Math.max(200,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*e.tableNoFrameWidth/e.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),"adaptive"===this.table.heightMode&&(this.rowLimit=this.table.rowCount),"adaptive"===this.table.widthMode&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let e=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=e,this.totalCol=this.bodyLeftCol+e-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;let t=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/t);let i=t*e,l=t*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=i/2,this.xLimitRight=l-i/2;let o=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(o/t))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let e=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=e,this.totalRow=this.bodyTopRow+e-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;let t=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/t);let i=t*e,l=t*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=i/2,this.yLimitBottom=l-i/2;let o=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/t),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(o/t))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let e=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=e,this.totalRow=this.rowStart+e-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let e=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=e,this.totalCol=this.bodyLeftCol+e-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){let e=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/e);let t=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(t/e));let i=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/i);let l=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/i),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(l/i))}createGroupForFirstScreen(e,t,i,l,o,r,n,a){!function(e,t,i,l,o,r,n,a,s){var h,d,u,c,g,p,f,b,m,C,v,w,y;let x,_,S,R,{table:H}=s,{leftBottomCornerGroup:A,rightTopCornerGroup:M,rightBottomCornerGroup:F}=H.scenegraph;s.setParamsForRow(),s.setParamsForColumn(),("adaptive"===H.widthMode||H.options.autoWrapText&&("adaptive"===H.heightMode||H.isAutoRowHeight(H.columnHeaderLevelCount)))&&(S=H.colCount-1),x=Math.min(s.firstScreenColLimit-1,H.colCount-1),"adaptive"===H.heightMode&&(R=H.rowCount-1),_=Math.min(s.firstScreenRowLimit-1,H.rowCount-1),0===H.internalProps._widthResizedColMap.size&&(0,ty.rj)(H,0,null!=S?S:x),0===H.internalProps._heightResizedRowMap.size&&(0,ee.Y)(H,0,"auto"===H.options.canvasHeight||(null==(h=H.options.customConfig)?void 0:h.forceComputeAllRowHeight)?H.rowCount-1:null!=R?R:_),x<H.colCount-H.rightFrozenColCount&&H.colCount-H.rightFrozenColCount<=H.colCount-1&&(0,ty.rj)(H,H.colCount-H.rightFrozenColCount,H.colCount-1),_<H.rowCount-H.bottomFrozenRowCount&&H.rowCount-H.bottomFrozenRowCount<=H.rowCount-1&&(0,ee.Y)(H,H.rowCount-H.bottomFrozenRowCount,H.rowCount-1),H.scenegraph.colHeaderGroup.setAttribute("x",H.getFrozenColsWidth()),H.scenegraph.rowHeaderGroup.setAttribute("y",H.getFrozenRowsHeight()),H.scenegraph.bottomFrozenGroup.setAttribute("x",H.getFrozenColsWidth()),H.scenegraph.rightFrozenGroup.setAttribute("y",H.getFrozenRowsHeight()),H.scenegraph.bodyGroup.setAttributes({x:H.getFrozenColsWidth(),y:H.getFrozenRowsHeight()}),tA(e,n,a,0,H.frozenColCount-1,0,H.frozenRowCount-1,H.isListTable()?"columnHeader":"cornerHeader",H),x-H.rightFrozenColCount>=H.frozenColCount&&tA(t,n,a,H.frozenColCount,x-H.rightFrozenColCount,0,H.frozenRowCount-1,"columnHeader",H),H.frozenColCount>0&&(H.leftRowSeriesNumberCount>0&&tA(i,n,a,0,H.leftRowSeriesNumberCount-1,H.frozenRowCount,_-H.bottomFrozenRowCount,"rowHeader",H),H.frozenColCount>H.leftRowSeriesNumberCount&&tA(i,n,a,H.leftRowSeriesNumberCount,Math.min(H.frozenColCount-1,H.rowHeaderLevelCount+H.leftRowSeriesNumberCount-1),H.frozenRowCount,_-H.bottomFrozenRowCount,"rowHeader",H),H.frozenColCount>H.rowHeaderLevelCount+H.leftRowSeriesNumberCount&&tA(i,n,a,H.rowHeaderLevelCount+H.leftRowSeriesNumberCount,H.frozenColCount-1,H.frozenRowCount,_-H.bottomFrozenRowCount,"body",H)),H.bottomFrozenRowCount>0&&(H.frozenColCount>0&&(H.leftRowSeriesNumberCount>0&&tA(A,n,a,0,H.leftRowSeriesNumberCount-1,H.rowCount-1-H.bottomFrozenRowCount+1,H.rowCount-1,"rowHeader",H),H.rowHeaderLevelCount>0&&tA(A,n,a,H.leftRowSeriesNumberCount,H.leftRowSeriesNumberCount+H.rowHeaderLevelCount-1,H.rowCount-1-H.bottomFrozenRowCount+1,H.rowCount-1,"rowHeader",H),H.frozenColCount>H.rowHeaderLevelCount+H.leftRowSeriesNumberCount&&tA(A,n,a,H.rowHeaderLevelCount+H.leftRowSeriesNumberCount,H.frozenColCount-1,H.rowCount-1-H.bottomFrozenRowCount+1,H.rowCount-1,"body",H)),x-H.rightFrozenColCount>=H.frozenColCount&&tA(o,n,a,H.frozenColCount,x-H.rightFrozenColCount,H.rowCount-1-H.bottomFrozenRowCount+1,H.rowCount-1,H.isPivotChart()?"rowHeader":"body",H)),H.rightFrozenColCount>0&&(tA(M,n,a,H.colCount-1-H.rightFrozenColCount+1,H.colCount-1,0,H.frozenRowCount-1,"columnHeader",H),tA(l,n,a,H.colCount-1-H.rightFrozenColCount+1,H.colCount-1,H.frozenRowCount,_-H.bottomFrozenRowCount,H.isPivotChart()?"rowHeader":"body",H)),H.bottomFrozenRowCount>0&&H.rightFrozenColCount>0&&tA(F,n,a,H.colCount-1-H.rightFrozenColCount+1,H.colCount-1,H.rowCount-1-H.bottomFrozenRowCount+1,H.rowCount-1,"body",H),x-H.rightFrozenColCount>=H.frozenColCount&&tA(r,n,a,H.frozenColCount,x-H.rightFrozenColCount,H.frozenRowCount,_-H.bottomFrozenRowCount,"body",H),r.firstChild||t.firstChild||e.firstChild||i.firstChild?(s.currentRow=null!=(g=null!=(u=null==(d=r.firstChild)?void 0:d.rowNumber)?u:null==(c=i.firstChild)?void 0:c.rowNumber)?g:s.totalRow,s.rowEnd=s.currentRow,s.rowUpdatePos=s.rowEnd+1,s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.currentCol=null!=(y=null!=(v=null!=(m=null!=(f=null==(p=r.lastChild)?void 0:p.col)?f:null==(b=t.lastChild)?void 0:b.col)?m:null==(C=i.lastChild)?void 0:C.col)?v:null==(w=e.lastChild)?void 0:w.col)?y:s.totalCol,s.colEnd=s.currentCol,s.colUpdatePos=s.colEnd+1,s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.progress()):(s.currentRow=s.totalRow,s.rowEnd=s.currentRow,s.rowUpdatePos=s.rowEnd+1,s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.currentCol=s.totalCol,s.colEnd=s.currentCol,s.colUpdatePos=s.colEnd+1,s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2))}(e,t,i,l,o,r,n,a,this)}progress(){return tQ(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((e,t)=>{setTimeout(()=>tQ(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),tU(this.table),this.table.scenegraph.updateNextFrame(),e())}),16)})})}createRow(){return tQ(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return tQ(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(e){let t=Math.min(this.totalRow,this.currentRow+e);if("adaptive"!==this.table.heightMode&&(0,ee.Y)(this.table,this.currentRow+1,t,!1),this.rowEnd=t,this.table.frozenColCount){let e=0;for(let i=0;i<this.table.frozenColCount;i++){let l=this.table.scenegraph.getColGroup(i),{height:o}=(this.table.isListTable(),tS(l,i,l.attribute.width,this.currentRow+1,t,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));e=Math.max(e,o),this.table.scenegraph.rowHeaderGroup.setAttribute("height",e)}}if(this.table.rightFrozenColCount){let e=0;for(let i=this.table.colCount-this.table.rightFrozenColCount;i<this.table.colCount;i++){let l=this.table.scenegraph.getColGroup(i),{height:o}=(this.table.isPivotChart(),tS(l,i,l.attribute.width,this.currentRow+1,t,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));e=Math.max(e,o),this.table.scenegraph.rightFrozenGroup.setAttribute("height",e)}}let i=0;for(let e=this.bodyLeftCol;e<=this.bodyRightCol;e++){let l=this.table.scenegraph.getColGroup(e);if(!l)continue;this.table.rowHeaderLevelCount;let{height:o}=tS(l,e,l.attribute.width,this.currentRow+1,t,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);i=Math.max(i,o)}this.table.scenegraph.bodyGroup.setAttribute("height",i),this.currentRow=t,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(e){let t=Math.min(this.totalCol,this.currentCol+e);"adaptive"!==this.table.widthMode&&(0,ty.rj)(this.table,this.currentCol+1,t),this.colEnd=t;for(let e=0;e<this.table.rowCount;e++){let t=this.highPerformanceGetCell(this.currentCol,e);"cell"===t.role&&(0,J.Z)(t.mergeStartCol)&&t.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(t.col,t.row)}if(this.table.frozenRowCount){let e=this.table.scenegraph.colHeaderGroup.lastChild instanceof ep.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,i=e.attribute.x+e.attribute.width,l=e.attribute.y;tA(this.table.scenegraph.colHeaderGroup,i,l,this.currentCol+1,t,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){let e=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof ep.Z?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,i=e.attribute.x+e.attribute.width,l=e.attribute.y;tA(this.table.scenegraph.bottomFrozenGroup,i,l,this.currentCol+1,t,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let i=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof ep.Z?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);i||(i=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof ep.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));let l=i.attribute.x+i.attribute.width,o=i.attribute.y;tA(this.table.scenegraph.bodyGroup,l,o,this.currentCol+1,t,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=t,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(e,t=!1){return tQ(this,void 0,void 0,function*(){let i=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,l=this.table.getAllRowsHeight()-i,o=this.table.getTargetRowAt(e+this.table.scenegraph.colHeaderGroup.attribute.height);o&&(this.screenTopRow=o.row),e<i&&this.rowStart===this.bodyTopRow||e>l&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(e),this.updateBody(e-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0!==this.table.scenegraph.bodyGroup.firstChild.childrenCount||this.table.scenegraph.rowHeaderGroup.firstChild&&"group"===this.table.scenegraph.rowHeaderGroup.firstChild.type&&0!==this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount?this.dynamicSetY(e,o,t):(this.updateDeltaY(e),this.updateBody(e-this.deltaY))})}setX(e,t=!1){return tQ(this,void 0,void 0,function*(){let i=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,l=this.table.getAllColsWidth()-i,o=this.table.getTargetColAt(e+this.table.scenegraph.rowHeaderGroup.attribute.width);o&&(this.screenLeftCol=o.col),e<i&&this.colStart===this.bodyLeftCol||e>l&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0===this.table.scenegraph.bodyGroup.firstChild.childrenCount?(this.updateDeltaX(e),this.table.scenegraph.setBodyAndColHeaderX(-e+this.deltaX)):this.dynamicSetX(e,o,t)})}dynamicSetY(e,t,i=!1){return tQ(this,void 0,void 0,function*(){!function(e,t,i,l){tG(this,void 0,void 0,function*(){var o,r,n,a,s;if(!t)return;let h=t.row,d=t.top;if(o=i?l.bodyBottomRow-l.rowEnd:h-l.referenceRow,r=h,n=d,a=e,s=l,o>0?tN(o,"up",r,n,a,s):o<0&&tN(-o,"down",r,n,a,s),s.updateDeltaY(a,n,r),s.updateBody(a-s.deltaY),i){let t=l.table.scenegraph.highPerformanceGetCell(l.colStart,l.rowEnd,!0);if("cell"===t.role){let i=t.attribute.y+t.attribute.height-(l.table.tableNoFrameHeight-l.table.getFrozenRowsHeight()-l.table.getBottomFrozenRowsHeight())-e;l.deltaY=-i,l.updateBody(e-l.deltaY)}}})}(e,t,i,this)})}dynamicSetX(e,t,i=!1){return tQ(this,void 0,void 0,function*(){!function(e,t,i,l){tz(this,void 0,void 0,function*(){var o,r,n,a,s;if(!t)return;let h=t.col,d=t.left;if(o=i?l.bodyRightCol-l.colEnd:l.screenLeftCol-l.referenceCol,r=h,n=d,a=e,s=l,o>0?tL(o,"left",s.screenLeftCol,n,a,s):o<0&&tL(-o,"right",s.screenLeftCol,n,a,s),s.updateDeltaX(a,n,r),s.table.scenegraph.setBodyAndColHeaderX(-a+s.deltaX),i){let t=l.table.scenegraph.getColGroup(l.colEnd);if(t){let i=t.attribute.x+t.attribute.width-(l.table.tableNoFrameWidth-l.table.getFrozenColsWidth()-l.table.getRightFrozenColsWidth())-e;l.deltaX=-i,l.table.scenegraph.setBodyAndColHeaderX(-e+l.deltaX)}}l.table.scenegraph.updateNextFrame()})}(e,t,i,this)})}updateBody(e){this.table.scenegraph.setBodyAndRowHeaderY(-e)}updateRowCellGroupsAsync(){return tQ(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(e){let t=Math.min(this.bodyBottomRow,this.rowUpdatePos+e);this.table.isAutoRowHeight(this.rowUpdatePos)&&(0,ee.Y)(this.table,this.rowUpdatePos,t,!1),tK(this.rowUpdatePos,t,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(tW(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0),tW(0,this.table.frozenColCount-1,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0),tW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=t+1}updateBottomFrozenCellGroups(){let e=this.table.rowCount-this.table.bottomFrozenRowCount,t=this.table.rowCount-1;this.table.isAutoRowHeight(e)&&(0,ee.Y)(this.table,e,t,!1),tK(e,t,this),this.table.isAutoRowHeight(e)&&(tW(this.bodyLeftCol,this.bodyRightCol,e,t,this.table,this.rowUpdateDirection),tW(0,this.table.frozenColCount-1,e,t,this.table,this.rowUpdateDirection),tW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,e,t,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){let e=this.table.colCount-this.table.rightFrozenColCount,t=this.table.colCount-1;"autoWidth"===this.table.widthMode&&(0,ty.rj)(this.table,e,t,!1),tE(e,t,this),this.table.isAutoRowHeight(this.rowStart)&&tB(e,t,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return tQ(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(e){let t=Math.min(this.bodyRightCol,this.colUpdatePos+e);"autoWidth"===this.table.widthMode&&(0,ty.rj)(this.table,this.colUpdatePos,t),tE(this.colUpdatePos,t,this),this.colUpdatePos=t+1}updateCellGroupPosition(e,t,i){e.row=t,e.mergeStartCol=void 0,e.mergeStartRow=void 0,e.mergeEndCol=void 0,e.mergeEndRow=void 0,e.setAttribute("y",i),e.needUpdate=!0,e.needUpdateForAutoRowHeight=!0}updateCellGroupContent(e){if(!e.needUpdate||"cell"!==e.role)return e;let t=this.table.scenegraph.updateCellContent(e.col,e.row);return e.needUpdate=!1,t||e}sortCellVertical(){return tQ(this,void 0,void 0,function*(){yield function(e){var t,i,l,o,r;return i=this,l=void 0,o=void 0,r=function*(){let i,l;e.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{"group"===e.type&&(e.needUpdate=!0,null==e||e.forEachChildren(e=>{e.needUpdate=!0}))}),e.table.isAutoRowHeight(e.rowStart)?(i=e.rowStart,l=e.rowEnd):(i=Math.max(e.bodyTopRow,e.screenTopRow-e.screenRowCount),l=Math.min(e.bodyBottomRow,e.screenTopRow+2*e.screenRowCount,e.table.rowCount-1));let o=e.table.getAllRowsHeight();(0,ee.Y)(e.table,i,l);let r=e.table.getAllRowsHeight();o!==r&&e.table.scenegraph.updateContainerHeight(e.table.frozenRowCount,r-o);for(let i=0;i<(null!=(t=e.table.frozenColCount)?t:0);i++){let t=e.table.scenegraph.getColGroup(i);null==t||t.setAttribute("chartInstance",void 0);for(let t=e.rowStart;t<=e.rowEnd;t++)e.table.scenegraph.updateCellContent(i,t);for(let t=e.table.rowCount-e.table.bottomFrozenRowCount;t<e.table.rowCount;t++)e.table.scenegraph.updateCellContent(i,t)}for(let t=e.colStart;t<=e.colEnd;t++){let i=e.table.scenegraph.getColGroup(t);null==i||i.setAttribute("chartInstance",void 0);for(let i=e.table.rowCount-e.table.bottomFrozenRowCount;i<e.table.rowCount;i++)e.table.scenegraph.updateCellContent(t,i)}for(let t=e.table.colCount-e.table.rightFrozenColCount;t<e.table.colCount;t++){let i=e.table.scenegraph.getColGroup(t);null==i||i.setAttribute("chartInstance",void 0);for(let i=e.rowStart;i<=e.rowEnd;i++)e.table.scenegraph.updateCellContent(t,i);for(let i=e.table.rowCount-e.table.bottomFrozenRowCount;i<e.table.rowCount;i++)e.table.scenegraph.updateCellContent(t,i)}tK(i,l,e),e.table.isAutoRowHeight(i)&&tW(e.bodyLeftCol,e.bodyRightCol,i,l,e.table,e.rowEnd>e.bodyBottomRow-(e.rowEnd-e.rowStart+1)?"down":"up"),e.rowUpdatePos=e.rowStart,e.rowUpdateDirection=e.rowEnd>e.bodyBottomRow-(e.rowEnd-e.rowStart+1)?"down":"up",e.table.scenegraph.updateNextFrame(),e.table.isAutoRowHeight(e.rowStart)||(yield e.progress())},new(o||(o=Promise))(function(e,t){function n(e){try{s(r.next(e))}catch(e){t(e)}}function a(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):((i=t.value)instanceof o?i:new o(function(e){e(i)})).then(n,a)}s((r=r.apply(i,l||[])).next())})}(this)})}sortCellHorizontal(){return tQ(this,void 0,void 0,function*(){yield function(e){var t,i,l,o;return t=this,i=void 0,l=void 0,o=function*(){e.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{"group"===e.type&&(e.needUpdate=!0,null==e||e.forEachChildren(e=>{e.needUpdate=!0}))});let t=Math.max(e.bodyLeftCol,e.screenLeftCol-e.screenColCount),i=Math.min(e.bodyRightCol,e.screenLeftCol+2*e.screenColCount);(0,ty.rj)(e.table,t,i);for(let t=e.colStart;t<=e.colEnd;t++){let i=e.table.scenegraph.getColGroup(t);null==i||i.setAttribute("chartInstance",void 0);for(let i=e.table.rowCount-e.table.bottomFrozenRowCount;i<e.table.rowCount;i++)e.table.scenegraph.updateCellContent(t,i)}for(let t=e.table.colCount-e.table.rightFrozenColCount;t<e.table.colCount;t++){let i=e.table.scenegraph.getColGroup(t);null==i||i.setAttribute("chartInstance",void 0);for(let i=e.rowStart;i<=e.rowEnd;i++)e.table.scenegraph.updateCellContent(t,i);for(let i=e.table.rowCount-e.table.bottomFrozenRowCount;i<e.table.rowCount;i++)e.table.scenegraph.updateCellContent(t,i)}tE(t,i,e),e.colUpdatePos=e.colStart,e.colUpdateDirection=e.colEnd>e.bodyRightCol-(e.colEnd-e.colStart+1)?"right":"left",e.table.scenegraph.updateNextFrame(),yield e.progress()},new(l||(l=Promise))(function(e,r){function n(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(t){var i;t.done?e(t.value):((i=t.value)instanceof l?i:new l(function(e){e(i)})).then(n,a)}s((o=o.apply(t,i||[])).next())})}(this)})}highPerformanceGetCell(e,t,i){if(t>=this.table.frozenRowCount&&t<this.table.rowCount-this.table.bottomFrozenRowCount&&(t<this.rowStart||t>this.rowEnd)||e>=this.table.frozenColCount&&e<this.table.colCount-this.table.rightFrozenColCount&&(e<this.colStart||e>this.colEnd))return tx;if(this.cellCache.get(e)){let l=this.cellCache.get(e);if((l._next||l._prev)&&Math.abs(l.row-t)<t){let o=function e(t,i){if(!t)return null;if(t.row===i)return t;let l=t._prev,o=t._next;return t.row>i&&l&&l.row===t.row-1?e(l,i):t.row<i&&o&&o.row===t.row+1?e(o,i):null}(l,t);return o&&(i||"shadow-cell"!==o.role)||(o=this.table.scenegraph.getCell(e,t,i)),o.row&&this.cellCache.set(e,o),o}let o=this.table.scenegraph.getCell(e,t,i);return o.col===e&&o.row&&this.cellCache.set(e,o),o}let l=this.table.scenegraph.getCell(e,t,i);return l.col===e&&l.row&&this.cellCache.set(e,l),l}updateDeltaY(e,t,i){if(this.rowStart===this.bodyTopRow){let e=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if("cell"===e.role){let t=e.attribute.y;this.deltaY=-t}}else if(this.rowEnd===this.bodyBottomRow){let e=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if("cell"===e.role){let t=e.attribute.y+e.attribute.height-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-t}}else if((0,m.Z)(t)&&(0,m.Z)(i)){let l=this.table.scenegraph.highPerformanceGetCell(this.colStart,i,!0);"cell"!==l.role&&(l=this.table.scenegraph.highPerformanceGetCell(0,i,!0));let o=e-this.deltaY,r=t-o,n=l.attribute.y-o+this.table.getFrozenRowsHeight();this.deltaY=r-n}}updateDeltaX(e,t,i){if(this.colStart===this.bodyLeftCol){let e=this.table.scenegraph.getColGroup(this.colStart);if(e){let t=e.attribute.x;this.deltaX=-t}}else if(this.colEnd===this.bodyRightCol){let e=this.table.scenegraph.getColGroup(this.colEnd);if(e){let t=e.attribute.x+e.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-t}}else if((0,m.Z)(t)&&(0,m.Z)(i)){let l=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),o=e-this.deltaX,r=t-o,n=l.attribute.x-o+this.table.getFrozenColsWidth();this.deltaX=r-n}}release(){this.isRelease=!0}}function t1(e){e.customSelectedRangeComponents.forEach((t,i)=>{t2(t,i,e)}),e.selectingRangeComponents.forEach((t,i)=>{t2(t,i,e)}),e.selectedRangeComponents.forEach((t,i)=>{t2(t,i,e)})}function t2(e,t,i){var l,o,r,n,a,s,h,d,u,c;let g=i.table,[p,f,b,m]=t.split("-"),C=parseInt(p,10),v=parseInt(f,10),w=parseInt(b,10),y=parseInt(m,10),x,_=C,S=v,R=w,H=y;switch(e.role){case"rowHeader":(x=g.getBodyVisibleRowRange())&&(S=Math.max(v,x.rowStart-1),H=Math.min(y,x.rowEnd+1));break;case"columnHeader":case"bottomFrozen":(x=g.getBodyVisibleCellRange())&&(_=Math.max(C,x.colStart-1),R=Math.min(w,x.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":(x=g.getBodyVisibleCellRange())&&(S=Math.max(v,x.rowStart-1),H=Math.min(y,x.rowEnd+1));break;default:(x=g.getBodyVisibleCellRange())&&(S=Math.max(v,x.rowStart-1),H=Math.min(y,x.rowEnd+1),_=Math.max(C,x.colStart-1),R=Math.min(w,x.colEnd+1))}let A=g.getColsWidth(_,R),M=g.getRowsHeight(S,H),F=i.highPerformanceGetCell(_,S).globalAABBBounds;if(e.rect.setAttributes({x:F.x1-i.tableGroup.attribute.x,y:F.y1-i.tableGroup.attribute.y,width:A,height:M,visible:!0}),e.fillhandle){let t=null==(l=i.table.options.excelOptions)?void 0:l.fillHandle,r,n=!0;"function"==typeof t&&(n=t({selectRanges:i.table.stateManager.select.ranges,table:i.table}));let a=(R<g.colCount-1?i.highPerformanceGetCell(R,H).globalAABBBounds:i.highPerformanceGetCell(_-1,H).globalAABBBounds).x2-i.tableGroup.attribute.x-3,s=(H<g.rowCount-1?i.highPerformanceGetCell(R,H).globalAABBBounds:i.highPerformanceGetCell(R,S-1).globalAABBBounds).y2-i.tableGroup.attribute.y-3;null==(o=e.fillhandle)||o.setAttributes({x:a,y:s,width:6,height:6,visible:n})}let B=!!g.frozenColCount&&C===g.frozenColCount;!B&&g.frozenColCount&&g.scrollLeft>0&&C>=g.frozenColCount&&g.getColsWidth(0,C-1)-g.scrollLeft<g.getFrozenColsWidth()&&(B=!0);let T=!!g.rightFrozenColCount&&g.rightFrozenColCount>0&&w===g.colCount-g.rightFrozenColCount-1;!T&&g.rightFrozenColCount&&w<g.colCount-g.rightFrozenColCount&&g.getColsWidth(0,w)-g.scrollLeft>g.tableNoFrameWidth-g.getRightFrozenColsWidth()&&(T=!0);let z=!g.frozenRowCount||v===g.frozenRowCount;!z&&g.frozenRowCount&&g.scrollTop>0&&v>=g.frozenRowCount&&g.getRowsHeight(0,v-1)-g.scrollTop<g.getFrozenRowsHeight()&&(z=!0);let L=!!g.bottomFrozenRowCount&&y===g.rowCount-g.bottomFrozenRowCount-1;!L&&g.bottomFrozenRowCount&&y<g.rowCount-g.bottomFrozenRowCount&&g.getRowsHeight(0,y)-g.scrollTop>g.tableNoFrameHeight-g.getBottomFrozenRowsHeight()&&(L=!0);let{dynamicUpdateSelectionSize:k}=g.theme.selectionStyle;if(B&&(e.rect.attribute.stroke[3]||k)||T&&(e.rect.attribute.stroke[1]||k)||z&&(e.rect.attribute.stroke[0]||k)||L&&(e.rect.attribute.stroke[2]||k)){if(B&&e.rect.attribute.stroke[3]&&i.tableGroup.insertAfter(e.rect,"columnHeader"===e.role?i.cornerHeaderGroup:"bottomFrozen"===e.role?i.leftBottomCornerGroup:i.rowHeaderGroup),L&&e.rect.attribute.stroke[2]&&i.tableGroup.insertAfter(e.rect,"rowHeader"===e.role?i.leftBottomCornerGroup:"rightFrozen"===e.role?i.rightBottomCornerGroup:i.bottomFrozenGroup),z&&e.rect.attribute.stroke[0]&&i.tableGroup.insertAfter(e.rect,"rowHeader"===e.role?i.cornerHeaderGroup:"rightFrozen"===e.role?i.rightTopCornerGroup:i.colHeaderGroup),T&&e.rect.attribute.stroke[1]&&i.tableGroup.insertAfter(e.rect,"columnHeader"===e.role?i.rightTopCornerGroup:"bottomFrozen"===e.role?i.rightBottomCornerGroup:i.rightFrozenGroup),e.rect.attribute.x<g.getFrozenColsWidth()&&g.scrollLeft>0&&("body"===e.role||"columnHeader"===e.role||"bottomFrozen"===e.role)){let t=e.rect.attribute.width-(g.getFrozenColsWidth()-e.rect.attribute.x);e.rect.setAttributes({x:e.rect.attribute.x+(g.getFrozenColsWidth()-e.rect.attribute.x),width:t>0?t:0}),null==(r=e.fillhandle)||r.setAttributes({visible:t>0})}if(g.getRightFrozenColsWidth()>0&&i.rightFrozenGroup.attribute.height>0&&e.rect.attribute.x+e.rect.attribute.width>i.rightFrozenGroup.attribute.x&&("body"===e.role||"columnHeader"===e.role||"bottomFrozen"===e.role)){let t=i.rightFrozenGroup.attribute.x-e.rect.attribute.x;e.rect.setAttributes({x:e.rect.attribute.x,width:t>0?t:0}),null==(n=e.fillhandle)||n.setAttributes({visible:t-A>0})}if(e.rect.attribute.y<i.colHeaderGroup.attribute.height&&g.scrollTop>0&&("body"===e.role||"rowHeader"===e.role||"rightFrozen"===e.role)){let t=e.rect.attribute.height-(i.colHeaderGroup.attribute.height-e.rect.attribute.y);e.rect.setAttributes({y:e.rect.attribute.y+(i.colHeaderGroup.attribute.height-e.rect.attribute.y),height:t>0?t:0}),null==(a=e.fillhandle)||a.setAttributes({visible:t>0})}if(i.bottomFrozenGroup.attribute.width>0&&i.bottomFrozenGroup.attribute.height>0&&e.rect.attribute.y+e.rect.attribute.height>i.bottomFrozenGroup.attribute.y&&("body"===e.role||"rowHeader"===e.role||"rightFrozen"===e.role)){let t=i.bottomFrozenGroup.attribute.y-e.rect.attribute.y;e.rect.setAttributes({y:e.rect.attribute.y,height:t>0?t:0}),null==(s=e.fillhandle)||s.setAttributes({visible:t-M>0})}}else i.tableGroup.insertAfter(e.rect,"body"===e.role?i.bodyGroup:"columnHeader"===e.role?i.colHeaderGroup:"rowHeader"===e.role?i.rowHeaderGroup:"cornerHeader"===e.role?i.cornerHeaderGroup:"rightTopCorner"===e.role?i.rightTopCornerGroup:"rightFrozen"===e.role?i.rightFrozenGroup:"leftBottomCorner"===e.role?i.leftBottomCornerGroup:"bottomFrozen"===e.role?i.bottomFrozenGroup:i.rightBottomCornerGroup);let P=0;"number"==typeof e.rect.attribute.lineWidth&&(P=Math.ceil(e.rect.attribute.lineWidth/2)),w===g.colCount-1&&(Array.isArray(e.rect.attribute.lineWidth)&&(P=Math.ceil((null!=(h=e.rect.attribute.lineWidth[1])?h:0)/2)),e.rect.setAttributes({width:e.rect.attribute.width-P})),0===C&&(Array.isArray(e.rect.attribute.lineWidth)&&(P=Math.ceil((null!=(d=e.rect.attribute.lineWidth[3])?d:0)/2)),e.rect.setAttributes({x:e.rect.attribute.x+P,width:e.rect.attribute.width-P})),y===g.rowCount-1&&(Array.isArray(e.rect.attribute.lineWidth)&&(P=Math.ceil((null!=(u=e.rect.attribute.lineWidth[2])?u:0)/2)),e.rect.setAttributes({height:e.rect.attribute.height-P})),0===v&&(Array.isArray(e.rect.attribute.lineWidth)&&(P=Math.ceil((null!=(c=e.rect.attribute.lineWidth[0])?c:0)/2)),e.rect.setAttributes({y:e.rect.attribute.y+P,height:e.rect.attribute.height-P}))}function t3(e,t,i=!0){let l=e.table,o=t.start.col,r=t.start.row,n=t.end.col,a=t.end.row,s=t.skipBodyMerge,h=Math.max(Math.min(n,o),0),d=Math.max(Math.min(a,r),0),u=Math.min(Math.max(n,o),l.colCount-1),c=Math.min(Math.max(a,r),l.rowCount-1),g=()=>{let e=!1;for(let t=h;t<=u;t++){if(t===h)for(let i=d;i<=c;i++){if(!l.isHeader(t,i)&&s)continue;let o=(0,Z.Z)(l,t,i);if(o&&o.start.col<h){h=o.start.col,e=!0;break}}if(!e&&t===u)for(let i=d;i<=c;i++){if(!l.isHeader(t,i)&&s)continue;let o=(0,Z.Z)(l,t,i);if(o&&Math.min(o.end.col,l.colCount-1)>u){u=o.end.col,e=!0;break}}if(e)break}if(!e)for(let t=d;t<=c;t++){if(t===d)for(let i=h;i<=u;i++){if(!l.isHeader(i,t)&&s)continue;let o=(0,Z.Z)(l,i,t);if(o&&o.start.row<d){d=o.start.row,e=!0;break}}if(!e&&t===c)for(let i=h;i<=u;i++){if(!l.isHeader(i,t)&&s)continue;let o=(0,Z.Z)(l,i,t);if(o&&Math.min(o.end.row,l.rowCount-1)>c){c=o.end.row,e=!0;break}}if(e)break}e&&g()};i&&(g(),t.start.col>t.end.col?(t.start.col=Math.max(h,u),t.end.col=Math.min(h,u)):(t.start.col=Math.min(h,u),t.end.col=Math.max(h,u)),t.start.row>t.end.row?(t.start.row=Math.max(d,c),t.end.row=Math.min(d,c)):(t.start.row=Math.min(d,c),t.end.row=Math.max(d,c))),e.selectingRangeComponents.forEach((e,t)=>{var i;e.rect.delete(),null==(i=e.fillhandle)||i.delete()}),e.selectingRangeComponents=new Map;let p=!1,f=!1,b=!1,m=!1,C=!1,v=!1,w=!1,y=!1,x=!1;if(h<=l.frozenColCount-1&&d<=l.frozenRowCount-1&&(v=!0),u>=l.colCount-l.rightFrozenColCount&&d<=l.frozenRowCount-1&&(w=!0),h<=l.frozenColCount-1&&c>=l.rowCount-l.bottomFrozenRowCount&&(x=!0),u>=l.colCount-l.rightFrozenColCount&&c>=l.rowCount-l.bottomFrozenRowCount&&(y=!0),h<=l.frozenColCount-1&&c>=l.frozenRowCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&(p=!0),u>=l.colCount-l.rightFrozenColCount&&c>=l.frozenRowCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&(f=!0),d<=l.frozenRowCount-1&&u>=l.frozenColCount&&h<=l.colCount-l.rightFrozenColCount-1&&(b=!0),c>=l.rowCount-l.bottomFrozenRowCount&&u>=l.frozenColCount&&h<=l.colCount-l.rightFrozenColCount-1&&(m=!0),h<=l.colCount-l.rightFrozenColCount-1&&u>=l.frozenColCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&c>=l.frozenRowCount&&(C=!0),v){let t=Math.min(u,l.frozenColCount-1),i=Math.min(c,l.frozenRowCount-1),o=[!0,!b,!p,!0];e.createCellSelectBorder(h,d,t,i,"cornerHeader",`${h}${d}${u}${c}`,o)}if(w){let t=Math.max(h,l.colCount-l.rightFrozenColCount),i=Math.min(c,l.frozenRowCount-1),o=[!0,!0,!f,!b];e.createCellSelectBorder(t,d,u,i,"rightTopCorner",`${h}${d}${u}${c}`,o)}if(x){let t=Math.min(u,l.frozenColCount-1),i=Math.max(d,l.rowCount-l.bottomFrozenRowCount),o=[!p,!m,!0,!0];e.createCellSelectBorder(h,i,t,c,"leftBottomCorner",`${h}${d}${u}${c}`,o)}if(y){let t=Math.max(h,l.colCount-l.rightFrozenColCount),i=Math.max(d,l.rowCount-l.bottomFrozenRowCount),o=[!f,!0,!0,!m];e.createCellSelectBorder(t,i,u,c,"rightBottomCorner",`${h}${d}${u}${c}`,o)}if(b){let t=Math.max(h,l.frozenColCount),i=Math.min(u,l.colCount-l.rightFrozenColCount-1),o=Math.min(c,l.frozenRowCount-1),r=[!0,!w,!C,!v];e.createCellSelectBorder(t,d,i,o,"columnHeader",`${h}${d}${u}${c}`,r)}if(m){let t=Math.max(h,l.frozenColCount),i=Math.min(u,l.colCount-l.rightFrozenColCount-1),o=Math.max(d,l.rowCount-l.bottomFrozenRowCount),r=[!C,!y,!0,!x];e.createCellSelectBorder(t,o,i,c,"bottomFrozen",`${h}${d}${u}${c}`,r)}if(p){let t=Math.max(d,l.frozenRowCount),i=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),o=Math.min(u,l.frozenColCount-1),r=[!v,!C,!x,!0];e.createCellSelectBorder(h,t,o,i,"rowHeader",`${h}${d}${u}${c}`,r)}if(f){let t=Math.max(d,l.frozenRowCount),i=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),o=Math.max(h,l.colCount-l.rightFrozenColCount),r=[!w,!0,!y,!C];e.createCellSelectBorder(o,t,u,i,"rightFrozen",`${h}${d}${u}${c}`,r)}if(C){let t=Math.max(h,l.frozenColCount),i=Math.max(d,l.frozenRowCount),o=Math.min(u,l.colCount-l.rightFrozenColCount-1),r=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),n=[!b,!f,!m,!p];e.createCellSelectBorder(t,i,o,r,"body",`${h}${d}${u}${c}`,n)}}function t6(e){e.selectingRangeComponents.forEach((e,t)=>{e.rect.setAttribute("opacity",0)}),e.selectedRangeComponents.forEach((e,t)=>{e.rect.setAttribute("opacity",0)})}function t5(e){e.selectingRangeComponents.forEach((e,t)=>{e.rect.setAttribute("opacity",1)}),e.selectedRangeComponents.forEach((e,t)=>{e.rect.setAttribute("opacity",1)})}function t4(e){e.selectingRangeComponents.forEach((t,i)=>{var l;e.selectedRangeComponents.get(i)&&(e.selectingRangeComponents.get(i).rect.delete(),null==(l=e.selectingRangeComponents.get(i).fillhandle)||l.delete()),e.selectedRangeComponents.set(i,t)}),e.selectingRangeComponents=new Map,e.updateNextFrame()}function t8(e){e.selectedRangeComponents.forEach((e,t)=>{var i;e.rect.delete(),null==(i=e.fillhandle)||i.delete()}),e.selectedRangeComponents=new Map}function t9(e){e.selectingRangeComponents.forEach((e,t)=>{var i;e.rect.delete(),null==(i=e.fillhandle)||i.delete()}),e.selectingRangeComponents=new Map}function t7(e,t){for(let i=0;i<t.table.colCount;i++){let l=new ep.Z({x:0,y:0,width:t.table.getColWidth(i),height:t.table.getRowHeight(e)});if(l.role="cell",l.col=i,l.row=e,l.needUpdate=!0,!l)continue;let o=t.getColGroup(i);if(o)if(o.firstChild&&e<o.firstChild.row)o.insertBefore(l,o.firstChild),o.firstChild.row=o.firstChild.row+1;else if(o.lastChild&&e>o.lastChild.row)o.appendChild(l);else{let r=t.highPerformanceGetCell(i,e,!0);r!==l&&(o.insertBefore(l,r),r&&(r.row=r.row+1),r!==o.lastChild&&o.lastChild&&(o.lastChild.row=o.lastChild.row+1))}}}function ie(e,t){for(let i=0;i<t.table.colCount;i++){let l,o=t.getColGroup(i,!1);o&&(o.forEachChildren(t=>t.row===e&&(l=t,!0)),l&&(o.updateColumnHeight(-l.attribute.height),o.removeChild(l)))}}function it(e,t,i){let l;for(let o=0;o<i.table.colCount;o++){let r,n=i.table.getCellRange(o,e);n.start.row<=e+1&&n.end.row>=e+1&&(il(n,i),r=n.start.row);let a=i.table.getCellRange(o,t);a.start.row<=t+1&&a.end.row>=t+1&&(il(a,i),r=a.start.row),(0,m.Z)(r)&&(l=(0,m.Z)(l)?Math.min(l,r):r)}return l}function ii(e,t,i){let l;for(let o=0;o<i.table.colCount;o++){let r,n=i.highPerformanceGetCell(o,e);n.mergeStartRow&&n.mergeEndRow&&n.mergeEndRow>e&&(il({start:{row:n.mergeStartRow,col:i.table.isAutoRowHeight(t)?0:n.mergeStartCol},end:{row:n.mergeEndRow,col:i.table.isAutoRowHeight(t)?i.table.colCount-1:n.mergeEndCol}},i),r=n.mergeStartRow);let a=i.highPerformanceGetCell(o,t);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<t&&(il({start:{row:a.mergeStartRow,col:i.table.isAutoRowHeight(t)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:i.table.isAutoRowHeight(t)?i.table.colCount-1:a.mergeEndCol}},i),r=a.mergeStartRow),(0,m.Z)(r)&&(l=(0,m.Z)(l)?Math.min(l,r):r)}return l}function il(e,t){let{start:i,end:l}=e;for(let e=i.col;e<=l.col;e++)for(let o=i.row;o<=l.row;o++){let i=t.highPerformanceGetCell(e,o,!0);i&&(i.needUpdate=!0)}}var io=i(63388);function ir(e){if(!e.table.reactCustomLayout)return;let{table:t,stage:i}=e,l=i.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:o,renderId:r}=l;for(let n in o){let a,s=o[n],{graphic:h,wrapContainer:d,renderId:u}=s;if(u===r){if(e.frozenColCount>t.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:l,row:o}=i;o>=t.rowCount-t.bottomFrozenRowCount&&l<e.frozenColCount&&l>=t.frozenColCount&&h.attribute.react.container===t.frozenBottomDomContainer?a=t.bottomDomContainer:o>=t.frozenRowCount&&l<e.frozenColCount&&l>=t.frozenColCount&&h.attribute.react.container===t.frozenBodyDomContainer?a=t.bodyDomContainer:o<t.frozenRowCount&&l<e.frozenColCount&&l>=t.frozenColCount&&h.attribute.react.container===t.frozenHeaderDomContainer&&(a=t.headerDomContainer)}else if(e.frozenColCount<t.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:l,row:o}=i;o>=t.rowCount-t.bottomFrozenRowCount&&l<t.frozenColCount&&l>=e.frozenColCount&&h.attribute.react.container===t.bottomDomContainer?a=t.frozenBottomDomContainer:o>=t.frozenRowCount&&l<t.frozenColCount&&l>=e.frozenColCount&&h.attribute.react.container===t.bodyDomContainer?a=t.frozenBodyDomContainer:o<t.frozenRowCount&&l<t.frozenColCount&&l>=e.frozenColCount&&h.attribute.react.container===t.headerDomContainer&&(a=t.frozenHeaderDomContainer)}a&&(a.appendChild(d),s.nativeContainer=a,s.container=a,h.attribute.react.container=a,l.updateStyleOfWrapContainer(h,i,d,a,h.attribute.react))}}}function ia(e){let t=e.bodyGroup.firstChild instanceof ep.Z?e.bodyGroup.firstChild:null;t&&(e.rowHeaderGroup.appendChild(t),e.rowHeaderGroup.setAttribute("width",e.rowHeaderGroup.attribute.width+t.attribute.width),e.bodyGroup.setAttribute("width",e.bodyGroup.attribute.width-t.attribute.width))}function is(e){let t=e.colHeaderGroup.firstChild instanceof ep.Z?e.colHeaderGroup.firstChild:null;t&&(e.cornerHeaderGroup.appendChild(t),e.cornerHeaderGroup.setAttribute("width",e.cornerHeaderGroup.attribute.width+t.attribute.width),e.colHeaderGroup.setAttribute("width",e.colHeaderGroup.attribute.width-t.attribute.width))}function ih(e){var t;let i=e.rowHeaderGroup.lastChild instanceof ep.Z?e.rowHeaderGroup.lastChild:null==(t=e.rowHeaderGroup.lastChild)?void 0:t._prev;i&&(ig(e.bodyGroup,i,e.bodyGroup.firstChild),e.bodyGroup.setAttribute("width",e.bodyGroup.attribute.width+i.attribute.width),e.rowHeaderGroup.setAttribute("width",e.rowHeaderGroup.attribute.width-i.attribute.width))}function id(e){var t;let i=e.cornerHeaderGroup.lastChild instanceof ep.Z?e.cornerHeaderGroup.lastChild:null==(t=e.cornerHeaderGroup.lastChild)?void 0:t._prev;i&&(ig(e.colHeaderGroup,i,e.colHeaderGroup.firstChild),e.colHeaderGroup.setAttribute("width",e.colHeaderGroup.attribute.width+i.attribute.width),e.cornerHeaderGroup.setAttribute("width",e.cornerHeaderGroup.attribute.width-i.attribute.width))}function iu(e){let t=e.bottomFrozenGroup.firstChild instanceof ep.Z?e.bottomFrozenGroup.firstChild:null;t&&(e.leftBottomCornerGroup.appendChild(t),e.leftBottomCornerGroup.setAttribute("width",e.leftBottomCornerGroup.attribute.width+t.attribute.width),e.bottomFrozenGroup.setAttribute("width",e.bottomFrozenGroup.attribute.width-t.attribute.width),e.table.isPivotChart()&&t.forEachChildren(e=>{e.setAttributes({stroke:!1,fill:!1})}))}function ic(e){var t;let i=e.leftBottomCornerGroup.lastChild instanceof ep.Z?e.leftBottomCornerGroup.lastChild:null==(t=e.leftBottomCornerGroup.lastChild)?void 0:t._prev;i&&(ig(e.bottomFrozenGroup,i,e.bottomFrozenGroup.firstChild),e.bottomFrozenGroup.setAttribute("width",e.bottomFrozenGroup.attribute.width+i.attribute.width),e.leftBottomCornerGroup.setAttribute("width",e.leftBottomCornerGroup.attribute.width-i.attribute.width),e.table.isPivotChart()&&i.forEachChildren(t=>{var i,l,o,r;let n=e.table._getCellStyle(t.col,t.row),a=e.table.getCellRange(t.col,t.row),s=(0,V.RT)(n,e.table,a?a.start.col:t.col,a?a.start.row:t.row,X.WJ).theme;t.setAttributes({fill:null!=(l=null==(i=null==s?void 0:s.group)?void 0:i.fill)?l:void 0,stroke:null!=(r=null==(o=null==s?void 0:s.group)?void 0:o.stroke)?r:void 0})}))}function ig(e,t,i){t&&e&&(i?e.insertBefore(t,i):e.appendChild(t))}function ip(e){return e instanceof ep.Z&&"table-border-rect"!==(null==e?void 0:e.name)}var ib=i(42365);function im(e,t,i){return new ep.Z({x:0,y:0,width:e,height:t,clip:null!=i&&i,pickable:!1})}function iC(e,t){return e.forEachChildrenSkipChild((e,i)=>{e.setAttribute("x",t),t+=e.attribute.width}),t}var iv=i(45257);function iw(e,t,i,l,o){let r=e.name;ix(i,l,e=>e.name===r,e=>{(0,Q.Bg)(t,e),e.name=t.name},o),o.updateNextFrame()}function iy(e,t,i){e&&"empty"!==e.role&&e.forEachChildren(e=>{"group"===e.type?iy(e,t,i):t(e)&&i(e)})}function ix(e,t,i,l,o){let r=o.getCell(e,t);if("cell"===r.role&&(0,m.Z)(r.mergeStartCol)&&(0,m.Z)(r.mergeStartRow)&&(0,m.Z)(r.mergeEndCol)&&(0,m.Z)(r.mergeEndRow)){let{colStart:e,colEnd:t,rowStart:n,rowEnd:a}=(0,et.e)(r,o);for(let r=e;r<=t;r++)for(let e=n;e<=a;e++)iy(o.highPerformanceGetCell(r,e),i,l)}else iy(r,i,l)}function i_(e,t){let{bgColor:i,borderColor:l,borderLineWidth:o,borderLineDash:r}=t,n={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:i};return n.stroke=eF(l,void 0),n.lineWidth=o,r&&(n.lineDash=r),n.lineCap="butt",Array.isArray(l)&&(n.strokeArrayColor=(0,q.u)(l)),Array.isArray(o)&&(n.strokeArrayWidth=(0,q.u)(o),n.lineWidth=1),e.setAttributes(n),e.role="corner-frozen",e}function iS(e){let t=[];for(let i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function iR(e){let t=e.bodyColStart;function i(i){i.col=t;let l=(0,Z.Z)(e.table,i.col,i.row);l&&(i.mergeStartCol=l.start.col,i.mergeStartCol=l.start.col,i.mergeEndCol=l.end.col,i.mergeEndCol=l.end.col),i.role}e.bodyGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{i(e)}),t++}),t=e.bodyColStart,e.colHeaderGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{i(e)}),t++}),t=e.bodyColStart,e.bottomFrozenGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{i(e)}),t++})}function iH(e,t){if(t.colHeaderGroup&&t.table.columnHeaderLevelCount>0){let l=new ep.Z({x:0,y:0,width:t.table.getColWidth(e),height:0,clip:!1,pickable:!1});l.role="column",l.col=e;let o=t.getColGroup(e,!0);o?t.colHeaderGroup.insertBefore(l,o):t.colHeaderGroup.appendChild(l),i(l,e,0,t.table.columnHeaderLevelCount-1)}if(t.bodyGroup){let l=new ep.Z({x:0,y:0,width:t.table.getColWidth(e),height:0,clip:!1,pickable:!1});l.role="column",l.col=e;let o=t.getColGroup(e,!1);o?t.bodyGroup.insertBefore(l,o):t.bodyGroup.appendChild(l),i(l,e,t.bodyRowStart,t.bodyRowEnd)}if(t.bottomFrozenGroup&&t.table.bottomFrozenRowCount>0){let l=new ep.Z({x:0,y:0,width:t.table.getColWidth(e),height:0,clip:!1,pickable:!1});l.role="column",l.col=e;let o=t.getColGroupInBottom(e);o?t.bottomFrozenGroup.insertBefore(l,o):t.bottomFrozenGroup.appendChild(l),i(l,e,t.table.rowCount-t.table.bottomFrozenRowCount,t.table.rowCount-1)}function i(e,i,l,o){for(let r=l;r<=o;r++){let l=new ep.Z({x:0,y:0,width:t.table.getColWidth(i),height:t.table.getRowHeight(r)});l.role="cell",l.col=i,l.row=r,l.needUpdate=!0,e.appendChild(l)}}}(0,D.sTO)(),W.n.load(tw),W.n.load(tm.ZP);class iA{constructor(e){var t;let i,l;this._needUpdateContainer=!1,this.table=e,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,(0,iv.C)(this.table.theme.textPopTipStyle),"node"===A.X.mode?(O.rF.setEnv("node",e.options.modeParams),i=e.canvasWidth,l=e.canvasHeight):e.options.canvas&&e.options.viewBox?(O.rF.setEnv("browser"),i=e.options.viewBox.x2-e.options.viewBox.x1,l=e.options.viewBox.y2-e.options.viewBox.y1):(O.rF.setEnv("browser"),i=e.canvas.width,l=e.canvas.height),this.stage=(t=Object.assign({canvas:e.canvas,width:i,height:l,disableDirtyBounds:!1,background:e.theme.underlayBackgroundColor,dpr:e.internalProps.pixelRatio,enableLayout:!0,beforeRender:e=>{this.table.options.beforeRender&&this.table.options.beforeRender(e),this.table.animationManager.ticker.start()},afterRender:e=>{this.table.options.afterRender&&this.table.options.afterRender(e),this.table.fireListeners("after_render",null)},canvasControled:!e.options.canvas,viewBox:e.options.viewBox},e.options.renderOption),new G.H(t)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var e,t;return null!=(t=null==(e=this.tableGroup.attribute)?void 0:e.width)?t:0}get height(){var e,t;return null!=(t=null==(e=this.tableGroup.attribute)?void 0:e.height)?t:0}get x(){var e,t;return null!=(t=null==(e=this.tableGroup.attribute)?void 0:e.x)?t:0}get y(){var e,t;return null!=(t=null==(e=this.tableGroup.attribute)?void 0:e.y)?t:0}get bodyRowStart(){var e;return null!=(e=this.proxy.rowStart)?e:0}get bodyRowEnd(){var e;return null!=(e=this.proxy.rowEnd)?e:this.table.rowCount-1}get bodyColStart(){var e;return null!=(e=this.proxy.colStart)?e:0}get bodyColEnd(){var e;return null!=(e=this.proxy.colEnd)?e:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),function(e){let t=e.table.tableNoFrameWidth,i=e.table.tableNoFrameHeight;e.tableGroup=new ep.Z({x:0,y:0,width:t,height:i,clip:!0,pickable:!1}),e.tableGroup.role="table";let l=im(0,0,!e.table.internalProps.enableTreeStickCell);l.role="col-header",e.colHeaderGroup=l;let o=im(0,0,!e.table.options.enableTreeStickCell);o.role="corner-header",e.cornerHeaderGroup=o;let r=im(0,0,!0);r.role="row-header",e.rowHeaderGroup=r;let n=im(t,0,!0);n.role="body",e.bodyGroup=n;let a=im(0,0,!0);a.role="right-frozen",e.rightFrozenGroup=a;let s=im(0,0,!0);s.role="bottom-frozen",e.bottomFrozenGroup=s;let h=im(0,0);h.role="component",e.componentGroup=h;let d=im(0,0,!0);d.role="corner-right-top-header",e.rightTopCornerGroup=d;let u=im(0,0,!0);u.role="corner-right-bottom-header",e.rightBottomCornerGroup=u;let c=im(0,0,!0);c.role="corner-left-bottom-header",e.leftBottomCornerGroup=c,e.tableGroup.addChild(n),e.tableGroup.addChild(r),e.tableGroup.addChild(s),e.tableGroup.addChild(l),e.tableGroup.addChild(a),e.tableGroup.addChild(u),e.tableGroup.addChild(d),e.tableGroup.addChild(c),e.tableGroup.addChild(o),e.tableGroup.addChild(h)}(this)}clearCells(){var e,t;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(e=>{e.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),null==(e=this.proxy)||e.release(),null==(t=this.table.reactCustomLayout)||t.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new eR(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(e=!1){e||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(e=>{"poptipForText"===e.name&&this.stage.pluginService.register(e)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new t0(this.table),eA(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(i_(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),i_(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),i_(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(e,t,i){var l,o,r,n,a,s;let h;if((h=this.table.rightFrozenColCount>0&&e>=this.table.colCount-this.table.rightFrozenColCount&&t<this.table.frozenRowCount?null==(l=this.rightTopCornerGroup.getColGroup(e))?void 0:l.getRowGroup(t):this.table.bottomFrozenRowCount>0&&t>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<this.table.frozenColCount?null==(o=this.leftBottomCornerGroup.getColGroup(e))?void 0:o.getRowGroup(t):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&e>=this.table.colCount-this.table.rightFrozenColCount&&t>=this.table.rowCount-this.table.bottomFrozenRowCount?null==(r=this.rightBottomCornerGroup.getColGroup(e))?void 0:r.getRowGroup(t):this.table.rightFrozenColCount>0&&e>this.table.colCount-1-this.table.rightFrozenColCount?null==(n=this.rightFrozenGroup.getColGroup(e))?void 0:n.getRowGroup(t):this.table.bottomFrozenRowCount>0&&t>this.table.rowCount-1-this.table.bottomFrozenRowCount?null==(a=this.bottomFrozenGroup.getColGroup(e))?void 0:a.getRowGroup(t):null==(s=this.getColGroup(e,t<this.frozenRowCount))?void 0:s.getRowGroup(t))&&"shadow-cell"===h.role&&!i){let i=this.table.getCellRange(e,t);i.start.col===e&&i.start.row===t||(h=this.getCell(i.start.col,i.start.row))}return h||tx}highPerformanceGetCell(e,t,i){return this.proxy.highPerformanceGetCell(e,t,i)}getColGroup(e,t=!1){return(e<this.frozenColCount&&t?this.cornerHeaderGroup.getColGroup(e):e<this.frozenColCount?this.rowHeaderGroup.getColGroup(e):t&&this.table.rightFrozenColCount>0&&e>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(e):!t&&this.table.rightFrozenColCount>0&&e>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(e):t?this.colHeaderGroup.getColGroup(e):this.bodyGroup.getColGroup(e))||void 0}getColGroupInBottom(e,t=!1){var i;if(t){let t=null!=(i=this.getColGroupInLeftBottomCorner(e))?i:this.getColGroupInRightBottomCorner(e);if(t)return t}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(e)}getColGroupInLeftBottomCorner(e){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(e)}getColGroupInRightTopCorner(e){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(e)}getColGroupInRightBottomCorner(e){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(e)}getCellSize(e,t){let i=this.getCell(e,t),l=(0,Z.Z)(this.table,e,t),o=i.attribute.width,r=i.attribute.height;return l&&(o/=l.end.col-l.start.col+1,r/=l.end.row-l.start.row+1),{width:o,height:r}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var e,t,i,l;((null==(t=null==(e=this.table.stateManager.select)?void 0:e.ranges)?void 0:t.length)>0||(null==(l=null==(i=this.table.stateManager.select)?void 0:i.customSelectRanges)?void 0:l.length)>0)&&t1(this)}hideHoverIcon(e,t){-1!==e&&-1!==t&&(ix(e,t,e=>"mouseenter_cell"===e.attribute.visibleTime,e=>{e.setAttribute("opacity",0);let t=e.parent.getChildByName("icon-back");t&&t.setAttribute("visible",!1)},this),this.updateNextFrame())}showHoverIcon(e,t){-1!==e&&-1!==t&&(ix(e,t,e=>"mouseenter_cell"===e.attribute.visibleTime,e=>{e.setAttribute("opacity",1)},this),this.updateNextFrame())}hideClickIcon(e,t){-1!==e&&-1!==t&&(ix(e,t,e=>"click_cell"===e.attribute.visibleTime,e=>{e.setAttribute("opacity",0)},this),this.updateNextFrame())}showClickIcon(e,t){-1!==e&&-1!==t&&(ix(e,t,e=>"click_cell"===e.attribute.visibleTime,e=>{e.setAttribute("opacity",1)},this),this.updateNextFrame())}getIcon(e,t,i,l){let o;return this.getCell(e,t).forEachChildren(e=>{e.role&&e.role.startsWith("icon")&&e.containsPoint(i,l,eV.LZ.GLOBAL)&&(o=e)}),o}setIconHoverStyle(e,t,i,l){!function(e,t,i,l,o){var r,n;if((e.attribute.backgroundColor||e.attribute.hoverImage)&&ix(t,i,t=>t.name===e.name,e=>{var t,i,l,o,r,n,a,s;if(e.attribute.backgroundColor){let h=e.parent.getChildByName("icon-back");h?h.setAttributes({x:(null!=(t=e.attribute.x)?t:0)+(e.AABBBounds.width()-e.backgroundWidth)/2,y:(null!=(i=e.attribute.y)?i:0)+(e.AABBBounds.height()-e.backgroundHeight)/2,dx:null!=(l=e.attribute.dx)?l:0,dy:null!=(o=e.attribute.dy)?o:0,width:e.backgroundWidth,height:e.backgroundHeight,fill:e.attribute.backgroundColor,cornerRadius:5,visible:!0}):(h=(0,eu.f)({x:(null!=(r=e.attribute.x)?r:0)+(e.AABBBounds.width()-e.backgroundWidth)/2,y:(null!=(n=e.attribute.y)?n:0)+(e.AABBBounds.height()-e.backgroundHeight)/2,dx:null!=(a=e.attribute.dx)?a:0,dy:null!=(s=e.attribute.dy)?s:0,width:e.backgroundWidth,height:e.backgroundHeight,fill:e.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0})).name="icon-back",e.parent.insertBefore(h,e)}e.attribute.hoverImage&&e.attribute.image!==e.attribute.hoverImage&&(e.image=e.attribute.hoverImage)},o),e.tooltip){let{x1:l,x2:a,y1:s,y2:h}=e.globalAABBBounds,d={content:e.tooltip.title,referencePosition:{rect:{left:l,right:a,top:s,bottom:h,width:e.globalAABBBounds.width(),height:e.globalAABBBounds.height()},placement:e.tooltip.placement},disappearDelay:e.tooltip.disappearDelay,style:Object.assign({},null==(r=o.table.internalProps.theme)?void 0:r.tooltipStyle,null==(n=e.tooltip)?void 0:n.style)};o.table.internalProps.tooltipHandler.isBinded(d)||o.table.showTooltip(t,i,d)}}(e,t,i,0,this)}updateSortIcon(e){let{col:t,row:i,iconMark:l,order:o,oldSortCol:r,oldSortRow:n,oldIconMark:a}=e;!function(e){let{col:t,row:i,iconMark:l,order:o,oldSortCol:r,oldSortRow:n,oldIconMark:a,scene:s}=e,h=s.table.internalProps.headerHelper.getSortIcon(o,s.table,t,i);if(l&&iw(l,h,t,i,s),!function(e,t,i,l,o){let r=o.getCellRange(e,t),n=o.getCellRange(i,l);return r.start.col===n.start.col&&r.start.row===n.start.row&&r.end.col===n.end.col&&r.end.row===n.end.row}(t,i,r,n,s.table)){let e=s.table.internalProps.headerHelper.getSortIcon("normal",s.table,r,n);a?iw(a,e,r,n,s):function(e,t,i,l){let o=l.getCell(e,t);if((0,m.Z)(o.mergeStartCol)&&(0,m.Z)(o.mergeStartRow)&&(0,m.Z)(o.mergeEndCol)&&(0,m.Z)(o.mergeEndRow))for(let e=o.mergeStartCol;e<=o.mergeEndCol;e++)for(let t=o.mergeStartRow;t<=o.mergeEndRow;t++){let o;l.getCell(e,t).forEachChildren(e=>"sort"===e.attribute.funcType&&(o=e,!0)),o&&((0,Q.Bg)(i,o),o.name=i.name)}else{let e;(0,I.yW)(o,"children",t=>"sort"===t.attribute.funcType&&(e=t,!0)),e&&((0,Q.Bg)(i,e),e.name=i.name)}}(r,n,e,s)}}({col:t,row:i,iconMark:l,order:o,oldSortCol:r,oldSortRow:n,oldIconMark:a,scene:this})}updateFrozenIcon(e,t){var i=this;for(let e=0;e<i.table.colCount;e++)for(let t=0;t<i.table.columnHeaderLevelCount;t++)ix(e,t,e=>"frozen"===e.attribute.funcType,l=>{let o=i.table.internalProps.headerHelper.getFrozenIcon(e,t);(0,Q.Bg)(o,l),l.name=o.name},i)}updateHierarchyIcon(e,t){let i;i=this.table.isHeader(e,t)?this.table.internalProps.headerHelper.getHierarchyIcon(e,t):this.table.internalProps.bodyHelper.getHierarchyIcon(e,t),ix(e,t,e=>e.attribute.funcType===N.cI.collapse||e.attribute.funcType===N.cI.expand,e=>{(0,Q.Bg)(i,e),e.name=i.name},this)}setIconNormalStyle(e,t,i){(e.attribute.backgroundColor||e.attribute.hoverImage)&&ix(t,i,t=>t.name===e.name,e=>{let t=e.parent.getChildByName("icon-back");t&&t.setAttribute("visible",!1),e.attribute.hoverImage&&e.attribute.image!==e.attribute.originImage&&(e.image=e.attribute.originImage)},this)}residentHoverIcon(e,t){ix(e,t,e=>e.attribute.funcType===N.cI.dropDown,e=>{e.oldVisibleTime=e.attribute.visibleTime,e.setAttribute("visibleTime","always"),e.setAttribute("opacity",1)},this)}resetResidentHoverIcon(e,t){ix(e,t,e=>e.attribute.funcType===N.cI.dropDown,e=>{e.oldVisibleTime&&e.setAttribute("visibleTime",e.oldVisibleTime),e.setAttribute("opacity",+("always"===e.attribute.visibleTime))},this)}deactivateChart(e,t){var i,l;if(-1===e||-1===t)return;let o=this.getCell(e,t);null==(l=null==(i=null==o?void 0:o.firstChild)?void 0:i.deactivate)||l.call(i)}activateChart(e,t){var i,l,o;if(-1===e||-1===t)return;let r=this.getCell(e,t);return null==(l=null==(i=null==r?void 0:r.firstChild)?void 0:i.activate)||l.call(i,this.table),null==(o=null==r?void 0:r.firstChild)?void 0:o.activeChartInstance}removeInteractionBorder(e,t){let i=this.getCell(e,t);i.setAttribute("highlightStroke",void 0),i.setAttribute("highlightStrokeArrayWidth",void 0),i.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(e,t,i,l,o,r,n){!function(e,t,i,l,o,r,n,a){var s,h,d,u,c,g,p,f,b;let m,C=!!(null==(s=e.table.options.excelOptions)?void 0:s.fillHandle);if((null==(h=e.table.stateManager.select.ranges)?void 0:h.length)>1)C=!1,e.removeFillHandleFromSelectComponents();else if(1===(null==(d=e.table.stateManager.select.ranges)?void 0:d.length)){let t=Math.max(e.table.stateManager.select.ranges[0].start.row,e.table.stateManager.select.ranges[0].end.row),i=Math.max(e.table.stateManager.select.ranges[0].start.col,e.table.stateManager.select.ranges[0].end.col);e.table.isHeader(i,t)&&(C=!1)}Array.isArray(a)&&(!1===a[1]||!1===a[2])&&(C=!1);let v=Math.min(t,l),w=Math.min(i,o),y=Math.max(t,l),x=Math.max(i,o),_=e.highPerformanceGetCell(v,w).globalAABBBounds,S=e.highPerformanceGetCell(y,x).globalAABBBounds,R=e.table.theme,H=null==(u=R.selectionStyle)?void 0:u.cellBorderColor,A=null==(c=R.selectionStyle)?void 0:c.cellBorderLineWidth,M=(0,eu.f)({pickable:!1,fill:"replace"!==(null==(g=R.selectionStyle)?void 0:g.selectionFillMode)&&(null!=(f=null==(p=R.selectionStyle)?void 0:p.cellBgColor)?f:"rgba(0, 0, 255,0.1)"),lineWidth:A,stroke:a.map(e=>!!e&&H),x:_.x1-e.tableGroup.attribute.x,y:_.y1-e.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:function(e,t,i,l,o,r,n){if(!t)return;let a=Array.isArray(t)?t:[t,t,t,t],s=n.colCount-1,h=n.rowCount-1,d=[0,0,0,0],u=!1;return 0===i&&0===l?(d[0]=a[0],u=!0):o===s&&r===h?(d[2]=a[2],u=!0):0===i&&r===h?(d[3]=a[3],u=!0):o===s&&0===l&&(d[1]=a[1],u=!0),u?d:void 0}(0,null==(b=e.table.theme.frameStyle)?void 0:b.cornerRadius,t,i,l,o,e.table)});C&&(m=(0,eu.f)({pickable:!1,fill:H,stroke:H,x:S.x2-3,y:S.y2-3,width:6,height:6,visible:!0})),e.lastSelectId=n,e.selectingRangeComponents.set(`${v}-${w}-${y}-${x}-${n}`,{rect:M,fillhandle:m,role:r}),e.tableGroup.insertAfter(M,"body"===r?e.bodyGroup:"columnHeader"===r?e.colHeaderGroup:"rowHeader"===r?e.rowHeaderGroup:"cornerHeader"===r?e.cornerHeaderGroup:"rightTopCorner"===r?e.rightTopCornerGroup:"rightFrozen"===r?e.rightFrozenGroup:"leftBottomCorner"===r?e.leftBottomCornerGroup:"bottomFrozen"===r?e.bottomFrozenGroup:e.rightBottomCornerGroup),C&&e.tableGroup.insertAfter(m,"body"===r?e.bodyGroup:"columnHeader"===r?e.colHeaderGroup:"rowHeader"===r?e.rowHeaderGroup:"cornerHeader"===r?e.cornerHeaderGroup:"rightTopCorner"===r?e.rightTopCornerGroup:"rightFrozen"===r?e.rightFrozenGroup:"leftBottomCorner"===r?e.leftBottomCornerGroup:"bottomFrozen"===r?e.bottomFrozenGroup:e.rightBottomCornerGroup)}(this,e,t,i,l,o,r,n)}moveSelectingRangeComponentsToSelectedRangeComponents(){t4(this)}deleteLastSelectedRangeComponents(){var e;e=this,e.selectedRangeComponents.forEach((t,i)=>{var l;i.split("-")[4]===e.lastSelectId&&(t.rect.delete(),null==(l=t.fillhandle)||l.delete(),e.selectedRangeComponents.delete(i))})}deleteAllSelectBorder(){t8(this),t9(this)}updateCellSelectBorder(e,t=!0){t3(this,e,t)}removeFillHandleFromSelectComponents(){this.selectedRangeComponents.forEach((e,t)=>{var i;null==(i=e.fillhandle)||i.delete(),e.fillhandle=void 0})}recreateAllSelectRangeComponents(){t8(this),this.table.stateManager.select.ranges.forEach(e=>{t3(this,e),t4(this)})}updateColWidth(e,t,i,l){(function(e,t,i,l){l||e.table._setColWidth(t,e.table.getColWidth(t)+i,!0);let o=e.getColGroup(t,!0),r=e.getColGroupInRightTopCorner(t);o&&!r&&en(o,i,"col-corner",e),r&&en(r,i,"right-top",e);let n=e.getColGroup(t);n&&en(n,i,"row-body",e);let a=e.getColGroupInLeftBottomCorner(t);a&&en(a,i,"left-bottom",e);let s=e.getColGroupInBottom(t);s&&en(s,i,"bottom",e);let h=e.getColGroupInRightBottomCorner(t);h&&en(h,i,"right-bottom",e),t<e.frozenColCount?(e.cornerHeaderGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)}),e.rowHeaderGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)})):(e.colHeaderGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)}),e.bodyGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)})),a&&e.leftBottomCornerGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)}),s&&e.bottomFrozenGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)}),h&&e.rightBottomCornerGroup.forEachChildrenSkipChild((e,l)=>{e.col>t&&e.setAttribute("x",e.attribute.x+i)})})(this,e,Math.round(t),l),i||this.updateContainer(!0)}updateChartSizeForResizeColWidth(e){(0,ib.s9)(this,e)}updateChartSizeForResizeRowHeight(e){(0,ib.kl)(this,e)}updateChartState(e){this.table.isPivotChart()&&(0,ib.s8)(this,e)}updateCheckboxCellState(e,t,i){var l,o;if(this.table.transpose)null==(l=this.bodyGroup.children)||l.forEach(e=>{var l;null==(l=e.getChildAt(t))||l.getChildren().forEach(e=>{"checkbox"===e.name&&("indeterminate"===i?(e.setAttribute("indeterminate",!0),e.setAttribute("checked",void 0)):(e.setAttribute("indeterminate",void 0),e.setAttribute("checked",i))),"checkbox-content"===e.name&&("indeterminate"===i?(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})});else{let t=this.getColGroup(e);null==(o=null==t?void 0:t.children)||o.forEach(e=>{e.getChildren().find(e=>{"checkbox"===e.name&&("indeterminate"===i?(e.setAttribute("indeterminate",!0),e.setAttribute("checked",void 0)):(e.setAttribute("indeterminate",void 0),e.setAttribute("checked",i))),"checkbox-content"===e.name&&("indeterminate"===i?(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}}updateHeaderCheckboxCellState(e,t,i){var l,o;this.table.transpose?null==(l=this.rowHeaderGroup.children)||l.forEach(e=>{e.getChildAt(t).getChildren().forEach(e=>{"checkbox"===e.name&&("indeterminate"===i?(e.setAttribute("indeterminate",!0),e.setAttribute("checked",void 0)):(e.setAttribute("indeterminate",void 0),e.setAttribute("checked",i))),"checkbox-content"===e.name&&("indeterminate"===i?(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})}):null==(o=this.getColGroup(e,!0).children)||o.forEach(e=>{e.getChildren().find(e=>{"checkbox"===e.name&&("indeterminate"===i?(e.setAttribute("indeterminate",!0),e.setAttribute("checked",void 0)):(e.setAttribute("indeterminate",void 0),e.setAttribute("checked",i))),"checkbox-content"===e.name&&("indeterminate"===i?(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(e._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),e._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}updateAutoColWidth(e){this.table.internalProps._widthResizedColMap.delete(e);let t=this.table.getColWidth(e),i=(0,ty.al)(e,0,this.table.rowCount-1,this.table,!0);i!==t&&this.updateColWidth(e,i-t)}recalculateColWidths(){let e=this.table;"adaptive"===e.widthMode||e.autoFillWidth||e.internalProps.transpose?(0,ty.rj)(this.table,0,this.table.colCount-1,!0):(e._clearColRangeWidthsMap(),e.frozenColCount>0&&(0,ty.rj)(this.table,0,e.frozenColCount-1,!0),e.rightFrozenColCount>0&&(0,ty.rj)(this.table,e.rightFrozenColCount,e.colCount-1,!0),(0,ty.rj)(e,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){let e=this.table;e.internalProps.useOneRowHeightFillAll=!1,"adaptive"===e.heightMode||e.autoFillHeight?(0,ee.Y)(this.table,0,this.table.rowCount-1,!0,!0):(e.frozenRowCount>0&&(0,ee.Y)(this.table,0,e.frozenRowCount-1,!0,!0),e.bottomFrozenRowCount>0&&(0,ee.Y)(this.table,e.bottomFrozenRowCount,e.rowCount-1,!0,!0),(0,ee.Y)(e,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var e,t;this.proxy.resize(),("adaptive"===this.table.widthMode||this.table.autoFillWidth)&&(0===this.table.internalProps._widthResizedColMap.size?this.recalculateColWidths():this.dealWidthMode()),"adaptive"===this.table.heightMode?0===this.table.internalProps._heightResizedRowMap.size?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),("adaptive"===this.table.widthMode||"adaptive"===this.table.heightMode||this.table.autoFillWidth||this.table.autoFillHeight||(null==(e=this.table.containerFit)?void 0:e.width)||(null==(t=this.table.containerFit)?void 0:t.height))&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var e,t,i,l,o,r,n,a,s,h,d,u,c,g,p;let f=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),b=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0),m=f,C=b;if(m=(null==(e=this.table.containerFit)?void 0:e.width)?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,f),C=(null==(t=this.table.containerFit)?void 0:t.height)?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,b),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:m,height:C}),this.tableGroup.border){let e,t,f,b,m=null==(i=this.tableGroup.border)?void 0:i.attribute;(null==m?void 0:m.strokeArrayWidth)?(e=m.strokeArrayWidth?m.strokeArrayWidth[0]:null!=(l=m.lineWidth)?l:0,t=m.strokeArrayWidth?m.strokeArrayWidth[1]:null!=(o=m.lineWidth)?o:0,f=m.strokeArrayWidth?m.strokeArrayWidth[2]:null!=(r=m.lineWidth)?r:0,b=m.strokeArrayWidth?m.strokeArrayWidth[3]:null!=(n=m.lineWidth)?n:0):(e=null!=(a=null==m?void 0:m.lineWidth)?a:0,t=null!=(s=null==m?void 0:m.lineWidth)?s:0,f=null!=(h=null==m?void 0:m.lineWidth)?h:0,b=null!=(d=null==m?void 0:m.lineWidth)?d:0),"rect"===this.tableGroup.border.type?(null==(u=this.table.theme.frameStyle)?void 0:u.innerBorder)?this.tableGroup.border.setAttributes({x:this.table.tableX+b/2,y:this.table.tableY+e/2,width:this.tableGroup.attribute.width-b/2-t/2,height:this.tableGroup.attribute.height-e/2-f/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-b/2,y:this.table.tableY-e/2,width:this.tableGroup.attribute.width+b/2+t/2,height:this.tableGroup.attribute.height+e/2+f/2}):"group"===this.tableGroup.border.type&&((null==(c=this.table.theme.frameStyle)?void 0:c.innerBorder)?(this.tableGroup.border.setAttributes({x:this.table.tableX+b/2,y:this.table.tableY+e/2,width:this.tableGroup.attribute.width-b/2-t/2,height:this.tableGroup.attribute.height-e/2-f/2}),null==(g=this.tableGroup.border.firstChild)||g.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-b/2-t/2,height:this.tableGroup.attribute.height-e/2-f/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-b/2,y:this.table.tableY-e/2,width:this.tableGroup.attribute.width+b/2+t/2,height:this.tableGroup.attribute.height+e/2+f/2}),null==(p=this.tableGroup.border.firstChild)||p.setAttributes({x:b/2,y:e/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(e,t,i){ei(this,e,t=Math.round(t),i),this.updateContainerHeight(e,t)}updateRowsHeight(e,t,i){for(let l=0;l<e.length;l++){let o=e[l];if(o>=this.proxy.rowStart&&o<=this.proxy.rowEnd){let e=t[l];ei(this,o,Math.round(e),i),this._updateContainerHeight(o,e)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(e,t){e<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(t),this.cornerHeaderGroup.setDeltaWidth(t),this.colHeaderGroup.setDeltaX(t),this.bodyGroup.setDeltaX(t)):(this.colHeaderGroup.setDeltaWidth(t),this.bodyGroup.setDeltaWidth(t)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(e,t){e<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(t),this.cornerHeaderGroup.setDeltaHeight(t),this.rowHeaderGroup.setDeltaY(t),this.bodyGroup.setDeltaY(t),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(t)):e>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(t),this.bottomFrozenGroup.setDeltaHeight(t),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(t)):(this.rowHeaderGroup.setDeltaHeight(t),this.bodyGroup.setDeltaHeight(t),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(t))}updateContainerHeight(e,t){this._updateContainerHeight(e,t),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(e,t){let i=this.table.getColWidth(e);i!==t&&(this.updateColWidth(e,t-i),this.table._clearColRangeWidthsMap(e))}setRowHeight(e,t){let i=this.table.getRowHeight(e);i!==t&&((e>=this.proxy.rowStart&&e<=this.proxy.rowEnd||e>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<=this.table.rowCount-1||e<this.table.frozenRowCount)&&this.updateRowHeight(e,t-i),this.table._clearRowRangeHeightsMap(e))}setX(e,t=!1){this.table.scenegraph.proxy.setX(-e,t)}setY(e,t=!1){this.table.scenegraph.proxy.setY(-e,t)}setBodyAndRowHeaderY(e){var t,i,l,o,r,n;let a=null!=(i=null==(t=this.bodyGroup.firstChild)?void 0:t.firstChild)?i:null==(l=this.rowHeaderGroup.firstChild)?void 0:l.firstChild,s=null!=(r=null==(o=this.bodyGroup.firstChild)?void 0:o.lastChild)?r:null==(n=this.rowHeaderGroup.firstChild)?void 0:n.lastChild;0===e&&a&&a.row===this.table.frozenRowCount&&a.attribute.y+e<0?e=-a.attribute.y:s&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&s.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&s.attribute.y+s.attribute.height+e<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(e=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-s.attribute.y-s.attribute.height),this.colHeaderGroup.attribute.height+e!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+e),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+e),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+e),this.updateNextFrame())}setBodyAndColHeaderX(e){let t=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;0===e&&t&&t.col===this.table.frozenColCount&&t.attribute.x+e<0?e=-t.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+e<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(e=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+e!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+e),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+e),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+e),this.updateNextFrame())}afterScenegraphCreated(){this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),tU(this.table),this.table.options.animationAppear&&function(e){var t,i,l,o;let r,n,a,s;if(!e.options.animationAppear)return;!0===e.options.animationAppear?(r=500,n=0,a="one-by-one",s="column"):(r=null!=(t=e.options.animationAppear.duration)?t:500,n=null!=(i=e.options.animationAppear.delay)?i:0,a=null!=(l=e.options.animationAppear.type)?l:"one-by-one",s=null!=(o=e.options.animationAppear.direction)?o:"row");let{scenegraph:h,frozenColCount:d,frozenRowCount:u}=e,{colStart:c,colEnd:g,rowStart:p,rowEnd:f}=h.proxy;for(let e=0;e<=g;e++)for(let t=0;t<=f;t++){let i=h.highPerformanceGetCell(e,t);i&&"cell"===i.role&&i.forEachChildren(i=>{i.setAttribute("opacity",0),i.animate().wait("one-by-one"===a?("row"===s?t:e)*(r-n):n).to({opacity:1},r,"linear")})}}(this.table),this.updateNextFrame()}dealWidthMode(){let e=this.table;if("adaptive"===e.widthMode){e._clearColRangeWidthsMap();let t=e.tableNoFrameWidth,i=0,l=0,o=e.colCount;if("only-body"===e.widthAdaptiveMode){for(let t=0;t<e.colCount;t++)(t<e.rowHeaderLevelCount||e.isPivotChart()&&t>=e.colCount-e.rightFrozenColCount)&&(i+=e.getColWidth(t));l=e.rowHeaderLevelCount,o=e.isPivotChart()?e.colCount-e.rightFrozenColCount:e.colCount}(0,ty.j8)(t-i,l,o,!1,[],e,!0)}else if(e.autoFillWidth){e._clearColRangeWidthsMap();let t=e.tableNoFrameWidth,i=0,l=0;for(let t=0;t<e.colCount;t++){let o=e.getColWidth(t);(t<e.rowHeaderLevelCount||e.isPivotChart()&&t>=e.colCount-e.rightFrozenColCount)&&(i+=o),l+=o}if(l<t&&l>i){let l=e.rowHeaderLevelCount,o=e.isPivotChart()?e.colCount-e.rightFrozenColCount:e.colCount;(0,ty.j8)(t-i,l,o,!1,[],e,!0)}}let t=0;this.bodyGroup.forEachChildrenSkipChild(e=>{t+=e.attribute.width}),this.bodyGroup.setAttribute("width",t);let i=0;this.colHeaderGroup.forEachChildrenSkipChild(e=>{i+=e.attribute.width}),this.colHeaderGroup.setAttribute("width",i);let l=0;this.rowHeaderGroup.forEachChildrenSkipChild(e=>{l+=e.attribute.width}),this.rowHeaderGroup.setAttribute("width",l);let o=0;this.cornerHeaderGroup.forEachChildrenSkipChild(e=>{o+=e.attribute.width}),this.cornerHeaderGroup.setAttribute("width",o),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var e;let t=this.table;if("adaptive"===t.heightMode){t._clearRowRangeHeightsMap();let e=t.getRowsHeight(0,t.columnHeaderLevelCount-1),i=t.isPivotChart()?t.getBottomFrozenRowsHeight():0,l=t.tableNoFrameHeight-e-i,o=t.columnHeaderLevelCount,r=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount,n=0;for(let e=o;e<r;e++)n+=t.getRowHeight(e);let a=l/n;for(let e=o;e<r;e++){let i;i=e===r-1?l-t.getRowsHeight(o,r-2):Math.round(t.getRowHeight(e)*a),this.setRowHeight(e,i)}}else if(t.autoFillHeight){t._clearRowRangeHeightsMap();let i=t.tableNoFrameHeight,l=0,o=0;for(let e=0;e<t.rowCount;e++){let i=t.getRowHeight(e);(e<t.columnHeaderLevelCount||t.isPivotChart()&&e>=t.rowCount-t.bottomFrozenRowCount)&&(o+=i),l+=i}if((null!=(e=this._dealAutoFillHeightOriginRowsHeight)?e:l)<i&&l-o>0){let e=t.columnHeaderLevelCount,r=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount,n=(i-o)/(l-o);for(let l=e;l<r;l++){let a;a=l===r-1?i-o-t.getRowsHeight(e,r-2):Math.round(t.getRowHeight(l)*n),this.setRowHeight(l,a)}}}}dealFrozen(){!function(e){var t,i,l,o;if(e.table.frozenColCount>e.table.rowHeaderLevelCount){e.rowHeaderGroup.setAttribute("height",e.bodyGroup.attribute.height),e.rowHeaderGroup.setAttribute("y",e.bodyGroup.attribute.y),e.cornerHeaderGroup.setAttribute("height",e.colHeaderGroup.attribute.height);for(let t=0;t<e.table.frozenColCount-e.table.rowHeaderLevelCount;t++)ia(e),is(e),iu(e)}else if(e.table.frozenColCount<e.table.rowHeaderLevelCount){e.bodyGroup.setAttribute("height",e.rowHeaderGroup.attribute.height),e.bodyGroup.setAttribute("y",e.rowHeaderGroup.attribute.y),e.colHeaderGroup.setAttribute("height",e.cornerHeaderGroup.attribute.height);for(let t=0;t<e.table.rowHeaderLevelCount-e.table.frozenColCount;t++)ih(e),id(e),ic(e)}e.bodyGroup.setAttribute("x",e.rowHeaderGroup.attribute.width),e.colHeaderGroup.setAttribute("x",e.cornerHeaderGroup.attribute.width),e.updateContainer(),e.updateBorderSizeAndPosition(),e.isPivot||e.table.transpose?e.table.options.frozenColCount?e.component.setFrozenColumnShadow(e.table.frozenColCount-1):e.table.options.frozenColCount&&e.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):(e.component.setFrozenColumnShadow(e.table.frozenColCount-1),e.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount)),e.hasFrozen=!0,e.frozenColCount=e.table.frozenColCount,e.frozenRowCount=null!=(o=null!=(i=null==(t=e.colHeaderGroup.firstChild)?void 0:t.childrenCount)?i:null==(l=e.cornerHeaderGroup.firstChild)?void 0:l.childrenCount)?o:e.table.frozenRowCount}(this)}resetFrozen(){!function(e){var t,i,l,o,r,n;if(e.frozenColCount>e.table.frozenColCount){e.bodyGroup.setAttribute("height",e.rowHeaderGroup.attribute.height),e.bodyGroup.setAttribute("y",e.rowHeaderGroup.attribute.y),e.colHeaderGroup.setAttribute("height",e.cornerHeaderGroup.attribute.height);for(let t=0;t<e.frozenColCount-e.table.frozenColCount;t++)ih(e),id(e),ic(e)}else if(e.frozenColCount<e.table.frozenColCount){e.rowHeaderGroup.setAttribute("height",e.bodyGroup.attribute.height),e.rowHeaderGroup.setAttribute("y",e.bodyGroup.attribute.y),e.cornerHeaderGroup.setAttribute("height",e.colHeaderGroup.attribute.height);for(let t=0;t<e.table.frozenColCount-e.frozenColCount;t++)ia(e),is(e),iu(e)}ir(e),e.recreateAllSelectRangeComponents(),e.frozenColCount=e.table.frozenColCount,e.frozenRowCount=null!=(o=null!=(i=null==(t=e.colHeaderGroup.firstChild)?void 0:t.childrenCount)?i:null==(l=e.cornerHeaderGroup.firstChild)?void 0:l.childrenCount)?o:e.table.frozenRowCount,e.proxy.colStart=null!=(n=null==(r=e.bodyGroup.firstChild)?void 0:r.col)?n:e.table.frozenColCount,e.bodyGroup.setAttribute("x",e.rowHeaderGroup.attribute.width),e.colHeaderGroup.setAttribute("x",e.cornerHeaderGroup.attribute.width),e.updateContainer(),e.updateBorderSizeAndPosition(),e.isPivot||e.table.transpose?e.table.options.frozenColCount?e.component.setFrozenColumnShadow(e.table.frozenColCount-1):e.table.options.rightFrozenColCount&&e.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):(e.component.setFrozenColumnShadow(e.table.frozenColCount-1),e.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount)),e.hasFrozen=!0}(this)}resetRowFrozen(){!function(e){var t,i,l,o,r;if(e.frozenRowCount>e.table.frozenRowCount){e.bodyGroup.setAttribute("width",e.colHeaderGroup.attribute.width),e.bodyGroup.setAttribute("x",e.colHeaderGroup.attribute.x),e.rowHeaderGroup.setAttribute("width",e.cornerHeaderGroup.attribute.width);for(let t=0;t<e.frozenRowCount-e.table.frozenRowCount;t++)(function(e){let t=!1;for(let i=0;i<e.colHeaderGroup.childrenCount;i++){let l=e.colHeaderGroup.children[i];if(!ip(l))continue;let o=e.bodyGroup.children[i];if(!o)continue;let r=l.lastChild;ig(o,r,o.firstChild),t||(e.colHeaderGroup.setAttribute("height",e.colHeaderGroup.attribute.height-r.attribute.height),e.bodyGroup.setAttribute("height",e.bodyGroup.attribute.height+r.attribute.height),t=!0)}})(e),function(e){let t=!1;for(let i=0;i<e.cornerHeaderGroup.childrenCount;i++){let l=e.cornerHeaderGroup.children[i];if(!ip(l))continue;let o=e.rowHeaderGroup.children[i];if(!o)continue;let r=l.lastChild;ig(o,r,o.firstChild),t||(e.cornerHeaderGroup.setAttribute("height",e.cornerHeaderGroup.attribute.height-r.attribute.height),e.rowHeaderGroup.setAttribute("height",e.rowHeaderGroup.attribute.height+r.attribute.height),t=!0)}}(e),function(e){let t=!1;for(let i=0;i<e.rightTopCornerGroup.childrenCount;i++){let l=e.rightTopCornerGroup.children[i];if(!ip(l))continue;let o=e.rightFrozenGroup.children[i];if(!o)continue;let r=l.lastChild;ig(o,r,o.firstChild),t||(e.rightTopCornerGroup.setAttribute("height",e.rightTopCornerGroup.attribute.height-r.attribute.height),e.rightFrozenGroup.setAttribute("height",e.rightFrozenGroup.attribute.height+r.attribute.height),t=!0)}}(e)}else if(e.frozenRowCount<e.table.frozenRowCount){e.colHeaderGroup.setAttribute("width",e.bodyGroup.attribute.width),e.colHeaderGroup.setAttribute("x",e.bodyGroup.attribute.x),e.cornerHeaderGroup.setAttribute("width",e.rowHeaderGroup.attribute.width);for(let t=0;t<e.table.frozenRowCount-e.frozenRowCount;t++)(function(e){var t;let i=!1;for(let l=0;l<e.bodyGroup.childrenCount;l++){let o=e.bodyGroup.children[l];if(!ip(o))continue;let r=o.firstChild;null==(t=e.colHeaderGroup.children[l])||t.appendChild(r),i||(e.colHeaderGroup.setAttribute("height",e.colHeaderGroup.attribute.height+r.attribute.height),e.bodyGroup.setAttribute("height",e.bodyGroup.attribute.height-r.attribute.height),i=!0)}})(e),function(e){var t;let i=!1;for(let l=0;l<e.rowHeaderGroup.childrenCount;l++){let o=e.rowHeaderGroup.children[l];if(!ip(o))continue;let r=o.firstChild;null==(t=e.cornerHeaderGroup.children[l])||t.appendChild(r),i||(e.cornerHeaderGroup.setAttribute("height",e.cornerHeaderGroup.attribute.height+r.attribute.height),e.rowHeaderGroup.setAttribute("height",e.rowHeaderGroup.attribute.height-r.attribute.height),i=!0)}}(e),function(e){var t;let i=!1;for(let l=0;l<e.rightFrozenGroup.childrenCount;l++){let o=e.rightFrozenGroup.children[l];if(!ip(o))continue;let r=o.firstChild;null==(t=e.rightTopCornerGroup.children[l])||t.appendChild(r),i||(e.rightTopCornerGroup.setAttribute("height",e.rightTopCornerGroup.attribute.height+r.attribute.height),e.rightFrozenGroup.setAttribute("height",e.rightFrozenGroup.attribute.height-r.attribute.height),i=!0)}}(e)}ir(e),e.recreateAllSelectRangeComponents(),e.frozenRowCount=e.table.frozenRowCount,e.frozenColCount=null!=(i=null==(t=e.rowHeaderGroup)?void 0:t.childrenCount)?i:0,e.proxy.rowStart=null!=(r=null==(o=null==(l=e.bodyGroup.firstChild)?void 0:l.firstChild)?void 0:o.row)?r:e.table.frozenRowCount,e.bodyGroup.setAttribute("y",e.colHeaderGroup.attribute.height),e.rowHeaderGroup.setAttribute("y",e.cornerHeaderGroup.attribute.height),e.updateContainer(),e.updateBorderSizeAndPosition(),e.hasFrozen=!0}(this)}updateCellLayoutWidthCertainWidth(e,t,i){let l=e.attribute.width,o=!1;return e.forEachChildren((e,r)=>{r+=t;let n=(0,Z.Z)(this.table,i,r);n?e=this.getCell(n.start.col,n.start.row):e.setAttribute("width",l);let a=this.table._getCellStyle(i,r),s=(0,q.u)((0,X.WJ)("padding",a,i,r,this.table)),h=e.getChildByName("text"),d=0,u=0;if(h)d=h.AABBBounds.height()+(s[0]+s[2]),h.setAttribute("maxLineWidth",l-(s[1]+s[3])),u=h.AABBBounds.height()+(s[0]+s[2]);else{let t=e.getChildAt(1);d=t.AABBBounds.height()+(s[0]+s[2]),t._cellWidth=l-(s[1]+s[3]),t.layout(),u=t.AABBBounds.height()+(s[0]+s[2])}let c=this.table.getRowHeight(r);e.attribute.height!==u&&(e.setAttribute("height",u),(c===d||u>c)&&(o=!0))}),o}updateHeaderPosition(e,t,i,l,o){!function(e,t,i,l,o,r){let n=r.scenegraph;for(let i=e;i<=t;i++){let e=r.getColWidth(i),t=r.scenegraph.getColGroup(i,!0),l=r.scenegraph.getColGroup(i),o=r.scenegraph.getColGroupInBottom(i),n=r.scenegraph.getColGroupInLeftBottomCorner(i),a=r.scenegraph.getColGroupInRightBottomCorner(i);t&&(t.setAttribute("width",e),t.forEachChildren(t=>{t.setAttribute("width",e)})),l&&(l.setAttribute("width",e),l.forEachChildren(t=>{t.setAttribute("width",e)})),o&&(o.setAttribute("width",e),o.forEachChildren(t=>{t.setAttribute("width",e)})),a&&(a.setAttribute("width",e),a.forEachChildren(t=>{t.setAttribute("width",e)})),n&&(n.setAttribute("width",e),n.forEachChildren(t=>{t.setAttribute("width",e)}))}if(n.updateContainer(),"column"===o)for(let i=e;i<=t;i++){let e=r.scenegraph.getColGroup(i);null==e||e.setAttribute("chartInstance",void 0);for(let e=0;e<=r.frozenRowCount-1;e++)n.updateCellContent(i,e);for(let e=n.bodyRowStart;e<=n.bodyRowEnd;e++)n.updateCellContent(i,e);for(let e=r.rowCount-r.bottomFrozenRowCount;e<=r.rowCount-1;e++)n.updateCellContent(i,e)}else{for(let e=0;e<=r.frozenColCount-1;e++){let t=r.scenegraph.getColGroup(e);null==t||t.setAttribute("chartInstance",void 0);for(let t=i;t<=l;t++)n.updateCellContent(e,t)}for(let e=n.bodyColStart;e<=n.bodyColEnd;e++){let t=r.scenegraph.getColGroup(e);null==t||t.setAttribute("chartInstance",void 0);for(let t=i;t<=l;t++)n.updateCellContent(e,t)}for(let e=r.colCount-r.rightFrozenColCount;e<=r.colCount-1;e++){let t=r.scenegraph.getColGroup(e);null==t||t.setAttribute("chartInstance",void 0);for(let t=i;t<=l;t++)n.updateCellContent(e,t)}}}(e,t,i,l,o,this.table)}updateContainerAttrWidthAndX(){var e,t,i;let l=iC(this.cornerHeaderGroup,0),o=iC(this.rowHeaderGroup,0),r=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?iC(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth(null!=(e=this.table.frozenColCount)?e:0,this.colHeaderGroup.firstChild.col-1):0):0,n=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?iC(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth(null!=(t=this.table.frozenColCount)?t:0,this.bodyGroup.firstChild.col-1):0):0,a=iC(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&iC(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth(null!=(i=this.table.frozenColCount)?i:0,this.bottomFrozenGroup.firstChild.col-1):0),iC(this.leftBottomCornerGroup,0),iC(this.rightTopCornerGroup,0),iC(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(l-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(l-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(r-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(o-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(r-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(a-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(a-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(a-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(n-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainer(e=!1){e?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{this.updateContainerSync()},0)):(this._needUpdateContainer=!0,this.updateContainerSync())}updateContainerSync(){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(e,t){var i;let l=(null==(i=this.table.getCellRawRecord(e,t))?void 0:i.vtableMerge)?"text":this.table.isHeader(e,t)?this.table._getHeaderLayoutMap(e,t).headerType:this.table.getBodyColumnType(e,t),o=this.getCell(e,t);"image"!==l&&"video"!==l||(0,U.km)(o,e,t,0,0,this.table)}createFrameBorder(){var e,t,i,l,o;this.updateTableSize();let r=!this.isPivot&&!this.table.internalProps.transpose;eA(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,r?[!0,!0,!0,!1]:void 0),eA(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,r?[!0,!1,!0,!0]:void 0),eA(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,r?[!0,!0,!0,!1]:void 0),eA(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,r?[!0,!1,!0,!0]:void 0),(null==(e=this.table.theme.cornerLeftBottomCellStyle)?void 0:e.frameStyle)&&eA(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,r?[!0,!1,!0,!0]:void 0),(null==(t=this.table.theme.bottomFrozenStyle)?void 0:t.frameStyle)&&eA(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,r?[!0,!0,!0,!1]:void 0),(null==(i=this.table.theme.rightFrozenStyle)?void 0:i.frameStyle)&&eA(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),(null==(l=this.table.theme.cornerRightTopCellStyle)?void 0:l.frameStyle)&&eA(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),(null==(o=this.table.theme.cornerRightBottomCellStyle)?void 0:o.frameStyle)&&eA(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),eA(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(e,t,i){let l,o=this.table.theme.columnResize.resizeHotSpotSize/2;if(!i){let i=this.table.getDrawRange();return t>=i.top&&t<=i.bottom&&(l=this.table.getCellAtRelativePosition(e-o,t)).col===this.table.colCount-1?l:{col:-1,row:-1}}return i.stage?(e<i.globalAABBBounds.x1+o?l={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-o<e&&(l={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),l&&this.table.rightFrozenColCount>0&&l.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(l.col=l.col+1,l.rightFrozen=!0),l||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(e,t,i){let l=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let e;if(t<i.globalAABBBounds.y1+l?e={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-l<t&&(e={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),e&&this.table.bottomFrozenRowCount>0&&e.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(e.row=e.row+1,e.bottomFrozen=!0),e)return e}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(e){this.clear?this.table.internalProps.rightFrozenColCount=e:function(e,t){let{table:i,proxy:l,rightTopCornerGroup:o,rightFrozenGroup:r,rightBottomCornerGroup:n,bottomFrozenGroup:a,bodyGroup:s,colHeaderGroup:h}=t,d=t.table.rightFrozenColCount;if(e>d){for(let l=i.colCount-d-1;l>=i.colCount-e;l--)ig(r,t.getColGroup(l),r.firstChild),ig(o,t.getColGroup(l,!0),o.firstChild),ig(n,t.getColGroupInBottom(l),n.firstChild);let l=0;r.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width}),l=0,o.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width}),l=0,n.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width})}else if(e<d){for(let l=i.colCount-d;l<i.colCount-e;l++){let e=t.getColGroup(l);e.setAttribute("x",s.lastChild.attribute.x+i.getColWidth(s.lastChild.col)),s.appendChild(e);let o=t.getColGroupInRightTopCorner(l);o.setAttribute("x",h.lastChild.attribute.x+i.getColWidth(h.lastChild.col)),h.appendChild(o);let r=t.getColGroupInRightBottomCorner(l);r.setAttribute("x",a.lastChild.attribute.x+i.getColWidth(a.lastChild.col)),a.appendChild(r)}let l=0;r.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width}),l=0,o.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width}),l=0,n.forEachChildren(e=>{e.setAttribute("x",l),l+=e.attribute.width})}r.setAttribute("width",i.getColsWidth(i.colCount-e,i.colCount-1)),o.setAttribute("width",i.getColsWidth(i.colCount-e,i.colCount-1)),n.setAttribute("width",i.getColsWidth(i.colCount-e,i.colCount-1)),i.internalProps.rightFrozenColCount=e,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}(e,this)}dealWidthBottomFrozen(e){this.clear?this.table.internalProps.bottomFrozenRowCount=e:function(e,t){let{table:i,proxy:l,bottomFrozenGroup:o,leftBottomCornerGroup:r,rightBottomCornerGroup:n}=t;o.childrenCount||(l.table.isPivotChart()||(tA(r,0,0,0,i.frozenColCount-1,0,-1,"rowHeader",i),tA(n,0,0,i.colCount-i.rightFrozenColCount,i.colCount-1,0,-1,"body",i)),tA(o,0,0,l.colStart,l.colEnd,0,-1,"body",i));let a=t.table.bottomFrozenRowCount;if(e>a){for(let l=0;l<i.frozenColCount;l++){let o=t.getColGroupInLeftBottomCorner(l);for(let r=i.rowCount-a-1;r>=i.rowCount-e;r--)ig(o,t.getCell(l,r,!0),o.firstChild);let r=0;o.forEachChildren(e=>{e.setAttribute("y",r),r+=i.getRowHeight(e.row)})}for(let o=l.colStart;o<=l.colEnd;o++){let l=t.getColGroupInBottom(o);for(let r=i.rowCount-a-1;r>=i.rowCount-e;r--)ig(l,t.getCell(o,r,!0),l.firstChild);let r=0;l.forEachChildren(e=>{e.setAttribute("y",r),r+=i.getRowHeight(e.row)})}if(i.rightFrozenColCount>0)for(let l=i.colCount-i.rightFrozenColCount;l<i.colCount;l++){let o=t.getColGroupInRightBottomCorner(l);for(let r=i.rowCount-a-1;r>=i.rowCount-e;r--)ig(o,t.getCell(l,r,!0),o.firstChild);let r=0;o.forEachChildren(e=>{e.setAttribute("y",r),r+=i.getRowHeight(e.row)})}}else if(e<a){for(let l=0;l<i.rowHeaderLevelCount;l++){let o=t.getColGroup(l);for(let r=i.rowCount-a;r<i.rowCount-e;r++){let e=t.getCell(l,r,!0);e.setAttribute("y",o.lastChild.attribute.y+i.getRowHeight(o.lastChild.row)),o.appendChild(e)}let r=t.getColGroupInLeftBottomCorner(l),n=0;r.forEachChildren(e=>{e.setAttribute("y",n),n+=i.getRowHeight(e.row)})}for(let o=l.colStart;o<=l.colEnd;o++){let l=t.getColGroup(o);for(let r=i.rowCount-a;r<i.rowCount-e;r++){let e=t.getCell(o,r,!0);e.setAttribute("y",l.lastChild.attribute.y+i.getRowHeight(l.lastChild.row)),l.appendChild(e)}let r=t.getColGroupInBottom(o),n=0;r.forEachChildren(e=>{e.setAttribute("y",n),n+=i.getRowHeight(e.row)})}if(i.rightFrozenColCount>0)for(let l=i.colCount-i.rightFrozenColCount;l<i.colCount;l++){let o=t.getColGroup(l);for(let r=i.rowCount-a;r<i.rowCount-e;r++){let e=t.getCell(l,r,!0);e.setAttribute("y",o.lastChild.attribute.y+i.getRowHeight(o.lastChild.row)),o.appendChild(e)}let r=t.getColGroupInRightBottomCorner(l),n=0;r.forEachChildren(e=>{e.setAttribute("y",n),n+=i.getRowHeight(e.row)})}}o.setAttribute("height",i.getRowsHeight(i.rowCount-e,i.rowCount-1)),r.setAttribute("height",i.getRowsHeight(i.rowCount-e,i.rowCount-1)),n.setAttribute("height",i.getRowsHeight(i.rowCount-e,i.rowCount-1)),i.internalProps.bottomFrozenRowCount=e,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}(e,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),eB(this.bodyGroup),this.rowHeaderGroup.attribute.width,eM(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),eB(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,eM(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),eB(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),eB(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),eB(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),eB(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),eB(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),eB(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),eB(this.rightBottomCornerGroup)),function(e){if(!e.theme.frameStyle.cornerRadius)return;let t=e.theme.frameStyle.cornerRadius,{cornerHeaderGroup:i,colHeaderGroup:l,rowHeaderGroup:o,bodyGroup:r,rightTopCornerGroup:n,leftBottomCornerGroup:a,rightBottomCornerGroup:s,rightFrozenGroup:h,bottomFrozenGroup:d}=e.scenegraph;i.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),n.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0),d.setAttribute("cornerRadius",0);let u=(0,T.JO)(t);i.attribute.width>0&&i.attribute.height>0?eT(i,[u[0],0,0,0]):l.attribute.height>0?eT(l,[u[0],0,0,0]):o.attribute.width>0?eT(o,[u[0],0,0,0]):eT(r,[u[0],0,0,0]),a.attribute.width>0&&a.attribute.height>0?eT(a,[0,0,0,u[3]]):d.attribute.height>0?eT(d,[0,0,0,u[3]]):o.attribute.width>0?eT(o,[0,0,0,u[3]]):eT(r,[0,0,0,u[3]]),n.attribute.width>0&&n.attribute.height>0?eT(n,[0,u[1],0,0]):l.attribute.height>0?eT(l,[0,u[1],0,0]):h.attribute.width>0?eT(h,[0,u[1],0,0]):eT(r,[0,u[1],0,0]),s.attribute.width>0&&s.attribute.height>0?eT(s,[0,0,u[2],0]):h.attribute.width>0?eT(h,[0,0,u[2],0]):d.attribute.height>0?eT(d,[0,0,u[2],0]):eT(r,[0,0,u[2],0])}(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(e,t){let i=this.getCell(e,t).getChildByName("text",!0);if(i&&"text"===i.type){if(i.attribute.moreThanMaxCharacters||i.cliped)return this.table.getCellValue(e,t)}else if(i&&"richtext"===i.type&&i.attribute.ellipsis&&i._frameCache&&i.attribute.height<i._frameCache.actualHeight)return i.attribute.textConfig.find(e=>e.text),this.table.getCellValue(e,t);return null}updateDrill(e,t,i,l,o){this.component.drillIcon.update(e,t,i,l,o,this)}updateCellContent(e,t,i=!1){if(!this.clear)return(0,$.wW)(e,t,this.table,void 0,void 0,i)}setPixelRatio(e){this.stage.disableDirtyBounds(),this.stage.window.setDpr(e),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(e,t,i=[],l=!0,o){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;let r=(0,I.oM)(t.map(e=>e.row)).sort((e,t)=>e-t),n=(0,I.oM)(i.map(e=>e.row)).sort((e,t)=>e-t),a=this.table.getAllRowsHeight()-[...r,...n].reduce((e,t)=>e+this.table.getRowHeight(t),0)<=this.table.tableNoFrameHeight;if(function(e,t,i,l,o){let r,n;tq(l)&&tj(l);let a=l.scenegraph,s=(0,I.oM)(e.map(e=>e.row)).sort((e,t)=>t-e),h=(0,I.oM)(t.map(e=>e.row)).sort((e,t)=>e-t),d=(0,I.oM)(i.map(e=>e.row)).sort((e,t)=>e-t);if(d.length&&(r=ii(d[0]-1,d[d.length-1]+1,a)),h.length){let e=ii(h[0]-1,h[h.length-1]+1,a);r=(0,m.Z)(r)?(0,m.Z)(e)?Math.min(r,e):r:e}if(s.length){let e=ii(s[0]-1,s[s.length-1]+1,a);r=(0,m.Z)(r)?(0,m.Z)(e)?Math.min(r,e):r:e}s.forEach(e=>{var t=e,i=a,l=o;let r=i.proxy;if(t>=r.rowStart&&t<=r.rowEnd&&(ie(t,i),r.rowEnd--,r.currentRow--),!l){r.bodyBottomRow--;let e=Math.min(r.rowLimit,r.bodyBottomRow-r.bodyTopRow+1);r.totalActualBodyRowCount=e,r.totalRow=Math.min(r.table.rowCount-1,r.rowStart+e-1)}});let u=l.rowHeightsMap;if(s.forEach(e=>{u.delete(e)}),s.length){var c,g,p=a;function f(e,t){e.row=t;let i=(0,Z.Z)(p.table,e.col,e.row);i?(e.mergeStartCol=i.start.col,e.mergeEndCol=i.end.col,e.mergeStartRow=i.start.row,e.mergeEndRow=i.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}p.bodyGroup.forEachChildren(e=>{let t=p.bodyRowStart;null==e||e.forEachChildren(e=>{f(e,t),t++})}),p.rowHeaderGroup.forEachChildren(e=>{let t=p.bodyRowStart;null==e||e.forEachChildren(e=>{f(e,t),t++})}),p.rightFrozenGroup.forEachChildren(e=>{let t=p.bodyRowStart;null==e||e.forEachChildren(e=>{f(e,t),t++})}),p.bottomFrozenGroup.forEachChildren(e=>{let t=p.table.rowCount-p.table.bottomFrozenRowCount;null==e||e.forEachChildren(e=>{f(e,t),t++})}),p.leftBottomCornerGroup.forEachChildren(e=>{let t=p.table.rowCount-p.table.bottomFrozenRowCount;null==e||e.forEachChildren(e=>{f(e,t),t++})}),p.rightBottomCornerGroup.forEachChildren(e=>{let t=p.table.rowCount-p.table.bottomFrozenRowCount;null==e||e.forEachChildren(e=>{f(e,t),t++})});let e=it(s[s.length-1]-1,s[0]-s.length+1,a);r=(0,m.Z)(r)?(0,m.Z)(e)?Math.min(r,e):r:e}if(a.table._clearRowRangeHeightsMap(),h.forEach(e=>{let t=function(e,t,i){let l=t.proxy;if(!i){l.bodyBottomRow++;let e=Math.min(l.rowLimit,l.bodyBottomRow-l.bodyTopRow+1);l.totalActualBodyRowCount=e,l.totalRow=l.rowStart+e-1}if(!(e<l.rowStart))return e>l.rowEnd?l.rowEnd-l.rowStart+1<l.rowLimit?(l.rowEnd++,l.currentRow++,t7(e,t),e):void 0:(l.rowEnd-l.rowStart+1<l.rowLimit&&(l.rowEnd++,l.currentRow++,t7(e,t)),e)}(e,a,o);n=null!=n?n:t,u.insert(e)}),function(e){function t(t,i,l){t.row=i,t.setAttribute("y",l);let o=(0,Z.Z)(e.table,t.col,t.row);o?(t.mergeStartCol=o.start.col,t.mergeEndCol=o.end.col,t.mergeStartRow=o.start.row,t.mergeEndRow=o.end.row):(t.mergeStartCol=void 0,t.mergeEndCol=void 0,t.mergeStartRow=void 0,t.mergeEndRow=void 0)}e.bodyGroup.forEachChildren(i=>{let l=e.bodyRowStart,o=e.getCellGroupY(l);null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})}),e.rowHeaderGroup.forEachChildren(i=>{let l=e.bodyRowStart,o=e.getCellGroupY(l);null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})}),e.rightFrozenGroup.forEachChildren(i=>{let l=e.bodyRowStart,o=e.getCellGroupY(l);null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})}),e.bottomFrozenGroup.forEachChildren(i=>{let l=e.table.rowCount-e.table.bottomFrozenRowCount,o=0;null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})}),e.leftBottomCornerGroup.forEachChildren(i=>{let l=e.table.rowCount-e.table.bottomFrozenRowCount,o=0;null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})}),e.rightBottomCornerGroup.forEachChildren(i=>{let l=e.table.rowCount-e.table.bottomFrozenRowCount,o=0;null==i||i.forEachChildren(e=>{t(e,l,o),l++,o+=e.attribute.height})})}(a),h.length){let e=it(h[0]-1,h[h.length-1]+1,a);r=(0,m.Z)(r)?(0,m.Z)(e)?Math.min(r,e):r:e}let b=new Set;for(let e=0;e<l.colCount;e++)d.forEach(t=>{if(t<l.frozenRowCount){let i=(0,Z.Z)(a.table,e,t);if(i)for(let e=i.start.col;e<=i.end.col;e++)for(let t=i.start.row;t<=i.end.row;t++){let i=`${e}-${t}`;b.has(i)||((0,$.wW)(e,t,a.table,!1),b.add(i))}else(0,$.wW)(e,t,a.table,!1)}else if(t>l.rowCount-1||t<a.table.rowCount-a.table.bottomFrozenRowCount&&(t<a.proxy.rowStart||t>a.proxy.rowEnd))ie(t,a);else{let i=(0,Z.Z)(a.table,e,t);if(i)for(let e=i.start.col;e<=i.end.col;e++)for(let t=i.start.row;t<=i.end.row;t++){let i=`${e}-${t}`;b.has(i)||((0,$.wW)(e,t,a.table,!1),b.add(i))}else(0,$.wW)(e,t,a.table,!1)}});if(d.length){let e=it(d[0]-1,d[d.length-1]+1,a);r=(0,m.Z)(r)?(0,m.Z)(e)?Math.min(r,e):r:e}if((0,J.Z)(n)){for(let e=0;e<Math.max(l.colCount,null!=(c=l.internalProps._oldColCount)?c:l.colCount);e++)for(let t=n;t<Math.max(l.rowCount,null!=(g=l.internalProps._oldRowCount)?g:l.rowCount);t++){let i=a.highPerformanceGetCell(e,t,!0);i&&(i.needUpdate=!0)}r=(0,m.Z)(r)?(0,m.Z)(n)?Math.min(r,n):r:n}if((0,J.Z)(r)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,r)),h.length){if(!(0,J.Z)(n)){let e=Math.min(...h);a.proxy.rowUpdatePos=Math.min(e,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),v()}else s.length&&(function(e,t){if(t.table.isHasSeriesNumber())for(let i=e;i<=t.table.rowCount-1;i++)(0,$.wW)(0,i,t.table,!1)}(s[s.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),v());a.proxy.progress();let C=l.getRowsHeight(l.frozenRowCount,l.rowCount-1-l.bottomFrozenRowCount);function v(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=l.rowCount-l.bottomFrozenRowCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=l.rowCount-l.bottomFrozenRowCount||(null==s?void 0:s[0])>=l.rowCount-l.bottomFrozenRowCount){for(let e=0;e<l.colCount;e++)for(let t=l.rowCount-l.bottomFrozenRowCount;t<l.rowCount;t++){let i=a.highPerformanceGetCell(e,t,!0);i&&(i.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,C-a.bodyGroup.attribute.height)}(e,t,i,this.table,o),l&&this.recalculateColWidths(),"adaptive"===this.table.heightMode||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||a))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let e=0;e<n.length;e++){let t=n[e],i=this.table.getRowHeight(t),l=(0,ee.P)(t,0,this.table.colCount-1,this.table);(t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(t,l-i)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(e,t,i=[]){(function(e,t,i,l){var o,r;let n;tq(l)&&tj(l);let a=l.scenegraph,s=iS(e.map(e=>e.col)).sort((e,t)=>t-e),h=iS(t.map(e=>e.col)).sort((e,t)=>e-t),d=iS(i.map(e=>e.col)).sort((e,t)=>e-t);s.forEach(e=>{!function(e,t){let i=t.proxy;if(e>=t.table.rowHeaderLevelCount)if(e>=t.table.colCount-t.table.rightFrozenColCount);else{let i=t.getColGroup(e,!1);i&&i.parent===t.bodyGroup&&t.bodyGroup.removeChild(i);let l=t.getColGroupInBottom(e);l&&l.parent===t.bottomFrozenGroup&&t.bottomFrozenGroup.removeChild(l);let o=t.getColGroup(e,!0);o&&o.parent===t.colHeaderGroup&&t.colHeaderGroup.removeChild(o)}e>=i.colStart&&e<=i.colEnd&&(i.colEnd--,i.currentCol--),i.bodyRightCol--;let l=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);i.totalActualBodyColCount=l,i.totalCol=i.colStart+l-1}(e,a)});let u=l.colWidthsMap;s.forEach(e=>{u.delAndReorder(e)}),s.length&&iR(a),a.table._clearColRangeWidthsMap(),h.forEach(e=>{let t=function(e,t){let i=t.proxy;i.bodyRightCol++;let l=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);if(i.totalActualBodyColCount=l,i.totalCol=i.colStart+l-1,!(e<i.colStart))return e>i.colEnd?i.colEnd-i.colStart+1<i.colLimit?(i.colEnd++,i.currentCol++,iH(e,t),e):void 0:(i.colEnd-i.colStart+1<i.colLimit&&(i.colEnd++,i.currentCol++,iH(e,t)),e)}(e,a);iR(a),n=null!=n?n:t,u.addAndReorder(e)}),function(e){let t=e.bodyColStart,i=e.getCellGroupX(t);function l(i){i.col=t;let l=(0,Z.Z)(e.table,i.col,i.row);l&&(i.mergeStartCol=l.start.col,i.mergeStartCol=l.start.col,i.mergeEndCol=l.end.col,i.mergeEndCol=l.end.col),i.role}e.bodyGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++}),t=e.bodyColStart,i=e.getCellGroupX(t),e.colHeaderGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++}),t=e.bodyColStart,i=e.getCellGroupX(t),e.bottomFrozenGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++}),t=e.table.colCount-e.table.rightFrozenColCount,i=0,e.rightFrozenGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++}),t=e.table.colCount-e.table.rightFrozenColCount,i=0,e.rightTopCornerGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++}),t=e.table.colCount-e.table.rightFrozenColCount,i=0,e.rightBottomCornerGroup.forEachChildren(e=>{e.col=t,null==e||e.forEachChildren(e=>{l(e)}),e.setAttribute("x",i),i+=e.attribute.width,t++})}(a);let c=new Set;if(d.forEach(e=>{for(let t=0;t<l.rowCount;t++){let i=(0,Z.Z)(a.table,e,t);if(i)for(let e=i.start.col;e<=i.end.col;e++)for(let e=i.start.col;e<=i.end.col;e++){let i=`${e}-${t}`;c.has(i)||((0,$.wW)(e,t,a.table,!1),c.add(i))}else(0,$.wW)(e,t,a.table,!1)}}),(0,J.Z)(n)){for(let e=n;e<Math.max(l.colCount,null!=(o=l.internalProps._oldColCount)?o:l.colCount);e++)for(let t=0;t<Math.max(l.rowCount,null!=(r=l.internalProps._oldRowCount)?r:l.rowCount);t++){let i=a.highPerformanceGetCell(e,t,!0);i&&(i.needUpdate=!0)}a.proxy.colUpdatePos=n}if(h.length){if(!(0,J.Z)(n)){let e=Math.min(...h);a.proxy.colUpdatePos=e}a.proxy.colUpdateDirection="left",a.proxy.updateColGroups(2*a.proxy.screenColCount),p(),a.proxy.progress()}else s.length&&(a.proxy.updateColGroups(2*a.proxy.screenColCount),p(),a.proxy.progress());let g=l.getColsWidth(l.frozenColCount,l.colCount-1);function p(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=l.colCount-l.rightFrozenColCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=l.colCount-l.rightFrozenColCount||(null==s?void 0:s[0])>=l.colCount-l.rightFrozenColCount){for(let e=l.colCount-l.rightFrozenColCount;e<l.colCount;e++)for(let t=0;t<l.rowCount;t++){let i=a.highPerformanceGetCell(e,t,!0);i&&(i.needUpdate=!0)}a.proxy.updateRightFrozenCellGroups()}}a.updateContainerWidth(a.table.frozenColCount,g-a.bodyGroup.attribute.width)})(e,t,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let e=0;e<this.table.frozenColCount;e++)for(let t=0;t<this.table.frozenRowCount;t++)(0,$.wW)(e,t,this.table,!1)}updateRowHeaderCells(){for(let e=0;e<this.table.frozenColCount;e++)for(let t=this.table.frozenRowCount;t<this.table.rowCount;t++)(0,$.wW)(e,t,this.table,!1)}updateColumnHeaderCells(){for(let e=0;e<this.table.frozenRowCount;e++)for(let t=this.table.frozenColCount;t<this.table.colCount;t++)(0,$.wW)(t,e,this.table,!1)}getColumnGroupX(e){return e<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,e-1):e<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,e-1):e<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,e-1):0}getCellGroupY(e){return e<this.table.frozenRowCount?this.table.getRowsHeight(0,e-1):e<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.frozenRowCount,e-1):e<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,e-1):0}getCellGroupX(e){return e<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,e-1):e<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,e-1):e<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,e-1):0}updateDomContainer(){!function(e){let{headerDomContainer:t,bodyDomContainer:i,frozenBodyDomContainer:l,frozenHeaderDomContainer:o,rightFrozenBodyDomContainer:r,rightFrozenHeaderDomContainer:n,bottomDomContainer:a,frozenBottomDomContainer:s,rightFrozenBottomDomContainer:h}=e.internalProps;if(!(t||i||l||o||r||n||a||s||h))return;let d=e.getAllColsWidth(),u=Math.min(d,e.tableNoFrameWidth),c=e.getFrozenColsWidth(),g=e.getRightFrozenColsWidth(),p=c+g,f=Math.min(d-p,u-p),b=e.getAllRowsHeight(),m=Math.min(b,e.tableNoFrameHeight),C=e.getFrozenRowsHeight(),v=e.getBottomFrozenRowsHeight(),w=C+v,y=Math.min(b-w,m-w);e.frozenColCount>0?(t.style.left=`${e.tableX+c}px`,i.style.left=`${e.tableX+c}px`,a.style.left=`${e.tableX+c}px`):0===e.frozenColCount&&(t.style.left=`${e.tableX}px`,i.style.left=`${e.tableX}px`,a.style.left=`${e.tableX}px`),l.style.left=`${e.tableX}px`,o.style.left=`${e.tableX}px`,t.style.width=`${f}px`,t.style.height=`${C}px`,i.style.top=`${e.tableY}px`,i.style.width=`${f}px`,i.style.height=`${y}px`,i.style.top=`${e.tableY+C}px`,l.style.width=`${c}px`,l.style.height=`${y}px`,l.style.top=`${e.tableY+C}px`,o.style.width=`${c}px`,o.style.height=`${C}px`,o.style.top=`${e.tableY}px`,r.style.width=`${g}px`,r.style.height=`${y}px`,r.style.top=`${e.tableY+C}px`,r.style.left=e.tableX+u-g+"px",n.style.width=`${g}px`,n.style.height=`${C}px`,n.style.top=`${e.tableY}px`,n.style.left=e.tableX+u-g+"px",a.style.width=`${f}px`,a.style.height=`${v}px`,a.style.top=e.tableY+m-v+"px",s.style.width=`${c}px`,s.style.height=`${v}px`,s.style.top=e.tableY+m-v+"px",h.style.width=`${g}px`,h.style.height=`${v}px`,h.style.top=e.tableY+m-v+"px",h.style.left=e.tableX+u-g+"px"}(this.table)}setLoadingHierarchyState(e,t){let i=this.getCell(e,t),l=i.getChildByName("collapse",!0)||i.getChildByName("expand",!0);if(l){let i=eC.U2()[N.up.loadingIconName];i&&(0,Q.Bg)(i,l,e,t)}}temporarilyUpdateSelectRectStyle(e){let{selectedRangeComponents:t}=this;t.forEach((t,i)=>{t.rect.setAttributes(e)}),this.updateNextFrame()}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}function iM(e,t,i){let l=e.highPerformanceGetCell(t,i);if("cell"===l.role&&(0,m.Z)(l.mergeStartCol)&&(0,m.Z)(l.mergeStartRow)&&(0,m.Z)(l.mergeEndCol)&&(0,m.Z)(l.mergeEndRow)){let{colStart:t,colEnd:i,rowStart:o,rowEnd:r}=(0,et.e)(l,e);for(let l=t;l<=i;l++)for(let t=o;t<=r;t++){let i=e.highPerformanceGetCell(l,t);"cell"===i.role&&i.addUpdateBoundTag()}}else l.addUpdateBoundTag()}function iF(e,t,i,l,o){let r=e.table;for(let i=0;i<r.columnHeaderLevelCount;i++)iM(e,t,i);let n=e.getColGroup(t);return null==n||n.addUpdateBoundTag(),!0}function iB(e,t,i,l,o,r){let n=e.table;for(let i=0;i<n.columnHeaderLevelCount;i++)iM(e,t,i);let a=e.getColGroup(t);return null==a||a.addUpdateBoundTag(),!0}function iT(e,t,i,l,o){let r=e.table;for(let t=0;t<r.colCount;t++)iM(e,t,i);return!0}function iz(e,t,i,l,o,r){let n=e.table;for(let t=0;t<n.colCount;t++)iM(e,t,i);return!0}function iL(e,t,i,l,o){return o._getLayoutCellId(e,t)===o._getLayoutCellId(i,l)}var ik=i(53372),iP=i(22295),iI=i(47e3);function iE(e,t,i,l,o){for(let i=e;i<=t;i++)o._clearColRangeWidthsMap(i);for(let e=i;e<=l;e++)o._clearRowRangeHeightsMap(e)}function iD(e){var t;if(!e)return;let i=(null==(t=e.role)?void 0:t.startsWith("icon"))?e:"richtext"===e.type?e._currentHoverIcon:void 0;return i?"richtext"===e.type?{icon:i,position:{left:e.globalAABBBounds.x1+i.globalAABBBounds.x1,right:e.globalAABBBounds.x1+i.globalAABBBounds.x2,top:e.globalAABBBounds.y1+i.globalAABBBounds.y1,bottom:e.globalAABBBounds.y1+i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"richtext-icon"}:{icon:i,position:{left:i.globalAABBBounds.x1,right:i.globalAABBBounds.x2,top:i.globalAABBBounds.y1,bottom:i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"icon"}:void 0}var iW=i(32095);function iO(e,t){"adaptive"===t.table.widthMode&&t.columnResize.col<t.table.colCount-1?(t.table.scenegraph.updateColWidth(t.columnResize.col,e),t.table.scenegraph.updateColWidth(t.columnResize.col+1,-e),t.table.internalProps._widthResizedColMap.add(t.columnResize.col),t.table.internalProps._widthResizedColMap.add(t.columnResize.col+1)):(t.table.scenegraph.updateColWidth(t.columnResize.col,e),t.table.internalProps._widthResizedColMap.add(t.columnResize.col))}var iG=i(45847),iN=i(65962);function iZ(e,t){"adaptive"===t.table.heightMode&&t.rowResize.row<t.table.rowCount-1?(t.table.scenegraph.updateRowHeight(t.rowResize.row,e),t.table.scenegraph.updateRowHeight(t.rowResize.row+1,-e),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row+1)):(t.table.scenegraph.updateRowHeight(t.rowResize.row,e),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row))}class iK{constructor(e){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=(0,iW.D)(e=>{this.updateInteractionState(null!=e?e:B.F.default)},100),this.table=e,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=B.F.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iP.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=B.F.default,this.select={highlightScope:B.p.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:B.p.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iP.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var e;let{highlightMode:t,disableHover:i,disableHeaderHover:l}=null!=(e=this.table.options.hover)?e:{highlightMode:"cell"};i?this.hover.highlightScope=B.p.none:"cross"===t?this.hover.highlightScope=B.p.cross:"row"===t?this.hover.highlightScope=B.p.row:"column"===t?this.hover.highlightScope=B.p.column:"cell"===t&&(this.hover.highlightScope=B.p.single),this.hover.singleStyle=!i,this.hover.disableHeader=l,(this.hover.highlightScope===B.p.none||l)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var e,t,i,l,o;let{headerSelectMode:r,disableSelect:n,disableHeaderSelect:a,highlightMode:s,highlightInRange:h}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select),d=(null==(e=this.table.options.select)?void 0:e.cornerHeaderSelectMode)?null==(t=this.table.options.select)?void 0:t.cornerHeaderSelectMode:"body"===(null==(i=this.table.options.select)?void 0:i.headerSelectMode)?null==(l=this.table.options.select)?void 0:l.headerSelectMode:"all";this.select.highlightScope=!0===n?B.p.none:"cross"===s?B.p.cross:"row"===s?B.p.row:"column"===s?B.p.column:B.p.single,this.select.singleStyle=!n,this.select.disableHeader=a,this.select.headerSelectMode=r,this.select.cornerHeaderSelectMode=d,this.select.highlightInRange=h,this.select.disableCtrlMultiSelect=!1===(null==(o=this.table.options.keyboardOptions)?void 0:o.ctrlMultiSelect)}isSelected(e,t){let i=!1;return this.select.ranges.forEach(l=>{(0,T._Z)(l,e,t)&&(i=!0)}),i}setSortState(e){let t=this,i=(e=!e||Array.isArray(e)?e:[e])&&e.reduce((e,i)=>{var l,o,r;let n=null==(l=function(e){let i=[];return function e(l,o=0){l.forEach(l=>{var r;let n=l.startInTotal?null!=(r=l.startInTotal+t.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?r:0:o;l.columns?e(l.columns,n):i.push(Object.assign(Object.assign({},l),{startIndex:n}))})}(e),i}(this.table.internalProps.columns))?void 0:l.find(e=>(null==e?void 0:e.field)===(null==i?void 0:i.field));return this.table.internalProps.transpose?e.push({field:i.field,order:i.order,row:null!=(o=(null==n?void 0:n.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?o:0,col:null==n?void 0:n.level}):e.push({field:i.field,order:i.order,col:null!=(r=(null==n?void 0:n.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?r:0,row:null==n?void 0:n.level}),e},[]);this.sort=i||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(e){if(this.interactionState===e)return;e===B.F.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);let t=this.interactionState;this.interactionState=e,t===B.F.scrolling&&B.F.default}updateHoverhighlightScope(e){this.hover.highlightScope!==e&&(this.hover.highlightScope=e)}updateHoverPos(e,t){!function(e,t,i){var l;let{table:o}=e,{scenegraph:r}=o,{highlightScope:n,singleStyle:a,disableHeader:s,cellPos:h,cellPosContainHeader:d}=e.hover,u=h.col,c=h.row;if(n===B.p.none||s&&(d.col!==t||d.row!==i)){let e=d.col,l=d.row;r.hideHoverIcon(e,l),r.showHoverIcon(t,i),d.col=t,d.row=i}if((s&&o.isHeader(t,i)||n===B.p.none)&&(t=-1,i=-1),u===t&&c===i)return;h.col=t,h.row=i,(null==(l=e.table.options.customConfig)?void 0:l.disableBuildInChartActive)||(r.deactivateChart(u,c),r.activateChart(t,i));let g=!1,{ranges:p,highlightScope:f}=e.select;if(-1!==u&&-1!==c&&(g=function(e,t,i,l,o,r,n){let a=!1;return r===B.p.single?(iM(e,t,i),a=!0):r===B.p.row?a=!!iT(e,t,i,l,n)||a:r===B.p.column?a=!!iF(e,t,i,l,n)||a:r===B.p.cross&&(a=!!iT(e,t,i,l,n)||a,a=!!iF(e,t,i,l,n)||a),a}(r,u,c,p,0,n,f),s||r.hideHoverIcon(u,c)),-1===t||-1===i)return h.col=-1,h.row=-1,!g||u===t&&c===i||e.table.scenegraph.updateNextFrame();n===B.p.single?(iM(r,t,i),g=!0):n===B.p.row?g=!!iz(r,t,i,p,f,a)||g:n===B.p.column?g=!!iB(r,t,i,p,f,a)||g:n===B.p.cross&&(g=!!iz(r,t,i,p,f,a)||g,g=!!iB(r,t,i,p,f,a)||g),n===B.p.none||s||r.showHoverIcon(t,i),g&&e.table.scenegraph.updateNextFrame()}(this,e,t)}updateSelectPos(e,t,i=!1,l=!1,o=!1,r=!0,n=!1){-1!==t&&-1!==t&&(this.select.selecting=!0),e<0&&(e=-1),t<0&&(t=-1),e>this.table.colCount-1&&(e=this.table.colCount-1),t>this.table.rowCount-1&&(t=this.table.rowCount-1),function(e,t,i,l,o,r,n=!0,a=!1){var s,h;let{table:d,interactionState:u}=e,{scenegraph:c}=d,{highlightScope:g,disableHeader:p,cellPos:f,disableCtrlMultiSelect:b}=e.select;if(-1!==t&&-1!==i&&n&&d._makeVisibleCell(t,i),-1!==t&&-1!==i&&n)if(u===B.F.grabing&&e.select.ranges.length>0){let l=e.select.ranges[e.select.ranges.length-1];t>l.start.col&&t>l.end.col&&d._makeVisibleCell(t+1,i),i>l.start.row&&i>l.end.row&&d._makeVisibleCell(t,i+1),t<l.start.col&&t<l.end.col&&d._makeVisibleCell(t-1,i),i<l.start.row&&i<l.end.row&&d._makeVisibleCell(t,i-1)}else d._makeVisibleCell(t,i);if(r){e.select.ranges=[],c.deleteAllSelectBorder();let t=0,i=0,{disableHeaderSelect:l,disableRowSeriesNumberSelect:o}=(null==(s=d.options.keyboardOptions)?void 0:s.selectAllOnCtrlA)||{};l&&(t=d.rowHeaderLevelCount,i=d.columnHeaderLevelCount),(o||l&&d.transpose)&&d.options.rowSeriesNumber&&(t+=1),e.select.ranges.push({start:{col:t,row:i},end:{col:d.colCount-1,row:d.rowCount-1}});let r=e.select.ranges[e.select.ranges.length-1];c.updateCellSelectBorder(r,!1)}else if(-1===f.col||-1===f.row||-1!==t&&-1!==i)if(u!==B.F.default||d.eventManager.isDraging||d.stateManager.isResizeCol()){if((u===B.F.grabing||d.eventManager.isDraging)&&!d.stateManager.isResizeCol()){let l=!0;-1===f.col&&(f.col=t),-1===f.row&&(f.row=i),f.col=t,f.row=i;let o=e.select.ranges[e.select.ranges.length-1];if(o){if(d.internalProps.layoutMap.isSeriesNumberInBody(o.start.col,o.start.row))l=!1,o.end={col:d.colCount-1,row:i};else if(e.fillHandle.isFilling){if("top"===e.fillHandle.direction)if(i===e.fillHandle.beforeFillMinRow&&i===e.fillHandle.beforeFillMaxRow)o.start.row=o.end.row=i;else if(i<=e.fillHandle.beforeFillMinRow){if(o.start.row<o.end.row){let e=o.start.row;o.start.row=o.end.row,o.end.row=e}o.end.row=i}else i===e.fillHandle.beforeFillMaxRow&&(o.start.row>o.end.row?o.start.row=i:o.end.row=i);else if("bottom"===e.fillHandle.direction){if(i>=e.fillHandle.beforeFillMaxRow){if(o.start.row>o.end.row){let e=o.start.row;o.start.row=o.end.row,o.end.row=e}o.end.row=i}}else if("left"===e.fillHandle.direction)if(t===e.fillHandle.beforeFillMinCol&&t===e.fillHandle.beforeFillMaxCol)o.start.col=o.end.col=t;else if(t<=e.fillHandle.beforeFillMinCol){if(o.start.col<o.end.col){let e=o.start.col;o.start.col=o.end.col,o.end.col=e}o.end.col=t}else t===e.fillHandle.beforeFillMaxCol&&(o.start.col>o.end.col?o.start.col=t:o.end.col=t);else if("right"===e.fillHandle.direction&&t>=e.fillHandle.beforeFillMaxCol){if(o.start.col>o.end.col){let e=o.start.col;o.start.col=o.end.col,o.end.col=e}o.end.col=t}}else{o.end={col:t,row:i};let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);o.start.col<l.end.col?o.end.col=l.end.col:o.start.col>l.start.col&&(o.end.col=l.start.col),o.start.row<l.end.row?o.end.row=l.end.row:o.start.row>l.start.row&&(o.end.row=l.start.row),"body"===e.select.headerSelectMode&&(d.isRowHeader(t,i)?(o.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,o.end.col=d.colCount-1):d.isColumnHeader(t,i)?(o.start.row=d.columnHeaderLevelCount,o.end.row=d.rowCount-1):d.internalProps.layoutMap.isSeriesNumberInBody(t,i)?(o.start.col=d.leftRowSeriesNumberCount,o.end.col=d.colCount-1):d.isCornerHeader(t,i)?(o.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,o.start.row=d.columnHeaderLevelCount,o.end.col=d.colCount-1,o.end.row=d.rowCount-1):d.isSeriesNumber(t,i)&&(o.start.col=d.leftRowSeriesNumberCount,o.start.row=d.columnHeaderLevelCount,o.end.col=d.colCount-1,o.end.row=d.rowCount-1)),a&&(o.skipBodyMerge=!0)}o&&o.start.row<=d.rowCount-1&&o.end.row<=d.rowCount-1&&o.start.col<=d.colCount-1&&o.end.col<=d.colCount-1&&c.updateCellSelectBorder(o,l)}}}else{let r=e.select.ranges[e.select.ranges.length-1];if(l&&r){if(o&&!b||(f.col=t,f.row=i),"cell"!==e.select.headerSelectMode&&d.isColumnHeader(t,i)){let l=Math.min(r.start.col,r.end.col,t),o=Math.max(r.start.col,r.end.col,t),n=Math.min(r.start.row,r.end.row,i),a=d.rowCount-1;"body"===e.select.headerSelectMode?(r.start={col:l,row:d.columnHeaderLevelCount},r.end={col:o,row:d.rowCount-1}):(r.start={col:l,row:n},r.end={col:o,row:a})}else if("cell"!==e.select.headerSelectMode&&d.isRowHeader(t,i)){let l=Math.min(r.start.col,r.end.col,t),o=d.colCount-1,n=Math.min(r.start.row,r.end.row,i),a=Math.max(r.start.row,r.end.row,i);"body"===e.select.headerSelectMode?(r.start={col:d.leftRowSeriesNumberCount+d.rowHeaderLevelCount,row:n},r.end={col:d.colCount-1,row:a}):(r.start={col:l,row:n},r.end={col:o,row:a})}else if("cell"!==e.select.headerSelectMode&&d.isSeriesNumberInBody(t,i)){let l=Math.min(r.start.col,r.end.col,t),o=d.colCount-1,n=Math.min(r.start.row,r.end.row,i),a=Math.max(r.start.row,r.end.row,i);"body"===e.select.headerSelectMode?(r.start={col:d.leftRowSeriesNumberCount,row:n},r.end={col:d.colCount-1,row:a}):(r.start={col:l,row:n},r.end={col:o,row:a})}else r.end={col:t,row:i};c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(r)}else{let l=!0;if(-1===f.col||-1===f.row||o&&!b||(e.select.ranges=[],c.deleteAllSelectBorder()),"cell"!==e.select.headerSelectMode&&d.isColumnHeader(t,i)){let l=d.getCellRange(t,i);"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:l.start.col,row:d.columnHeaderLevelCount},end:{col:l.end.col,row:d.rowCount-1},skipBodyMerge:!0}):e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else if("cell"!==e.select.headerSelectMode&&d.isRowHeader(t,i)){let l=d.getCellRange(t,i);"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:l.start.row},end:{col:d.colCount-1,row:l.end.row},skipBodyMerge:!0}):e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:d.colCount-1,row:l.end.row},skipBodyMerge:!0})}else if(d.internalProps.layoutMap.isSeriesNumberInHeader(t,i)){l=!1;let{cornerHeaderSelectMode:o}=e.select;if("body"===o)e.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if("inline"===o){let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else if("cell"===o){let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:a||void 0})}else e.select.ranges.push({start:{col:0,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0})}else if(d.internalProps.layoutMap.isSeriesNumberInBody(t,i))l=!1,"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:i},end:{col:d.colCount-1,row:i},skipBodyMerge:!0}):e.select.ranges.push({start:{col:t,row:i},end:{col:d.colCount-1,row:i},skipBodyMerge:!0});else if(d.internalProps.layoutMap.isCornerHeader(t,i)){l=!1;let{cornerHeaderSelectMode:o}=e.select;if("body"===o)e.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if("cell"===o){let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:a||void 0})}else if("inline"===o){let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else e.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0})}else if(t>=0&&i>=0){let l=a?{start:{col:t,row:i},end:{col:t,row:i}}:d.getCellRange(t,i);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:a||void 0})}f.col=t,f.row=i;let r=null==(h=e.select.ranges)?void 0:h[e.select.ranges.length-1];r&&r.start.row<=d.rowCount-1&&r.end.row<=d.rowCount-1&&r.start.col<=d.colCount-1&&r.end.col<=d.colCount-1&&c.updateCellSelectBorder(r,l)}}else f.col=-1,f.row=-1,e.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()}(this,e,t,i,l,o,r,n)}checkCellRangeInSelect(e,t){return function(e,t,i,l){for(let l=0;l<i.length;l++){let o=i[l];if((0,T.ib)(o,{start:e,end:t}))return!0}return!1}(e,t,this.select.ranges,this.select.highlightScope)}updateHoverIcon(e,t,i,l){var o,r,n,a,s,h,d,u,c;if((null==(o=this.residentHoverIcon)?void 0:o.icon)&&i===(null==(r=this.residentHoverIcon)?void 0:r.icon))return;let g=iD(i);if(g)if("richtext-icon"===g.type){let i=g.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(a=this.residentHoverIcon)?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),i.attribute.tooltip){let l={content:i.attribute.tooltip.title,referencePosition:{rect:g.position,placement:i.attribute.tooltip.placement},style:Object.assign({},null==(s=this.table.internalProps.theme)?void 0:s.tooltipStyle,null==(h=i.tooltip)?void 0:h.style,null==(u=null==(d=i.attribute)?void 0:d.tooltip)?void 0:u.style),disappearDelay:i.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(l)||this.table.showTooltip(e,t,l)}}else{let i=g.icon;i!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(c=this.residentHoverIcon)?void 0:c.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=e,this.hoverIcon.row=t,this.hoverIcon.icon=i,this.table.scenegraph.setIconHoverStyle(i,e,t,l),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(n=this.residentHoverIcon)?void 0:n.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(e=!0,t=!0){if(this.select.selecting){if(this.select.selecting=!1,0===this.select.ranges.length)return;let t=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||(0,et.T)(t,this.table);let i=!1;for(let e=0;e<this.select.ranges.length-1;e++){let l=this.select.ranges[e];if(l&&l.start.col===t.start.col&&l.start.row===t.start.row&&l.end.col===t.end.col&&l.end.row===t.end.row){i=!0;break}}i?(this.select.ranges.pop(),t9(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):this.table.scenegraph.moveSelectingRangeComponentsToSelectedRangeComponents();let l=this.select.ranges[this.select.ranges.length-1].end.col,o=this.select.ranges[this.select.ranges.length-1].end.row;e&&this.table.fireListeners(z.B.SELECTED_CELL,{ranges:this.select.ranges,col:l,row:o})}else t&&0===this.select.ranges.length&&this.table.fireListeners(z.B.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(e,t,i,l){this.columnResize.resizing=!0,this.columnResize.col=e,this.columnResize.x=t,this.columnResize.isRightFrozen=l,this.table.scenegraph.component.showResizeCol(e,i,l),this.table.scenegraph.updateNextFrame()}updateResizeCol(e,t){!function(e,t,i){e=Math.ceil(e),t=Math.ceil(t);let l=i.columnResize.isRightFrozen?i.columnResize.x-e:e-i.columnResize.x;if(1>Math.abs(l))return;let o=i.table.getColWidth(i.columnResize.col),r=o;r+=l;let n=i.table.getMinColWidth(i.columnResize.col),a=i.table.getMaxColWidth(i.columnResize.col);if(r<n||r>a){if(o===n||o===a)return;l=o-n>a-o?a-o:n-o}let s=i.table.getColWidth(i.columnResize.col)+l;if(s<i.table.internalProps.limitMinWidth&&(l=(s=i.table.internalProps.limitMinWidth)-i.table.getColWidth(i.columnResize.col)),"adaptive"===i.table.widthMode&&i.columnResize.col<i.table.colCount-1){let e=i.table.getColWidth(i.columnResize.col+1),t=i.table.getMinColWidth(i.columnResize.col+1),o=i.table.getMaxColWidth(i.columnResize.col+1),r=e;if((r-=l)<t||r>o){if(e===t||e===o)return;l=e-t>o-e?o-e:t-e}r-l<i.table.internalProps.limitMinWidth&&(l=r-i.table.internalProps.limitMinWidth)}l=Math.ceil(l),i.columnResize.col<i.table.rowHeaderLevelCount||i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount?iO(l,i):"indicator"===i.table.internalProps.columnResizeType?function(e,t){let i,l,o,r=t.table.internalProps.layoutMap;if(r.indicatorsAsCol)i=r.getIndicatorKey(t.columnResize.col,t.table.columnHeaderLevelCount);else{let e=r.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount-1),i=e.colHeaderPaths[e.colHeaderPaths.length-1];l=i.dimensionKey,o=i.value}for(let n=t.table.rowHeaderLevelCount;n<t.table.colCount-t.table.rightFrozenColCount;n++){let a=r.getIndicatorKey(n,t.table.columnHeaderLevelCount);if(r.indicatorsAsCol&&a===i)t.table.scenegraph.updateColWidth(n,e),t.table.internalProps._widthResizedColMap.add(n);else if(!r.indicatorsAsCol){let i=r.getCellHeaderPaths(n,t.table.columnHeaderLevelCount-1),a=null==i?void 0:i.colHeaderPaths[i.colHeaderPaths.length-1];a&&l===a.dimensionKey&&o===a.value&&(t.table.scenegraph.updateColWidth(n,e),t.table.internalProps._widthResizedColMap.add(n))}}}(l,i):"indicatorGroup"===i.table.internalProps.columnResizeType?function(e,t){let i=t.table.internalProps.layoutMap,l=i.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount),o=i.getHeadNodeByRowOrColDimensions(l.colHeaderPaths.slice(0,l.colHeaderPaths.length-1)),r=o.startInTotal+t.table.frozenColCount,n=o.startInTotal+t.table.frozenColCount+o.size-1,a=t.table.getColsWidth(r,n);for(let l=r;l<=n;l++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!i.indicatorsAsCol)){let e=i.getBody(l,t.table.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)continue}let o=t.table.getColWidth(l)/a*e;o>0&&o<.5?o=.5:o<0&&o>=-.5&&(o=-.5),t.table.scenegraph.updateColWidth(l,o),t.table.internalProps._widthResizedColMap.add(l)}}(l,i):"all"===i.table.internalProps.columnResizeType?function(e,t){let i=t.table.internalProps.layoutMap;for(let l=t.table.frozenColCount;l<t.table.colCount-t.table.rightFrozenColCount;l++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!i.indicatorsAsCol)){let e=i.getBody(l,t.table.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)continue}t.table.scenegraph.updateColWidth(l,e),t.table.internalProps._widthResizedColMap.add(l)}}(l,i):iO(l,i),i.columnResize.x=e,i.table.scenegraph.component.updateResizeCol(i.columnResize.col,t,i.columnResize.isRightFrozen),!(i.columnResize.col<i.table.frozenColCount)||i.table.isPivotTable()||i.table.transpose?i.table.options.frozenColCount&&i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1,i.columnResize.isRightFrozen),(i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount&&!i.table.isPivotTable()&&!i.table.transpose||i.table.options.rightFrozenColCount)&&i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount),i.table.scenegraph.updateNextFrame()}(e,t,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(e,t,i,l){this.rowResize.resizing=!0,this.rowResize.row=e,this.rowResize.y=i,this.rowResize.isBottomFrozen=l,this.table.scenegraph.component.showResizeRow(e,t,l),this.table.scenegraph.updateNextFrame()}updateResizeRow(e,t){!function(e,t,i){e=Math.ceil(e),t=Math.ceil(t);let l=i.rowResize.isBottomFrozen?i.rowResize.y-t:t-i.rowResize.y;if(1>Math.abs(l))return;i.table.getRowHeight(i.rowResize.row);let o=i.table.getRowHeight(i.rowResize.row)+l;if(o<i.table.internalProps.limitMinHeight&&(l=(o=i.table.internalProps.limitMinHeight)-i.table.getRowHeight(i.rowResize.row)),"adaptive"===i.table.heightMode&&i.rowResize.row<i.table.rowCount-1){let e=i.table.getRowHeight(i.rowResize.row+1);(e-=l)-l<i.table.internalProps.limitMinHeight&&(l=e-i.table.internalProps.limitMinHeight)}l=Math.ceil(l),i.rowResize.row<i.table.columnHeaderLevelCount||i.rowResize.row>=i.table.rowCount-i.table.bottomFrozenRowCount?iZ(l,i):"indicator"===i.table.internalProps.rowResizeType?function(e,t){var i,l;let o,r,n,a=t.table.internalProps.layoutMap;if(a.indicatorsAsCol){let e=a.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,t.rowResize.row),l=null==(i=e.rowHeaderPaths)?void 0:i[e.rowHeaderPaths.length-1];r=null==l?void 0:l.dimensionKey,n=null==l?void 0:l.value}else o=a.getIndicatorKey(t.table.rowHeaderLevelCount,t.rowResize.row);for(let i=t.table.columnHeaderLevelCount;i<t.table.rowCount-t.table.bottomFrozenRowCount;i++){let s=a.getIndicatorKey(t.table.rowHeaderLevelCount,i);if(a.indicatorsAsCol||s!==o){if(a.indicatorsAsCol){let o=a.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,i),s=null==(l=null==o?void 0:o.rowHeaderPaths)?void 0:l[o.rowHeaderPaths.length-1];s&&r===s.dimensionKey&&n===s.value&&(t.table.scenegraph.updateRowHeight(i,e),t.table.internalProps._heightResizedRowMap.add(i))}}else t.table.scenegraph.updateRowHeight(i,e),t.table.internalProps._heightResizedRowMap.add(i)}}(l,i):"indicatorGroup"===i.table.internalProps.rowResizeType?function(e,t){let i=t.table.internalProps.layoutMap,l=i.getCellHeaderPaths(t.table.rowHeaderLevelCount,t.rowResize.row),o=i.getHeadNodeByRowOrColDimensions(l.rowHeaderPaths.slice(0,l.rowHeaderPaths.length-1)),r=o.startInTotal+t.table.frozenRowCount,n=o.startInTotal+t.table.frozenRowCount+o.size-1,a=t.table.getRowsHeight(r,n);for(let i=r;i<=n;i++){let l=t.table.getRowHeight(i)/a*e;l>0&&l<.5?l=.5:l<0&&l>=-.5&&(l=-.51),t.table.scenegraph.updateRowHeight(i,l),t.table.internalProps._heightResizedRowMap.add(i)}}(l,i):"all"===i.table.internalProps.rowResizeType?function(e,t){for(let i=t.table.frozenRowCount;i<t.table.rowCount-t.table.bottomFrozenRowCount;i++)t.table.scenegraph.updateRowHeight(i,e),t.table.internalProps._heightResizedRowMap.add(i)}(l,i):iZ(l,i),i.rowResize.y=t,i.table.scenegraph.component.updateResizeRow(i.rowResize.row,e,i.rowResize.isBottomFrozen),i.table.scenegraph.updateNextFrame()}(e,t,this)}startFillSelect(e,t){this.fillHandle.isFilling=!0,this.fillHandle.startX=e,this.fillHandle.startY=t;let i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(z.B.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;let e=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),t=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),l=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===e&&this.fillHandle.beforeFillMinRow===t&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===l||this.table.eventManager.isDraging&&this.table.fireListeners(z.B.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(e,t,i,l,o){!function(e,t,i,l,o,r){var n;if(!("canMoveHeaderPosition"in o.table.internalProps.layoutMap))return;if(o.columnMove.moving=!0,o.columnMove.colSource=e,o.columnMove.rowSource=t,o.table.isListTable()){let i=o.table.getRecordIndexByCell(e,t),l=o.table.getRecordByCell(e,t),r=o.table.getRecordHierarchyState(e,t);o.columnMove.rowSourceSize=(0,I.pr)(i,r,l)+1}o.columnMove.x=i-o.table.tableX,o.columnMove.y=l-o.table.tableY;let a=o.table.getCellLocation(e,t),s="columnHeader"===a?o.columnMove.x:"rowHeader"===a||o.table.internalProps.layoutMap.isSeriesNumberInBody(e,t)?o.columnMove.y:0,{backX:h,lineX:d,backY:u,lineY:c}=o.table.scenegraph.component.showMoveCol(e,t,s);o.table.fireListeners(z.B.CHANGE_HEADER_POSITION_START,{col:e,row:t,x:i,y:l,backX:h,lineX:d,backY:u,lineY:c,event:r});let g=!!(null==(n=o.select.ranges)?void 0:n.length);o.table.stateManager.updateSelectPos(-1,-1),o.table.stateManager.endSelectCells(!0,g),o.table.scenegraph.updateNextFrame()}(e,t,i,l,this,o)}updateMoveCol(e,t,i,l,o){!function(e,t,i,l,o,r){if(!("canMoveHeaderPosition"in o.table.internalProps.layoutMap))return;let n=function(e,t,i){let l=i.getCellRange(e.col,e.row);if(i.isColumnHeader(e.col,e.row)){let o=i.getCellRange(t.col,l.start.row);t.row>=i.columnHeaderLevelCount&&(t.row=i.columnHeaderLevelCount-1),t.col>=e.col?t.col=o.end.col:t.col=o.start.col}else if(i.isRowHeader(e.col,e.row)){let o=i.internalProps.layoutMap,r=i.getCellRange(l.start.col,t.row);if(t.col>=i.rowHeaderLevelCount+o.leftRowSeriesNumberColumnCount&&(t.col=i.rowHeaderLevelCount+o.leftRowSeriesNumberColumnCount-1),"tree"===o.rowHierarchyType){let l=o.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,r=o.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths;if(l.length<=r.length){let o=r[l.length-1];o&&(t.row>=e.row?t.row=o.startInTotal+o.size-1+i.columnHeaderLevelCount:t.row=o.startInTotal+i.columnHeaderLevelCount)}}else t.row>=e.row?t.row=r.end.row:t.row=r.start.row}return t}({col:o.columnMove.colSource,row:o.columnMove.rowSource},{col:e,row:t},o.table);if(o.table.internalProps.layoutMap.canMoveHeaderPosition({col:o.columnMove.colSource,row:o.columnMove.rowSource},{col:n.col,row:n.row})){let a,s,h,d;if(o.columnMove.x=i-o.table.tableX,o.columnMove.y=l-o.table.tableY,o.columnMove.colTarget=n.col,o.columnMove.rowTarget=n.row,o.table.isListTable()){let e=o.table.getRecordIndexByCell(n.col,n.row),t=o.table.getRecordByCell(n.col,n.row),i=o.table.getRecordHierarchyState(n.col,n.row);o.columnMove.rowTargetSize=(0,I.pr)(e,i,t)+1}o.updateCursor("grabbing");let u=o.table.getCellLocation(o.columnMove.colSource,o.columnMove.rowSource);"columnHeader"===u?(s=o.columnMove.x,a=o.table.isLeftFrozenColumn(e)?o.columnMove.colTarget>=o.columnMove.colSource?o.table.getColsWidth(0,o.columnMove.colTarget):o.table.getColsWidth(0,o.columnMove.colTarget-1):o.table.isRightFrozenColumn(e)?o.table.tableNoFrameWidth-o.table.getColsWidth(n.col+1,o.table.colCount-1):(o.columnMove.colTarget>=o.columnMove.colSource?o.table.getColsWidth(0,o.columnMove.colTarget):o.table.getColsWidth(0,o.columnMove.colTarget-1))-o.table.stateManager.scroll.horizontalBarPos):("rowHeader"===u||o.table.internalProps.layoutMap.isSeriesNumberInBody(e,t))&&(d=o.columnMove.y,h=o.table.isFrozenRow(t)?o.columnMove.rowTarget>=o.columnMove.rowSource?o.table.getRowsHeight(0,o.columnMove.rowTarget):o.table.getRowsHeight(0,o.columnMove.rowTarget-1):o.table.isBottomFrozenRow(t)?o.table.tableNoFrameHeight-o.table.getRowsHeight(n.row+1,o.table.rowCount-1):(o.columnMove.rowTarget>=o.columnMove.rowSource?o.table.getRowsHeight(0,o.columnMove.rowTarget):o.table.getRowsHeight(0,o.columnMove.rowTarget-1))-o.table.stateManager.scroll.verticalBarPos),o.table.scenegraph.component.updateMoveCol(s,a,d,h),o.table.fireListeners(z.B.CHANGING_HEADER_POSITION,{col:e,row:t,x:i,y:l,backX:s,lineX:a,backY:d,lineY:h,event:r}),o.table.scenegraph.updateNextFrame()}else o.updateCursor("not-allowed"),o.columnMove.colTarget=o.columnMove.colSource,o.columnMove.rowTarget=o.columnMove.rowSource}(e,t,i,l,this,o)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return function(e){var t,i;let l=!1;if("canMoveHeaderPosition"in e.table.internalProps.layoutMap&&e.columnMove.moving&&e.columnMove.colSource>=0&&e.columnMove.rowSource>=0&&e.columnMove.colTarget>=0&&e.columnMove.rowTarget>=0&&!0!==(null==(t=e.table.options.customConfig)?void 0:t.notUpdateInColumnRowMove)){let t=e.table.getCellRange(e.columnMove.colSource,e.columnMove.rowSource),i=e.table.getCellRange(e.columnMove.colTarget,e.columnMove.rowTarget),o=e.table._moveHeaderPosition({col:e.columnMove.colSource,row:e.columnMove.rowSource},{col:e.columnMove.colTarget,row:e.columnMove.rowTarget});if(!o||o.targetIndex===o.sourceIndex)return e.updateCursor(),e.columnMove.moving=!1,delete e.columnMove.colSource,delete e.columnMove.rowSource,delete e.columnMove.colTarget,delete e.columnMove.rowTarget,e.table.scenegraph.component.hideMoveCol(),e.table.scenegraph.updateNextFrame(),!1;{e.table.internalProps.useOneRowHeightFillAll=!1,e.table.internalProps.layoutMap.clearCellRangeMap();let r=e.table.getCellRange(e.columnMove.colSource,e.columnMove.rowSource),n=e.table.getCellRange(e.columnMove.colTarget,e.columnMove.rowTarget),a=Math.min(r.start.col,n.start.col,t.start.col,i.start.col),s=Math.max(r.end.col,n.end.col,t.end.col,i.end.col),h=Math.min(r.start.row,n.start.row,t.start.row,i.start.row),d=Math.max(r.end.row,n.end.row,t.end.row,i.end.row);"row"===o.moveType&&"tree"===e.table.internalProps.layoutMap.rowHierarchyType&&(d=o.targetIndex>o.sourceIndex?d+o.targetSize-1:d+o.sourceSize-1),!e.table.transpose&&e.table.internalProps.layoutMap.isSeriesNumberInBody(e.columnMove.colSource,e.columnMove.rowSource)&&(e.table.changeRecordOrder(o.sourceIndex,o.targetIndex),e.changeCheckboxAndRadioOrder(o.sourceIndex,o.targetIndex)),"column"===o.moveType?iE(a,s,0,-1,e.table):iE(0,-1,h,d,e.table),e.table.clearCellStyleCache(),e.table.internalProps.layoutMap.isSeriesNumberInBody(e.columnMove.colSource,e.columnMove.rowSource)?e.table.scenegraph.updateHeaderPosition(e.table.scenegraph.proxy.colStart,e.table.scenegraph.proxy.colEnd,e.table.scenegraph.proxy.rowStart,e.table.scenegraph.proxy.rowEnd,o.moveType):"column"===o.moveType?e.table.scenegraph.updateHeaderPosition(a,s,0,-1,o.moveType):e.table.scenegraph.updateHeaderPosition(0,-1,h,d,o.moveType),"adjustFrozenCount"===e.table.internalProps.frozenColDragHeaderMode&&e.table.isListTable()&&(e.table.isLeftFrozenColumn(e.columnMove.colTarget)&&!e.table.isLeftFrozenColumn(e.columnMove.colSource)?e.table.frozenColCount+=r.end.col-r.start.col+1:e.table.isLeftFrozenColumn(e.columnMove.colSource)&&!e.table.isLeftFrozenColumn(e.columnMove.colTarget)&&(e.table.frozenColCount-=r.end.col-r.start.col+1),e.table.isRightFrozenColumn(e.columnMove.colTarget)&&!e.table.isRightFrozenColumn(e.columnMove.colSource)?e.table.rightFrozenColCount+=r.end.col-r.start.col+1:e.table.isRightFrozenColumn(e.columnMove.colSource)&&!e.table.isRightFrozenColumn(e.columnMove.colTarget)&&(e.table.rightFrozenColCount-=r.end.col-r.start.col+1)),l=!0}}return e.columnMove.moving=!1,setTimeout(()=>{delete e.columnMove.colSource,delete e.columnMove.rowSource,delete e.columnMove.colTarget,delete e.columnMove.rowTarget},0),e.table.scenegraph.component.hideMoveCol(),!(e.columnResize.col<e.table.frozenColCount)||e.table.isPivotTable()||e.table.transpose?!(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount)||e.table.isPivotTable()||e.table.transpose?e.table.options.frozenColCount?e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1):e.table.options.rightFrozenColCount&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):(e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen),e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount)),e.table.scenegraph.updateNextFrame(),!0===(null==(i=e.table.options.customConfig)?void 0:i.notUpdateInColumnRowMove)||l}(this)}checkFrozen(){var e;let t=this.table.options.frozenColCount?this.table.options.frozenColCount:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?(null!=(e=this.table.rowHeaderLevelCount)?e:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(t){t=Math.min(t,this.table.colCount);let e=this.table.getContainer();if(e&&0===e.clientWidth){if(this._frozenObserver)return;return this._frozenObserver=new ResizeObserver(e=>{for(let t of e)if(t.contentRect.width>0)return this.clearFrozenObserver(),this.table.resize(),void setTimeout(()=>{this.checkFrozen()},0)}),void this._frozenObserver.observe(e)}if(this.table.getColsWidth(0,t-1)>this.table._getMaxFrozenWidth())if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{let e=this.table._getComputedFrozenColCount(t);this.table._setFrozenColCount(e),this.setFrozenCol(e)}else this.table.frozenColCount!==t&&(this.table._setFrozenColCount(t),this.setFrozenCol(t))}else this.clearFrozenObserver()}clearFrozenObserver(){this._frozenObserver&&(this._frozenObserver.disconnect(),this._frozenObserver=null)}setFrozenCol(e){e!==this.frozen.col&&(this.frozen.col=e,this.table.scenegraph.updateFrozen()),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(e){e!==this.frozen.row&&(this.frozen.row=e,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var e,t;let i=this.table.getAllRowsHeight(),l=this.scroll.verticalBarPos,o=this.table.tableNoFrameHeight;l+o>=i&&this.table.fireListeners(z.B.SCROLL_VERTICAL_END,{scrollTop:l,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(t=this.table.theme.scrollStyle)?void 0:t.width,viewHeight:o,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var e,t;let i=this.table.getAllColsWidth(),l=this.scroll.horizontalBarPos,o=this.table.tableNoFrameWidth;l+o>=i&&this.table.fireListeners(z.B.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:l,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(t=this.table.theme.scrollStyle)?void 0:t.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:o})}updateVerticalScrollBar(e){var t,i,l,o;let r=this.table.getAllRowsHeight(),n=this.scroll.verticalBarPos,a=Math.ceil(e*(r-this.table.scenegraph.height));(0,m.Z)(a)&&!isNaN(a)||(a=0);let s=a-this.table.scenegraph.proxy.deltaY-n;if(this.table.fireListeners(z.B.CAN_SCROLL,{event:void 0,scrollTop:a-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:e,dy:s}).some(e=>!1===e)){let e=this.scroll.verticalBarPos/(r-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(e)}else this.scroll.verticalBarPos=a,this.table.scenegraph.setY(-this.scroll.verticalBarPos,1===e),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(z.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(l=this.table.theme.scrollStyle)?void 0:l.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:e,dy:s}),n!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(e){var t,i,l,o;let r=this.table.getAllColsWidth(),n=this.scroll.horizontalBarPos,a=Math.ceil(e*(r-this.table.scenegraph.width));(0,m.Z)(a)&&!isNaN(a)||(a=0);let s=a-this.table.scenegraph.proxy.deltaX-n;if(this.table.fireListeners(z.B.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:a-this.table.scenegraph.proxy.deltaX,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:e,dx:s}).some(e=>!1===e)){let e=this.scroll.horizontalBarPos/(r-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(e)}else this.scroll.horizontalBarPos=a,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,1===e),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(z.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(l=this.table.theme.scrollStyle)?void 0:l.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:e,dx:s}),n!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(e,t,i=!0){var l,o,r,n,a,s,h;let d=this.table.getAllRowsHeight(),u=+(null!=(l=this.table.options.customConfig)&&!!l._disableColumnAndRowSizeRound);e=Math.ceil(e=Math.max(0,Math.min(e,d-this.table.scenegraph.height-u)));let c=this.scroll.verticalBarPos,g=e/(d-this.table.scenegraph.height);if((c!==e||!0===(null==(r=null==(o=this.table.options)?void 0:o.customConfig)?void 0:r.scrollEventAlwaysTrigger))&&i){let i=e;(0,m.Z)(i)&&!isNaN(i)||(i=0);let l=i-c;if(this.table.fireListeners(z.B.CAN_SCROLL,{event:null==t?void 0:t.nativeEvent,scrollTop:i,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(n=this.table.theme.scrollStyle)?void 0:n.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:l}).some(e=>!1===e)){let e=this.scroll.verticalBarPos/(d-this.table.scenegraph.height);return void this.table.scenegraph.component.updateVerticalScrollBarPos(e)}}(e!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=e,(0,m.Z)(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-e),this.table.scenegraph.component.updateVerticalScrollBarPos(g);let p=this.scroll.verticalBarPos-c;this.table.fireListeners(z.B.SCROLL,{event:null==t?void 0:t.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(s=this.table.theme.scrollStyle)?void 0:s.width,scrollWidth:null==(h=this.table.theme.scrollStyle)?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:p}),c!==e&&i&&this.checkVerticalScrollBarEnd()}setScrollLeft(e,t,i=!0){var l,o,r,n,a,s,h;this.table.scrollLeft;let d=this.table.getAllColsWidth(),u=(this.table.getFrozenColsWidth(),+(null!=(l=this.table.options.customConfig)&&!!l._disableColumnAndRowSizeRound));e=Math.ceil(e=Math.max(0,Math.min(e,d-this.table.scenegraph.width-u)));let c=this.scroll.horizontalBarPos,g=e/(d-this.table.scenegraph.width);if((c!==e||!0===(null==(r=null==(o=this.table.options)?void 0:o.customConfig)?void 0:r.scrollEventAlwaysTrigger))&&i){let i=e;(0,m.Z)(i)&&!isNaN(i)||(i=0);let l=i-c;if(this.table.fireListeners(z.B.CAN_SCROLL,{event:null==t?void 0:t.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:i,scrollHeight:null==(n=this.table.theme.scrollStyle)?void 0:n.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:l}).some(e=>!1===e)){let e=this.scroll.horizontalBarPos/(d-this.table.scenegraph.width);return void this.table.scenegraph.component.updateHorizontalScrollBarPos(e)}}e!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=e,(0,m.Z)(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-e),this.table.scenegraph.component.updateHorizontalScrollBarPos(g);let p=this.scroll.horizontalBarPos-c;this.table.fireListeners(z.B.SCROLL,{event:null==t?void 0:t.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(s=this.table.theme.scrollStyle)?void 0:s.width,scrollWidth:null==(h=this.table.theme.scrollStyle)?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:p}),c!==e&&i&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(e){this.table.scenegraph.component.showVerticalScrollBar(),e&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var e;null==(e=this.table.scenegraph)||e.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(e){var t;this.table.scenegraph.component.showHorizontalScrollBar(),null==(t=this.table.scenegraph)||t.component.showFrozenColumnShadow(),e&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var e,t;null==(e=this.table.scenegraph)||e.component.hideFrozenColumnShadow(),null==(t=this.table.scenegraph)||t.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(e,t,i,l){this.menu.isShow&&this.menu.x===i&&this.menu.y===l?this.hideMenu():this.showContextMenu(e,t,i,l)}showContextMenu(e,t,i,l){var o;(null==(o=this.table.internalProps.menu)?void 0:o.contextMenuItems)&&("html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=l,this.table.scenegraph.component.menu.attach(i,l,e,t,b.contextmenu)),this.table.fireListeners(z.B.SHOW_MENU,{x:i,y:l,col:e,row:t,type:"contextmenu"}))}triggerDropDownMenu(e,t,i,l,o){this.table.fireListeners(z.B.DROPDOWN_ICON_CLICK,{col:e,row:t,event:o}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(e,t,i,l)}showDropDownMenu(e,t,i,l){let o;"html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,l,e,t,b.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(z.B.SHOW_MENU,{x:i,y:l,col:e,row:t,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);let r=this.table.scenegraph.getCell(e,t);r.forEachChildren(e=>e.attribute.funcType===N.cI.dropDown&&(o=e,!0)),o&&(this.residentHoverIcon={col:e,row:t,icon:o},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,r),this.table.scenegraph.residentHoverIcon(e,t))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(z.B.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(z.B.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(e){this.menu.dropDownMenuHighlight=e;for(let t=0;t<e.length;t++){let{col:i,row:l}=e[t],o=this.table.getCellRange(i,l);if(o)for(let e=o.start.col;e<=o.end.col;e++)for(let t=o.start.row;t<=o.end.row;t++)this.table.scenegraph.updateCellContent(e,t)}}dropDownMenuIsHighlight(e,t,i){let l=this.menu.dropDownMenuHighlight;if(Array.isArray(l))for(let o=0;o<l.length;o++){let r=l[o],{col:n,row:a}=r,{field:s,menuKey:h}=r;if("number"!=typeof n||"number"!=typeof a)if(this.table.isPivotTable()&&(Array.isArray(s),1)){let e=this.table.internalProps.layoutMap.getPivotCellAdress(s);if(!e)continue;n=e.col,a=e.row}else{let e=this.table.internalProps.layoutMap.getHeaderCellAddressByField(s);if(!e)continue;n=e.col,a=e.row}if((0,m.Z)(n)&&(0,m.Z)(a)&&this.table.isCellRangeEqual(e,t,n,a)){let l=this.table._getHeaderLayoutMap(null!=n?n:e,null!=a?a:t).dropDownMenu||this.table.globalDropDownMenu;if("function"==typeof l&&(l=l({row:a,col:n,table:this.table})),l)for(let e=0;e<l.length;e++){let t=l[e];if((0,iI.Z)(t)&&(t.menuKey||t.text)===(h||"")&&e===i||(0,tb.Z)(t)&&t===h&&e===i)return!0}}}return!1}triggerSort(e,t,i,l){if(this.table.isPivotTable()){let i=this.table.getPivotSortState(e,t),o=i?i.toUpperCase():"NORMAL";return this.table.sort(e,t,"ASC"===o?"DESC":"DESC"===o?"NORMAL":"ASC"),void this.table.fireListeners(ik.z.PIVOT_SORT_CLICK,{col:e,row:t,order:o||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(e,t),cellLocation:this.table.getCellLocation(e,t),event:l})}let o=[...this.sort],r=this.table.internalProps.multipleSort||!o.length?null:this.sort[this.sort.length-1];!function(e,t,i,l){var o,r,n,a;let s,h=null,d=!1;if(Array.isArray(i.sortState))for(let l=0;l<i.sortState.length&&((s=i.sortState[l])&&(h=i._getHeaderCellBySortState(s)),h&&(d=iL(e,t,h.col,h.row,i)),!d);l++);else(s=i.sortState)&&(h=i._getHeaderCellBySortState(s)),h&&(d=iL(e,t,h.col,h.row,i));let u=i.getHeaderDefine(e,t);if(s&&d&&(null==u?void 0:u.sort)?s.order="asc"===s.order?"desc":"desc"===s.order?"normal":"asc":(null==u?void 0:u.sort)?s={field:i.getHeaderField(e,t),order:"asc"}:d&&(null==u?void 0:u.showSort)||(s={field:i.getHeaderField(e,t),order:"normal"}),s.event=l,i.fireListeners(z.B.SORT_CLICK,s).includes(!1))return;let c=!1,g=i.internalProps.sortState?Array.isArray(i.internalProps.sortState)&&(c=!0)?i.internalProps.sortState:[i.internalProps.sortState]:[];if(Array.isArray(g)){let e=g.findIndex(e=>e.field===s.field);e>=0?g[e]=s:g.push(s)}g=g.filter(e=>"normal"!==e.order),g=i.internalProps.multipleSort&&(c=!0)?g:g.splice(-1),g=c&&g.length?g:g[0],i.internalProps.sortState=g,i.stateManager.setSortState(g),(null==u?void 0:u.sort)&&(r=g,n=i,a=0,r=Array.isArray(r)||!r?r:[r],n.dataSource.sort((r||[]).map(e=>{var t,i;let l=n.internalProps.layoutMap.headerObjects.find(t=>t&&t.field===e.field);return{field:e.field,order:e.order||"asc",orderFn:"function"==typeof(null==(t=null==l?void 0:l.define)?void 0:t.sort)?null==(i=null==l?void 0:l.define)?void 0:i.sort:I.K$}}))),i.internalProps.useOneRowHeightFillAll=!1,i.internalProps.layoutMap.clearCellRangeMap(),i.scenegraph.sortCell();let p=!!(null==(o=i.stateManager.select.ranges)?void 0:o.length);i.stateManager.updateSelectPos(-1,-1),i.stateManager.endSelectCells(!0,p)}(e,t,this.table,l);let n=this.table.getCellRange(e,t),a=this.sort.find(e=>e.col===n.start.col&&e.row===n.start.row),s=this.table.internalProps.multipleSort||!r?null:r.col,h=this.table.internalProps.multipleSort||!r?null:r.row,d=o.findIndex(i=>i.col===e&&i.row===t);d>=0&&o.splice(d,1),this.table.scenegraph.updateSortIcon({col:e,row:t,iconMark:i,order:null==a?void 0:a.order,oldSortCol:s,oldSortRow:h,oldIconMark:null==r?void 0:r.icon}),a&&(a.icon=i),this.table.internalProps.multipleSort||o.forEach(e=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:e.col,oldSortRow:e.row,oldIconMark:null})}),this.table.fireListeners(ik.z.AFTER_SORT,{order:null==a?void 0:a.order,field:this.table.getHeaderField(e,t),event:l})}updateSortState(e){var t,i,l,o,r,n,a,s;e=Array.isArray(e)?e:[e];for(let s=0;s<e.length;s++){let h;if(e[s].field===(null==(t=this.sort[s])?void 0:t.field)&&e[e.length-1].order===(null==(i=this.sort[s])?void 0:i.order))return;let d=this.table.internalProps.multipleSort?null:(null==(l=this.sort[s])?void 0:l.col)||null,u=this.table.internalProps.multipleSort?null:(null==(o=this.sort[s])?void 0:o.row)||null;"asc"===(null==(r=this.sort[s])?void 0:r.order)||null==(n=this.sort[s])||n.order,this.setSortState(e.slice(0,s+1));let c=this.table.internalProps.layoutMap.getHeaderCellAddressByField(e[s].field);this.sort[s].col=c.col,this.sort[s].row=c.row;let g=this.table.scenegraph.getCell(this.sort[s].col,this.sort[s].row);(0,I.yW)(g,"children",e=>"sort"===e.attribute.funcType&&(h=e,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[s].col,row:this.sort[s].row,iconMark:h,order:this.sort[s].order,oldSortCol:d,oldSortRow:u,oldIconMark:null==(a=this.sort[s])?void 0:a.icon})}let h=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(t=>{e.some(e=>e.field===t.field)||h.push(t)});for(let e=0;e<h.length;e++){let t=h[e];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:null!=(s=t.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?s:0,oldSortRow:t.level,oldIconMark:null})}}triggerFreeze(e,t,i){if(!this.table.isPivotTable()&&!this.table.transpose){var l;if((l=this.table).frozenColCount>0?e!==l.frozenColCount-1?l.setFrozenColCount(e+1):l.setFrozenColCount(0):l.setFrozenColCount(e+1),this.table.hasListeners(ik.z.FREEZE_CLICK)){let i=this.table.internalProps.layoutMap.columnObjects.slice(0,e+1);this.table.fireListeners(ik.z.FREEZE_CLICK,{col:e,row:t,fields:i.reduce((e,t)=>e.concat(t.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=i}}updateCursor(e="default"){this.table.getElement().style.cursor=e}updateDrillState(e,t,i,l,o,r){this.drill.dimensionKey=e,this.drill.title=t,this.drill.drillDown=i,this.drill.drillUp=l,this.drill.col=o,this.drill.row=r,function(e,t,i,l,o){let r=o.getCellLocation(e,t),n=0,a=0,s=!1;"columnHeader"===r?(n=o.getColsWidth(0,o.rowHeaderLevelCount-1)-(0===o.frozenColCount?o.scrollLeft:0),a=o.getRowsHeight(0,t-1)+o.getRowHeight(t)/2,s=!0):"rowHeader"===r&&(a=o.getRowsHeight(0,o.columnHeaderLevelCount-1),n=o.getColsWidth(0,e-1)+o.getColWidth(e)/2,s=!0),o.scenegraph.updateDrill(s,n,a,i,l)}(o,r,i,l,this.table)}updateSparklineHoverPose(e,t,i,l){-1!==this.sparkLine.col&&-1!==this.sparkLine.row&&function(e,t,i){let l=i.scenegraph.getCell(e,t).getChildByName("sparkline"),o=null==l?void 0:l.getChildByName("highlight-line"),r=null==l?void 0:l.getChildByName("highlight-symbol");o&&o.setAttributes({visible:!1,pickable:!1}),r&&r.setAttributes({visible:!1,pickable:!1}),i.scenegraph.updateNextFrame()}(this.sparkLine.col,this.sparkLine.row,this.table);let o=!1;-1!==e&&-1!==t&&(o=function(e,t,i,l,o){var r,n;let a,s=o.scenegraph.getCell(e,t).getChildByName("sparkline"),h=null==s?void 0:s.getChildByName("sparkline-line"),d=null==s?void 0:s.getChildByName("sparkline-symbol-group");if(!h)return!1;let u=h.bandwidth,c=h.min,g=h.max,p=h.attribute.points;i-=s.globalAABBBounds.x1,s.globalAABBBounds.y1;for(let e=0;e<p.length;e++){let{x:t,y:l,defined:o,rawData:f}=p[e];if(Math.abs(i-t)<u/2&&(a={point:p[e],points:p,pointsBandWidth:u,pointData:f},o)){let e=s.getChildByName("highlight-line");if(e)e.setAttributes({points:[{x:t,y:g},{x:t,y:c}],visible:!0,pickable:!0});else{let e=(0,eh.W)({points:[{x:t,y:g},{x:t,y:c}],lineWidth:null==(r=h.hover)?void 0:r.strokeWidth,stroke:null==(n=h.hover)?void 0:n.stroke});e.name="highlight-line",s.addChild(e)}let i=s.getChildByName("highlight-symbol");if(i)i.setAttributes({x:t,y:l,visible:!0,pickable:!0});else{let e=(0,ey.t)({x:t,y:l,stroke:d.hover.stroke,lineWidth:d.hover.strokeWidth,fill:d.hover.fill,size:2*d.hover.size,symbolType:"circle"});e.name="highlight-symbol",s.addChild(e)}break}}if(o.scenegraph.updateNextFrame(),a){let i={col:e,row:t,field:o.getHeaderField(e,t),value:o.getCellValue(e,t),dataValue:o.getCellOriginValue(e,t),cellHeaderPaths:o.internalProps.layoutMap.getCellHeaderPaths(e,t),title:o.getBodyColumnDefine(e,t).title,cellRange:o.getCellRelativeRect(e,t),sparkline:{pointData:a.pointData},scaleRatio:o.canvas.getBoundingClientRect().width/o.canvas.offsetWidth};o.fireListeners(z.B.MOUSEOVER_CHART_SYMBOL,i)}return!0}(e,t,i,0,this.table)),o?(this.sparkLine.col=e,this.sparkLine.row=t):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(e,t,i,l){return(0,iN.Y)(e,t,i,l,this)}setHeaderCheckedState(e,t){return(0,iN.Vz)(e,t,this)}syncCheckedState(e,t,i,l){return(0,iN.GW)(e,t,i,l,this)}initCheckedState(e){return(0,iN.gs)(e,this)}updateHeaderCheckedState(e,t,i){return(0,iN.Pi)(e,this,t,i)}initLeftRecordsCheckState(e){return(0,iN.Bd)(e,this)}setRadioState(e,t,i,l,o){(0,iG.Oq)(e,t,i,l,o,this)}syncRadioState(e,t,i,l,o,r){return(0,iG.fM)(e,t,i,l,o,r,this)}changeCheckboxAndRadioOrder(e,t){this.checkedState.size&&(0,iN.hR)(e,t,this),this.radioState.length&&(0,iG.tO)(e,t,this)}setCustomSelectRanges(e){(function(e){let{customSelectedRangeComponents:t}=e.table.scenegraph;t.forEach((e,t)=>{e.rect.delete()}),t.clear(),e.select.customSelectRanges=[]})(this),function(e,t){let{customSelectedRangeComponents:i}=t.table.scenegraph;e.forEach(e=>{var t,l,o,r;let{range:n,style:a}=e,s=(0,eu.f)({fill:null!=(t=a.cellBgColor)&&t,stroke:null!=(l=a.cellBorderColor)&&l,lineWidth:null!=(o=a.cellBorderLineWidth)?o:0,lineDash:null!=(r=a.cellBorderLineDash)?r:[],pickable:!1});i.set(`${n.start.col}-${n.start.row}-${n.end.col}-${n.end.row}`,{rect:s,role:"body"})}),t.select.customSelectRanges=e,t1(t.table.scenegraph),t.table.scenegraph.updateNextFrame()}(e,this)}}var iV=i(93342),ij=i(70506),iU=i(90251);function i$(e){if(e.eventManager.bindSparklineHoverEvent)return;let t=!1;(e.isPivotTable()?e.internalProps.layoutMap.indicatorsDefine.some(e=>"string"!=typeof e&&"sparkline"===e.cellType):e.internalProps.layoutMap.columnObjects.some(e=>"sparkline"===e.cellType||"function"==typeof e.cellType))&&(e.eventManager.bindSparklineHoverEvent=!0,e.on(z.B.MOUSEMOVE_CELL,t=>{let{col:i,row:l,x:o,y:r}=t;"sparkline"!==e.getBodyColumnType(i,l)&&e.stateManager.updateSparklineHoverPose(-1,-1,0,0),e.stateManager.updateSparklineHoverPose(i,l,o,r)}),e.on(z.B.MOUSELEAVE_TABLE,t=>{e.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}var iX=i(6715);function iJ(e,t,i=!0){var l,o,r;let{deltaX:n,deltaY:a}=e;e.shiftKey&&e.deltaY&&(n=a,a=0);let[s,h]=function(e,t,i){var l,o;let r=Math.abs(e/t);return[Math.ceil((r<=.5?0:e)*(null!=(l=i.horizontal)?l:0)),Math.ceil((r>2?0:t)*(null!=(o=i.vertical)?o:0))]}(n,a,{horizontal:1,vertical:1});(s||h)&&t.interactionState!==B.F.scrolling&&t.updateInteractionState(B.F.scrolling);let d="scrolling"===(null==(o=null==(l=t.table.options.theme)?void 0:l.scrollStyle)?void 0:o.visible);s&&(t.setScrollLeft(t.scroll.horizontalBarPos+s,e),t.showHorizontalScrollBar(d)),h&&(t.setScrollTop(t.scroll.verticalBarPos+h,e),t.showVerticalScrollBar(d)),i&&t.resetInteractionState(t.interactionStateBeforeScroll),(null==(r=e.nativeEvent)?void 0:r.cancelable)&&("none"===t.table.internalProps.overscrollBehavior||Math.abs(a)>=Math.abs(n)&&0!==a&&iY(a,t)||Math.abs(a)<=Math.abs(n)&&0!==n&&iq(n,t))&&e.nativeEvent.preventDefault()}function iY(e,t){var i,l;return 0!=t.table.getAllRowsHeight()-t.table.scenegraph.height&&(i=e,0==(l=t).table.getAllRowsHeight()-l.table.scenegraph.height||!(i<=0)||!(l.scroll.verticalBarPos<1))&&!function(e,t){var i;let l=+(null!=(i=t.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),o=t.table.getAllRowsHeight()-t.table.scenegraph.height;return 0!==o&&e>=0&&Math.abs(t.scroll.verticalBarPos-o)<1+l}(e,t)}function iq(e,t){var i,l;return 0!=t.table.getAllColsWidth()-t.table.scenegraph.width&&(i=e,0==(l=t).table.getAllColsWidth()-l.table.scenegraph.width||!(i<=0)||!(l.scroll.horizontalBarPos<1))&&!function(e,t){var i;let l=+(null!=(i=t.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),o=t.table.getAllColsWidth()-t.table.scenegraph.width;return 0!==o&&e>=0&&Math.abs(t.scroll.horizontalBarPos-o)<1+l}(e,t)}class iQ{constructor(e){this.stateManager=e}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,i){this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var e;let t=Date.now(),i=t-this.lastTime,l=!0,o=Math.pow(this.friction,i/16),r=o*this.speedX,n=o*this.speedY,a=0,s=0;Math.abs(r)>.05&&(l=!1,a=(this.speedX+r)/2*i),Math.abs(n)>.05&&(l=!1,s=(this.speedY+n)/2*i),null==(e=this.scrollHandle)||e.call(this,a,s),l?this.runingId=null:(this.lastTime=t,this.speedX=r,this.speedY=n,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function i0(e,t,i){var l,o,r,n,a,s,h,d;if(t&&-1!==(null==(l=e.stateManager.columnMove)?void 0:l.colSource)&&-1!==(null==(o=e.stateManager.columnMove)?void 0:o.rowSource)&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.colTarget)&&-1!==(null==(n=e.stateManager.columnMove)?void 0:n.rowTarget)){if(e.hasListeners(z.B.CHANGE_HEADER_POSITION)){let{colSource:t,rowSource:l,colTarget:o,rowTarget:r}=e.stateManager.columnMove,n=null!=(a=e.stateManager.columnMove.rowSourceSize)?a:0,h=null!=(s=e.stateManager.columnMove.rowTargetSize)?s:0;e.fireListeners(z.B.CHANGE_HEADER_POSITION,{target:{col:o,row:r+h-n},source:{col:t,row:l},event:i})}}else if(!t&&e.hasListeners(z.B.CHANGE_HEADER_POSITION_FAIL)){let t=null!=(h=e.stateManager.columnMove.rowSourceSize)?h:0,l=null!=(d=e.stateManager.columnMove.rowTargetSize)?d:0;e.fireListeners(z.B.CHANGE_HEADER_POSITION_FAIL,{target:{col:e.stateManager.columnMove.colTarget,row:e.stateManager.columnMove.rowTarget+l-t},source:{col:e.stateManager.columnMove.colSource,row:e.stateManager.columnMove.rowSource},event:i})}}function i1(e){e.stateManager.endResizeCol();let t=[];for(let i=0;i<e.colCount;i++)t.push(e.getColWidth(i));e.fireListeners(z.B.RESIZE_COLUMN_END,{col:e.stateManager.columnResize.col,colWidths:t})}function i2(e){e.stateManager.endResizeRow(),e.fireListeners(z.B.RESIZE_ROW_END,{row:e.stateManager.rowResize.row,rowHeight:e.getRowHeight(e.stateManager.rowResize.row)})}let i3=1;function i6(){return T.UG?i3=1:(i3=Math.ceil(window.devicePixelRatio||1))>1&&i3%2!=0&&(i3+=1),i3}i6();var i5=function(e,t,i,l){return new(i||(i=Promise))(function(o,r){function n(e){try{s(l.next(e))}catch(e){r(e)}}function a(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,a)}s((l=l.apply(e,t||[])).next())})};function i4(e){return!!e.changedTouches}function i8(e,t,i){if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&t===i.columnHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return"top";if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return"bottom";if(e===i.rowHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return"left"}else{if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return"left";if(e===i.colCount-i.rightFrozenColCount&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return"right";t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&(i.colCount,i.rightFrozenColCount)}return"bottom"}function i9(e,t,i,l,o,r,n){var a;let s=n||"_vtable_rowSeries_number",h=t+1;for(;(0,eH.Z)(l[h])&&(null==(a=l[h])?void 0:a.length)>i.length;){let t=o.columnHeaderLevelCount+h;o.stateManager.setCheckedState(r,t,s,e),(0,iN.r5)(r,t,e,o),h++}}function i7(e,t,i,l,o,r){var n;let a=t.length-1;if(a>0){let t=e-1;for(;a>0&&t>=0;)((0,eH.Z)(i[t])&&(null==(n=i[t])?void 0:n.length)===a||1===a&&(0,J.Z)(i[t]))&&(function(e,t,i,l,o){let{checkedState:r}=l.stateManager,n=i.toString(),a=o||"_vtable_rowSeries_number";(0,eH.Z)(i)&&i.length;let s=!1,h=[],d=Array.from(r.keys()).sort((e,t)=>{var i,l;let o=e.split(","),r=t.split(","),n=Math.max(o.length,r.length);for(let e=0;e<n;e++){let t=null!=(i=Number(o[e]))?i:0,n=null!=(l=Number(r[e]))?l:0;if(t!==n)return t-n}return 0}),u=d.map(e=>r.get(e)),c=d.filter(e=>e.startsWith(n+",")&&e!==n);if(u.forEach((e,t)=>{let i=d[t],l=c.includes(i);s&&(l?h.push(e[a]):s=!1),i===n&&(s=!0)}),0===h.length)return;let g=h.every(e=>!!e),p=h.every(e=>!e);g?(l.stateManager.setCheckedState(e,t,a,!0),(0,iN.r5)(e,t,!0,l)):p?(l.stateManager.setCheckedState(e,t,a,!1),(0,iN.r5)(e,t,!1,l)):(l.stateManager.setCheckedState(e,t,a,"indeterminate"),(0,iN.r5)(e,t,"indeterminate",l))}(o,l.columnHeaderLevelCount+t,i[t],l,r),a--),t--}}function le(e,t,i,l){let{checkedState:o}=i.stateManager,r=t.toString();(0,eH.Z)(t)&&t.length;let n=!1,a=Array.from(o.keys()).sort((e,t)=>{var i,l;let o=e.split(","),r=t.split(","),n=Math.max(o.length,r.length);for(let e=0;e<n;e++){let t=null!=(i=Number(o[e]))?i:0,n=null!=(l=Number(r[e]))?l:0;if(t!==n)return t-n}return 0}),s=a.filter(e=>e.startsWith(r+",")&&e!==r);a.map(e=>o.get(e)).forEach((t,i)=>{let o=a[i],h=0!==s.length&&s.includes(o);n&&(h?t[l]=e:n=!1),o===r&&(n=!0)})}function lt(e,t,i){let l=e.getRecordShowIndexByCell(t,i);return e.dataSource.getHierarchyState(l)}class li{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.table=e,this.handleTextStickBindId=[],this.inertiaScroll=new iQ(e.stateManager),"node"===A.X.mode||e.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){(function(e){let t=e.table,i=t.stateManager;t.scenegraph.tableGroup.addEventListener("pointermove",l=>{var o,r,n,a,s,h,d,u,c,g,p,f,b,C,v,w,y,x,_;let S=null!=(r=null==(o=t.eventManager.LastPointerXY)?void 0:o.x)?r:l.x,R=null!=(a=null==(n=t.eventManager.LastPointerXY)?void 0:n.y)?a:l.y;t.eventManager.LastPointerXY={x:l.x,y:l.y},e.touchSetTimeout&&(clearTimeout(e.touchSetTimeout),e.touchSetTimeout=void 0);let H=(0,io.RJ)(l);if(H.eventArgs&&t.hasListeners(z.B.MOUSEMOVE_TABLE)&&t.fireListeners(z.B.MOUSEMOVE_TABLE,{col:H.eventArgs.col,row:H.eventArgs.row,x:H.abstractPos.x,y:H.abstractPos.y,event:l.nativeEvent,target:null==(s=null==H?void 0:H.eventArgs)?void 0:s.target,mergeCellInfo:null==(h=H.eventArgs)?void 0:h.mergeInfo}),i.interactionState===B.F.grabing&&!(null==(d=t.editorManager)?void 0:d.editingEditor))return void(Math.abs(S-l.x)+Math.abs(R-l.y)>=1&&(i.isResizeCol()||i.isResizeRow()||(i.isMoveCol()?e.dealColumnMover(H):i.isFillHandle()?e.dealFillSelect(H,!0):(null==(u=t.options.select)?void 0:u.disableDragSelect)||e.dealTableSelect(H,!0))));!(null==(c=t.options.select)?void 0:c.disableDragSelect)&&t.eventManager.isDraging&&i.isSelecting()&&!(null==(g=t.editorManager)?void 0:g.editingEditor)&&e.dealTableSelect(H,!0);let A=l.path.find(e=>"cell"===e.role);if(t.hasListeners(z.B.MOUSELEAVE_CELL)&&(-1===t.stateManager.hover.cellPos.col||-1===t.stateManager.hover.cellPos.row||(null==A?void 0:A.col)===t.stateManager.hover.cellPos.col&&(null==A?void 0:A.row)===t.stateManager.hover.cellPos.row||t.fireListeners(z.B.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:l.nativeEvent,target:null==(p=null==H?void 0:H.eventArgs)?void 0:p.target})),t.hasListeners(z.B.MOUSEENTER_CELL)&&"cell"===(null==A?void 0:A.role)&&(0,m.Z)(A.col)&&(0,m.Z)(A.row)&&(A.col!==t.stateManager.hover.cellPos.col||A.row!==t.stateManager.hover.cellPos.row)&&(A.col!==(null==(f=t.stateManager.hover.cellPosContainHeader)?void 0:f.col)||A.row!==(null==(b=t.stateManager.hover.cellPosContainHeader)?void 0:b.row))&&t.fireListeners(z.B.MOUSEENTER_CELL,{col:A.col,row:A.row,cellRange:t.getCellRangeRelativeRect({col:A.col,row:A.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:l.nativeEvent,target:null==(C=null==H?void 0:H.eventArgs)?void 0:C.target,mergeCellInfo:null==(v=H.eventArgs)?void 0:v.mergeInfo}),e.dealIconHover(H),e.dealTableHover(H),t.theme.columnResize.visibleOnHover&&e.checkColumnResize(H,!0),H.eventArgs&&t.hasListeners(z.B.MOUSEMOVE_CELL)){let e,i;if(null==(w=H.eventArgs)?void 0:w.target){let t=iD(null==(y=H.eventArgs)?void 0:y.target);t&&(e=t.icon,i=t.position)}t.fireListeners(z.B.MOUSEMOVE_CELL,{col:H.eventArgs.col,row:H.eventArgs.row,x:H.abstractPos.x,y:H.abstractPos.y,event:l.nativeEvent,targetIcon:e?{name:e.name,position:i,funcType:e.attribute.funcType}:void 0,target:null==(x=null==H?void 0:H.eventArgs)?void 0:x.target,mergeCellInfo:null==(_=H.eventArgs)?void 0:_.mergeInfo})}}),t.scenegraph.tableGroup.addEventListener("pointerout",t=>{var i;let l=(0,io.RJ)(t),o=null==(i=null==l?void 0:l.eventArgs)?void 0:i.target;"table"===(null==o?void 0:o.role)&&e.dealTableHover()}),t.scenegraph.tableGroup.addEventListener("pointerover",e=>{var i,l;let o=(0,io.RJ)(e),r=null==(i=null==o?void 0:o.eventArgs)?void 0:i.target;if(r&&t.hasListeners(z.B.MOUSEOVER_CHART_SYMBOL)&&"symbol"===r.type){let i=e.composedPath().find(e=>"cell"===e.roll);if(i){let{col:r,row:n}=i,a={col:r,row:n,field:t.getHeaderField(r,n),value:t.getCellValue(r,n),dataValue:t.getCellOriginValue(r,n),cellHeaderPaths:t.internalProps.layoutMap.getCellHeaderPaths(r,n),title:t.getBodyColumnDefine(r,n).title,cellRange:t.getCellRelativeRect(r,n),event:e.nativeEvent,sparkline:{pointData:void 0},scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:null==(l=null==o?void 0:o.eventArgs)?void 0:l.target};t.fireListeners(z.B.MOUSEOVER_CHART_SYMBOL,a)}}}),t.scenegraph.tableGroup.addEventListener("pointerenter",e=>{(t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.horizontalVisible||!t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.visible)&&i.showHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.verticalVisible||!t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.visible)&&i.showVerticalScrollBar(),t.hasListeners(z.B.MOUSEENTER_TABLE)&&t.fireListeners(z.B.MOUSEENTER_TABLE,{event:e.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerleave",l=>{i.isResizeCol()||i.isResizeRow()||i.isMoveCol()||i.isSelecting()||(i.updateInteractionState(B.F.default),i.updateCursor()),(t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.horizontalVisible||!t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.visible)&&i.hideHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.verticalVisible||!t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.visible)&&i.hideVerticalScrollBar(),t.hasListeners(z.B.MOUSELEAVE_CELL)&&-1!==t.stateManager.hover.cellPos.col&&-1!==t.stateManager.hover.cellPos.row&&t.fireListeners(z.B.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:l.nativeEvent,target:void 0}),e.dealTableHover();let o=l.target;o&&!o.isDescendantsOf(t.scenegraph.tableGroup)&&t.fireListeners(z.B.MOUSELEAVE_TABLE,{event:l.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerdown",l=>{var o,r,n,a,s;if(t.hasListeners(z.B.MOUSEDOWN_TABLE)&&t.fireListeners(z.B.MOUSEDOWN_TABLE,{event:l.nativeEvent}),(0,A.u)(),t.eventManager.isDown=!0,t.eventManager.LastBodyPointerXY={x:l.x,y:l.y},t.eventManager.LastPointerXY={x:l.x,y:l.y},0!==l.button)return;let h=(0,io.RJ)(l);if(e.downIcon=void 0,i.interactionState!==B.F.default||(t.isPivotChart()&&"chart"!==(null==(o=null==h?void 0:h.eventArgs)?void 0:o.target.type)&&t.scenegraph.updateChartState(null),(null==(r=h.eventArgs)?void 0:r.target)!==(null==(n=i.residentHoverIcon)?void 0:n.icon)&&i.hideMenu(),"chart"===(null==(a=null==h?void 0:h.eventArgs)?void 0:a.target.type)))return;let d=null==(s=t.editorManager)?void 0:s.completeEdit(l.nativeEvent);(0,T.NC)(d,o=>{var r,n,a,s,d,u,c,g,p,f,b;if(!1===o)return;let C=(null==(a=null==(n=null==(r=null==h?void 0:h.eventArgs)?void 0:r.target)?void 0:n.role)?void 0:a.startsWith("icon"))?h.eventArgs.target:(null==(s=l.target.role)?void 0:s.startsWith("icon"))?l.target:void 0;if(e.downIcon=C,C&&!1!==C.attribute.interactive)C.attribute.funcType===N.cI.dragReorder&&(i.startMoveCol(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y,null==(f=null==(p=h.eventArgs)?void 0:p.event)?void 0:f.nativeEvent),i.updateInteractionState(B.F.grabing));else{if(e.cellIsHeaderCheck(h))return;if("touch"===l.pointerType){if(e.touchEnd=!1,e.touchSetTimeout=setTimeout(()=>{e.isTouchdown=!1,e.isLongTouch=!0,!e.touchEnd&&(e.checkColumnResize(h,!0)||e.checkRowResize(h,!0))||!e.touchEnd&&e.checkColumnMover(h)?i.updateInteractionState(B.F.grabing):e.dealTableSelect(h)&&!e.touchEnd&&i.updateInteractionState(B.F.grabing)},500),t.hasListeners(z.B.MOUSEENTER_CELL)){let e=l.path.find(e=>"cell"===e.role);"cell"===(null==e?void 0:e.role)&&(0,m.Z)(e.col)&&(0,m.Z)(e.row)&&(e.col!==t.stateManager.hover.cellPos.col||e.row!==t.stateManager.hover.cellPos.row)&&(e.col!==(null==(d=t.stateManager.hover.cellPosContainHeader)?void 0:d.col)||e.row!==(null==(u=t.stateManager.hover.cellPosContainHeader)?void 0:u.row))&&t.fireListeners(z.B.MOUSEENTER_CELL,{col:e.col,row:e.row,cellRange:t.getCellRangeRelativeRect({col:e.col,row:e.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:l.nativeEvent,target:null==(c=null==h?void 0:h.eventArgs)?void 0:c.target,mergeCellInfo:null==(g=h.eventArgs)?void 0:g.mergeInfo})}e.dealTableHover(h)}else{if(!e.checkCellFillhandle(h)&&(e.checkColumnResize(h,!0)||e.checkRowResize(h,!0)))return t.scenegraph.updateChartState(null),void i.updateInteractionState(B.F.grabing);if(e.checkColumnMover(h)||e.checkCellFillhandle(h,!0)&&e.dealFillSelect(h))return void i.updateInteractionState(B.F.grabing);e.dealTableSelect(h)&&i.updateInteractionState(B.F.grabing)}}if(t.hasListeners(z.B.MOUSEDOWN_CELL)){let e=(0,io.RJ)(l);e.eventArgs&&t.fireListeners(z.B.MOUSEDOWN_CELL,{col:e.eventArgs.col,row:e.eventArgs.row,event:l.nativeEvent,target:null==(b=null==e?void 0:e.eventArgs)?void 0:b.target,mergeCellInfo:e.eventArgs.mergeInfo})}})}),t.scenegraph.tableGroup.addEventListener("pointerup",l=>{var o,r,n,a,s,h,d,u;if(0===l.button){if("grabing"===i.interactionState){if(i.updateInteractionState(B.F.default),i.isResizeCol())i1(t);else if(i.isResizeRow())i2(t);else if(i.isMoveCol()){let e=t.stateManager.endMoveCol();i0(t,e,l.nativeEvent)}else if(i.isSelecting()){t.stateManager.endSelectCells(),t.stateManager.isFillHandle()&&t.stateManager.endFillSelect();let e=(0,io.RJ)(l);if(t.eventManager.isDraging&&e.eventArgs&&t.hasListeners(z.B.DRAG_SELECT_END)){let i={event:l.nativeEvent,cells:[],col:e.eventArgs.target.col,row:e.eventArgs.target.row,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:null==(o=null==e?void 0:e.eventArgs)?void 0:o.target,mergeCellInfo:null==(r=e.eventArgs)?void 0:r.mergeInfo};i.cells=t.getSelectedCellInfos(),t.fireListeners(z.B.DRAG_SELECT_END,i)}}}else i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default);if(!t.eventManager.isDraging){let i=(0,io.RJ)(l);if(!e.isTouchMove&&0===l.button&&i.eventArgs&&t.hasListeners(z.B.CLICK_CELL)){let e,o,{col:r,row:d}=i.eventArgs,u=t.getCellInfo(r,d);if(null==(n=i.eventArgs)?void 0:n.target){let t=iD(null==(a=i.eventArgs)?void 0:a.target);t&&(e=t.icon,o=t.position)}let c=Object.assign(Object.assign({},u),{event:l.nativeEvent,federatedEvent:l,cells:[],targetIcon:e?{name:e.name,position:o,funcType:e.attribute.funcType}:void 0,target:null==(s=null==i?void 0:i.eventArgs)?void 0:s.target,mergeCellInfo:null==(h=i.eventArgs)?void 0:h.mergeInfo});t.fireListeners(z.B.CLICK_CELL,c)}}if(t.hasListeners(z.B.MOUSEUP_CELL)){let e=(0,io.RJ)(l);e.eventArgs&&t.fireListeners(z.B.MOUSEUP_CELL,{col:e.eventArgs.col,row:e.eventArgs.row,event:l.nativeEvent,target:null==(d=null==e?void 0:e.eventArgs)?void 0:d.target,mergeCellInfo:null==(u=e.eventArgs)?void 0:u.mergeInfo})}setTimeout(()=>{e.isDown=!1,e.isTouchdown=!1,e.isTouchMove=!1,e.isDraging=!1,e.touchMovePoints=[]},0)}}),t.scenegraph.tableGroup.addEventListener("rightdown",e=>{var l,o,r,n,a,s;let h=(0,io.RJ)(e);if(h.eventArgs){i.triggerContextMenu(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y);let{col:d,row:u}=h.eventArgs;if(t.hasListeners(z.B.CONTEXTMENU_CELL)){let i,c,g=t.getCellInfo(d,u);if(null==(l=h.eventArgs)?void 0:l.target){let e=iD(null==(o=h.eventArgs)?void 0:o.target);e&&(i=e.icon,c=e.position)}let p=Object.assign(Object.assign({},g),{event:e.nativeEvent,cells:[],targetIcon:i?{name:i.name,position:c,funcType:i.attribute.funcType}:void 0,target:null==(r=null==h?void 0:h.eventArgs)?void 0:r.target,mergeCellInfo:null==(n=h.eventArgs)?void 0:n.mergeInfo});(null==(s=null==(a=t.options.eventOptions)?void 0:a.contextmenuReturnAllSelectedCells)||s)&&((0,T.yD)(t.stateManager.select.ranges,d,u)?p.cells=t.getSelectedCellInfos():p.cells=[[g]]),t.fireListeners(z.B.CONTEXTMENU_CELL,p)}}}),t.scenegraph.tableGroup.addEventListener("pointertap",l=>{var o;if(t.stateManager.columnResize.resizing)return;let r=(0,io.RJ)(l);if(!t.stateManager.columnResize.resizing&&!t.stateManager.columnMove.moving&&(e.dealIconClick(l,r),(null==r?void 0:r.eventArgs)&&e.touchSetTimeout&&"touch"===l.pointerType)){let t=(0,io.RJ)(l);if(e.touchSetTimeout){clearTimeout(e.touchSetTimeout);let l=!!(null==(o=i.select.ranges)?void 0:o.length);e.dealTableSelect(t),i.endSelectCells(!0,l),e.touchSetTimeout=void 0}}}),t.scenegraph.stage.addEventListener("pointerdown",l=>{var o,r,n,a;let s=(0,io.RJ)(l);(null==(o=s.eventArgs)?void 0:o.target)&&(null==(r=s.eventArgs)?void 0:r.target)===(null==(n=i.residentHoverIcon)?void 0:n.icon)||i.hideMenu();let h=null==(a=t.editorManager)?void 0:a.completeEdit(l.nativeEvent);(0,T.NC)(h,o=>{var r;if(!1===o)return;let n=(null==(r=l.target.role)?void 0:r.startsWith("icon"))?l.target:void 0;if(e.downIcon=n,"touch"===l.pointerType||n||e.checkCellFillhandle(s)||i.columnResize.resizing||!e.checkColumnResize(s,!0));else{t.scenegraph.updateChartState(null),i.updateInteractionState(B.F.grabing);let{eventArgs:e}=s;!(null==e?void 0:e.targetCell)&&t.getCellAt(s.abstractPos.x-t.theme.columnResize.resizeHotSpotSize/2,s.abstractPos.y)&&t.hasListeners(z.B.MOUSEDOWN_TABLE)&&t.fireListeners(z.B.MOUSEDOWN_TABLE,{event:l.nativeEvent})}})}),t.scenegraph.stage.addEventListener("pointerup",e=>{"grabing"===i.interactionState&&(i.updateInteractionState(B.F.default),i.isResizeCol()?i1(t):i.isResizeRow()&&i2(t))}),t.scenegraph.stage.addEventListener("pointertap",l=>{var o,r,n;let a=l.target;if(t.eventManager.isDraging||!a||!a.isDescendantsOf(t.scenegraph.stage)&&a.stage!==a||a.isDescendantsOf(t.scenegraph.tableGroup))t.eventManager.isDraging&&i.isSelecting()&&i.endSelectCells();else{i.updateInteractionState(B.F.default),e.dealTableHover();let l=!!(null==(o=i.select.ranges)?void 0:o.length);(null==(n=null==(r=t.options.select)?void 0:r.blankAreaClickDeselect)||n)&&e.dealTableSelect(),i.endSelectCells(!0,l),i.updateCursor(),t.scenegraph.updateChartState(null)}}),t.scenegraph.stage.addEventListener("pointermove",l=>{let o=(0,io.RJ)(l);i.isResizeCol()||e.checkColumnResize(o)?t.stateManager.select&&e.checkCellFillhandle(o)?i.updateCursor("crosshair"):i.updateCursor("col-resize"):i.isResizeRow()||e.checkRowResize(o)?t.stateManager.select&&e.checkCellFillhandle(o)?i.updateCursor("crosshair"):i.updateCursor("row-resize"):i.isMoveCol()||i.updateCursor()}),t.scenegraph.tableGroup.addEventListener("checkbox_state_change",e=>{var i,l;let o=(0,io.RJ)(e),{col:r,row:n}=o.eventArgs,a=t.getCellInfo(r,n),s=(0,Z.Z)(t,r,n);if(s)for(let i=s.start.col;i<=s.end.col;i++)for(let l=s.start.row;l<=s.end.row;l++)t.scenegraph.getCell(i,l).forEachChildren(t=>{"checkbox"===t.name&&t.setAttributes({checked:e.target.attribute.checked,indeterminate:e.target.attribute.indeterminate})});let h=Object.assign(Object.assign({},a),{event:e.nativeEvent,target:null==(i=null==o?void 0:o.eventArgs)?void 0:i.target,mergeCellInfo:null==(l=null==o?void 0:o.eventArgs)?void 0:l.mergeInfo,checked:e.detail.checked});if(t.isHeader(r,n))t.stateManager.setHeaderCheckedState(a.field,e.detail.checked),t.internalProps.enableCheckboxCascade&&"checkbox"===t.getCellType(r,n)&&t.scenegraph.updateCheckboxCellState(r,n,e.detail.checked);else if(t.stateManager.setCheckedState(r,n,a.field,e.detail.checked),t.internalProps.enableCheckboxCascade&&"checkbox"===t.getCellType(r,n)){let e=t.stateManager.headerCheckedState[a.field],i=t.stateManager.updateHeaderCheckedState(a.field,r,n);e!==i&&t.scenegraph.updateHeaderCheckboxCellState(r,n,i)}t.fireListeners(z.B.CHECKBOX_STATE_CHANGE,h),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("radio_checked",e=>{var i,l,o;let r=(0,io.RJ)(e),{col:n,row:a,target:s}=r.eventArgs,h=t.getCellInfo(n,a),d=null==(i=io.xD.exec(s.id))?void 0:i[1],u=(0,Z.Z)(t,n,a);if(u)for(let e=u.start.col;e<=u.end.col;e++)for(let i=u.start.row;i<=u.end.row;i++)t.scenegraph.getCell(e,i).forEachChildren(e=>{"radio"===e.name&&e.id===s.id&&e.setAttributes({checked:!0})});let c=t.getBodyColumnDefine(n,a).radioCheckType||"column";if("cell"===c)if(u)for(let e=u.start.col;e<=u.end.col;e++)for(let i=u.start.row;i<=u.end.row;i++)t.scenegraph.getCell(e,i).forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})});else t.scenegraph.getCell(n,a).forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})});else"column"===c&&t.scenegraph.getColGroup(n).forEachChildren(e=>{e.forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})})});let g=d?Number(d):void 0;t.stateManager.setRadioState(n,a,h.field,c,g);let p=Object.assign(Object.assign({},h),{event:e.nativeEvent,target:null==(l=null==r?void 0:r.eventArgs)?void 0:l.target,mergeCellInfo:null==(o=null==r?void 0:r.eventArgs)?void 0:o.mergeInfo,radioIndexInCell:g});t.fireListeners(z.B.RADIO_STATE_CHANGE,p),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("switch_state_change",e=>{var i,l;let o=(0,io.RJ)(e),{col:r,row:n,target:a}=o.eventArgs,s=t.getCellInfo(r,n),h=(0,Z.Z)(t,r,n);if(h)for(let i=h.start.col;i<=h.end.col;i++)for(let l=h.start.row;l<=h.end.row;l++)t.scenegraph.getCell(i,l).forEachChildren(t=>{"switch"===t.name&&t.setAttributes({checked:e.target.attribute.checked})});let d=Object.assign(Object.assign({},s),{event:e.nativeEvent,target:null==(i=null==o?void 0:o.eventArgs)?void 0:i.target,mergeCellInfo:null==(l=null==o?void 0:o.eventArgs)?void 0:l.mergeInfo,checked:e.detail.checked});t.stateManager.setCheckedState(r,n,s.field,e.detail.checked),t.fireListeners(z.B.SWITCH_STATE_CHANGE,d),t.scenegraph.updateNextFrame()}),t.scenegraph.stage.addEventListener("wheel",e=>{var l;e.path.find(e=>"legend"===e.name)||(null==(l=t.editorManager)||l.completeEdit(),t.eventManager._enableTableScroll&&iJ(e,i))})})(this),function(e){let t=e.table,i=t.stateManager,l=t.internalProps.handler;function o(e){var i;if(t.hasListeners(z.B.KEYDOWN)){let l={keyCode:null!=(i=e.keyCode)?i:e.which,code:e.code,event:e,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth};t.fireListeners(z.B.KEYDOWN,l)}}l.on(t.getElement(),"blur",t=>{e.dealTableHover()}),l.on(t.getElement(),"keydown",l=>{var r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,L;let k={keyCode:null!=(r=l.keyCode)?r:l.which,code:l.code,event:l};if(t.fireListeners(z.B.BEFORE_KEYDOWN,k),"a"===l.key&&(l.ctrlKey||l.metaKey))(null==(n=t.keyboardOptions)?void 0:n.selectAllOnCtrlA)&&(l.preventDefault(),e.deelTableSelectAll());else if(i.select.cellPos.col>=0&&i.select.cellPos.row>=0&&("ArrowUp"===l.key||"ArrowDown"===l.key||"ArrowLeft"===l.key||"ArrowRight"===l.key)){let e,o;if((null==(s=null==(a=t.options.keyboardOptions)?void 0:a.moveEditCellOnArrowKeys)||!s)&&(null==(h=t.editorManager)?void 0:h.editingEditor)||!1===(null==(d=t.options.keyboardOptions)?void 0:d.moveSelectedCellOnArrowKeys)||(l.preventDefault(),l.stopPropagation(),"ArrowUp"===l.key?l.ctrlKey||l.metaKey?(e=i.select.cellPos.col,o=0):(l.shiftKey,e=i.select.cellPos.col,o=Math.min(t.rowCount-1,Math.max(0,i.select.cellPos.row-1))):"ArrowDown"===l.key?l.ctrlKey||l.metaKey?(e=i.select.cellPos.col,o=t.rowCount-1):(l.shiftKey,e=i.select.cellPos.col,o=Math.min(t.rowCount-1,Math.max(0,i.select.cellPos.row+1))):"ArrowLeft"===l.key?l.ctrlKey||l.metaKey?(e=0,o=i.select.cellPos.row):(l.shiftKey,o=i.select.cellPos.row,e=Math.min(t.colCount-1,Math.max(0,i.select.cellPos.col-1))):"ArrowRight"===l.key&&(l.ctrlKey||l.metaKey?(e=t.colCount-1,o=i.select.cellPos.row):(l.shiftKey,o=i.select.cellPos.row,e=Math.min(t.colCount-1,Math.max(0,i.select.cellPos.col+1)))),e0(t,e,o)))return;t.selectCell(e,o,l.shiftKey),null!=(c=null==(u=t.options.keyboardOptions)?void 0:u.moveEditCellOnArrowKeys)&&c&&(null==(g=t.editorManager)?void 0:g.editingEditor)&&(null==(p=t.editorManager)||p.completeEdit(),t.getElement().focus(),t.getEditor(e,o)&&(null==(f=t.editorManager)||f.startEditCell(e,o)))}else if("Escape"===l.key)null==(b=t.editorManager)||b.cancelEdit(),t.getElement().focus();else if("Enter"===l.key){if(null==(m=t.editorManager)?void 0:m.editingEditor){if(o(l),null==(C=t.editorManager)||C.completeEdit(),t.getElement().focus(),!0===(null==(v=t.options.keyboardOptions)?void 0:v.moveFocusCellOnEnter)){let e=i.select.cellPos.col,o=Math.min(t.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(e0(t,e,o))return;t.selectCell(e,o,l.shiftKey)}return}if(!0===(null==(w=t.options.keyboardOptions)?void 0:w.moveFocusCellOnEnter)){let e=i.select.cellPos.col,o=Math.min(t.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(e0(t,e,o))return;t.selectCell(e,o,l.shiftKey)}else if((null==(x=null==(y=t.options.keyboardOptions)?void 0:y.editCellOnEnter)||x)&&1===(null!=(S=null==(_=t.stateManager.select.ranges)?void 0:_.length)?S:0)){let e=t.stateManager.select.ranges[0].start.col,i=t.stateManager.select.ranges[0].start.row,l=t.stateManager.select.ranges[0].end.col,o=t.stateManager.select.ranges[0].end.row;e===l&&i===o&&t.getEditor(e,i)&&(null==(R=t.editorManager)||R.startEditCell(e,i))}}else if("Tab"===l.key){if((null==(A=null==(H=t.options.keyboardOptions)?void 0:H.moveFocusCellOnTab)||A)&&i.select.cellPos.col>=0&&i.select.cellPos.row>=0){let e,o;if(i.select.cellPos.col===t.colCount-1&&i.select.cellPos.row===t.rowCount-1||(l.preventDefault(),i.select.cellPos.col===t.colCount-1?(o=Math.min(t.rowCount-1,i.select.cellPos.row+1),e=t.rowHeaderLevelCount):(o=i.select.cellPos.row,e=i.select.cellPos.col+1),e0(t,e,o)))return;t.selectCell(e,o),(null==(M=t.editorManager)?void 0:M.editingEditor)&&(null==(F=t.editorManager)||F.completeEdit(),t.getElement().focus(),t.getEditor(e,o)&&(null==(B=t.editorManager)||B.startEditCell(e,o)))}}else if(!l.ctrlKey&&!l.metaKey){let e=t.options.editCellTrigger;("keydown"===e||Array.isArray(e)&&e.includes("keydown"))&&!(null==(T=t.editorManager)?void 0:T.editingEditor)&&l.key.match(/^[a-zA-Z0-9+\-*\/%=.,\s]$/)&&(t.editorManager&&(t.editorManager.beginTriggerEditCellMode="keydown"),null==(L=t.editorManager)||L.startEditCell(i.select.cellPos.col,i.select.cellPos.row,""))}o(l)}),l.on(t.getElement(),"copy",e=>i5(this,void 0,void 0,function*(){var i,l;if(null==(i=t.keyboardOptions)?void 0:i.copySelected){let i=t.getCopyValue();if((0,m.Z)(i)){e.preventDefault();let o=yield navigator.permissions.query({name:"clipboard-write"});if((null==(l=navigator.clipboard)?void 0:l.write)&&"granted"===o.state){let e=(e=>{let t=["<table>"],i=e.split("\r\n");return i.forEach(function(e,l){let o=e.split("	"),r=[];0===l&&t.push("<tbody>"),o.forEach(function(e,t){let i=e?e.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";r.push(`<td>${i}</td>`)}),t.push("<tr>",...r,"</tr>"),l===i.length-1&&t.push("</tbody>")}),t.push("</table>"),['<meta name="author" content="Visactor"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>',t.join("")].join("")})(i);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([i],{type:"text/plain"})})])}else T.Xh.IE?window.clipboardData.setData("Text",i):e.clipboardData.setData("text/plain",i);t.fireListeners(z.B.COPY_DATA,{cellRange:t.stateManager.select.ranges,copyData:i})}}})),l.on(t.getElement(),"paste",e=>i5(this,void 0,void 0,function*(){var i,l,o,h;if((null==(i=t.keyboardOptions)?void 0:i.pasteValueToCell)&&t.changeCellValues){if(null==(l=t.editorManager)?void 0:l.editingEditor)return;if((null==(o=t.stateManager.select.ranges)?void 0:o.length)>0)if(null==(h=navigator.clipboard)?void 0:h.read)navigator.clipboard.read().then(e=>{for(let i of e)i.types.includes("text/html")?function(e){let i=t.stateManager.select.ranges,l=i.length,o=Math.min(i[l-1].start.col,i[l-1].end.col),h=Math.min(i[l-1].start.row,i[l-1].end.row),d=Math.max(i[l-1].start.col,i[l-1].end.col),u=Math.max(i[l-1].start.row,i[l-1].end.row),c=0,g=0,p=[];e.getType("text/html").then(e=>{e.text().then(e=>i5(this,void 0,void 0,function*(){var i,l;if(e&&/(<table)|(<TABLE)/g.test(e)){for(let t of Array.from(e.matchAll(r))){let e=Array.from(t[1].matchAll(n)).map(e=>e[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,"\n").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));p.push(e),c=Math.max(c,null!=(i=null==e?void 0:e.length)?i:0)}g=null!=(l=p.length)?l:0,p=s(p,g,c,u-h+1,d-o+1);let a=yield t.changeCellValues(o,h,p,!0);t.hasListeners(z.B.PASTED_DATA)&&t.fireListeners(z.B.PASTED_DATA,{col:o,row:h,pasteData:p,changedCellResults:a})}else navigator.clipboard.read().then(e=>{for(let t of e)t.types.includes("text/plain")&&t.getType("text/plain").then(e=>{e.text().then(a)})})}))})}(i):1===i.types.length&&"text/plain"===i.types[0]&&function(e){let i=t.stateManager.select.ranges,l=i.length,o=Math.min(i[l-1].start.col,i[l-1].end.col),r=Math.min(i[l-1].start.row,i[l-1].end.row),n=Math.max(i[l-1].start.col,i[l-1].end.col),a=Math.max(i[l-1].start.row,i[l-1].end.row),h=0,d=0;e.getType("text/plain").then(e=>{e.text().then(e=>i5(this,void 0,void 0,function*(){var i;let l=e.replace(/\r(?!\n)/g,"\r\n").split("\r\n"),u=[];l.length>1&&""===l[l.length-1]&&l.pop(),l.forEach(function(e,t){var i;let l=e.split("	"),o=[];u.push(o),l.forEach(function(e,t){e.includes("\n")&&(e=e.replace(/^"(.*)"$/,"$1").replace(/["]*/g,e=>Array(Math.floor(e.length/2)).fill('"').join(""))),o.push(e)}),h=Math.max(h,null!=(i=null==o?void 0:o.length)?i:0)}),d=null!=(i=u.length)?i:0,u=s(u,d,h,a-r+1,n-o+1);let c=yield t.changeCellValues(o,r,u,!0);t.hasListeners(z.B.PASTED_DATA)&&t.fireListeners(z.B.PASTED_DATA,{col:o,row:r,pasteData:u,changedCellResults:c})}))})}(i)});else{let i=t.stateManager.select.ranges,l=Math.min(i[0].start.col,i[0].end.col),o=Math.min(i[0].start.row,i[0].end.row),r=(e.clipboardData||window.Clipboard).getData("text").split("\n"),n=[];r.forEach(function(e,t){let i=e.split("	"),l=[];n.push(l),i.forEach(function(e,t){t===i.length-1&&(e=e.trim()),l.push(e)})});let a=yield t.changeCellValues(l,o,n);t.hasListeners(z.B.PASTED_DATA)&&t.fireListeners(z.B.PASTED_DATA,{col:l,row:o,pasteData:n,changedCellResults:a})}}})),l.on(t.getElement(),"contextmenu",e=>{var i;!1!==(null==(i=t.eventOptions)?void 0:i.preventDefaultContextMenu)?e.preventDefault():d(e)}),t.options.canvas||l.on(t.getContainer(),"resize",e=>{var i;t.isReleased||0===e.width&&0===e.height||((t.autoFillWidth||t.autoFillHeight)&&(null==(i=t.editorManager)||i.completeEdit()),(0,m.Z)(t.options.pixelRatio)||t.setPixelRatio(i6()),e.windowSizeNotChange||t.resize())});let r=/<tr[^>]*>([\s\S]*?)<\/tr>/g,n=/<td[^>]*>([\s\S]*?)<\/td>/g;function a(e){var i;return i5(this,void 0,void 0,function*(){let l=t.stateManager.select.ranges,o=l.length,r=Math.min(l[o-1].start.col,l[o-1].end.col),n=Math.min(l[o-1].start.row,l[o-1].end.row),a=Math.max(l[o-1].start.col,l[o-1].end.col),h=Math.max(l[o-1].start.row,l[o-1].end.row),d=0,u=0,c=[];e.split("\n").forEach(function(e,t){var i;let l=e.split("	"),o=[];c.push(o),l.forEach(function(e,t){t===l.length-1&&(e=e.trim()),o.push(e)}),d=Math.max(d,null!=(i=null==o?void 0:o.length)?i:0)}),u=null!=(i=c.length)?i:0,c=s(c,u,d,h-n+1,a-r+1);let g=yield t.changeCellValues(r,n,c,!0);t.hasListeners(z.B.PASTED_DATA)&&t.fireListeners(z.B.PASTED_DATA,{col:r,row:n,pasteData:c,changedCellResults:g})})}function s(e,t,i,l,o){if((o>i||l>t)&&o%i==0&&l%t==0){let r=[];for(let n=0;n<l;n++){let l=[];r.push(l);for(let r=0;r<o;r++){let o=n%t,a=r%i;l.push(e[o][a])}}return r}return e}let h=l=>{var o;if(t.isReleased)return;t.eventManager.LastBodyPointerXY={x:l.x,y:l.y},t.eventManager.isDown=!0;let r=l.target;if(!t.getElement().contains(r)&&!t.internalProps.menuHandler.containElement(r)){let r=null==(o=t.editorManager)?void 0:o.completeEdit(l);(0,T.NC)(r,l=>{var o,r;if(!1!==l&&(null==(o=t.options.select)?void 0:o.outsideClickDeselect)){let t=!!(null==(r=i.select.ranges)?void 0:r.length);e.dealTableSelect(),i.endSelectCells(!0,t)}})}};e.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:h}),O.rF.addEventListener("pointerdown",h);let d=l=>{var o,r;if(t.isReleased)return;let n=l.target;if(n!==t.canvas&&(e=>{var l,o;if(i.menu.isShow&&setTimeout(()=>{t.internalProps.menuHandler.pointInMenuElement(e.clientX,e.clientY)||i.menu.isShow&&i.hideMenu()},0),i.isResizeCol())i1(t);else if(i.isResizeRow())i2(t);else if(i.isMoveCol()){let i=t.stateManager.endMoveCol();i0(t,i,e)}else if(i.isSelecting()&&(null==(o=null==(l=t.stateManager.select)?void 0:l.ranges)?void 0:o.length)){let i=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.col,l=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.row;if(t.stateManager.endSelectCells(),t.hasListeners(z.B.DRAG_SELECT_END)){let o={event:e,cells:[],col:i,row:l,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:void 0};o.cells=t.getSelectedCellInfos(),t.fireListeners(z.B.DRAG_SELECT_END,o)}}})(l),t.eventManager.LastBodyPointerXY=null,t.eventManager.isDown=!1,t.eventManager.isDraging=!1,t.eventManager.inertiaScroll.endInertia(),"grabing"===i.interactionState&&i.isResizeCol())i1(t);else if("grabing"===i.interactionState&&i.isResizeRow())i2(t);else if(i.isMoveCol()){let e=t.stateManager.endMoveCol();i0(t,e,l)}else if((null==(o=t.editorManager)?void 0:o.editingEditor)&&!t.getElement().contains(n)){let o=null==(r=t.editorManager)?void 0:r.completeEdit(l);(0,T.NC)(o,t=>{!1!==t&&(i.updateInteractionState(B.F.default),e.dealTableHover())})}i.updateInteractionState(B.F.default)};e.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:d}),O.rF.addEventListener("pointerup",d);let u=l=>{var o,r,n,a,s;if(t.eventManager.isDown&&t.eventManager.LastBodyPointerXY){let e=null!=(r=null==(o=t.eventManager.LastBodyPointerXY)?void 0:o.x)?r:l.x,i=null!=(a=null==(n=t.eventManager.LastBodyPointerXY)?void 0:n.y)?a:l.y;(Math.abs(e-l.x)>1||Math.abs(i-l.y)>1)&&(t.eventManager.isDraging=!0)}let{x:h,y:d}=t._getMouseAbstractPoint(l);i.interactionState===B.F.grabing&&(i.isResizeCol()?(e.dealColumnResize(h,d),t.hasListeners(z.B.RESIZE_COLUMN)&&t.fireListeners(z.B.RESIZE_COLUMN,{col:t.stateManager.columnResize.col,colWidth:t.getColWidth(t.stateManager.columnResize.col)})):i.isResizeRow()&&(e.dealRowResize(h,d),t.hasListeners(z.B.RESIZE_ROW)&&t.fireListeners(z.B.RESIZE_ROW,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})));let u=t.stateManager.isSelecting();if(e._enableTableScroll&&e.isDraging&&u&&(null==(s=t.stateManager.select.ranges)?void 0:s.length)>0){let e=t.getDrawRange(),i=t.getFrozenRowsHeight(),l=t.getBottomFrozenRowsHeight(),o=t.getFrozenColsWidth(),r=t.getRightFrozenColsWidth(),n=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].start;if(t.isSeriesNumber(n.col,n.row))return;let a=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end,s=(!1===t.isFrozenRow(n.row)||!1===t.isFrozenRow(a.row))&&t.getAllRowsHeight()>t.tableNoFrameHeight,u=(!1===t.isFrozenColumn(n.col)||!1===t.isFrozenColumn(a.col))&&t.getAllColsWidth()>t.tableNoFrameWidth;if((d>e.bottom-l||d<e.top+i)&&s||(h>e.right-r||h<e.left+o)&&u){t.eventManager.scrollXSpeed=0,t.eventManager.scrollYSpeed=0;let n=!1,a=!1,c=!1,g=!1;d>e.bottom-l&&s&&t.scrollTop+t.tableNoFrameHeight<t.getAllRowsHeight()?(n=!0,t.eventManager.scrollYSpeed=-(d-e.bottom+l)/50):d<e.top+i&&s&&t.scrollTop>0&&(a=!0,t.eventManager.scrollYSpeed=-(d-e.top-i)/50),h>e.right-r&&u&&t.scrollLeft+t.tableNoFrameWidth<t.getAllColsWidth()?(c=!0,t.eventManager.scrollXSpeed=-(h-e.right+r)/50):h<e.left+o&&u&&t.scrollLeft>0&&(g=!0,t.eventManager.scrollXSpeed=-(h-e.left-o)/50),t.eventManager.inertiaScroll.startInertia(t.eventManager.scrollXSpeed,t.eventManager.scrollYSpeed,1),t.eventManager.inertiaScroll.setScrollHandle((s,u)=>{var p;let f,b;iJ({deltaX:-s,deltaY:-u},t.stateManager,!1),n?b=t.scrollTop+e.height-l-20:a&&(b=t.scrollTop+i+20),c?f=t.scrollLeft+e.width-r-20:g&&(f=t.scrollLeft+o+20);let C=!1,v=!1;c||g||(h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&h<t.tableNoFrameWidth||h>0&&h<t.getFrozenColsWidth()?(f=h,v=!0):f=t.scrollLeft+h),n||a||(d>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&d<t.tableNoFrameHeight||d>0&&d<t.getFrozenRowsHeight()?(b=d,C=!0):b=t.scrollTop+d),t.stateManager.updateInteractionState(B.F.grabing);let w=t.getTargetColAtConsiderRightFrozen(f,v),y=t.getTargetRowAtConsiderBottomFrozen(b,C);!(null==(p=t.options.select)?void 0:p.disableDragSelect)&&(0,m.Z)(w)&&(0,m.Z)(y)&&t.stateManager.updateSelectPos(w.col,y.row,!1,!1,!1,!1)})}else t.eventManager.inertiaScroll.isInertiaScrolling()?t.eventManager.inertiaScroll.endInertia():t.eventManager.scrollYSpeed=0}};e.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:u}),O.rF.addEventListener("pointermove",u)}(this),function(e){let t=e.table,i=t.stateManager,l=t.scenegraph;l.component.vScrollBar.addEventListener("pointerover",e=>{i.showVerticalScrollBar()}),l.component.hScrollBar.addEventListener("pointerover",e=>{i.showHorizontalScrollBar()}),l.component.vScrollBar.addEventListener("pointerout",e=>{i.interactionState!==B.F.scrolling&&i.hideVerticalScrollBar()}),l.component.hScrollBar.addEventListener("pointerout",e=>{i.interactionState!==B.F.scrolling&&i.hideHorizontalScrollBar()}),l.component.vScrollBar.addEventListener("pointermove",e=>{l.table.stateManager.updateCursor("default"),e.stopPropagation()}),l.component.vScrollBar.addEventListener("pointerdown",e=>{e.stopPropagation(),l.table.hasListeners(z.B.MOUSEDOWN_TABLE)&&l.table.fireListeners(z.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),l.component.vScrollBar.addEventListener("scrollDown",e=>{var t;l.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},l.table.eventManager.isDown=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),l.table.stateManager.hideMenu(),null==(t=l.table.editorManager)||t.completeEdit(),l.table.hasListeners(z.B.MOUSEDOWN_TABLE)&&l.table.fireListeners(z.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),l.component.vScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,l.table.eventManager.isDraging=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),l.component.vScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),l.component.vScrollBar.addEventListener("scrollUp",e=>{l.table.eventManager.isDraging=!1}),l.component.hScrollBar.addEventListener("pointermove",e=>{l.table.stateManager.updateCursor("default"),e.stopPropagation()}),l.component.hScrollBar.addEventListener("pointerdown",e=>{e.stopPropagation(),l.table.hasListeners(z.B.MOUSEDOWN_TABLE)&&l.table.fireListeners(z.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),l.component.hScrollBar.addEventListener("scrollDown",e=>{var t;l.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},l.table.eventManager.isDown=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),l.table.stateManager.hideMenu(),null==(t=l.table.editorManager)||t.completeEdit(),l.table.hasListeners(z.B.MOUSEDOWN_TABLE)&&l.table.fireListeners(z.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),l.component.hScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,l.table.eventManager.isDraging=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),l.component.hScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),l.component.hScrollBar.addEventListener("scrollUp",e=>{l.table.eventManager.isDraging=!1});let o=(0,I.P2)(i.updateVerticalScrollBar,20),r=(0,I.P2)(i.updateHorizontalScrollBar,20);l.component.vScrollBar.addEventListener("scrollDrag",e=>{l.table.eventManager.isDown&&(l.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),o(e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]),e)}),l.component.hScrollBar.addEventListener("scrollDrag",e=>{l.table.eventManager.isDown&&(l.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),r(e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]))})}(this),function(e){let t=e.table,i=t.stateManager,l=t.scenegraph;if(!1===O.rF.envContribution.supportsTouchEvents)return;O.rF.addEventListener("contextmenu",e=>{e.stopPropagation(),e.preventDefault()},{capture:!0}),e.touchMovePoints=[],t.scenegraph.tableGroup.addEventListener("touchstart",i=>{var o,r,n,a,s,h,d,u;if(i.target.isChildOf(l.component.vScrollBar)||i.target.isChildOf(l.component.vScrollBar))return;e.isTouchdown=!0;let c=i.nativeEvent;e.touchMovePoints.push({x:t.rotateDegree?null!=(n=null==(r=null==(o=c.changedTouches)?void 0:o[0])?void 0:r._canvasX)?n:null==(a=i.canvas)?void 0:a.x:i.page.x,y:t.rotateDegree?null!=(d=null==(h=null==(s=c.changedTouches)?void 0:s[0])?void 0:h._canvasY)?d:null==(u=i.canvas)?void 0:u.y:i.page.y,timestamp:Date.now()})});let o=l=>{var o,r;if(e.isLongTouch&&l.preventDefault(),e.isTouchdown&&i4(l)){if(e.isTouchMove=!0,(null==(r=null==(o=e.downIcon)?void 0:o.attribute)?void 0:r.funcType)===N.cI.dragReorder)l.preventDefault();else if(e.touchMovePoints.length>4&&e.touchMovePoints.shift(),e.touchMovePoints.push({x:t.rotateDegree?l.changedTouches[0]._canvasX:l.changedTouches[0].pageX,y:t.rotateDegree?l.changedTouches[0]._canvasY:l.changedTouches[0].pageY,timestamp:Date.now()}),e._enableTableScroll){let o=-e.touchMovePoints[e.touchMovePoints.length-1].x+e.touchMovePoints[e.touchMovePoints.length-2].x,r=-e.touchMovePoints[e.touchMovePoints.length-1].y+e.touchMovePoints[e.touchMovePoints.length-2].y;iJ({deltaX:o,deltaY:r},i),l.cancelable&&("none"===t.internalProps.overscrollBehavior||Math.abs(r)>=Math.abs(o)&&0!==r&&iY(r,i)||Math.abs(r)<=Math.abs(o)&&0!==o&&iq(o,i))&&l.preventDefault()}}};O.rF.addEventListener("touchmove",o,{passive:!1}),e.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:o});let r=i=>{var l,o,r,n;if(e.touchEnd=!0,e.isLongTouch=!1,e.isTouchdown&&i4(i)){if((null==(o=null==(l=e.downIcon)?void 0:l.attribute)?void 0:o.funcType)===N.cI.dragReorder)i.preventDefault();else if((null==(r=e.touchMovePoints)?void 0:r.length)&&(e.touchMovePoints.length>4&&e.touchMovePoints.shift(),e.touchMovePoints.push({x:t.rotateDegree?i.changedTouches[0]._canvasX:i.changedTouches[0].pageX,y:t.rotateDegree?i.changedTouches[0]._canvasY:i.changedTouches[0].pageY,timestamp:Date.now()}),e._enableTableScroll)){let i=e.touchMovePoints[0],l=e.touchMovePoints[(null==(n=e.touchMovePoints)?void 0:n.length)-1],o=(l.x-i.x)/(l.timestamp-i.timestamp),r=(l.y-i.y)/(l.timestamp-i.timestamp);e.inertiaScroll.startInertia(o,r,.95),t.eventManager.inertiaScroll.setScrollHandle((e,i)=>{iJ({deltaX:-e,deltaY:-i},t.stateManager)})}e.isTouchdown=!1,e.isTouchMove=!1,e.isDraging=!1,e.touchMovePoints=[]}};O.rF.addEventListener("touchend",r),e.globalEventListeners.push({name:"touchend",env:"vglobal",callback:r});let n=t=>{e.touchEnd=!0,e.isLongTouch=!1,e.isTouchdown&&(e.isTouchdown=!1,e.isTouchMove=!1,e.touchMovePoints=[],e.isDraging=!1)};O.rF.addEventListener("touchcancel",n),e.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:n})}(this),function(e){let t=e.table;e.gesture=new iX.o(t.scenegraph.tableGroup,{tap:{interval:300}}),e.gesture.on("doubletap",e=>{!function(e,t){var i,l,o,r,n,a;let s=(0,io.RJ)(e),h=-1,d=-1;s.eventArgs&&(h=s.eventArgs.col,d=s.eventArgs.row);let u=t.getCellValue(h,d),c=null==(l=null==(i=s.eventArgs)?void 0:i.targetCell)?void 0:l.globalAABBBounds;if(c&&t.internalProps.focusControl.setFocusRect(new P.U(c.x1+t.scrollLeft,c.y1+t.scrollTop,c.x2-c.x1,c.y2-c.y1),u),t.hasListeners(z.B.DBLCLICK_CELL)){let i,l,u=t.getCellInfo(h,d);if(null==(o=s.eventArgs)?void 0:o.target){let e=iD(null==(r=s.eventArgs)?void 0:r.target);e&&(i=e.icon,l=e.position)}let c=Object.assign(Object.assign({},u),{event:e.nativeEvent,federatedEvent:e,cells:[],targetIcon:i?{name:i.name,position:l,funcType:i.attribute.funcType}:void 0,target:null==(n=null==s?void 0:s.eventArgs)?void 0:n.target,mergeCellInfo:null==(a=null==s?void 0:s.eventArgs)?void 0:a.mergeInfo});t.fireListeners(z.B.DBLCLICK_CELL,c)}}(e,t)})}(this)}updateEventBinder(){setTimeout(()=>{var e;this.table.isReleased||(tq(this.table)&&0===(null==(e=this.handleTextStickBindId)?void 0:e.length)?(this.handleTextStickBindId.push(this.table.on(z.B.SCROLL,e=>{tU(this.table)})),this.handleTextStickBindId.push(this.table.on(z.B.RESIZE_COLUMN_END,e=>{tU(this.table)})),this.handleTextStickBindId.push(this.table.on(z.B.RESIZE_ROW_END,e=>{tU(this.table)}))):!tq(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),i$(this.table))},0)}bindSelfEvent(){var e,t,i,l,o,r,n,a,s,h,d,u;this.table.isReleased||((e=this.table).on(z.B.ICON_CLICK,t=>{var i;let{col:l,row:o,x:r,y:n,funcType:a,icon:s,event:h}=t,{stateManager:d}=e;if(a===N.cI.dropDown)d.triggerDropDownMenu(l,o,r,n,h);else if(a===N.cI.sort)d.triggerSort(l,o,s,h);else if(a===N.cI.frozen)d.triggerFreeze(l,o,s);else if(a===N.cI.drillDown)e.fireListeners(ik.z.DRILLMENU_CLICK,e.stateManager.drill);else if(a===N.cI.collapse||a===N.cI.expand){let t=!!(null==(i=d.select.ranges)?void 0:i.length);d.updateSelectPos(-1,-1),d.endSelectCells(!0,t),e.toggleHierarchyState(l,o)}}),(t=this.table).on(z.B.DROPDOWN_MENU_CLICK,()=>{t.stateManager.hideMenu()}),t.on(z.B.SCROLL,()=>{t.stateManager.hideMenu()}),this.updateEventBinder(),i=this.table,"browser"===A.X.mode&&i.on(z.B.CLICK_CELL,e=>{let t,{col:l,row:o}=e;if("image"===e.target.type&&e.target.role&&e.target.role.startsWith("icon"))return;t=i.internalProps.layoutMap.isHeader(l,o)?i.isPivotTable()?i._getHeaderLayoutMap(l,o).headerType:i.getHeaderDefine(l,o).headerType:i.getBodyColumnType(l,o);let r=i.isHeader(l,o)?i.getHeaderDefine(l,o):i.getBodyColumnDefine(l,o),n=i.getCellValue(l,o),a=i.getCellOriginValue(l,o);if("link"===t){let e=(0,T.vi)(r.linkJump,{col:l,row:o,table:i,value:n,dataValue:a,cellHeaderPaths:void 0});if(!(e=!1!==e))return;let t=r.templateLink,s,h=(0,T.vi)(r.linkDetect,{col:l,row:o,table:i,value:n,dataValue:a,cellHeaderPaths:void 0});if(h=!1!==h,t){let e=i.getCellOriginRecord(l,o);if(e&&e.vtableMerge)return;let r=Object.assign({__value:n,__dataValue:a},e);s=(0,ij.Z)(t)?t(r,l,o,i):t.replace(/\{\s*(\S+?)\s*\}/g,(e,t)=>r[t])}else if(h){if(!iU.tP.test(n))return;s=n}else s=n;if(!s)return;let d=r.linkTarget,u=r.linkWindowFeatures;window.open(s,d,u)}else if("image"===t){let{clickToPreview:e}=r;if(!1===e)return;let t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.backgroundColor="rgba(30, 30, 30, 0.4)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.overflow="hidden",t.style.zIndex="9999",t.addEventListener("click",e=>{e.target===t&&document.body.removeChild(t)});let i=new Image;i.src=n,i.style.maxWidth="80%",i.style.maxHeight="80%",t.appendChild(i),document.body.appendChild(t)}else if("video"===t){let{clickToPreview:e}=r;if(!1===e)return;let t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.backgroundColor="rgba(30, 30, 30, 0.4)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.overflow="hidden",t.style.zIndex="9999",t.addEventListener("click",e=>{e.target===t&&document.body.removeChild(t)});let i=document.createElement("video");i.src=n,i.style.maxWidth="80%",i.style.maxHeight="80%",i.setAttribute("preload","auto"),i.setAttribute("controls","true"),t.appendChild(i),document.body.appendChild(t)}}),(l=this.table).on(z.B.DBLCLICK_CELL,e=>{var t,i,o;if(e.federatedEvent){let r=(0,io.RJ)(e.federatedEvent),n=l.scenegraph.getResizeColAt(r.abstractPos.x,r.abstractPos.y,null==(t=r.eventArgs)?void 0:t.targetCell),a=null!=(i=l.options.disableDblclickAutoResizeColWidth)?i:null==(o=l.options.resize)?void 0:o.disableDblclickAutoResizeColWidth;if(l.eventManager.checkCellFillhandle(r))l.fireListeners(z.B.DBLCLICK_FILL_HANDLE,{});else if(l._canResizeColumn(n.col,n.row)&&n.col>=0&&!a){l.scenegraph.updateAutoColWidth(n.col),l.internalProps._widthResizedColMap.add(n.col),l.scenegraph.updateChartSizeForResizeColWidth(n.col);let e=l.stateManager;!(e.columnResize.col<e.table.frozenColCount)||e.table.isPivotTable()||e.table.transpose||e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen);let t=[];for(let e=0;e<l.colCount;e++)t.push(l.getColWidth(e));l.fireListeners(z.B.RESIZE_COLUMN_END,{col:n.col,colWidths:t})}}}),this.table.isPivotTable()&&function(e){let t=e.internalProps.layoutMap.rowsDefine,i=e.internalProps.layoutMap.columnsDefine;for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.drillDown||i.drillUp))return!0}for(let e=0;e<i.length;e++){let t=i[e];if("string"!=typeof t&&(t.drillDown||t.drillUp))return!0}return!1}(this.table)&&((o=this.table).on(z.B.MOUSEENTER_CELL,e=>{let{col:t,row:i}=e;if(-1===t||-1===i)return;let l=o.internalProps.layoutMap.getHeaderDimension(t,i);(null==l?void 0:l.drillDown)||(null==l?void 0:l.drillUp)?o.stateManager.updateDrillState(l.dimensionKey,l.title,l.drillDown,l.drillUp,t,i):o.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),o.on(z.B.MOUSELEAVE_TABLE,e=>{o.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})),i$(this.table),(r=this.table).isPivotChart()&&r.scenegraph.tableGroup.addEventListener("click",e=>{var t;if(!r.stateManager.columnMove.moving&&!r.stateManager.columnResize.resizing)if("axis-label"===e.target.name){let t,i,{col:l,row:o}=(0,io.RJ)(e).eventArgs,n=r.internalProps.layoutMap;n.indicatorsAsCol?(t=n.getDimensionKeyInChartSpec(n.rowHeaderLevelCount,o),i=n.getCellHeaderPaths(n.rowHeaderLevelCount-2,o).rowHeaderPaths):(t=n.getDimensionKeyInChartSpec(l,n.columnHeaderLevelCount),i=n.getCellHeaderPaths(l,n.columnHeaderLevelCount-1).colHeaderPaths);let a=i.map(e=>({key:e.dimensionKey,value:e.value})).filter(e=>e.key);if(a.push({key:t,value:e.target.attribute.text}),r._selectedDimensionInChart.length&&function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i].key!==t[i].key||e[i].value!==t[i].value)return!1;return!0}(r._selectedDimensionInChart,a))return;r._selectedDimensionInChart=a,n.updateDataStateToChartInstance(),(0,ib.RW)(r.scenegraph),r.scenegraph.updateNextFrame()}else(null==(t=r._selectedDimensionInChart)?void 0:t.length)&&(r._selectedDimensionInChart.length=0,r.internalProps.layoutMap.updateDataStateToChartInstance(),(0,ib.RW)(r.scenegraph),r.scenegraph.updateNextFrame())}),(n=this.table).isPivotChart()&&(n.on(z.B.MOUSEENTER_CELL,e=>{n.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{if("axis"===t.name){let t=i8(e.col,e.row,n.internalProps.layoutMap);e.axisPosition=t,n.fireListeners(z.B.MOUSEENTER_AXIS,e)}})}),n.on(z.B.MOUSELEAVE_CELL,e=>{n.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{if("axis"===t.name){let t=i8(e.col,e.row,n.internalProps.layoutMap);e.axisPosition=t,n.fireListeners(z.B.MOUSELEAVE_AXIS,e)}})})),(a=this.table).on("checkbox_state_change",e=>{var t;let{col:i,row:l,checked:o,field:r}=e;if(!a.internalProps.layoutMap.isSeriesNumber(i,l)||!0!==a.internalProps.enableCheckboxCascade||a.isHeader(i,l))return;let n=a.getCellOriginRecord(i,l),s=a.dataSource.currentPagerIndexedData,h=a.getRecordShowIndexByCell(i,l),d=s[h];if((0,J.Z)(d)&&(d=[d]),n.vtableMerge||(null==(t=n.children)?void 0:t.length))if(o)lt(a,i,l)===F.g.collapse?le(!0,d,a,r):i9(!0,h,d,s,a,i),i7(h,d,s,a,i);else{lt(a,i,l)===F.g.collapse?le(!1,d,a,r):i9(!1,h,d,s,a,i),i7(h,d,s,a,i);let e=a.stateManager.headerCheckedState._vtable_rowSeries_number,t=a.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",i,l);e!==t&&a.scenegraph.updateHeaderCheckboxCellState(i,l,t)}else i7(h,d,s,a,i)}),!0===(s=this.table).internalProps.enableCheckboxCascade&&s.on("checkbox_state_change",e=>{var t;let{col:i,row:l,checked:o,field:r}=e,n=s.internalProps.columns.some(e=>e.tree);if(s.internalProps.enableCheckboxCascade,!n||s.isHeader(i,l))return;let a=s.getCellOriginRecord(i,l),h=s.dataSource.currentPagerIndexedData,d=s.getRecordShowIndexByCell(i,l),u=h[d];if((0,J.Z)(u)&&(u=[u]),a.vtableMerge||(null==(t=a.children)?void 0:t.length))if(o)lt(s,i,l)===F.g.collapse?le(!0,u,s,r):i9(!0,d,u,h,s,i,r),i7(d,u,h,s,i,r);else{lt(s,i,l)===F.g.collapse?le(!1,u,s,r):i9(!1,d,u,h,s,i,r),i7(d,u,h,s,i,r);let e=s.stateManager.headerCheckedState._vtable_rowSeries_number,t=s.stateManager.updateHeaderCheckedState(r,i,l);e!==t&&s.scenegraph.updateHeaderCheckboxCellState(i,l,t)}else i7(d,u,h,s,i,r)}),!0===(h=this.table).internalProps.enableCheckboxCascade&&h.on("checkbox_state_change",e=>{let{col:t,row:i,checked:l,field:o}=e;if(h.isHeader(t,i))h.stateManager.setHeaderCheckedState(o,l),"checkbox"===h.getCellType(t,i)&&h.scenegraph.updateCheckboxCellState(t,i,l);else if(h.stateManager.setCheckedState(t,i,o,l),"checkbox"===h.getCellType(t,i)){let e=h.stateManager.headerCheckedState[o],l=h.stateManager.updateHeaderCheckedState(o,t,i);e!==l&&h.scenegraph.updateHeaderCheckboxCellState(t,i,l)}}),(d=this.table).on(z.B.CLICK_CELL,e=>{let{col:t,row:i,target:l}=e;"button"!==l.name||l.attribute.disable||d.hasListeners(z.B.BUTTON_CLICK)&&d.fireListeners(z.B.BUTTON_CLICK,{col:t,row:i,event:e.event})}),(u=this.table).on(z.B.CONTEXTMENU_CELL,e=>{let{col:t,row:i}=e,l=u.getSelectedCellRanges(),o=!1;if(l.length>0)for(let e=0;e<l.length;e++){let r=l[e],n=r.start.col,a=r.end.col,s=r.start.row,h=r.end.row;if(t>=n&&t<=a&&i>=s&&i<=h||t>=a&&t<=n&&i>=h&&i<=s||t>=n&&t<=a&&i>=h&&i<=s||t>=a&&t<=n&&i>=s&&i<=h){o=!0;break}}o||u.selectCell(t,i)}))}dealTableHover(e){if(!e)return void this.table.stateManager.updateHoverPos(-1,-1);let{eventArgs:t}=e;t?this.table.stateManager.updateHoverPos(t.col,t.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(e){let{eventArgs:t}=e;t?this.table.stateManager.updateHoverIcon(t.col,t.row,t.target,t.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(e){}dealTableSelect(e,t){var i,l,o,r,n;if(!e)return this.table.stateManager.updateSelectPos(-1,-1),!1;let{eventArgs:a}=e;if(a){if("checkbox"===a.target.name||"radio"===a.target.name||"switch"===a.target.name||"button"===a.target.name)return!1;if(this.table.isHeader(a.col,a.row)&&e0(this.table,a.col,a.row))return t||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(a.col,a.row)&&e0(this.table,a.col,a.row)){if(!t){let e=!!(null==(i=this.table.stateManager.select.ranges)?void 0:i.length);this.table.stateManager.updateSelectPos(-1,-1),e&&this.table.stateManager.endSelectCells(!0,e)}return!1}return this.table.isPivotChart()&&("axis-label"===(null==(l=null==e?void 0:e.eventArgs)?void 0:l.target.name)||"chart"===(null==(o=null==e?void 0:e.eventArgs)?void 0:o.target.type))?(this.table.stateManager.updateSelectPos(-1,-1),!1):(this.table.stateManager.updateSelectPos(a.col,a.row,a.event.shiftKey,a.event.ctrlKey||a.event.metaKey,!1,!t&&(null==(n=null==(r=this.table.options.select)?void 0:r.makeSelectCellVisible)||n)),!0)}return!1}dealFillSelect(e,t){var i,l;let{eventArgs:o}=e;if(o){if((null==(l=null==(i=this.table.stateManager.select)?void 0:i.ranges)?void 0:l.length)&&this.table.stateManager.isFillHandle()){let i,l,r=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];t&&((0,m.Z)(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-e.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-e.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-e.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-e.abstractPos.x)?this.table.stateManager.fillHandle.startY-e.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-e.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(i=o.row,l=r.end.col):(i=r.end.row,l=o.col)),this.table.stateManager.updateSelectPos(t?l:r.end.col,t?i:r.end.row,!0,o.event.ctrlKey||o.event.metaKey,!1,!t)}else this.table.stateManager.updateSelectPos(o.col,o.row,o.event.shiftKey,o.event.ctrlKey||o.event.metaKey,!1,!t);return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(z.B.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(e){}checkColumnResize(e,t){let{eventArgs:i}=e;if(this.table.internalProps.enableTreeStickCell&&!i)return!1;let l=this.table.scenegraph.getResizeColAt(e.abstractPos.x,e.abstractPos.y,null==i?void 0:i.targetCell);return this.table._canResizeColumn(l.col,l.row)&&l.col>=0?(t&&this.table.stateManager.startResizeCol(l.col,e.abstractPos.x,e.abstractPos.y,l.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(e,t){let{eventArgs:i}=e;if(i){let l=this.table.scenegraph.getResizeRowAt(e.abstractPos.x,e.abstractPos.y,i.targetCell);if(this.table._canResizeRow(l.col,l.row)&&l.row>=0)return t&&this.table.stateManager.startResizeRow(l.row,e.abstractPos.x,e.abstractPos.y,l.bottomFrozen),!0}return!1}cellIsHeaderCheck(e,t){let{eventArgs:i}=e,{col:l,row:o,target:r}=i;return!!this.table.isHeader(l,o)&&"checkbox"===this.table.getCellType(i.col,i.row)&&"checkbox"===r.name}checkCellFillhandle(e,t){var i,l,o,r,n;if("function"==typeof(null==(i=this.table.options.excelOptions)?void 0:i.fillHandle)?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):null==(l=this.table.options.excelOptions)?void 0:l.fillHandle){let{eventArgs:i}=e;if(i&&(null==(r=null==(o=this.table.stateManager.select)?void 0:o.ranges)?void 0:r.length)){let i,l=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),o=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),r=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),a=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);i=l<this.table.colCount-1?this.table.scenegraph.highPerformanceGetCell(l,o).globalAABBBounds:this.table.scenegraph.highPerformanceGetCell(r-1,o).globalAABBBounds;let s=Math.abs(e.abstractPos.x-i.x2);i=o<this.table.rowCount-1?this.table.scenegraph.highPerformanceGetCell(l,o).globalAABBBounds:this.table.scenegraph.highPerformanceGetCell(l,a-1).globalAABBBounds;let h=Math.abs(e.abstractPos.y-i.y2);if((null==(n=this.table.stateManager.fillHandle)?void 0:n.isFilling)||s<=9&&h<=9)return t&&this.table.stateManager.startFillSelect(e.abstractPos.x,e.abstractPos.y),!0}}return!1}dealColumnResize(e,t){this.table.stateManager.updateResizeCol(e,t)}dealRowResize(e,t){this.table.stateManager.updateResizeRow(e,t)}checkColumnMover(e){var t;let{eventArgs:i}=e;return!(!i||!this.table._canDragHeaderPosition(i.col,i.row))&&(this.table.stateManager.startMoveCol(i.col,i.row,e.abstractPos.x,e.abstractPos.y,null==(t=null==i?void 0:i.event)?void 0:t.nativeEvent),!0)}dealColumnMover(e){var t;let{eventArgs:i}=e;(0,m.Z)(i.col)&&(0,m.Z)(i.row)&&this.table.stateManager.updateMoveCol(i.col,i.row,e.abstractPos.x,e.abstractPos.y,null==(t=null==i?void 0:i.event)?void 0:t.nativeEvent)}startColumnResize(e){}dealIconClick(e,t){let{eventArgs:i}=t,{target:l,event:o,col:r,row:n}=i||{target:e.target,event:e,col:-1,row:-1};if(l.role&&l.role.startsWith("icon-"))return this.table.fireListeners(z.B.ICON_CLICK,{name:l.name,x:(l.globalAABBBounds.x1+l.globalAABBBounds.x2)/2,y:l.globalAABBBounds.y2,col:r,row:n,funcType:l.attribute.funcType,icon:l,event:o}),!0;if(l instanceof iV.H){let e=l.pickIcon(o.global);if(e)return this.table.fireListeners(z.B.ICON_CLICK,{name:e.attribute.id,x:e.globalX+e.globalAABBBounds.width()/2,y:e.globalY+e.AABBBounds.height(),col:r,row:n,funcType:e.attribute.funcType,icon:e,event:o}),!0}return!1}release(){this.gesture.release(),this.globalEventListeners.forEach(e=>{"document"===e.env?document.removeEventListener(e.name,e.callback):"body"===e.env?document.body.removeEventListener(e.name,e.callback):"window"===e.env?window.removeEventListener(e.name,e.callback):"vglobal"===e.env&&O.rF.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}}class ll extends w{static get DEFAULT(){return s||(s=new ll)}constructor(e={},t={}){var i,l;super(e,t),this._autoWrapText=null!=(i=null==e?void 0:e.autoWrapText)?i:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(l=null==e?void 0:e.lineClamp)?l:null==t?void 0:t.lineClamp}clone(){return new ll(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}let lo=e=>{let t=e.value;return Number(t)>80?"#20a8d8":Number(t)>50?"#4dbd74":Number(t)>20?"#ffc107":"#f86c6b"};class lr extends w{static get DEFAULT(){return h||(h=new lr)}constructor(e={},t={}){var i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m;super(e,t),this._showBar=null==(i=e.showBar)||i,this._barColor=null!=(l=e.barColor)?l:lo,this._barPositiveColor=null!=(o=e.barPositiveColor)?o:"#4dbd74",this._barNegativeColor=null!=(r=e.barNegativeColor)?r:"#f86c6b",this._barAxisColor=null!=(n=e.barAxisColor)?n:"black",this._barBgColor=e.barBgColor,this._barHeight=null!=(a=e.barHeight)?a:3,this._barHeight=null!=(s=e.barHeight)?s:3,this._barBottom=null!=(h=e.barBottom)?h:0,this._barPadding=null!=(d=e.barPadding)?d:[0,0,0,0],this._showBarMark=null!=(u=e.showBarMark)&&u,this._barMarkPositiveColor=null!=(c=e.barMarkPositiveColor)?c:"#4dbd74",this._barMarkNegativeColor=null!=(g=e.barMarkNegativeColor)?g:"#f86c6b",this._barMarkWidth=null!=(p=e.barMarkWidth)?p:2,this._barMarkPosition=null!=(f=e.barMarkPosition)?f:"right",this._barRightToLeft=null!=(b=e.barRightToLeft)&&b,this._barMarkInBar=null==(m=e.barMarkInBar)||m}get showBar(){return this._showBar}set showBar(e){this._showBar=e}get barColor(){return this._barColor}set barColor(e){this._barColor=e}get barBgColor(){return this._barBgColor}set barBgColor(e){this._barBgColor=e}get barHeight(){return this._barHeight}set barHeight(e){this._barHeight=e}get barBottom(){return this._barBottom}set barBottom(e){this._barBottom=e}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(e){this._barPositiveColor=e}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(e){this._barNegativeColor=e}get barAxisColor(){return this._barAxisColor}set barAxisColor(e){this._barAxisColor=e}get barPadding(){return this._barPadding}set barPadding(e){this._barPadding=e}get showBarMark(){return this._showBarMark}set showBarMark(e){this._showBarMark=e}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(e){this._barMarkPositiveColor=e}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(e){this._barMarkNegativeColor=e}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(e){this._barMarkWidth=e}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(e){this._barMarkPosition=e}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(e){this._barRightToLeft=e}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(e){this._barMarkInBar=e}clone(){return new lr(this,null)}}class ln extends w{static get DEFAULT(){return d||(d=new ln)}constructor(e={},t={}){super(e,t)}clone(){return new ln(this,null)}}let la=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"];class ls{constructor(e){this._table=e;let t=eC.U2();this.expandIcon=t[N.up.expandIconName],this.collapseIcon=t[N.up.collapseIconName]}getIcons(e,t,i,l,o){let r=[],n=this.getHierarchyIcon(e,t);n&&r.push(n);let{icon:a}=this._table.getBodyColumnDefine(e,t);if(a){let o;o="function"==typeof a?a({col:e,row:t,value:i,dataValue:l,table:this._table}):a;let n=eC.U2(),s=e=>{let t;(t="string"==typeof e?n[e]:e)&&r.push(t)};Array.isArray(o)?o.forEach((e,t)=>{s(e)}):s(o)}return o&&r.forEach((i,l)=>{(i.content||i.src)&&(r[l]=this.getCellIconFromRecordValue(i,e,t))}),r}getStyleClass(e){switch(e){case"text":case"link":break;case"image":case"video":return ln;case"chart":case"sparkline":return w;case"progressbar":return lr;case"checkbox":return y;case"radio":return x;case"switch":return _;case"button":return S}return ll}getCellIconFromRecordValue(e,t,i){if(Array.isArray(e))return e.map(e=>this.getCellIconFromRecordValue(e,t,i));if(!T.j6.isObject(e)||"function"==typeof e)return this._table.getFieldData(e,t,i);let l={};return la.forEach(o=>{var r,n;if(void 0!==e[o]){let a=this._table.getFieldData(e[o],t,i);(0,m.Z)(a)?l[o]=a:(null==(n=(r=this._table)._hasField)?void 0:n.call(r,e[o],t,i))||(l[o]=e[o])}}),l}getHierarchyIcon(e,t){let i=this._table.getHierarchyState(e,t);return i===F.g.expand?this.expandIcon:i===F.g.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var e,t;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(t=this.expandIcon.marginRight)?t:0)}}var lh=i(27421);let ld={CHANGE_STYLE:"change_style"};class lu extends C.R{static get EVENT_TYPE(){return ld}static get DEFAULT(){return u||(u=new lu)}constructor(e={},t={}){var i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L;super(),this._defaultPadding=[10,16,10,16],this._color=null!=(i=e.color)?i:null==t?void 0:t.color,this._strokeColor=null!=(l=null==e?void 0:e.strokeColor)?l:null==t?void 0:t.strokeColor,this._fontSize=null!=(o=e.fontSize)?o:null==t?void 0:t.fontSize,this._fontFamily=null!=(r=e.fontFamily)?r:null==t?void 0:t.fontFamily,this._fontWeight=null!=(n=e.fontWeight)?n:null==t?void 0:t.fontWeight,this._fontVariant=null!=(a=e.fontVariant)?a:null==t?void 0:t.fontVariant,this._fontStyle=null!=(s=e.fontStyle)?s:null==t?void 0:t.fontStyle,this._textOverflow=(null!=(h=e.textOverflow)?h:null==t?void 0:t.textOverflow)||"ellipsis",this._textStick=null!=(u=null!=(d=e.textStick)?d:null==t?void 0:t.textStick)&&u,this._textStickBaseOnAlign=null!=(g=null!=(c=e.textStickBaseOnAlign)?c:null==t?void 0:t.textStickBaseOnAlign)&&g,this._marked=null!=(f=null!=(p=e.marked)?p:null==t?void 0:t.marked)&&f,this._textAlign=(null!=(b=e.textAlign)?b:null==t?void 0:t.textAlign)||"left",this._textBaseline=(null!=(m=e.textBaseline)?m:null==t?void 0:t.textBaseline)||"middle",this._bgColor=null!=(C=e.bgColor)?C:null==t?void 0:t.bgColor,this._padding=null!=(w=null!=(v=e.padding)?v:null==t?void 0:t.padding)?w:this._defaultPadding,this._borderColor=null!=(y=e.borderColor)?y:null==t?void 0:t.borderColor,this._lineHeight=null!=(x=e.lineHeight)?x:null==t?void 0:t.lineHeight,this._underline=null!=(_=e.underline)?_:null==t?void 0:t.underline,this._underlineColor=null!=(S=e.underlineColor)?S:null==t?void 0:t.underlineColor,this._underlineDash=null!=(R=e.underlineDash)?R:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(H=e.underlineOffset)?H:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(A=e.lineThrough)?A:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(M=e.lineThroughColor)?M:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(F=e.lineThroughDash)?F:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(B=e.linkColor)?B:null==t?void 0:t.linkColor,this._cursor=null!=(T=e.cursor)?T:null==t?void 0:t.cursor,this._borderLineWidth=null!=(z=e.borderLineWidth)?z:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(L=e.borderLineDash)?L:null==t?void 0:t.borderLineDash}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get padding(){var e;return null!=(e=this._padding)?e:this._defaultPadding}set padding(e){this._padding=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get marked(){return this._marked}set marked(e){this._marked=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}clone(){return new lu(this)}}class lc extends lu{static get DEFAULT(){return c||(c=new lc)}constructor(e={},t={}){var i;super(e,t),this.textAlign=(null!=(i=e.textAlign)?i:null==t?void 0:t.textAlign)||"center"}clone(){return new lc(this)}}class lg extends lu{static get DEFAULT(){return g||(g=new lg)}constructor(e={},t=null){var i,l;super(e,t),this._autoWrapText=null!=(i=null==e?void 0:e.autoWrapText)?i:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(l=null==e?void 0:e.lineClamp)?l:null==t?void 0:t.lineClamp}clone(){return new lg(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}class lp extends lu{static get DEFAULT(){return p||(p=new lp)}constructor(e={},t={},i={}){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S;super(e,t),this._size=(null!=(o=null!=(l=null==e?void 0:e.size)?l:null==t?void 0:t.size)?o:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(n=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?n:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(s=null==(a=null==e?void 0:e.checkboxStyle)?void 0:a.defaultFill)?s:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(d=null==(h=null==e?void 0:e.checkboxStyle)?void 0:h.defaultStroke)?d:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(u=null==e?void 0:e.checkboxStyle)?void 0:u.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(p=null==(g=null==e?void 0:e.checkboxStyle)?void 0:g.checkedFill)?p:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(b=null==(f=null==e?void 0:e.checkboxStyle)?void 0:f.checkedStroke)?b:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(C=null==(m=null==e?void 0:e.checkboxStyle)?void 0:m.disableCheckedFill)?C:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(w=null==(v=null==e?void 0:e.checkboxStyle)?void 0:v.disableCheckedStroke)?w:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(x=null==(y=null==e?void 0:e.checkboxStyle)?void 0:y.checkIconImage)?x:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(_=null==e?void 0:e.checkboxStyle)?void 0:_.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new lp(e,this)}clone(){return new lp(this)}}class lf{constructor(e){this._table=e;let t=eC.U2();this.freezeIcon=t[N.up.freezeIconName],this.frozenIcon=t[N.up.frozenIconName],this.frozenCurrentIcon=t[N.up.frozenCurrentIconName],this.normalIcon=t[N.up.normalIconName],this.upIcon=t[N.up.upwardIconName],this.downIcon=t[N.up.downwardIconName],this.dropDownAbsoluteIcon=t[N.up.dropdownIconName],this.expandIcon=t[N.up.expandIconName],this.collapseIcon=t[N.up.collapseIconName]}getIcons(e,t){let i=[];if(this._table.isPivotTable()){let{showSort:l,sort:o}=this._table.internalProps.layoutMap.getHeader(e,t);if("function"==typeof l?l({col:e,row:t,table:this._table}):l){let l=this._table.getPivotSortState(e,t);l&&(l=l.toUpperCase());let o="ASC"===l?this.upIcon:"DESC"===l?this.downIcon:this.normalIcon;o&&i.push(o)}else if(o){let l=this.getSortIconForPivotTable(this._table.getPivotSortState(e,t),this._table,e,t);l&&i.push(l)}}else{let l,o=this._table.sortState;l=void 0;let r=this._table.getCellRange(e,t);if(o)if(Array.isArray(o))for(let e=0;e<o.length;e++){let t=o[e],i=this._table._getHeaderCellBySortState(t);if(i&&(0,T._Z)(r,i.col,i.row)){({order:l}=t);break}}else{let e=this._table._getHeaderCellBySortState(o);e&&(0,T._Z)(r,e.col,e.row)&&({order:l}=o)}let n=this.getSortIcon(l,this._table,e,t);n&&i.push(n)}if(this._table.showFrozenIcon&&e<this._table.allowFrozenColCount){let l=this.getFrozenIcon(e,t);l&&i.push(l)}if(this.checkDropDownIcon(this._table,e,t)){let e=this.dropDownAbsoluteIcon;i.push(e)}let l=this.getDropDownStateIcons(this._table,e,t);l.length&&i.push(...l);let{headerIcon:o}=this._table._getHeaderLayoutMap(e,t),r=this.getHierarchyIcon(e,t);if(r&&i.push(r),o){let l;l="function"==typeof o?o({col:e,row:t,value:this._table.getCellValue(e,t),dataValue:this._table.getCellOriginValue(e,t),table:this._table}):o;let r=eC.U2(),n=e=>{let t;(t="string"==typeof e?r[e]:e)&&i.push(t)};Array.isArray(l)?l.forEach((e,t)=>{n(e)}):n(l)}return i}getFrozenIcon(e,t){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&e>=this._table.colCount-this._table.rightFrozenColCount)return null;let i=this._table.getHeaderDefine(e,t);if(i.columns&&i.columns.length>0)return null;let l=this.freezeIcon;return this._table.options.frozenColCount-1>e?l=this.frozenIcon:this._table.options.frozenColCount-1===e&&(l=this.frozenCurrentIcon),l}getSortIcon(e,t,i,l){let o,r="asc"===e?this.upIcon:"desc"===e?this.downIcon:this.normalIcon,n=t.getHeaderDefine(i,l);return n&&(o="function"==typeof n.showSort?n.showSort({col:i,row:l,table:this._table}):n.showSort),n&&!1!==o&&((0,m.Z)(o)||n.sort)&&(!n.columns||!(n.columns.length>0))?r:null}getSortIconForPivotTable(e,t,i,l){let o,r=t.getHeaderDefine(i,l);return(r&&(o="function"==typeof r.showSort?r.showSort({col:i,row:l,table:this._table}):r.showSort),r&&!1!==o&&((0,m.Z)(o)||r.sort)&&(!r.columns||!(r.columns.length>0)))?"ASC"===(null==e?void 0:e.toUpperCase())?this.upIcon:"DESC"===(null==e?void 0:e.toUpperCase())?this.downIcon:this.normalIcon:null}getDropDownStateIcons(e,t,i){var l,o,r;let n=e.getHeaderDefine(t,i),{dropDownMenu:a}=e._getHeaderLayoutMap(t,i);"function"==typeof a&&(a=a({row:i,col:t,table:e}));let s=e.globalDropDownMenu;"function"==typeof s&&(s=s({row:i,col:t,table:e}));let h=[];if(Array.isArray(a)&&a.length||Array.isArray(s)&&s.length&&!(null==(l=null==n?void 0:n.columns)?void 0:l.length)){let l=a||s,n=-1,d=-1;for(let a=0;a<l.length;a++){let s=l[a];if("object"==typeof s&&s.children&&s.children.length)for(let l=0;l<s.children.length;l++){let h=s.children[l];if((null==(o=e.stateManager.menu)?void 0:o.dropDownMenuHighlight)&&(0,lh.o)(e,null==(r=e.stateManager.menu)?void 0:r.dropDownMenuHighlight,"object"==typeof h?null==h?void 0:h.menuKey:h,t,i,a)){n=a,d=l;break}}if(e._dropDownMenuIsHighlight(t,i,a)){n=a;break}}if(-1!==n){let e;(e=-1!==d?l[n].children[d]:l[n]).stateIcon&&(e.stateIcon.svg?h.push({type:"svg",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,svg:e.stateIcon.svg,positionType:N.q0.right,marginRight:0,funcType:N.cI.dropDownState,interactive:!1}):e.stateIcon.src&&h.push({type:"image",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,src:e.stateIcon.src,positionType:N.q0.right,marginRight:0,funcType:N.cI.dropDownState,interactive:!1}))}}return h}getDropDownIconRect(e,t,i){var l,o,r,n,a,s,h,d;let u,c=null!=(n=null!=(o=null==(l=this.downIcon.hover)?void 0:l.width)?o:null==(r=this.downIcon)?void 0:r.width)?n:0,g=null!=(d=null!=(s=null==(a=this.downIcon.hover)?void 0:a.height)?s:null==(h=this.downIcon)?void 0:h.height)?d:0,p=e.right-2-c;return{left:p,right:e.right-2,top:u="middle"===i?e.top+e.height/2-c/2:"top"===i?e.top+t/2:"bottom"===i?e.bottom-2*t:e.top,bottom:g+u,width:c,height:g}}getHierarchyIcon(e,t){let{hierarchyState:i}=this._table._getHeaderLayoutMap(e,t);if(i){if(i===F.g.expand)return this.expandIcon;if(i===F.g.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var e,t;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(t=this.expandIcon.marginRight)?t:0)}checkDropDownIcon(e,t,i){var l;if(e.isPivotTable()){let l=e._getHeaderLayoutMap(t,i).dropDownMenu;if("function"==typeof l&&(l=l({row:i,col:t,table:e})),Array.isArray(l)&&l.length)return!0}else{let o=e.getHeaderDefine(t,i),r=o.dropDownMenu,n=e.globalDropDownMenu;if("function"==typeof n&&(n=n({row:i,col:t,table:e})),Array.isArray(r)&&r.length||(!Array.isArray(o.dropDownMenu)||0!==o.dropDownMenu.length)&&Array.isArray(n)&&n.length&&!(null==(l=null==o?void 0:o.columns)?void 0:l.length))return!0}return!1}getStyleClass(e){switch(e){case"text":case"link":return lg;case"image":case"video":return lc;case"checkbox":return lp}}setTableColumnsEditor(){let e=(t,i)=>{null==t||t.forEach((t,l)=>{t.editor&&(i[l].editor=t.editor),t.columns&&e(t.columns,i[l].columns)})};e(this._table.options.columns,this._table.internalProps.columns)}}var lb=i(47105),lm=i(19465);class lC extends EventTarget{constructor(e,t){if(super(),this._table=e,"node"===A.X.mode)return;let i=document.createElement("div");i.style.opacity="0",i.dataset.vtable="vtable",i.style.pointerEvents="none",i.classList.add("input-container");let l=this._input=document.createElement("input");i.appendChild(l),l.classList.add("table-focus-control"),l.dataset.vtable="vtable",l.readOnly=!0,t.appendChild(i),this._container=i}focus(){this._input.focus({preventScroll:!0})}setFocusRect(e,t){let i=this._input;i.value=t,i.select();let l=e.top-this._table.scrollTop,o=e.left-this._table.scrollLeft;i.style.top=`${l.toFixed()}px`,i.style.left=`${o.toFixed()}px`,i.style.width=`${e.width.toFixed()}px`,i.style.height=`${e.height.toFixed()}px`}get input(){return this._input}release(){var e;null==(e=this._container.parentElement)||e.removeChild(this._container)}}class lv{constructor(e){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=e}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(e,t){if(!(0,m.Z)(t))return;let i=this.table.getRowHeight(e);this.data.has(e)||(this._keys.push(e),this._sorted=!1),this.data.set(e,t),this.totalSum+=t,this.updateDifference(e,t-i)}remove(e){if(this.data.has(e)){let t=this.data.get(e);this.data.delete(e);let i=this._keys.indexOf(e);-1!==i&&this._keys.splice(i,1),this.totalSum-=t;let l=this.table.getRowHeight(e);this.updateDifference(e,l-t)}}put(e,t){if((0,m.Z)(t))if(this.data.has(e)){let i=this.data.get(e);if(i===t)return;this.data.set(e,t);let l=t-i;this.totalSum+=l,this.updateDifference(e,l)}else this.add(e,t)}get(e){return this.data.get(e)}has(e){return this.data.has(e)}_sort(){let{_keys:e}=this;this._sorted||(e.sort((e,t)=>e<t?-1:+(e>t)),this._sorted=!0)}updateDifference(e,t){var i;let l=null!=(i=this.difference.get(e))?i:0;this.difference.set(e,l+t),this.update()}getSumInRange(e,t){return this.calculatePrefixSum(t)-this.calculatePrefixSum(e-1)}updateCumulativeSum(e,t){for(let[i,l]of this.cumulativeSum)i>=e&&this.cumulativeSum.set(i,l+t)}calculatePrefixSum(e){if(e<0)return 0;if(this.cumulativeSum.has(e)){let t=this.cumulativeSum.get(e);for(let[i,l]of this.difference)i<=e&&(t+=l);return t}return this.dealDiffenence(),this.getCumulativeSum(e)}getCumulativeSum(e){var t,i;let l=0,o=0,r=!1,n=this.table.rowCount>0&&this.table.bottomFrozenRowCount>0?this.table.rowCount-this.table.bottomFrozenRowCount:-1;for(let i=e;i>=0;i--){if(this.cumulativeSum.has(i)){l+=this.cumulativeSum.get(i);break}l+=null!=(t=this.data.get(i))?t:this.table.getRowHeight(i),i>=n&&-1!==n&&(o=l,r=i===n)}if(r&&(null==(i=this.table.containerFit)?void 0:i.height)&&this.table.bottomFrozenRowCount){let e=this.table.tableNoFrameHeight||0;l<e&&(l=e-this.table.getBottomFrozenRowsHeight()+o)}return this.cumulativeSum.set(e,l),l}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(let[e]of this.cumulativeSum)for(let[t,i]of this.difference)if(e>=t){let t=this.cumulativeSum.get(e);this.cumulativeSum.set(e,t+i)}this.difference.clear()}insert(e,t){for(let t=e;t<=this.getLastIndex();t++)this.cumulativeSum.delete(t);let i=this.getLastIndex()+1;this.adjustOrder(e,e+1,i-e),(0,m.Z)(t)&&this.put(e,t)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){let e=this.getLastIndex();this.remove(e)}delete(e){if(!this.has(e))return;for(let t=e;t<=this.getLastIndex();t++)this.cumulativeSum.delete(t);let t=this.getLastIndex();this.adjustOrder(e+1,e,t-e),this.delLast()}adjustOrder(e,t,i){this.clearRange(),this._sort();let{_keys:l}=this;if(e>t){let o=[];for(let r=lw(l,e+i-1);r>=0;r--){let n=l[r];if(n>=e)o.push(this.get(n));else if(t<=n&&n<e)this.put(n+i,this.get(n));else if(n<t)break}for(let e=0;e<i;e++)this.put(t+e,o[i-1-e])}let{length:o}=l;if(e<t){let r=[];for(let n=lw(l,e);n<o;n++){let o=l[n];if(o>=e&&o<e+i)r.push(this.get(o));else if(e+i<=o&&o<=t)this.put(o-i,this.get(o));else if(o>t)break}for(let e=0;e<i;e++)this.put(t+e,r[e])}}exchangeOrder(e,t,i,l,o){let{_keys:r}=this;if(this._sorted||(r.sort((e,t)=>e<t?-1:+(e>t)),this._sorted=!0),e>i){let l=[],n=[];for(let o=lw(r,i);o<lw(r,e)+t;o++){let i=r[o];i>=e&&i<e+t?n.push(this.get(i)):l.push(this.get(i))}for(let e=0;e<t;e++)this.put(o+e,n[e]);for(let e=0;e<l.length;e++)this.put(o+t+e,l[e])}else{let n=[],a=[];for(let o=lw(r,e);o<lw(r,i)+l;o++){let i=r[o];i>=e&&i<e+t?a.push(this.get(i)):n.push(this.get(i))}for(let e=0;e<t;e++)this.put(o+e,a[e]);for(let t=0;t<n.length;t++)this.put(e+t,n[t])}}}function lw(e,t){let i=0,l=e.length-1;for(;i<=l;){let o=Math.floor((i+l)/2);if(e[o]===t)return o;e[o]>t?l=o-1:i=o+1}return l<0?0:l}class ly{constructor(e){this._table=e;let t=eC.U2();this.dragReorderIconName=t[N.up.dragReorderIconName]}getIcons(e,t){return[this.dragReorderIconName]}}var lx=i(57752),l_=i(43221);function lS(e,t){var i;return(0,V.ke)(t,e)||(null!=(i=lA(e,t))?i:{top:-1,row:-1,bottom:-1,height:-1})}function lR(e,t){var i;return(0,V.sQ)(t,e)||(null!=(i=lH(e,t))?i:{left:-1,col:-1,right:-1,width:1})}function lH(e,t){if(0===e)return{left:0,col:0,right:0,width:0};let i=function(e,t){if(t._colRangeWidthsMap.get("$0$"+(t.colCount-1))){let i=0,l=t.colCount-1;for(;l-i>1;){let o=Math.floor((i+l)/2);if(e<t._colRangeWidthsMap.get(`$0$${o}`))l=o;else{if(!(e>t._colRangeWidthsMap.get(`$0$${o}`)))return o;i=o}}return l}return Math.min(Math.ceil(e/t.internalProps.defaultColWidth),t.colCount-1)}(e,t),l=t.getColsWidth(0,i);return e>=l?((i,l)=>{let o=l-t.getColWidth(i),{colCount:r}=t.internalProps;for(let l=i;l<r;l++){let i=t.getColWidth(l),r=o+i;if(Math.round(o)<=Math.round(e)&&Math.round(e)<Math.round(r))return{left:o,col:l,right:r,width:i};o=r}return null})(i,l):((i,l)=>{let o=l;for(let l=i;l>=0;l--){let i=t.getColWidth(l),r=o-i;if(Math.round(r)<=Math.round(e)&&Math.round(e)<Math.round(o))return{left:r,col:l,right:o,width:i};o=r}return null})(i,l)}function lA(e,t){var i,l,o;let r;if(0===e)return{top:0,row:0,bottom:0,height:0};let n=!0===(null==(i=t.options.customConfig)?void 0:i._disableColumnAndRowSizeRound)?Math.floor:Math.round,a=(l=e,r=(o=t).defaultRowHeight,o._rowRangeHeightsMap.get("$0$"+(o.rowCount-1))&&(r=o._rowRangeHeightsMap.get("$0$"+(o.rowCount-1))/o.rowCount),Math.min(Math.ceil(l/r),o.rowCount-1)),s=t.getRowsHeight(0,a);return e>=s?((i,l)=>{let o=l-t.getRowHeight(i),{rowCount:r}=t.internalProps;for(let l=i;l<r;l++){let i=t.getRowHeight(l),r=o+i;if(n(o)<=n(e)&&n(e)<n(r))return{top:o,row:l,bottom:r,height:i};o=r}return null})(a,s):((i,l)=>{let o=l;for(let l=i;l>=0;l--){let i=t.getRowHeight(l),r=o-i;if(n(r)<=n(e)&&n(e)<n(o))return{top:r,row:l,bottom:o,height:i};o=r}return null})(a,s)}function lM(e,t,i){if(0===e)return{left:0,col:0,right:0,width:0};if(e-=i.tableX,t&&e>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&e<i.tableNoFrameWidth&&e<=i.getAllColsWidth()){for(let t=0;t<i.rightFrozenColCount;t++)if(e>i.tableNoFrameWidth-i.getColsWidth(i.colCount-t-1,i.colCount-1))return{col:i.colCount-t-1,left:void 0,right:void 0,width:void 0}}return lH(e,i)}function lF(e,t,i){if(0===e)return{top:0,row:0,bottom:0,height:0};if(e-=i.tableY,t&&e>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&e<i.tableNoFrameHeight){for(let t=0;t<i.rightFrozenColCount;t++)if(e>i.tableNoFrameHeight-i.getRowsHeight(i.rowCount-t-1,i.rowCount-1))return{row:i.rowCount-t-1,top:void 0,bottom:void 0,height:void 0}}return lA(e,i)}var lB=i(51235);function lT(e,t,i,l,o,r){var n;return e||t?e instanceof lu?e:"function"==typeof e?lT(e(i),t,i,l,o,r):(e||(e={}),o&&!(0,m.Z)(e.autoWrapText)&&(e.autoWrapText=!0),l===lp?new lp(null!=e?e:{},null!=t?t:{},null!=(n=r.checkboxStyle)?n:{}):new l(null!=e?e:{},null!=t?t:{})):l.DEFAULT}var lz=i(52110);let lL={};var lk=i(84564),lP=i(46511),lI=i(88994),lE=i(75365),lD=i(35437);function lW(e){return Math.floor(e)===e}class lO extends lk.r{onUpdate(e,t,i){if(this.from.x!==this.to.x){let i=e?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*t);this.params.table.scrollLeft=i}if(this.from.y!==this.to.y){let i=e?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*t);this.params.table.scrollTop=i}}}class lG{constructor(e){this.table=e,this.timeline=new lP.L,this.ticker=new lI.H(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=(0,eu.f)({})}scrollTo(e,t){var i,l;let o={x:this.table.scrollLeft,y:this.table.scrollTop},{col:r,row:n}=e,a,s,h=r,d=n;(0,J.Z)(r)&&!lW(r)&&(h=Math.floor(r),a=r-h),(0,J.Z)(n)&&!lW(n)&&(d=Math.floor(n),s=n-d);let u=this.table.getCellRect(null!=h?h:0,null!=d?d:0),{left:c,top:g}=u;a&&(c+=a*u.width),s&&(g+=s*u.height);let p={x:(0,J.Z)(r)?c-this.table.getFrozenColsWidth():this.table.scrollLeft,y:(0,J.Z)(n)?g-this.table.getFrozenRowsHeight():this.table.scrollTop},f=(0,lb.Z)(t)?3e3*!!t:null!=(i=null==t?void 0:t.duration)?i:3e3,b=(0,lb.Z)(t)?t?"linear":"":null!=(l=null==t?void 0:t.easing)?l:"linear";new lE.r(lD.R.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new lO(o,p,f,b,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}function lN(e){return(0,ij.Z)(e)?e:(0,eH.Z)(e)?(t,i)=>e.find(e=>e.range.start.col<=t&&e.range.end.col>=t&&e.range.start.row<=i&&e.range.end.row>=i):void 0}var lZ=i(61240);let{toBoxArray:lK}=T.oB,{isTouchEvent:lV}=T.B,lj=/^\$(\d+)\$(\d+)$/;!function(){if("node"===A.X.mode)return;let e=document.createElement("style");e.id="vtable-style-styleSheet",e.textContent="\n.vtable .input-container {\n	position: absolute;\n	top:0px;\n}\n.vtable .table-scrollable {\n	position: absolute;\n	overflow: scroll;\n}\n.vtable .table-scrollable::-webkit-scrollbar-button{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-track-piece{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-corner {\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-thumb {\n	border-radius      : 4px;\n	background-color   : rgba(100, 100, 100, .5);\n}\n\n.vtable .table-scroll-end-point {\n	opacity: 0;\n	position: relative;\n}\n.vtable {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: relative;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n\n.vtable-gantt {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: absolute;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n.vtable .table-component-container {\n  pointer-events: none;\n  overflow: hidden;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.vtable > canvas {\n	position: absolute;\n	width: 0;\n	height: 0;\n}\n.vtable .table-focus-control {\n	position: relative !important;\n	width: 1px;\n	height: 1px;\n	opacity: 0;\n	padding: 0;\n	margin: 0;\n	box-sizing: border-box;\n	pointer-events: none;\n	max-width: 500px;\n	max-height: 500px;\n	float: none !important;\n}\n.vtable input.table-focus-control::-ms-clear {\n	visibility: hidden;\n}\n.vtable input.table-focus-control.composition {\n	opacity: 1;\n	max-width: none;\n	max-height: none;\n}\n",document.head.appendChild(e)}();class lU extends C.R{static get EVENT_TYPE(){return z.B}constructor(e,t={}){var i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,C,v,w,y,x,_,S,R,H;if(super(),this.showFrozenIcon=!0,this.version="1.19.4",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=(0,I.E5)(this.render.bind(this),200),"node"===A.X.mode?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),!e&&"node"!==t.mode&&!t.canvas)throw Error("vtable's container is undefined");this.pluginManager=new lZ.Q(this,t),this.fireListeners(z.B.BEFORE_INIT,{options:t,container:e}),e=t.container&&t.container instanceof HTMLElement?t.container:e,!1===(null==(i=t.customConfig)?void 0:i.imageAnonymous)&&(O.rF.isImageAnonymous=!1);let{frozenColCount:M=0,unfreezeAllOnExceedsMaxWidth:B,frozenRowCount:T,defaultRowHeight:P=40,defaultHeaderRowHeight:D,defaultColWidth:W=80,defaultHeaderColWidth:G,widthMode:N="standard",heightMode:Z="standard",autoFillWidth:j=!1,autoFillHeight:U=!1,containerFit:$={width:!1,height:!1},widthAdaptiveMode:X="only-body",heightAdaptiveMode:Y="only-body",keyboardOptions:q,eventOptions:Q,rowSeriesNumber:ee,enableCheckboxCascade:et,columnResizeMode:ei,rowResizeMode:el="none",resize:eo,dragHeaderMode:er,dragOrder:en,showFrozenIcon:ea,allowFrozenColCount:es,padding:eh,hover:ed,menu:eu,select:ec,customRender:eg,pixelRatio:ep=i3,renderChartAsync:ef,renderChartAsyncBatchCount:eb,mode:em,modeParams:ev,canvasWidth:ew,canvasHeight:ey,overscrollBehavior:ex,limitMinWidth:e_,limitMinHeight:eS,clearDOM:eR=!0}=t,{groupConfig:eH,groupBy:eA,groupTitleFieldFormat:eM,groupTitleCustomLayout:eF,enableTreeStickCell:eB}=t;this.container=e,this.options=t,this._widthMode=N,this._heightMode=Z,this._widthAdaptiveMode=X,this._heightAdaptiveMode=Y,this._autoFillWidth=j,this._autoFillHeight=U,void 0!==$&&(this._containerFit="boolean"==typeof $?{width:$,height:$}:$&&"object"==typeof $?{width:null==(l=$.width)||l,height:null==(o=$.height)||o}:{width:!1,height:!1}),this.customRender=eg,this.padding={top:0,right:0,left:0,bottom:0},eh&&("number"==typeof eh?(this.padding.top=eh,this.padding.left=eh,this.padding.bottom=eh,this.padding.right=eh):(eh.top&&(this.padding.top=eh.top),eh.bottom&&(this.padding.bottom=eh.bottom),eh.left&&(this.padding.left=eh.left),eh.right&&(this.padding.right=eh.right))),((0,m.Z)(ey)||(0,m.Z)(ew))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.canvasWidth=(0,J.Z)(ew)?ew:void 0,this.canvasHeight=(0,J.Z)(ey)?ey:void 0,this.columnWidthComputeMode=null!=(r=t.columnWidthComputeMode)?r:"normal";let eT=this.internalProps={};void 0!==ea&&(this.showFrozenIcon=ea),"number"==typeof es&&es<=0&&(this.showFrozenIcon=!1),this.options.canvas?("node"!==A.X.mode&&(eT.element=this.options.canvas.parentElement,eT.element.style.position="relative"),eT.focusControl=new lC(this,eT.element),eT.canvas=this.options.canvas,eT.context=eT.canvas.getContext("2d")):"node"!==A.X.mode&&(eT.element=(0,V._I)(this.padding),eT.focusControl=new lC(this,eT.element),eT.canvas=document.createElement("canvas"),eT.element.appendChild(eT.canvas),eT.context=eT.canvas.getContext("2d"),(null==(n=t.customConfig)?void 0:n.createReactContainer)&&function(e){let{internalProps:t}=e;t.bodyDomContainer=document.createElement("div"),t.bodyDomContainer.id="vtable-body-dom-container",t.bodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bodyDomContainer),t.headerDomContainer=document.createElement("div"),t.headerDomContainer.id="vtable-header-dom-container",t.headerDomContainer.classList.add("table-component-container"),t.element.appendChild(t.headerDomContainer),t.frozenBodyDomContainer=document.createElement("div"),t.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",t.frozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBodyDomContainer),t.frozenHeaderDomContainer=document.createElement("div"),t.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",t.frozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenHeaderDomContainer),t.rightFrozenBodyDomContainer=document.createElement("div"),t.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",t.rightFrozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBodyDomContainer),t.rightFrozenHeaderDomContainer=document.createElement("div"),t.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",t.rightFrozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenHeaderDomContainer),t.frozenBottomDomContainer=document.createElement("div"),t.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",t.frozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBottomDomContainer),t.bottomDomContainer=document.createElement("div"),t.bottomDomContainer.id="vtable-bottom-dom-container",t.bottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bottomDomContainer),t.rightFrozenBottomDomContainer=document.createElement("div"),t.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",t.rightFrozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBottomDomContainer)}(this)),eT.handler=new L.b,(0,J.Z)(this.options.resizeTime)&&(eT.handler.resizeTime=this.options.resizeTime),eT.pixelRatio=ep,eT.frozenColCount=M,eT.frozenRowCount=T,eT.unfreezeAllOnExceedsMaxWidth=null==B||B,eT.defaultRowHeight=P,eT.defaultHeaderRowHeight=null!=D?D:P,eT.defaultColWidth=W,eT.defaultHeaderColWidth=null!=G?G:W,eT.keyboardOptions=q,eT.eventOptions=Q,eT.rowSeriesNumber=ee,eT.enableCheckboxCascade=null==(a=null!=et?et:null==ee?void 0:ee.enableTreeCheckbox)||a,eT.columnResizeMode=null!=(s=null==eo?void 0:eo.columnResizeMode)?s:ei,eT.rowResizeMode=null!=(h=null==eo?void 0:eo.rowResizeMode)?h:el,eT.dragHeaderMode=null!=(u=null!=(d=null==en?void 0:en.dragHeaderMode)?d:er)?u:"none",eT.renderChartAsync=ef,(0,eN.Ry)(eb),eT.overscrollBehavior=null!=ex?ex:"auto",eT.groupBy=null!=(c=null==eH?void 0:eH.groupBy)?c:eA,eT.groupTitleCheckbox=null!=(g=null==eH?void 0:eH.titleCheckbox)?g:!!(null==ee?void 0:ee.enableTreeCheckbox),eT.groupTitleFieldFormat=null!=(p=null==eH?void 0:eH.titleFieldFormat)?p:eM,eT.groupTitleCustomLayout=null!=(f=null==eH?void 0:eH.titleCustomLayout)?f:eF,eT.enableTreeStickCell=null!=(b=null==eH?void 0:eH.enableTreeStickCell)?b:eB,eT._rowHeightsMap=new lv(this),eT._rowRangeHeightsMap=new Map,eT._colRangeWidthsMap=new Map,eT._widthResizedColMap=new Set,eT._heightResizedRowMap=new Set,this.colWidthsMap=new k.B,this.colContentWidthsMap=new k.B,this.colWidthsLimit={};let ez=this;if(eT.calcWidthContext={_:eT,get full(){var eL;return"node"===A.X.mode?ez.canvasWidth/(null!=ep?ep:1):this._.canvas.width/(null!=(eL=this._.context.pixelRatio)?eL:window.devicePixelRatio)}},eT.cellTextOverflows={},eT.focusedTable=!1,eT.theme=E.default.of(null!=(C=t.theme)?C:E.default.DEFAULT),eT.theme.isPivot=this.isPivotTable(),(0,eC.E6)(eT.theme.functionalIconsStyle),e&&(eR&&(e.innerHTML=""),e.appendChild(eT.element)),this._updateSize(),eT.bodyHelper=new ls(this),eT.headerHelper=new lf(this),eT.rowSeriesNumberHelper=new ly(this),eT.autoWrapText=t.autoWrapText,eT.enableLineBreak=t.enableLineBreak,eT.allowFrozenColCount=null!=(v=t.allowFrozenColCount)?v:0,eT.limitMaxAutoWidth=null!=(w=t.limitMaxAutoWidth)?w:450,eT.limitMinWidth=null!=e_?"number"==typeof e_?e_:10*!!e_:10,eT.limitMinHeight=null!=eS?"number"==typeof eS?eS:10*!!eS:10,this.scenegraph=new iA(this),this.stateManager=new iK(this),this.eventManager=new li(this),this.animationManager=new lG(this),t.legends){eT.legends=[];let e=K.F.getFunction("createLegend");if(Array.isArray(t.legends)){for(let i=0;i<t.legends.length;i++)eT.legends.push(e(t.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else eT.legends.push(e(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(eT.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:F.u.bottom},t.tooltip),"html"===eT.tooltip.renderMode){let e=K.F.getComponent("tooltipHandler");e&&(eT.tooltipHandler=new e(this,eT.tooltip.confine))}eT.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray(null==(y=t.menu)?void 0:y.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(x=t.menu)?void 0:x.dropDownMenuHighlight),(Array.isArray(null==(_=t.menu)?void 0:_.defaultHeaderMenuItems)||"function"==typeof(null==(S=t.menu)?void 0:S.defaultHeaderMenuItems))&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),"html"===eT.menu.renderMode&&(eT.menuHandler=new(K.F.getComponent("menuHandler"))(this)),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,eT.stick={changedCells:new Map},eT.customMergeCell=lN(t.customMergeCell);let ek=K.F.getComponent("customCellStylePlugin");ek&&(this.customCellStylePlugin=new ek(this,null!=(R=t.customCellStyle)?R:[],null!=(H=t.customCellStyleArrangement)?H:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){"auto"!==this.options.canvasHeight&&"auto"!==this.options.canvasWidth||setTimeout(()=>{var e,t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_;let S,R;if("auto"===this.options.canvasHeight){let c=0;if(null==(e=this.theme.frameStyle)?void 0:e.innerBorder)c+=null!=(l=lK(null!=(i=null==(t=this.internalProps.theme.frameStyle)?void 0:t.shadowBlur)?i:[0])[1])?l:0;else if(this.theme.frameStyle){let e=lK(null!=(r=null==(o=this.internalProps.theme.frameStyle)?void 0:o.borderLineWidth)?r:[null]),t=lK(null!=(a=null==(n=this.internalProps.theme.frameStyle)?void 0:n.shadowBlur)?a:[0]);c+=(null!=(s=e[0])?s:0)+(null!=(h=t[0])?h:0)+((null!=(d=e[2])?d:0)+(null!=(u=t[2])?u:0))}R=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-c:2e4,this.getAllRowsHeight())+c}else R=this.canvasHeight;if("auto"===this.options.canvasWidth){let e=0;if(null==(c=this.theme.frameStyle)?void 0:c.innerBorder)e+=null!=(f=lK(null!=(p=null==(g=this.internalProps.theme.frameStyle)?void 0:g.shadowBlur)?p:[0])[2])?f:0;else if(this.theme.frameStyle){let t=lK(null!=(m=null==(b=this.internalProps.theme.frameStyle)?void 0:b.borderLineWidth)?m:[null]),i=lK(null!=(v=null==(C=this.internalProps.theme.frameStyle)?void 0:C.shadowBlur)?v:[0]);e+=(null!=(w=t[1])?w:0)+(null!=(y=i[1])?y:0)+((null!=(x=t[3])?x:0)+(null!=(_=i[3])?_:0))}S=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-e:2e4,this.getAllColsWidth())+e}else S=this.canvasWidth;this.setCanvasSize(S,R)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(e,t){this.canvasWidth=e,this.canvasHeight=t,this.options.canvasHeight=t,this.options.canvasWidth=e,this.resize()}resize(){var e;this._updateSize(),null==(e=this.internalProps.legends)||e.forEach(e=>{null==e||e.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(e){this.internalProps.rowCount=e}get colCount(){var e;return null!=(e=this.internalProps.colCount)?e:0}set colCount(e){this.internalProps.colCount=e}get frozenColCount(){var e,t,i,l,o;return null!=(o=null!=(i=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.frozenColCount)?i:null==(l=this.internalProps)?void 0:l.frozenColCount)?o:0}set frozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;let t=this._getMaxFrozenWidth();if(this.getColsWidth(0,e-1)>t)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let t=this._getComputedFrozenColCount(e);this.internalProps.frozenColCount=t}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;let t=this._getMaxFrozenWidth();if(this.getColsWidth(0,e-1)>t)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let t=this._getComputedFrozenColCount(e);this.internalProps.frozenColCount=t}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var e,t,i,l,o;return null!=(o=null!=(i=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.frozenRowCount)?i:null==(l=this.internalProps)?void 0:l.frozenRowCount)?o:0}set frozenRowCount(e){this.internalProps.frozenRowCount=e,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var e,t,i,l,o;return null!=(o=null!=(i=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.rightFrozenColCount)?i:null==(l=this.internalProps)?void 0:l.rightFrozenColCount)?o:0}set rightFrozenColCount(e){this.scenegraph.dealWidthRightFrozen(e)}get bottomFrozenRowCount(){var e,t,i,l,o;return null!=(o=null!=(i=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.bottomFrozenRowCount)?i:null==(l=this.internalProps)?void 0:l.bottomFrozenRowCount)?o:0}set bottomFrozenRowCount(e){this.scenegraph.dealWidthBottomFrozen(e)}get defaultRowHeight(){return(0,J.Z)(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(e){this.internalProps.defaultRowHeight=e,this.options.defaultRowHeight=e}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(e){this.internalProps.defaultHeaderRowHeight=e,this.options.defaultHeaderRowHeight=e}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(e){this.internalProps.defaultColWidth=e,this.options.defaultColWidth=e}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(e){this.internalProps.defaultHeaderColWidth=e,this.options.defaultHeaderColWidth=e}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(e){this.internalProps._colWidthsMap=e}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(e){this.internalProps._colContentWidthsMap=e}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(e){this.internalProps._colRangeWidthsMap=e}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(e){this.internalProps._rowRangeHeightsMap=e}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(e){this.internalProps._rowHeightsMap=e}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(e){this.internalProps._colWidthsLimit=e}get keyboardOptions(){var e;return null!=(e=this.internalProps.keyboardOptions)?e:null}set keyboardOptions(e){this.internalProps.keyboardOptions=null!=e?e:void 0}get eventOptions(){var e;return null!=(e=this.internalProps.eventOptions)?e:null}set eventOptions(e){this.internalProps.eventOptions=null!=e?e:void 0}get widthMode(){return this._widthMode}set widthMode(e){e!==this._widthMode&&(this._widthMode=e,this.options.widthMode=e)}get heightMode(){return this._heightMode}set heightMode(e){e!==this._heightMode&&(this._heightMode=e,this.options.heightMode=e)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(e){e!==this._autoFillWidth&&(this._autoFillWidth=e)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(e){e!==this._autoFillHeight&&(this._autoFillHeight=e)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(e){e!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=e)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(e){e!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=e)}_colWidthDefineToPxWidth(e){return"auto"===e?0:(0,V.qf)(this,e)}_getMaxFrozenWidth(){var e;let t=null!=(e=this.options.maxFrozenWidth)?e:"80%";return(0,V.qf)(this,t)}_getComputedFrozenColCount(e){let t=this._getMaxFrozenWidth(),i=e;for(;this.getColsWidth(0,i-1)>t&&!(--i<=0););return i}_getColWidthLimits(e){let t=this.colWidthsLimit[e];if(!t)return null;let i={};return t.min&&(i.min=(0,V.qf)(this,t.min),i.minDef=t.min),t.max&&(i.max=(0,V.qf)(this,t.max),i.maxDef=t.max),i}_adjustColWidth(e,t){let i=this._getColWidthLimits(e);return Math.max((0,V.AS)(i,t),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(e){var t;if(e!==(null==(t=this.internalProps)?void 0:t.pixelRatio)){this.internalProps.pixelRatio=e;let t=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var i;return"node"===A.X.mode?t/(null!=e?e:1):this._.canvas.width/(null!=(i=this._.context.pixelRatio)?i:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(e)}}_updateSize(){var e,t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,C,v,w,y,x,_,S,R,H,F,B,T,z;let{padding:L}=this,k=0,P=0;if(this.tableX=0,this.tableY=0,this.options.canvas&&this.options.viewBox)k=this.options.viewBox.x2-this.options.viewBox.x1,P=this.options.viewBox.y2-this.options.viewBox.y1,(null==(e=null==this?void 0:this.scenegraph)?void 0:e.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(k,P));else if("browser"===A.X.mode){let e=this.getElement(),d=0,u=0,c=(0,m.Z)(this.canvasWidth),g=(0,m.Z)(this.canvasHeight);if(this.canvasSizeSeted&&(c&&(d=this.canvasWidth),g&&(u=this.canvasHeight)),(!c||!g)&&e.parentElement){let t=e.parentElement.style||window.getComputedStyle(e.parentElement);c||(d=e.parentElement.offsetWidth-(parseInt(t.paddingLeft,10)||0)-(parseInt(t.paddingRight,10)||0)),g||(u=e.parentElement.offsetHeight-parseInt(t.paddingTop||"0px",10)-parseInt(t.paddingBottom||"0px",20)),d=(null!=d?d:1)-!!this.options.tableSizeAntiJitter,u=(null!=u?u:1)-!!this.options.tableSizeAntiJitter}e.style.width=d&&d-L.left-L.right+"px"||"0px",e.style.height=u&&u-L.top-L.bottom+"px"||"0px";let{canvas:p}=this.internalProps;k=(null!=(i=null==(t=p.parentElement)?void 0:t.offsetWidth)?i:1)-!!this.options.tableSizeAntiJitter,P=(null!=(o=null==(l=p.parentElement)?void 0:l.offsetHeight)?o:1)-!!this.options.tableSizeAntiJitter,(null==(r=null==this?void 0:this.scenegraph)?void 0:r.stage)?(null==(n=this.options)?void 0:n.viewBox)&&!(null==(a=this.options)?void 0:a.canvas)&&this.scenegraph.stage.resize(k,P):(p.style.width="",p.style.height="",p.width=k,p.height=P,p.style.width=`${k}px`,p.style.height=`${P}px`),(null==(s=this.options)?void 0:s.viewBox)&&(k=this.options.viewBox.x2-this.options.viewBox.x1,P=this.options.viewBox.y2-this.options.viewBox.y1),(null==(h=null==this?void 0:this.scenegraph)?void 0:h.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(k,P))}else"node"===A.X.mode&&(k=this.canvasWidth-1,P=this.canvasHeight-1);let I=Math.floor(k-M.Iv(this.getTheme().scrollStyle)),E=Math.floor(P-M.vP(this.getTheme().scrollStyle));if(null==(d=this.internalProps.theme)?void 0:d.frameStyle){let e=lK(null!=(c=null==(u=this.internalProps.theme.frameStyle)?void 0:u.borderLineWidth)?c:[null]),t=lK(null!=(p=null==(g=this.internalProps.theme.frameStyle)?void 0:g.shadowBlur)?p:[0]);(null==(f=this.theme.frameStyle)?void 0:f.innerBorder)?(this.tableX=0,this.tableY=0,this.tableNoFrameWidth=I-(null!=(b=t[1])?b:0),this.tableNoFrameHeight=E-(null!=(C=t[2])?C:0)):(this.tableX=(null!=(v=e[3])?v:0)+(null!=(w=t[3])?w:0),this.tableY=(null!=(y=e[0])?y:0)+(null!=(x=t[0])?x:0),this.tableNoFrameWidth=I-((null!=(_=e[1])?_:0)+(null!=(S=t[1])?S:0))-((null!=(R=e[3])?R:0)+(null!=(H=t[3])?H:0)),this.tableNoFrameHeight=E-((null!=(F=e[0])?F:0)+(null!=(B=t[0])?B:0))-((null!=(T=e[2])?T:0)+(null!=(z=t[2])?z:0)))}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}updateViewBox(e){var t,i,l,o,r,n,a,s,h,d,u,c;let g=(null!=(l=null==(i=null==(t=this.options)?void 0:t.viewBox)?void 0:i.x2)?l:0)-(null!=(n=null==(r=null==(o=this.options)?void 0:o.viewBox)?void 0:r.x1)?n:0),p=(null!=(h=null==(s=null==(a=this.options)?void 0:a.viewBox)?void 0:s.y2)?h:0)-(null!=(c=null==(u=null==(d=this.options)?void 0:d.viewBox)?void 0:u.y1)?c:0),f=e.x2-e.x1,b=e.y2-e.y1;this.options.viewBox=e,g!==f||p!==b?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(e,t,i,l,o,r){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(e,t,i,l,o,r)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(e,t){var i;if(e>t)return 0;e=Math.max(e,0),t=Math.min(t,(null!=(i=this.colCount)?i:1/0)-1);let l=this._colRangeWidthsMap.get(`$${e}$${t}`);if(null!=l)return l;let o=this._colRangeWidthsMap.get(`$${e}$${t-1}`);if(null!=o){let i=o+this.getColWidth(t);return this.rightFrozenColCount>0&&t===this.colCount-this.rightFrozenColCount&&(i=this._getRangeSizeForContainerFit(e,t,i,"col")),e>=0&&t>=0&&!Number.isNaN(i)&&this._colRangeWidthsMap.set(`$${e}$${t}`,Math.round(i)),Math.round(i)}let r=0;for(let i=e;i<=t;i++)r+=this.getColWidth(i);return r=this._getRangeSizeForContainerFit(e,t,r,"col"),e>=0&&t>=0&&this._colRangeWidthsMap.set(`$${e}$${t}`,Math.round(r)),Math.round(r)}getRowHeight(e){var t;if((0,m.Z)(this.rowHeightsMap.get(e))){if(null==(t=this.options.customConfig)?void 0:t._disableColumnAndRowSizeRound){let t,i=this.rowHeightsMap.get(e);return Number.isInteger(Number((e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e)).toFixed(2)))?Math.ceil(i):Math.floor(i)}return this.rowHeightsMap.get(e)}let i=this.getDefaultRowHeight(e);return(0,J.Z)(i)?i:this.defaultRowHeight}getDefaultColumnWidth(e){var t,i;return this.isRowHeader(e,0)||this.isCornerHeader(e,0)?Array.isArray(this.defaultHeaderColWidth)?null!=(t=this.defaultHeaderColWidth[e])?t:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(e,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?null!=(i=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])?i:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(e){var t,i;return this.isColumnHeader(0,e)||this.isCornerHeader(0,e)||this.isSeriesNumberInHeader(0,e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(t=this.defaultHeaderRowHeight[e])?t:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(i=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])?i:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(e,t,i){var l;this.rowHeightsMap.put(e,(null==(l=this.options.customConfig)?void 0:l._disableColumnAndRowSizeRound)?t:Math.round(t)),i&&this._clearRowRangeHeightsMap(e)}setRowHeight(e,t){this.scenegraph.setRowHeight(e,t),this.scenegraph.updateChartSizeForResizeRowHeight(e),this.internalProps._heightResizedRowMap.add(e)}getRowsHeight(e,t){var i,l;if(e>t||0===this.rowCount)return 0;e=Math.max(e,0),t=Math.min(t,(null!=(i=this.rowCount)?i:1/0)-1);let o=0,r="auto"===this.options.defaultRowHeight;if("standard"!==this.heightMode||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||r||0!==this.internalProps._heightResizedRowMap.size){if(null==(l=this.options.customConfig)?void 0:l._disableColumnAndRowSizeRound){let i,l=this.rowHeightsMap.getSumInRange(e,t);return Number.isInteger(Number((t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t)).toFixed(2)))?Math.ceil(l):Math.floor(l)}o=this.rowHeightsMap.getSumInRange(e,t)}else{let i=this.rowCount-this.bottomFrozenRowCount;for(let i=e;i<Math.min(t+1,this.columnHeaderLevelCount);i++)o+=this.getRowHeight(i);t>=this.columnHeaderLevelCount&&(o+=this.defaultRowHeight*(Math.min(t,i-1)-Math.max(this.columnHeaderLevelCount,e)+1));let l=0;for(let e=i;e<t+1;e++)l+=this.getRowHeight(e);o=this._getRangeSizeForContainerFit(e,t,o+l,"row")}return Math.round(o)}_getRangeSizeForContainerFit(e,t,i,l="col"){var o;if(!isFinite(e)||!isFinite(t))return i;let r="col"===l?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},n=this[r.tableSize];if(i>=n)return i;let a=this[r.totalCount]-this[r.frozenCount];if(!isFinite(this[r.totalCount])||this[r.frozenCount]<=0||a<0||e>a||t<a||e===t||!(null==(o=this.containerFit)?void 0:o[r.fitType]))return i;let s=this[r.totalCount]-1,h=n;if(e>0){for(let t=0;t<e;t++)if((h-=this[r.getSize](t))<=0)return i}if(t!==s){for(let e=t+1;e<=s;e++)if((h-=this[r.getSize](e))<=0)return i}return h}getColWidthDefined(e){var t;let{layoutMap:i}=this.internalProps;if("autoWidth"===this.widthMode)return"auto";let{width:l}=null!=(t=null==i?void 0:i.getColumnWidthDefined(e))?t:{};return"number"==typeof l&&l<=0?0:l||this.getDefaultColumnWidth(e)}getColWidthDefinedNumber(e){let t=this.getColWidthDefined(e);return this._adjustColWidth(e,this._colWidthDefineToPxWidth(t))}isAutoRowHeight(e){return"autoHeight"===this.heightMode||!!this.options.customComputeRowHeight||(e>=0&&e<this.columnHeaderLevelCount?"auto"===this.getDefaultRowHeight(e):"auto"===this.internalProps.defaultRowHeight)}getColWidth(e){var t;let i=null!=(t=this.colWidthsMap.get(e))?t:this.getDefaultColumnWidth(e);return"adaptive"===this.widthMode&&"number"==typeof i||this.transpose&&"number"==typeof i?this._colWidthDefineToPxWidth(i):this._adjustColWidth(e,this._colWidthDefineToPxWidth(i))}_setColWidth(e,t,i,l){this.colWidthsMap.put(e,"number"==typeof t?Math.round(t):t),i&&this._clearColRangeWidthsMap(e),l||this.stateManager.checkFrozen()}setColWidth(e,t){this.scenegraph.setColWidth(e,t),this.scenegraph.updateChartSizeForResizeColWidth(e),this.internalProps._widthResizedColMap.add(e)}_clearColRangeWidthsMap(e){if("number"!=typeof e)this._colRangeWidthsMap.clear();else for(let t of this._colRangeWidthsMap.keys()){let i=lj.exec(t);if(i){let l=Number(i[1]),o=Number(i[2]);e>=l&&e<=o&&this._colRangeWidthsMap.delete(t)}}}_clearRowRangeHeightsMap(e){this.rowHeightsMap.clearRange()}_getColContentWidth(e){return Number(this.colContentWidthsMap.get(e))}_setColContentWidth(e,t){this.colContentWidthsMap.put(e,t)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getColsWidths(){let e=this.colCount,t=[];for(let i=0;i<e;i++)t.push(this.getColWidth(i));return t}getMaxColWidth(e){var t;let i=this.colWidthsLimit[e],l=null!=(t=i&&i.max)?t:1/0;return"string"==typeof l&&(l=(0,V.qf)(this,l)),l}setMaxColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).max=t}getMinColWidth(e){var t;let i=this.colWidthsLimit[e],l=null!=(t=i&&i.min)?t:0;return"string"==typeof l&&(l=(0,V.qf)(this,l)),l}setMinColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).min=t}getCellRect(e,t){var i,l;let o,r,n=this.isFrozenCell(e,t),a=this.getColWidth(e);o=n&&n.col&&this.isRightFrozenColumn(e,t)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,e-1)||0:this.tableNoFrameWidth-(null!=(i=this.getColsWidth(e,this.colCount-1))?i:0):this.getColsWidth(0,e-1)||0;let s=this.getRowHeight(t);return r=n&&n.row&&this.isBottomFrozenRow(e,t)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,t-1):this.tableNoFrameHeight-(null!=(l=this.getRowsHeight(t,this.rowCount-1))?l:0):this.getRowsHeight(0,t-1),new P.U(Math.round(o),Math.round(r),Math.round(a),Math.round(s))}getMergeCellRect(e,t){let i=this.getCellRange(e,t),l=this.getColsWidth(0,i.start.col-1)||0,o=this.getColsWidth(i.start.col,i.end.col),r=this.getRowsHeight(0,i.start.row-1)||0,n=this.getRowsHeight(i.start.row,i.end.row);return new P.U(Math.round(l),Math.round(r),Math.round(o),Math.round(n))}getCellRelativeRect(e,t){let i=this.isFrozenCell(e,t),l=!0,o=!0;(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(l=!1,o=!1):(null==i?void 0:i.col)?l=!1:(null==i?void 0:i.row)&&(o=!1);let r=this.getCellRect(e,t);return this._toRelativeRect(r,l,o)}getCellRangeRelativeRect(e){if(e.start){let t=this.isFrozenCell(e.start.col,e.start.row),i=!0,l=!0;return(null==t?void 0:t.col)&&(null==t?void 0:t.row)?(i=!1,l=!1):(null==t?void 0:t.col)?i=!1:(null==t?void 0:t.row)&&(l=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),i,l)}let t=this.getCellRange(e.col,e.row),i=this.isFrozenCell(e.col,e.row),l=!0,o=!0;return(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(l=!1,o=!1):(null==i?void 0:i.col)?l=!1:(null==i?void 0:i.row)&&(o=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),l,o)}getVisibleCellRangeRelativeRect(e){let t;return t=e.start?e:this.getCellRange(e.col,e.row),this._getVisiableRect(this.getCellRangeRelativeRect(e),t)}_getVisiableRect(e,t){let i=t.start.col>=this.frozenColCount?Math.max(e.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):e.left,l=Math.min(e.right,this.tableNoFrameWidth),o=e.copy();o.left=i,o.right=l;let r=t.start.row>=this.frozenRowCount?Math.max(e.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):e.top,n=Math.min(e.bottom,this.tableNoFrameHeight);return o.top=r,o.bottom=n,o}getCellsRect(e,t,i,l){var o,r,n,a,s,h;let d=this.getColsWidth(0,e-1)||0,u=this.getColsWidth(e,i),c=this.scrollLeft,g=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),p=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(e)&&this.isRightFrozenColumn(i)?u=this.tableNoFrameWidth-(null!=(o=this.getColsWidth(e+1,this.colCount-1))?o:0)-d:this.isLeftFrozenColumn(e)&&!this.isLeftFrozenColumn(i)?u=Math.max(u-c,this.getColsWidth(e,this.frozenColCount-1)):!this.isRightFrozenColumn(e)&&this.isRightFrozenColumn(i)?(d=Math.min(d-c,g-this.getRightFrozenColsWidth()),u=g-(null!=(r=this.getColsWidth(e+1,this.colCount-1))?r:0)-d):this.isRightFrozenColumn(e)&&(d=g-(null!=(n=this.getColsWidth(e,this.colCount-1))?n:0));let f=this.getRowsHeight(0,t-1),b=this.getRowsHeight(t,l),m=this.scrollTop;return this.isTopFrozenRow(t)&&this.isBottomFrozenRow(l)?b=this.tableNoFrameHeight-(null!=(a=this.getRowsHeight(t+1,this.rowCount-1))?a:0)-f:this.isTopFrozenRow(t)&&!this.isTopFrozenRow(l)?b=Math.max(b-m,this.getRowsHeight(t,this.frozenRowCount-1)):!this.isBottomFrozenRow(t)&&this.isBottomFrozenRow(l)?(f=Math.min(f-m,p-this.getBottomFrozenRowsHeight()),b=p-(null!=(s=this.getRowsHeight(t+1,this.rowCount-1))?s:0)-f):this.isBottomFrozenRow(t)&&(f=p-(null!=(h=this.getRowsHeight(t,this.rowCount-1))?h:0)),new P.U(Math.round(d),Math.round(f),Math.round(u),Math.round(b))}getCellsRectWidth(e,t,i,l){let o=this.isFrozenCell(e,t),r=this.isFrozenCell(i,l),n=this.getColsWidth(e,i);if(o&&o.col){let t=this.scrollLeft;r&&r.col||(n-=t,n=Math.max(n,this.getColsWidth(e,this.frozenColCount-1)))}return n}getCellRangeRect(e){if(e.start)return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row);let t=this.getCellRange(e.col,e.row);return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row)}getCellRangeRectWidth(e){if(e.start)return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row);let t=this.getCellRange(e.col,e.row);return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row)}isFrozenCell(e,t){let i=this.isFrozenRow(t),l=this.isFrozenColumn(e);return i||l?{row:i,col:l}:null}getRowAt(e){return lS(e,this)}getColAt(e){return lR(e,this)}getCellAt(e,t){let{row:i,top:l,bottom:o,height:r}=lS(t,this),{col:n,left:a,right:s,width:h}=lR(e,this);return{row:i,col:n,rect:{left:a,right:s,top:l,bottom:o,width:h,height:r}}}getCellAtRelativePosition(e,t){return function(e,t,i){e-=i.tableX;let l=!1;(t-=i.tableY)>0&&t<i.getFrozenRowsHeight()&&(l=!0);let o=!1;e>0&&e<i.getFrozenColsWidth()&&(o=!0);let r=!1;t>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&t<i.tableNoFrameHeight&&t<=i.getAllRowsHeight()&&(r=!0);let n=!1;e>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&e<i.tableNoFrameWidth&&e<=i.getAllColsWidth()&&(n=!0);let a=lM((o||n?e:e+i.scrollLeft)+i.tableX,n,i),s=lF((l||r?t:t+i.scrollTop)+i.tableY,r,i);if(a&&s){let{row:e,top:t,bottom:i,height:l}=s,{col:o,left:r,right:n,width:h}=a;return{row:e,col:o,rect:{left:r,right:n,top:t,bottom:i,width:h,height:l}}}return{col:-1,row:-1}}(e,t,this)}_checkRowCol(e,t){return e>=0&&e<this.colCount&&t>=0&&t<this.rowCount}_makeVisibleCell(e,t){if(this._checkRowCol(e,t)){let i=this.isFrozenCell(e,t);if(i&&i.col&&i.row)return;let l=this.getCellRect(e,t),o=(0,V.VN)(this);!o.contains(l)&&(i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+l.width>this.canvas.width||(l.left<o.left?this.scrollLeft-=o.left-l.left:o.right<l.right&&(this.scrollLeft-=o.right-l.right)),i&&i.row||this.getRowsHeight(0,this.frozenRowCount-1)+l.height>this.canvas.height||(l.top<o.top?this.scrollTop-=o.top-l.top:o.bottom<l.bottom&&(this.scrollTop-=o.bottom-l.bottom)))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((e,t)=>{setTimeout(()=>{e()},0)})}_toRelativeRect(e,t=!0,i=!0){var l,o,r,n;let a=e.copy(),s=this.getVisibleRect();return a.offsetLeft(this.tableX-(t?s.left:0)),a.offsetTop(this.tableY-(i?s.top:0)),a.offsetLeft(null!=(o=null==(l=this.options.viewBox)?void 0:l.x1)?o:0),a.offsetTop(null!=(n=null==(r=this.options.viewBox)?void 0:r.y1)?n:0),a}getVisibleRect(){let{scrollTop:e,scrollLeft:t}=this,i=this.tableNoFrameWidth,l=this.tableNoFrameHeight;return new P.U(t,e,i,l)}get visibleRowCount(){let{frozenRowCount:e}=this,t=this.getVisibleRect(),i=e>0?t.top+this.getRowsHeight(0,e-1):t.top,l=this.getTargetRowAt(i);if(!l)return 0;let o=Math.max(l.top>=i?l.row:l.row+1,e),r=this.getRowsHeight(0,o-1),n=0,{rowCount:a}=this;for(let e=o;e<a;e++){let i=r+this.getRowHeight(e);if(t.bottom<i)break;n++,r=i}return n}getBodyVisibleCellRange(){let{scrollTop:e,scrollLeft:t}=this,i=this.getFrozenRowsHeight(),l=this.getFrozenColsWidth(),o=this.getBottomFrozenRowsHeight(),r=this.getRightFrozenColsWidth(),{row:n}=this.getRowAt(e+i+1),{col:a}=this.getColAt(t+l+1),s=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(e+this.tableNoFrameHeight-1-o).row:this.rowCount-1,h=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-r).col:this.colCount-1;return h<0||s<0?null:{rowStart:n,colStart:a,rowEnd:s,colEnd:h}}getBodyVisibleRowRange(){let{scrollTop:e}=this,t=this.getFrozenRowsHeight(),i=this.getBottomFrozenRowsHeight(),{row:l}=this.getRowAt(e+t+1),o=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(e+this.tableNoFrameHeight-1-i).row:this.rowCount-1;return o<0?null:{rowStart:l,rowEnd:o}}getBodyVisibleColRange(){let{scrollLeft:e}=this,t=this.getFrozenColsWidth(),i=this.getRightFrozenColsWidth(),{col:l}=this.getColAt(e+t+1),o=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-i).col:this.colCount-1;return o<0?null:{colStart:l,colEnd:o}}get visibleColCount(){let{frozenColCount:e}=this,t=this.getVisibleRect(),i=e>0?t.left+this.getColsWidth(0,e-1):t.left,l=this.getTargetColAt(i);if(!l)return 0;let o=Math.max(l.left>=i?l.col:l.col+1,e),r=this.getColsWidth(0,o-1),n=0,{colCount:a}=this;for(let e=o;e<a;e++){let i=r+this.getColWidth(e);if(t.right<i)break;n++,r=i}return n}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(e){this.stateManager.setScrollTop(e)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(e){this.stateManager.setScrollLeft(e)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(e){this.scrollLeft=Math.ceil(e)}setScrollTop(e){this.scrollTop=Math.ceil(e)}getCellOverflowText(e,t){return this.scenegraph.getCellOverflowText(e,t)}addReleaseObj(e){if(!e||!e.release||"function"!=typeof e.release)throw Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(e)}dispose(){this.release()}release(){var e,t,i,l,o,r,n,a,s,h,d,u,c,g,p,f;let b=this.internalProps;if(this.isReleased)return;null==(t=null==(e=b.tooltipHandler)?void 0:e.release)||t.call(e),null==(l=null==(i=b.menuHandler)?void 0:i.release)||l.call(i),null==(o=super.release)||o.call(this),null==(n=null==(r=b.handler)?void 0:r.release)||n.call(r),this.eventManager.release(),null==(s=null==(a=b.focusControl)?void 0:a.release)||s.call(a),null==(h=b.legends)||h.forEach(e=>{null==e||e.release()}),null==(d=b.title)||d.release(),b.title=null,null==(u=b.emptyTip)||u.release(),b.emptyTip=null,b.layoutMap.release(),b.releaseList&&(b.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),b.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),b.focusControl.release();let{parentElement:m}=b.element;m&&!this.options.canvas&&m.removeChild(b.element),null==(p=null==(g=null==(c=this.editorManager)?void 0:c.editingEditor)?void 0:g.onEnd)||p.call(g),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,null==(f=this.reactCustomLayout)||f.clearCache(),this.pluginManager.release(),(0,eN.H6)()}fireListeners(e,t){return super.fireListeners(e,t)}updateOption(e){var t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H;null==(t=this.editorManager)||t.cancelEdit(),this.options=e,this._hasAutoImageColumn=void 0;let{frozenColCount:M=0,unfreezeAllOnExceedsMaxWidth:B,defaultRowHeight:T=40,defaultHeaderRowHeight:z,defaultColWidth:L=80,defaultHeaderColWidth:P=80,keyboardOptions:I,eventOptions:D,rowSeriesNumber:W,enableCheckboxCascade:O,columnResizeMode:G,rowResizeMode:N="none",resize:Z,dragHeaderMode:j,dragOrder:U,showFrozenIcon:$,allowFrozenColCount:X,padding:Y,hover:q,menu:Q,select:ee,pixelRatio:et,widthMode:ei,heightMode:el,autoFillWidth:eo,autoFillHeight:er,containerFit:en,widthAdaptiveMode:ea,heightAdaptiveMode:es,customRender:eh,renderChartAsync:ed,renderChartAsyncBatchCount:eu,canvasWidth:ec,canvasHeight:eg,overscrollBehavior:ep,limitMinWidth:ef,limitMinHeight:eb}=e,{groupConfig:em,groupBy:ev,groupTitleFieldFormat:ew,groupTitleCustomLayout:ey,enableTreeStickCell:ex}=e;et&&et!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=et),Y&&("number"==typeof Y?(this.padding.top=Y,this.padding.left=Y,this.padding.bottom=Y,this.padding.right=Y):(Y.top&&(this.padding.top=Y.top),Y.bottom&&(this.padding.bottom=Y.bottom),Y.left&&(this.padding.left=Y.left),Y.right&&(this.padding.right=Y.right))),this.showFrozenIcon="boolean"!=typeof $||$,"number"==typeof X&&X<=0&&(this.showFrozenIcon=!1),this.widthMode=null!=ei?ei:"standard",this.heightMode=null!=el?el:"standard",this._widthAdaptiveMode=null!=ea?ea:"only-body",this._heightAdaptiveMode=null!=es?es:"only-body",this.autoFillWidth=null!=eo&&eo,this.autoFillHeight=null!=er&&er,void 0!==en&&(this._containerFit="boolean"==typeof en?{width:en,height:en}:en&&"object"==typeof en?{width:null==(i=en.width)||i,height:null==(l=en.height)||l}:{width:!1,height:!1}),this.customRender=eh,this.canvasWidth=(0,J.Z)(ec)?ec:void 0,this.canvasHeight=(0,J.Z)(eg)?eg:void 0;let e_=this.internalProps;if("node"===A.X.mode||e.canvas||(0,V.gX)(e_.element,this.padding),this.columnWidthComputeMode=null!=(o=e.columnWidthComputeMode)?o:"normal",e_.frozenColCount=M,e_.unfreezeAllOnExceedsMaxWidth=null==B||B,e_.defaultRowHeight=T,e_.defaultHeaderRowHeight=null!=z?z:T,e_.defaultColWidth=L,e_.defaultHeaderColWidth=null!=P?P:L,e_.keyboardOptions=I,e_.eventOptions=D,e_.rowSeriesNumber=W,e_.enableCheckboxCascade=null==(r=null!=O?O:null==W?void 0:W.enableTreeCheckbox)||r,e_.columnResizeMode=null!=(n=null==Z?void 0:Z.columnResizeMode)?n:G,e_.rowResizeMode=null!=(a=null==Z?void 0:Z.rowResizeMode)?a:N,e_.dragHeaderMode=null!=(h=null!=(s=null==U?void 0:U.dragHeaderMode)?s:j)?h:"none",e_.renderChartAsync=ed,(0,eN.Ry)(eu),e_.overscrollBehavior=null!=ep?ep:"auto",e_.cellTextOverflows={},e_.groupBy=null!=(d=null==em?void 0:em.groupBy)?d:ev,e_.groupTitleCheckbox=null==em?void 0:em.titleCheckbox,e_.groupTitleFieldFormat=null!=(u=null==em?void 0:em.titleFieldFormat)?u:ew,e_.groupTitleCustomLayout=null!=(c=null==em?void 0:em.titleCustomLayout)?c:ey,e_.enableTreeStickCell=null!=(g=null==em?void 0:em.enableTreeStickCell)?g:ex,e_._rowHeightsMap=new lv(this),e_._rowRangeHeightsMap=new Map,e_._colRangeWidthsMap=new Map,e_._widthResizedColMap=new Set,e_._heightResizedRowMap=new Set,this.colWidthsMap=new k.B,this.colContentWidthsMap=new k.B,this.colWidthsLimit={},e_.stick.changedCells.clear(),e_.theme=E.default.of(null!=(p=e.theme)?p:E.default.DEFAULT),e_.theme.isPivot=this.isPivotTable(),(0,eC.E6)(e_.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),e_.autoWrapText=e.autoWrapText,e_.enableLineBreak=e.enableLineBreak,e_.allowFrozenColCount=null!=(f=e.allowFrozenColCount)?f:0,e_.limitMaxAutoWidth=null!=(b=e.limitMaxAutoWidth)?b:450,e_.limitMinWidth=null!=ef?"number"==typeof ef?ef:10*!!ef:10,e_.limitMinHeight=null!=eb?"number"==typeof eb?eb:10*!!eb:10,null==(m=e_.legends)||m.forEach(e=>{null==e||e.release()}),null==(C=e_.title)||C.release(),e_.title=null,null==(v=e_.emptyTip)||v.release(),e_.emptyTip=null,e_.layoutMap.release(),(0,eN.H6)(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),e.legends){e_.legends=[];let t=K.F.getFunction("createLegend");if(Array.isArray(e.legends)){for(let i=0;i<e.legends.length;i++)e_.legends.push(t(e.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else e_.legends.push(t(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}e_.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:F.u.bottom},e.tooltip),"html"!==e_.tooltip.renderMode||e_.tooltipHandler||(e_.tooltipHandler=new(K.F.getComponent("tooltipHandler"))(this,e_.tooltip.confine)),e_.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray(null==(w=e.menu)?void 0:w.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(y=e.menu)?void 0:y.dropDownMenuHighlight),(Array.isArray(null==(x=e.menu)?void 0:x.defaultHeaderMenuItems)||"function"==typeof(null==(_=e.menu)?void 0:_.defaultHeaderMenuItems))&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),"html"!==e_.menu.renderMode||e_.menuHandler||(e_.menuHandler=new(K.F.getComponent("menuHandler"))(this)),this.clearCellStyleCache(),this.clearColWidthCache(),this.clearRowHeightCache(),e_.customMergeCell=lN(e.customMergeCell),null==(S=this.customCellStylePlugin)||S.updateCustomCell(null!=(R=e.customCellStyle)?R:[],null!=(H=e.customCellStyleArrangement)?H:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();let e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let e=0;for(let t=this.rowCount-this.bottomFrozenRowCount;t<=this.rowCount-1;t++)e+=this.getRowHeight(t);return e}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let e=0;for(let t=this.colCount-this.rightFrozenColCount;t<=this.colCount-1;t++)e+=this.getColWidth(t);return e}return 0}getDrawRange(){var e,t;let i=(null==(e=this.containerFit)?void 0:e.width)?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),l=(null==(t=this.containerFit)?void 0:t.height)?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new P.U(this.tableX,this.tableY,i,l)}_getMouseAbstractPoint(e){var t,i,l,o,r,n,a,s;let h;if(!e)return{inTable:!1,x:void 0,y:void 0};let d=(h=lV(e)?e.changedTouches[0]:e).clientX||h.pageX+window.scrollX,u=h.clientY||h.pageY+window.scrollY,c=this.internalProps.canvas.getBoundingClientRect(),g=!0;c.right<=d&&(g=!1),c.bottom<=u&&(g=!1);let p=c.width,f=p/((90===this.rotateDegree?this.canvas.offsetHeight:this.canvas.offsetWidth)||p),b=c.height,m=b/((90===this.rotateDegree?this.canvas.offsetWidth:this.canvas.offsetHeight)||b),C=this.pluginManager.getPluginByName("Rotate Table");if(C&&90===this.rotateDegree){let e={x:d/f-(null!=(i=null==(t=this.options.viewBox)?void 0:t.x1)?i:0),y:u/m-(null!=(o=null==(l=this.options.viewBox)?void 0:l.y1)?o:0),inTable:g};return C.matrix.transformPoint(e,e),e}let v={x:(d-c.left)/f-(null!=(n=null==(r=this.options.viewBox)?void 0:r.x1)?n:0),y:(u-c.top)/m-(null!=(s=null==(a=this.options.viewBox)?void 0:a.y1)?s:0),inTable:g};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(v,v),v}getTheme(){return this.internalProps.theme}getTargetColAt(e){return lH(e,this)}getTargetRowAt(e){let t=lA(e,this);return t&&(t.row=Math.min(t.row,this.rowCount-1)),t}getTargetColAtConsiderRightFrozen(e,t){return lM(e,t,this)}getTargetRowAtConsiderBottomFrozen(e,t){return lF(e,t,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(e,t,i,l,o,r=!1){var n,a,s;let h=!!(null==(n=this.stateManager.select.ranges)?void 0:n.length);this.stateManager.updateSelectPos(e,t,i,l,!1,null==(s=null!=o?o:null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||s,r),this.stateManager.endSelectCells(!0,h)}selectCells(e){let{scrollLeft:t,scrollTop:i}=this;e.forEach((e,t)=>{var i,l,o,r,n,a;e.start.col===e.end.col&&e.start.row===e.end.row?this.stateManager.updateSelectPos(e.start.col,e.start.row,!1,t>=1,!1,null==(l=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||l,!0):(this.stateManager.updateSelectPos(e.start.col,e.start.row,!1,t>=1,!1,null==(r=null==(o=this.options.select)?void 0:o.makeSelectCellVisible)||r,!0),this.stateManager.updateInteractionState(B.F.grabing),this.stateManager.updateSelectPos(e.end.col,e.end.row,!1,t>=1,!1,null==(a=null==(n=this.options.select)?void 0:n.makeSelectCellVisible)||a,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(B.F.default)}),this.setScrollTop(i),this.setScrollLeft(t)}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(e){this.scenegraph.clearCells(),(0,V.x6)(this,e),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(e){this.internalProps.autoWrapText=e,this.options.autoWrapText=e}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(e){this.internalProps.enableLineBreak=e,this.options.enableLineBreak=e}updateAutoWrapText(e){this.internalProps.autoWrapText!==e&&(this.internalProps.autoWrapText=e,this.options.autoWrapText=e,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(e){this.internalProps.theme=E.default.of(null!=e?e:E.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=e,(0,eC.E6)(this.internalProps.theme.functionalIconsStyle)}updateTheme(e){let t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=E.default.of(null!=e?e:E.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),(0,eC.E6)(this.internalProps.theme.functionalIconsStyle),this.options.theme=e,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getBodyField(e,t){return this.internalProps.layoutMap.getBody(e,t).field}getBodyColumnDefine(e,t){let i=this.internalProps.layoutMap.getBody(e,t);return null==i?void 0:i.define}getBodyColumnType(e,t){var i,l;let o=null!=(l=null==(i=this.internalProps.layoutMap.getBody(e,t))?void 0:i.cellType)?l:"text";return(0,X.WJ)("cellType",{cellType:o},e,t,this)}getCellType(e,t){let i;return this.isSeriesNumberInHeader(e,t)?this.internalProps.layoutMap.getSeriesNumberHeader(e,t).cellType:(i=this.isHeader(e,t)?this.internalProps.layoutMap.getHeader(e,t).headerType:this.internalProps.layoutMap.getBody(e,t).cellType,(0,X.WJ)("cellType",{cellType:i},e,t,this))}getHeaderField(e,t){return this.internalProps.layoutMap.getHeaderField(e,t)}getHeaderDefine(e,t){let i=this.internalProps.layoutMap.getHeader(e,t);return null==i?void 0:i.define}getCellLocation(e,t){return this.internalProps.layoutMap.getCellLocation(e,t)}getCellHeaderPaths(e,t){return this.internalProps.layoutMap.getCellHeaderPaths(e,t)}getHeadersDefine(e,t){let i=[];for(;;){let l=this.getHeaderDefine(e,t);if(!l||!l.field&&!l.columns)break;i.push(l),t++}return i}_getHeaderLayoutMap(e,t){return this.internalProps.layoutMap.getHeader(e,t)}_getBodyLayoutMap(e,t){return this.internalProps.layoutMap.getBody(e,t)}getContext(){return this.internalProps.context}getRecordByCell(e,t){if(!this.internalProps.layoutMap.isHeader(e,t))return this.getCellOriginRecord(e,t)}getRecordByRowCol(e,t){return this.getRecordByCell(e,t)}getRecordStartRowByRecordIndex(e){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(e)}_getHeaderCellBySortState(e){let{layoutMap:t}=this.internalProps,i=t.headerObjects.find(t=>t&&t.field===e.field);if(i)return t.getHeaderCellAdressById(i.id)}getCellRange(e,t){var i;if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(e,t,this);if(i&&i.range&&((0,m.Z)(i.text)||i.customLayout||i.customRender))return{start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0}}return null==(i=this.internalProps.layoutMap)?void 0:i.getCellRange(e,t)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(e,t){if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(e,t,this);if(i&&i.range&&((0,m.Z)(i.text)||i.customLayout||this.customRender)){if(i.style){let l=this.internalProps.bodyHelper.getStyleClass("text"),o=H(i.style,this.theme.bodyStyle,{col:e,row:t,table:this,value:i.text,dataValue:this.getCellOriginValue(e,t),cellHeaderPaths:this.getCellHeaderPaths(e,t)},l,this.options.autoWrapText,this.theme);i.style=o}return i.range={start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0},i}}}isCellRangeEqual(e,t,i,l){return this.internalProps.layoutMap.isCellRangeEqual(e,t,i,l)}_getLayoutCellId(e,t){return this.internalProps.layoutMap.getCellId(e,t)}getHeaderDescription(e,t){var i;let l=this._getHeaderLayoutMap(e,t),o=null==l?void 0:l.define,r=null!=(i=null==o?void 0:o.description)?i:null==l?void 0:l.description;return"function"==typeof r?r({col:e,row:t,value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t)}):r}setDropDownMenuHighlight(e){this.stateManager.setDropDownMenuHighlight(e)}_dropDownMenuIsHighlight(e,t,i){return this.stateManager.dropDownMenuIsHighlight(e,t,i)}isSeriesNumberInBody(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(e,t)}isSeriesNumberInHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)}isHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(e,t)}isColumnHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isColumnHeader(e,t)}isRowHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRowHeader(e,t)}isCornerHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isCornerHeader(e,t)}isFrozenColumn(e,t){return this.isLeftFrozenColumn(e,t)||this.isRightFrozenColumn(e,t)}isLeftFrozenColumn(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenColumn(e,t)}isRightFrozenColumn(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRightFrozenColumn(e,t)}isFrozenRow(e,t){return this.isTopFrozenRow(e,t)||this.isBottomFrozenRow(e,t)}isTopFrozenRow(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenRow(e,t)}isBottomFrozenRow(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isBottomFrozenRow(e,t)}getCellInfo(e,t){if(e>=0&&t>=0){let i=this.isHeader(e,t)?this.getHeaderDefine(e,t):this.getBodyColumnDefine(e,t);return{col:e,row:t,field:this.getHeaderField(e,t),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(e,t),title:null==i?void 0:i.title,cellType:this.getCellType(e,t),originData:this.getCellOriginRecord(e,t),cellRange:this.getCellRangeRelativeRect({col:e,row:t}),value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t),cellLocation:this.getCellLocation(e,t),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(e,t,i){var l;if(null===e||this.internalProps.layoutMap.isHeader(t,i))return!1;let o=this.getRecordShowIndexByCell(t,i);return null==(l=this.internalProps.dataSource)?void 0:l.hasField(o,e)}_getCellStyle(e,t){return function(e,t,i){var l,o,r,n,a,s,h,d,u,c;let g,p,f,b=null==(l=i.customCellStylePlugin)?void 0:l.getCustomCellStyle(e,t),{layoutMap:m}=i.internalProps;if(m.isHeader(e,t)){let l,s;if(!i.isPivotTable()||i.isBottomFrozenRow(t)||i.isRightFrozenColumn(e))l=`${e}-${t}`;else{let o=i.getHeaderDefine(e,t),r=i.isCornerHeader(e,t);l=(null==o?void 0:o.dimensionKey)?r?`dim-cor-${o.dimensionKey}`:`dim-${o.dimensionKey}`:(null==o?void 0:o.indicatorKey)?`ind-${o.indicatorKey}`:`${e}-${t}`}let h=i.headerStyleCache.get(l);if(h)return b?(0,lz.wh)(h,b):h;let d=m.getHeader(e,t);if(i.isPivotChart()&&(0,lB.Vp)(e,t,m)&&m.isAxisCell(e,t)?s=null!=(r=null==(o=m.getBody(e,i.rowHeaderLevelCount).style)?void 0:o.padding)?r:i.theme.bodyStyle.padding:i.isPivotChart()&&(0,lB.iN)(e,t,m)&&m.isAxisCell(e,t)&&(s=null!=(a=null==(n=m.getBody(i.columnHeaderLevelCount,t).style)?void 0:n.padding)?a:i.theme.bodyStyle.padding),(!d||d.isEmpty)&&(m.isLeftBottomCorner(e,t)||m.isRightBottomCorner(e,t)||m.isCornerHeader(e,t)||m.isRightTopCorner(e,t)))return lL;let u=i.internalProps.headerHelper.getStyleClass((null==d?void 0:d.headerType)||"text");if(m.isBottomFrozenRow(e,t)&&i.theme.bottomFrozenStyle)h=lT(s?{padding:s}:{},i.theme.bottomFrozenStyle,{col:e,row:t,table:i,value:i.getCellValue(e,t),dataValue:i.getCellOriginValue(e,t),cellHeaderPaths:i.getCellHeaderPaths(e,t)},u,i.options.autoWrapText,i.theme);else if(m.isRightFrozenColumn(e,t)&&i.theme.rightFrozenStyle)h=lT(s?{padding:s}:{},i.theme.rightFrozenStyle,{col:e,row:t,table:i,value:i.getCellValue(e,t),dataValue:i.getCellOriginValue(e,t),cellHeaderPaths:i.getCellHeaderPaths(e,t)},u,i.options.autoWrapText,i.theme);else{let l=(null==d?void 0:d.style)||{};s&&(l.padding=s),h=lT(l,m.isColumnHeader(e,t)||m.isBottomFrozenRow(e,t)?i.theme.headerStyle:m.isRowHeader(e,t)||m.isRightFrozenColumn(e,t)?i.theme.rowHeaderStyle:i.theme.cornerHeaderStyle,{col:e,row:t,table:i,value:i.getCellValue(e,t),dataValue:i.getCellOriginValue(e,t),cellHeaderPaths:i.getCellHeaderPaths(e,t)},u,i.options.autoWrapText,i.theme)}return i.headerStyleCache.set(l,h),b?(0,lz.wh)(h,b):h}(null==(h=null==(s=i.internalProps)?void 0:s.dataConfig)?void 0:h.mappingRules)&&!i.isHeader(e,t)&&(null==(c=null==(u=null==(d=i.internalProps)?void 0:d.dataConfig)?void 0:u.mappingRules)||c.forEach((l,o)=>{l.bgColor&&i.internalProps.layoutMap.getIndicatorKey(e,t)===l.bgColor.indicatorKey&&(g=l.bgColor.mapping)}));let C=i.getCellType(e,t),v=i.getCellOriginRecord(e,t);if(p=(null==v?void 0:v.vtableMerge)?"merge-title":i.isSeriesNumberInBody(e,t)?`${e}-series-`+C:i.isListTable()&&!i.transpose||i.isPivotTable()&&i.internalProps.layoutMap.indicatorsAsCol?e+C:t+C,f=(null==v?void 0:v.vtableMerge)?i.bodyMergeTitleCache.get(p):m.isBottomFrozenRow(t)?i.bodyBottomStyleCache.get(p):i.bodyStyleCache.get(p))return b?(0,lz.wh)(f,b):f;let w=m.getBody(e,t),y=i.internalProps.bodyHelper.getStyleClass(i.getCellType(e,t)),x=null==w?void 0:w.style;return f=H(x,(null==v?void 0:v.vtableMerge)&&i.theme.groupTitleStyle?i.theme.groupTitleStyle:m.isBottomFrozenRow(t)&&i.theme.bottomFrozenStyle?i.theme.bottomFrozenStyle:m.isRightFrozenColumn(e)&&i.theme.rightFrozenStyle?i.theme.rightFrozenStyle:i.theme.bodyStyle,{col:e,row:t,table:i,value:i.getCellValue(e,t),dataValue:i.getCellOriginValue(e,t),cellHeaderPaths:i.getCellHeaderPaths(e,t)},y,i.options.autoWrapText,i.theme),g&&(f=(0,lz.wh)(f,{bgColor:g})),(0,ij.Z)(x)||(m.isBottomFrozenRow(t)?i.bodyBottomStyleCache.set(p,f):i.bodyStyleCache.set(p,f)),b?(0,lz.wh)(f,b):f}(e,t,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(e,t){if(!(e>=0&&t>=0)||this.isCellRangeEqual(e,t,e+1,t)||"none"===this.internalProps.columnResizeMode)return!1;if("header"===this.internalProps.columnResizeMode){if(!this.isHeader(e,t))return!1}else if("body"===this.internalProps.columnResizeMode&&this.isHeader(e,t))return!1;let i=this.colWidthsLimit[e];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(e,t){if(!(e>=0&&t>=0)||this.isCellRangeEqual(e,t,e,t+1)||"none"===this.internalProps.rowResizeMode)return!1;if("header"===this.internalProps.rowResizeMode){if(!this.isHeader(e,t))return!1}else if("body"===this.internalProps.rowResizeMode&&this.isHeader(e,t))return!1;return!0}_canDragHeaderPosition(e,t){var i;if(this.isHeader(e,t)&&(this.stateManager.isSelected(e,t)||"body"===(null==(i=this.options.select)?void 0:i.headerSelectMode)&&function(e,t,i){for(let l=0;l<i.length;l++){let o=i[l];if((0,T._Z)(o,e,t))return!0}return!1}(e,t,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||e0(this,e,t))){if("disabled"===this.internalProps.frozenColDragHeaderMode&&this.isFrozenColumn(e))return!1;if(this.stateManager.isSelected(e,t)){let i=this.stateManager.select.ranges[0];if(this.isColumnHeader(e,t)){if(i.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(e,t)||i.end.col!==this.colCount-1)return!1}let i=this.getHeaderDefine(e,t);if(!i)return!1;if(void 0===i.dragHeader){if("all"===this.internalProps.dragHeaderMode)return!0;if("column"===this.internalProps.dragHeaderMode){if(this.isColumnHeader(e,t))return!0}else if("row"===this.internalProps.dragHeaderMode&&this.isRowHeader(e,t))return!0;return!1}return i.dragHeader}return!1}getCellIcons(e,t){var i,l,o;let r;if(this.isHeader(e,t))r=this.internalProps.headerHelper.getIcons(e,t);else if(this.internalProps.layoutMap.isSeriesNumber(e,t)){this.internalProps.groupBy&&(null==(i=this.getCellRawRecord(e,t))?void 0:i.vtableMerge)||null==(o=null==(l=this.internalProps.layoutMap.getSeriesNumberBody(e,t))?void 0:l.define)||!o.dragOrder||(r=this.internalProps.rowSeriesNumberHelper.getIcons(e,t));let n=this.getCellValue(e,t),a=this.getCellOriginValue(e,t),s=this.internalProps.context,h=this.internalProps.bodyHelper.getIcons(e,t,n,a,s);(null==r?void 0:r.length)>0?r=r.concat(h):(null==h?void 0:h.length)>0&&(r=h)}else{let i=this.getCellValue(e,t),l=this.getCellOriginValue(e,t),o=this.internalProps.context;r=this.internalProps.bodyHelper.getIcons(e,t,i,l,o)}return r}showDropDownMenu(e,t,i){let l="dropdown-menu";i&&(l=Array.isArray(i.content)?"dropdown-menu":"container"),"html"===this.internalProps.menu.renderMode&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(e,t,l,i))}showTooltip(e,t,i){"html"===this.internalProps.tooltip.renderMode&&this.internalProps.tooltipHandler._bindToCell(e,t,i)}getCellStyle(e,t){let i=this._getCellStyle(e,t),l=(0,V.RT)(i,this,e,t,X.WJ).theme,{autoWrapText:o,lineClamp:r,textOverflow:n}=i;return{textAlign:l.text.textAlign,textBaseline:l.text.textBaseline,bgColor:(0,lb.Z)(l.group.fill)?(0,X.WJ)("bgColor",i,e,t,this):l.group.fill,color:(0,lb.Z)(l.text.fill)?(0,X.WJ)("color",i,e,t,this):l.text.fill,strokeColor:(0,lb.Z)(l.text.stroke)?(0,X.WJ)("strokeColor",i,e,t,this):l.text.stroke,fontFamily:l.text.fontFamily,fontSize:l.text.fontSize,fontWeight:l.text.fontWeight,fontVariant:l.text.fontVariant,fontStyle:l.text.fontStyle,lineHeight:l.text.lineHeight,autoWrapText:null!=o&&o,lineClamp:null!=r?r:"auto",textOverflow:n,borderColor:(0,lb.Z)(l.group.stroke)?(0,X.WJ)("borderColor",i,e,t,this):l.group.stroke,borderLineWidth:l.group.lineWidth,borderLineDash:l.group.lineDash,underline:!!l.text.underline,underlineDash:l.text.underlineDash,underlineOffset:l.text.underlineOffset,lineThrough:!!l.text.lineThrough,padding:l._vtable.padding,underlineWidth:l.text.underline,lineThroughLineWidth:l.text.lineThrough,_strokeArrayWidth:l.group.strokeArrayWidth,_strokeArrayColor:l.group.strokeArrayColor,_linkColor:(0,X.WJ)("linkColor",i,e,t,this)}}getAllBodyCells(e,t){let i=this.rowHeaderLevelCount,l=this.columnHeaderLevelCount,o=this.colCount-1;return Array(Math.min(null!=t?t:2e3,this.rowCount-1-l+1,this.rowCount)).fill(0).map((t,r)=>Array(Math.min(null!=e?e:2e3,o-i+1,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+i,r+l)))}getAllCells(e,t){let i=this.colCount-1;return Array(Math.min(null!=t?t:2e3,this.rowCount-1-0+1,this.rowCount)).fill(0).map((t,l)=>Array(Math.min(null!=e?e:2e3,i-0+1,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+0,l+0)))}getAllColumnHeaderCells(){let e=this.rowHeaderLevelCount,t=this.colCount-1;return Array(this.columnHeaderLevelCount-1-0+1).fill(0).map((i,l)=>Array(t-e+1).fill(0).map((t,i)=>this.getCellInfo(i+e,l+0)))}getAllRowHeaderCells(){let e=this.columnHeaderLevelCount,t=this.rowHeaderLevelCount-1;return Array(this.rowCount-1-e+1).fill(0).map((i,l)=>Array(t-0+1).fill(0).map((t,i)=>this.getCellInfo(i+0,l+e)))}getCopyValue(){var e,t,i;if((null==(t=null==(e=this.stateManager.select)?void 0:e.ranges)?void 0:t.length)>0){let e=this.stateManager.select.ranges,t=Math.min(e[0].start.col,e[0].end.col),l=Math.max(e[0].start.col,e[0].end.col),o=Math.min(e[0].start.row,e[0].end.row),r=Math.max(e[0].start.row,e[0].end.row);e.forEach(e=>{t=Math.min(t,e.start.col,e.end.col),l=Math.max(l,e.start.col,e.end.col),o=Math.min(o,e.start.row,e.end.row),r=Math.max(r,e.start.row,e.end.row)});let n=t=>{let i=!1;return e.forEach(e=>{let l=Math.min(e.start.row,e.end.row),o=Math.max(e.start.row,e.end.row);l<=t&&o>=t&&(i=!0)}),i},a=t=>{let i=!1;return e.forEach(e=>{let l=Math.min(e.start.col,e.end.col),o=Math.max(e.start.col,e.end.col);l<=t&&o>=t&&(i=!0)}),i},s=(t,i)=>{let l;return e.forEach(e=>{let o=Math.min(e.start.row,e.end.row),r=Math.max(e.start.row,e.end.row),n=Math.min(e.start.col,e.end.col),a=Math.max(e.start.col,e.end.col);n<=t&&a>=t&&o<=i&&r>=i&&(l=e)}),l},h=(e,t,i)=>{let l=this.getCellRange(e,t),o=l.start.col,r=l.start.row;if(i){let e=Math.min(i.start.col,i.end.col),t=Math.min(i.start.row,i.end.row);o=Math.max(e,l.start.col),r=Math.max(t,l.start.row)}return o!==e||r!==t?"":this.getCellValue(e,t)},d="";for(let e=o;e<=r;e++)if(n(e)){for(let i=t;i<=l;i++)if(a(i)){let t=s(i,e);if(t){let o=h(i,e,t);if("undefined"!=typeof Promise&&o instanceof Promise);else{let e=(0,m.Z)(o)?`${o}`:"";/^\[object .*\]$/.exec(e)||(d+=e)}(i<t.end.col||i<l)&&(d+="	")}else d+="	"}e<r&&(d+="\r\n")}return(null==(i=this.options)?void 0:i.formatCopyValue)&&(d=this.options.formatCopyValue(d)),d}return""}getSelectedCellInfos(){var e;if(!(null==(e=this.stateManager.select)?void 0:e.ranges))return null;let t=this.stateManager.select.ranges;if(!t.length)return[];let i=Math.min(t[0].start.col,t[0].end.col),l=Math.max(t[0].start.col,t[0].end.col),o=Math.min(t[0].start.row,t[0].end.row),r=Math.max(t[0].start.row,t[0].end.row);t.forEach(e=>{i=Math.min(i,e.start.col,e.end.col),l=Math.max(l,e.start.col,e.end.col),o=Math.min(o,e.start.row,e.end.row),r=Math.max(r,e.start.row,e.end.row)});let n=e=>{let i=!1;return t.forEach(t=>{let l=Math.min(t.start.row,t.end.row),o=Math.max(t.start.row,t.end.row);l<=e&&o>=e&&(i=!0)}),i},a=e=>{let i=!1;return t.forEach(t=>{let l=Math.min(t.start.col,t.end.col),o=Math.max(t.start.col,t.end.col);l<=e&&o>=e&&(i=!0)}),i},s=(e,i)=>{let l;return t.forEach(t=>{let o=Math.min(t.start.row,t.end.row),r=Math.max(t.start.row,t.end.row),n=Math.min(t.start.col,t.end.col),a=Math.max(t.start.col,t.end.col);n<=e&&a>=e&&o<=i&&r>=i&&(l=t)}),l},h=[];for(let e=o;e<=r;e++)if(n(e)){let t=[];for(let o=i;o<=l;o++)if(a(o)&&s(o,e)){let i=this.getCellInfo(o,e);t.push(i)}h.push(t)}return h}getSelectedCellRanges(){let e=this.stateManager.select.ranges;return e.length?(0,lm.Z)(e):[]}measureText(e,t){return tm.QC.measureText(e,t)}measureTextBounds(e){return(0,tm.Rc)(e)}getCustomRender(e,t){let i;if("body"!==this.getCellLocation(e,t)){let l=this.getHeaderDefine(e,t);i=null==l?void 0:l.headerCustomRender}else{let l=this.getBodyColumnDefine(e,t);i=(null==l?void 0:l.customRender)||this.customRender}return i}getCustomLayout(e,t){let i;if("body"!==this.getCellLocation(e,t)){let l=this.getHeaderDefine(e,t);i=null==l?void 0:l.headerCustomLayout}else{let l=this.getBodyColumnDefine(e,t);i=null==l?void 0:l.customLayout}return i}hasAutoImageColumn(){return void 0===this._hasAutoImageColumn&&(this._hasAutoImageColumn=(0,l_.N3)(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var e,t,i,l,o,r;let n=this.scenegraph.getCell(null==(t=null==(e=this.stateManager.hover)?void 0:e.cellPos)?void 0:t.col,null==(l=null==(i=this.stateManager.hover)?void 0:i.cellPos)?void 0:l.row);return"chart"===(null==(r=null==(o=null==n?void 0:n.getChildren())?void 0:o[0])?void 0:r.type)?n.getChildren()[0].activeChartInstance:null}cellIsInVisualView(e,t){var i,l,o,r;let n,a,s,h,d=this.getDrawRange(),u=this.getCellRelativeRect(e,t);return!!(e<this.frozenColCount&&t<this.frozenRowCount||(this.frozenRowCount>=1&&(n=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(a=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(s=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),u.top>=d.top&&u.bottom<=d.bottom&&u.left>=d.left&&u.right<=d.right&&(this.isFrozenCell(e,t)||u.top>=(null!=(i=null==n?void 0:n.bottom)?i:u.top)&&u.left>=(null!=(l=null==a?void 0:a.right)?l:u.left)&&u.bottom<=(null!=(o=null==s?void 0:s.top)?o:u.bottom)&&u.right<=(null!=(r=null==h?void 0:h.left)?r:u.right))))||!1}getCustomMergeValue(e,t){if(this.internalProps.customMergeCell){let i=this.getCustomMerge(e,t);if(i){let{text:e}=i;return e}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(e,t,i){var l,o,r,n;let a,s,h=this.cellIsInVisualView(e,t),{scrollTop:d,scrollLeft:u}=this;h||this.scrollToCell({col:e,row:t});let c=this.getCellRelativeRect(e,t);(null==(o=null==(l=this.stateManager.select)?void 0:l.ranges)?void 0:o.length)>0&&t6(this.scenegraph);let{col:g,row:p}=this.stateManager.hover.cellPos;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),null==i?void 0:i.disableBackground){let i=this.scenegraph.getCell(e,t);a=i.attribute.fill,i.setAttribute("fill","transparent")}if(null==i?void 0:i.disableBorder){let i=this.scenegraph.getCell(e,t);s=i.attribute.stroke,i.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let f=0;"bottom-right"===this.theme.cellBorderClipDirection&&(f=1);let b=this.scenegraph.stage.toCanvas(!1,(new iP.FB).set(c.left+this.tableX+1,c.top+this.tableY+1,c.right+this.tableX-f,c.bottom+this.tableY-f));return h||(this.setScrollTop(d),this.setScrollLeft(u)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),a&&this.scenegraph.getCell(e,t).setAttribute("fill",a),s&&this.scenegraph.getCell(e,t).setAttribute("stroke",s),(null==(n=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:n.length)>0&&t5(this.scenegraph),this.stateManager.updateHoverPos(g,p),this.scenegraph.updateNextFrame(),b.toDataURL()}exportCellRangeImg(e){var t,i,l,o;let{scrollTop:r,scrollLeft:n}=this,a=Math.min(e.start.col,e.end.col),s=Math.min(e.start.row,e.end.row),h=Math.max(e.start.col,e.end.col),d=Math.max(e.start.row,e.end.row),u=this.cellIsInVisualView(a,s),c=this.cellIsInVisualView(h,d);u&&c||this.scrollToCell({col:a,row:s});let g=this.getCellRangeRelativeRect({start:{col:a,row:s},end:{col:h,row:d}});(null==(i=null==(t=this.stateManager.select)?void 0:t.ranges)?void 0:i.length)>0&&t6(this.scenegraph);let{col:p,row:f}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();let b=this.scenegraph.stage.toCanvas(!1,(new iP.FB).set(g.left+this.tableX+1,g.top+this.tableY+1,g.right+this.tableX,g.bottom+this.tableY)).toDataURL();return u&&c||(this.setScrollTop(r),this.setScrollLeft(n)),(null==(o=null==(l=this.stateManager.select)?void 0:l.ranges)?void 0:o.length)>0&&t5(this.scenegraph),this.stateManager.updateHoverPos(p,f),b}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(e="image/png"){if("node"!==this.options.mode)return;this.render();let t=this.scenegraph.stage;if(t){let i=this.tableX+this.getAllColsWidth(),l=this.tableY+this.getAllRowsHeight();return(this.internalProps.legends&&this.internalProps.legends.forEach(e=>{"right"===e.orient?i=Math.max(i,e.legendComponent.globalAABBBounds.x2):"bottom"===e.orient&&(l=Math.max(l,e.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&("right"===this.internalProps.title._titleOption.orient?i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):"bottom"===this.internalProps.title._titleOption.orient&&(l=Math.max(l,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),i>=this.canvasWidth&&l>=this.canvasHeight)?(t.render(),t.window.getImageBuffer(e)):this.scenegraph.stage.toCanvas(!1,(new iP.FB).set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,l))).toBuffer(e)}return null}getBodyIndexByTableIndex(e,t){return{col:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:t-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(e,t){return{col:e+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:t+this.columnHeaderLevelCount}}onVChartEvent(e,t,i){this._chartEventMap[e]||(this._chartEventMap[e]=[]),"function"==typeof t?this._chartEventMap[e].push({callback:t}):this._chartEventMap[e].push({callback:i,query:t})}offVChartEvent(e,t){this._chartEventMap[e]&&(this._chartEventMap[e]=t?this._chartEventMap[e].filter(e=>e.callback!==t):[])}_bindChartEvent(e){if(e)for(let t in this._chartEventMap)(this._chartEventMap[t]||[]).forEach(i=>{i.query?e.on(t,i.query,i.callback):e.on(t,i.callback)})}changeRecordOrder(e,t){}hasCustomCellStyle(e){var t;return null==(t=this.customCellStylePlugin)?void 0:t.hasCustomCellStyle(e)}registerCustomCellStyle(e,t){var i;null==(i=this.customCellStylePlugin)||i.registerCustomCellStyle(e,t)}arrangeCustomCellStyle(e,t,i){var l;null==(l=this.customCellStylePlugin)||l.arrangeCustomCellStyle(e,t,i)}isSeriesNumber(e,t){return this.internalProps.layoutMap.isSeriesNumber(e,t)}isHasSeriesNumber(){var e;return(null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var e,t;return null!=(t=null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)?t:0}setMinMaxLimitWidth(e=!1){var t,i;let l=this.internalProps;for(let o=0;o<l.layoutMap.columnWidths.length;o++){if(this.internalProps._widthResizedColMap.has(o))continue;let{width:r,minWidth:n,maxWidth:a}=null!=(i=null==(t=l.layoutMap.columnWidths)?void 0:t[o])?i:{};e&&r&&("string"==typeof r&&"auto"!==r||"number"==typeof r&&r>0)&&this._setColWidth(o,r),n&&("number"==typeof n&&n>0||"string"==typeof n)&&this.setMinColWidth(o,n),a&&("number"==typeof a&&a>0||"string"==typeof a)&&this.setMaxColWidth(o,a)}}setSortedIndexMap(e,t){var i;null==(i=this.dataSource)||i.setSortedIndexMap(e,t)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new lx.Z(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(e,t){this.scenegraph.component.showMoveCol(e,t,0),this.scenegraph.renderSceneGraph()}hideMoverLine(e,t){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(e,t){}scrollToRow(e,t){t?this.animationManager.scrollTo({row:e},t):this.scrollToCell({row:e})}scrollToCol(e,t){t?this.animationManager.scrollTo({col:e},t):this.scrollToCell({col:e})}scrollToCell(e,t){if(t)return void this.animationManager.scrollTo(e,t);let i=this.getDrawRange();if((0,m.Z)(e.col)&&e.col>=this.frozenColCount){let t=this.getFrozenColsWidth(),l=this.getColsWidth(0,e.col-1);this.scrollLeft=Math.min(l-t,this.getAllColsWidth()-i.width)}if((0,m.Z)(e.row)&&e.row>=this.frozenRowCount){let t=this.getFrozenRowsHeight(),l=this.getRowsHeight(0,e.row-1);this.scrollTop=Math.min(l-t,this.getAllRowsHeight()-i.height)}this.render()}checkHasColumnAutoWidth(){return(0,V.MO)(this)}get containerFit(){return this._containerFit}set containerFit(e){var t,i;this._containerFit="boolean"==typeof e?{width:e,height:e}:e&&"object"==typeof e?{width:null==(t=e.width)||t,height:null==(i=e.height)||i}:{width:!1,height:!1}}}},83847:function(e,t,i){"use strict";i.d(t,{B:()=>l});let l={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",AFTER_RENDER:"after_render",INITIALIZED:"initialized",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data"}},75025:function(e,t,i){"use strict";i.d(t,{F:()=>l});class l{static registerComponent(e,t){l._components[e]=t}static getComponent(e){return l._components[e]}static registerFunction(e,t){l._functions[e]=t}static getFunction(e){return l._functions[e]}static registerCellType(e,t){l._cellTypes[e]=t}static getCellType(e){return l._cellTypes[e]}}l._components={},l._functions={},l._cellTypes={}},50071:function(e,t,i){"use strict";i.d(t,{bW:()=>H,FJ:()=>S,x6:()=>b,sQ:()=>C,qf:()=>v,_I:()=>u,ke:()=>m,mP:()=>p,RT:()=>x,gX:()=>c,AS:()=>w,MO:()=>A,VN:()=>y,rQ:()=>R,xv:()=>_});var l=i(80983),o=i(56359),r=i(78596),n=i.n(r),a=i(37811),s=i(14116),h=i(41253),d=i(18585);function u(e,t="vtable"){var i,l;let o=document.createElement("div");o.setAttribute("tabindex","0"),o.classList.add(t),o.style.outline="none",o.style.margin=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`;let r=(o.offsetWidth||(null==(i=o.parentElement)?void 0:i.offsetWidth)||1)-1,n=(o.offsetHeight||(null==(l=o.parentElement)?void 0:l.offsetHeight)||1)-1;return o.style.width=r&&r-e.left-e.right+"px"||"0px",o.style.height=n&&n-e.top-e.bottom+"px"||"0px",o}function c(e,t){var i,l;e.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;let o=(e.offsetWidth||(null==(i=e.parentElement)?void 0:i.offsetWidth)||1)-1,r=(e.offsetHeight||(null==(l=e.parentElement)?void 0:l.offsetHeight)||1)-1;e.style.width=o&&o-t.left-t.right+"px"||"0px",e.style.height=r&&r-t.top-t.bottom+"px"||"0px"}function g(e,t){let{dataSourceEventIds:i}=e.internalProps;i&&i.forEach(t=>e.internalProps.handler.off(t)),t(e),e.internalProps.dataSourceEventIds=[e.internalProps.handler.on(e.internalProps.dataSource,l.o2.EVENT_TYPE.CHANGE_ORDER,()=>{e.dataSource.hierarchyExpandLevel&&e.refreshRowColCount(),e.render()})]}function p(e,t=[]){g(e,()=>{e.internalProps.records=t;let i=e.internalProps.dataSource=o.Z.ofArray(t,e.internalProps.dataConfig,e.pagination,e.internalProps.columns,e.internalProps.layoutMap.rowHierarchyType,f(e));e.addReleaseObj(i)})}function f(e){var t;return e.options.hierarchyExpandLevel?e.options.hierarchyExpandLevel:e.internalProps.groupBy?1/0:(null==(t=e._hasHierarchyTreeHeader)?void 0:t.call(e))?1:void 0}function b(e,t){g(e,()=>{e.internalProps.dataSource&&e.internalProps.releaseList.forEach(t=>{t instanceof l.o2&&(t.release(),e.internalProps.releaseList.splice(e.internalProps.releaseList.indexOf(t),1))}),t?t instanceof l.o2?(e.internalProps.dataSource=t,e.internalProps.dataSource.supplementConfig(e.pagination,e.options.columns,e.internalProps.layoutMap.rowHierarchyType,f(e))):e.internalProps.dataSource=new o.Z(t):e.internalProps.dataSource=l.o2.EMPTY,e.addReleaseObj(e.internalProps.dataSource),e.internalProps.records=null})}function m(e,t){if(!e.internalProps.frozenRowCount)return null;let{scrollTop:i}=e,l=e.internalProps.frozenRowCount;for(let o=0;o<l;o++){let l=e.getRowHeight(o),r=i+l;if(r>t)return{top:i,row:o,bottom:r,height:l};i=r}return null}function C(e,t){if(!e.internalProps.frozenColCount)return null;let{scrollLeft:i}=e,l=e.internalProps.frozenColCount;for(let o=0;o<l;o++){let l=e.getColWidth(o),r=i+l;if(r>t)return{left:i,col:o,right:r,width:l};i=r}return null}function v(e,t){return Math.round(h.aR(t,e.internalProps.calcWidthContext))}function w(e,t){return e?e.min&&e.min>t?e.min:e.max&&e.max<t?e.max:t:t}function y(e){let t=0,i=0;e.frozenColCount>0&&(t=e.getFrozenColsWidth()),e.rightFrozenColCount>0&&(i=e.getRightFrozenColsWidth());let l=0,o=0;return e.frozenRowCount>0&&(l=e.getFrozenRowsHeight()),e.bottomFrozenRowCount>0&&(o=e.getBottomFrozenRowsHeight()),new s.U(e.scrollLeft+t,e.scrollTop+l,e.tableNoFrameWidth-t-i,e.tableNoFrameHeight-l-o)}function x(e,t,i,l,o,r=!0){let s,h,u,c,g,p=(0,a.u)(o("padding",e,i,l,t)),f=o("bgColor",e,i,l,t),b=o("font",e,i,l,t);if(b){let{family:e,size:t,weight:i,style:l,variant:o}=n()(b);s=e.join(" "),h=t,u=i,c=l,c=o}else s=o("fontFamily",e,i,l,t),h=o("fontSize",e,i,l,t),u=o("fontWeight",e,i,l,t),c=o("fontStyle",e,i,l,t),g=o("fontVariant",e,i,l,t);let m=o("textAlign",e,i,l,t),C=o("textBaseline",e,i,l,t),v=o("color",e,i,l,t),w=o("strokeColor",e,i,l,t),y=o("lineHeight",e,i,l,t),_=o("underline",e,i,l,t),S=o("underlineDash",e,i,l,t),R=o("underlineOffset",e,i,l,t),H=o("lineThrough",e,i,l,t),A=Math.max(1,Math.floor(h/10)),M=o("textOverflow",e,i,l,t),F=o("borderColor",e,i,l,t),B=o("borderLineWidth",e,i,l,t),T=o("borderLineDash",e,i,l,t),z=o("marked",e,i,l,t),L=o("cursor",e,i,l,t),k=!(p&&f&&b&&m&&C&&v&&M&&F&&B&&T&&"boolean"==typeof _&&"boolean"==typeof H&&"boolean"==typeof z);if(!r)return{hasFunctionPros:k};let P={text:{fontFamily:s,fontSize:h,fontWeight:u,fontStyle:c,fontVariant:g,fill:v,stroke:null!=w&&w,textAlign:m,textBaseline:C,lineHeight:null!=y?y:h,underline:_?A:void 0,underlineDash:S,underlineOffset:R,lineThrough:H?A:void 0,ellipsis:"clip"===M?"":"ellipsis"===M?"...":(0,d.Z)(M)?M:void 0},group:{fill:f,lineDash:T,lineWidth:B,stroke:F,cursor:"auto"===L||"default"===L?void 0:L},_vtable:{padding:p,marked:z}};if(Array.isArray(B)&&(P.group.strokeArrayWidth=(0,a.u)(B)),Array.isArray(F)){let e=(0,a.u)(F);P.group.stroke=!e.every(e=>!e)&&e,P.group.strokeArrayColor=(0,a.u)(F)}return{theme:P,hasFunctionPros:k}}function _(e,t,i){let l=i.theme.frameStyle.cornerRadius;if(i.theme.cellInnerBorder){if(Array.isArray(l)){let o=[0,0,0,0];return 0===e&&0===t&&(o[0]=l[0]),e===i.colCount-1&&0===t&&(o[1]=l[1]),0===e&&t===i.rowCount-1&&(o[3]=l[3]),e===i.colCount-1&&t===i.rowCount-1&&(o[2]=l[2]),o}if(l){let o=[0,0,0,0];return 0===e&&0===t&&(o[0]=l),e===i.colCount-1&&0===t&&(o[1]=l),0===e&&t===i.rowCount-1&&(o[3]=l),e===i.colCount-1&&t===i.rowCount-1&&(o[2]=l),o}}return 0}function S(e){var t,i,l,o;if(e){if(Array.isArray(e)){let r;for(let n=0;n<e.length;n++)if(e[n].autoRange){if("sum"===e[n].y||"sum"===e[n].x||"sum"===e[n].y1||"sum"===e[n].x1)return"sum";"max"!==e[n].y&&"max"!==e[n].x&&"max"!==e[n].y1&&"max"!==e[n].x1||(r="max"),"number"==typeof e[n].y&&"number"==typeof(null!=r?r:0)&&(r=Math.max(null!=(t=r)?t:0,e[n].y)),"number"==typeof e[n].x&&"number"==typeof(null!=r?r:0)&&(r=Math.max(null!=(i=r)?i:0,e[n].x)),"number"==typeof e[n].y1&&"number"==typeof(null!=r?r:0)&&(r=Math.max(null!=(l=r)?l:0,e[n].y1)),"number"==typeof e[n].x1&&"number"==typeof(null!=r?r:0)&&(r=Math.max(null!=(o=r)?o:0,e[n].x1))}return r}if(e.autoRange){if("sum"===e.y||"sum"===e.x||"sum"===e.y1||"sum"===e.x1)return"sum";if("max"===e.y||"max"===e.x||"max"===e.y1||"max"===e.x1)return"max";if("number"==typeof e.y)return e.y;if("number"==typeof e.x)return e.x;if("number"==typeof e.y1)return e.y1;if("number"==typeof e.x1)return e.x1}}}function R(e){for(let t=0;t<e.internalProps.columns.length;t++){let i=e.internalProps.columns[t];if(i.aggregation);else if(e.options.aggregation){let l;if(l="function"==typeof e.options.aggregation?e.options.aggregation({col:t,field:i.field}):e.options.aggregation)if(Array.isArray(l)){let e=[];l.forEach(t=>{e.push(Object.assign({showOnTop:!1},t))}),i.aggregation=e}else i.aggregation=Object.assign({showOnTop:!1},l)}}}function H(e){for(let t=0;t<e.length;t++)if(e[t].aggregation)return!0;return!1}function A(e){if("autoWidth"===e.options.widthMode||"auto"===e.options.defaultHeaderColWidth||Array.isArray(e.options.defaultHeaderColWidth)&&e.options.defaultHeaderColWidth.includes("auto"))return!0;let t=e.internalProps.layoutMap.columnObjects;for(let e=0;e<t.length;e++)if("auto"===t[e].width)return!0;return!1}},56359:function(e,t,i){"use strict";i.d(t,{Z:()=>u});var l=i(43735),o=i(58977),r=i(18585),n=i(19465),a=i(21264),s=i(80983),h=i(13546),d=i.n(h);class u extends s.o2{static get EVENT_TYPE(){return s.o2.EVENT_TYPE}static ofArray(e,t,i,l,o,r){return new u({get:t=>e[t],length:e.length,records:e},t,i,l,o,r)}constructor(e,t,i,o,r,n){let a;(0,l.Z)(null==t?void 0:t.groupByRules)&&(r="tree",a=!0),super(e,t,i,o,r,n),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(e){return(0,o.Z)(e)&&this._recordCache&&this._recordCache[e]?this._recordCache[e]:super.getOriginalRecord(e)}getRawRecord(e){var t,i,l,n;let a,h;if(this._isGrouped){if(a=this.getOriginRecordIndexForGroup(e),(0,r.Z)(a)&&(null==(t=this.beforeChangedRecordsMap)?void 0:t.has(a.toString())))return null==(i=this.beforeChangedRecordsMap)?void 0:i.get(a.toString())}else if(null==(l=this.beforeChangedRecordsMap)?void 0:l.has(e.toString()))return null==(n=this.beforeChangedRecordsMap)?void 0:n.get(e.toString());return(0,o.Z)(e)&&this._recordCache&&this._recordCache[e]?this._recordCache[e]:(h=this.dataSourceObj.records?Array.isArray(e)?(0,s.UN)(this.records,e):this.records[e]:this._get(e),(0,s.NA)(h,t=>{this.recordPromiseCallBack(e,t)}))}getOriginalField(e,t,i,l,o){let r=this._fieldCache&&this._fieldCache[e];if(r){let e=r.get(t);if(e)return e}return super.getOriginalField(e,t,i,l,o)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(e,t,i){var l;l=this._fieldCache,(l[e]||(l[e]=new Map)).set(t,i)}recordPromiseCallBack(e,t){this._recordCache&&(this._recordCache[e]=t)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var e;null==(e=super.release)||e.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var e;if(super._generateFieldAggragations(),(0,l.Z)(null==(e=this.dataConfig)?void 0:e.groupByRules)){let e=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[a.E.CUSTOM]({field:"",aggregationFun:(t,i,l)=>{let o=new Map,n=[];for(let t=0;t<i.length;t++)!function e(t,i,l,o,n){let a=o[n];if(!(0,r.Z)(a))return void i.push(t);let s=d()(t,a);if(void 0!==s){if(l.has(s)){let r=l.get(s);return e(t,i[r].children,i[r].map,o,n+1)}return l.set(s,i.length),i.push({vtableMerge:!0,vtableMergeName:s,children:[],map:new Map}),e(t,i[i.length-1].children,i[i.length-1].map,o,n+1)}}(i[t],n,o,e,0);return n}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(e){var t;let i=super.processRecords(e);return(null==(t=this.groupAggregator)?void 0:t.value())||i}getGroupLength(){var e,t,i;return null!=(i=null==(t=null==(e=this.dataConfig)?void 0:e.groupByRules)?void 0:t.length)?i:0}updateGroup(){var e,t,i;this.clearCache();let o=this.source;this._source=this.processRecords(null!=(t=null==(e=this.dataSourceObj)?void 0:e.records)?t:this.dataSourceObj),o&&function e(t,i,o,n){if(!o){o=new Map;for(let e=0;e<t.length;e++){let i=t[e];i.vtableMerge&&o.set(i.vtableMergeName,e)}}if(!n){n=new Map;for(let e=0;e<i.length;e++){let t=i[e];t.vtableMerge&&n.set(t.vtableMergeName,e)}}for(let o=0;o<t.length;o++){let a=t[o],s=i[n.get(a.vtableMergeName)];(0,r.Z)(s)&&(s.hierarchyState=t[o].hierarchyState),(0,l.Z)(a.children)&&(0,l.Z)(s.children)&&0!==a.map.size&&0!==s.map.size&&e(a.children,s.children,a.map,s.map)}}(o,this.source),this.sourceLength=(null==(i=this.source)?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(e){let t=this.getOriginalRecord(e);if((0,r.Z)(t)&&!(t.children&&t.children.length>0)){for(let e=0;e<this.dataSourceObj.records.length;e++)if(this.dataSourceObj.records[e]===t)return e}}addRecordsForGroup(e,t){if(!(0,l.Z)(e)||0===e.length)return;let i=this.getOriginRecordIndexForGroup(t);(void 0===i||i>this.dataSourceObj.records)&&(i=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(i,0,...e),this.adjustBeforeChangedRecordsMap(i,e.length),this.updateGroup()}deleteRecordsForGroup(e){if(!(0,l.Z)(e)||0===e.length)return;let t=(0,s.pY)(e,-1);for(let e=0;e<t.length;e++){let i=t[e];if((0,o.Z)(i)&&(i>=this.sourceLength||i<0))continue;let l=this.getOriginRecordIndexForGroup(i);this.beforeChangedRecordsMap.delete(l.toString()),this.dataSourceObj.records.splice(l,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(l,1,"delete")}this.updateGroup()}updateRecordsForGroup(e,t){for(let i=0;i<t.length;i++){let l=t[i];if((0,o.Z)(l)&&(l>=this.sourceLength||l<0))continue;let r=this.getOriginRecordIndexForGroup(l);this.beforeChangedRecordsMap.delete(r.toString()),this.dataSourceObj.records[r]=e[i]}this.updateGroup()}addRecordsForTree(e,t){if((0,l.Z)(e)&&0!==e.length){if(this.adjustBeforeChangedRecordsMap(t,e.length),(0,o.Z)(t))this.dataSourceObj.records.splice(t,0,...e);else{let i=[...t],l=i.pop(),o=this.getOriginalRecord(i);o.children?o.children.splice(l,0,...e):o.children=e}this.initTreeHierarchyState(),this.updatePagerData()}}deleteRecordsForTree(e){if(!(0,l.Z)(e)||0===e.length)return;let t=(0,s.pY)(e,-1);for(let e=0;e<t.length;e++){let i=t[e];if(!(0,o.Z)(i)||!(i>=this.sourceLength||i<0)){if(this.beforeChangedRecordsMap.delete(i.toString()),(0,o.Z)(i))this.dataSourceObj.records.splice(i,1);else{let e=[...i],t=e.pop();this.getOriginalRecord(e).children.splice(t,1)}this.adjustBeforeChangedRecordsMap(i,1,"delete")}}this.initTreeHierarchyState(),this.updatePagerData()}updateRecordsForTree(e,t){for(let i=0;i<t.length;i++){let l=t[i],r=e[i];if(!(0,o.Z)(l)||!(l>=this.sourceLength||l<0))if(this.beforeChangedRecordsMap.delete(l.toString()),(0,o.Z)(l))this.dataSourceObj.records.splice(l,1,r);else{let e=[...l],t=e.pop();this.getOriginalRecord(e).children.splice(t,1,r)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(e,t,i="add"){if("tree"===this.rowHierarchyType){let l;l=(0,o.Z)(e)?[e]:e;let r=[];this.beforeChangedRecordsMap.forEach((e,o)=>{var n,a;let s=o.split(","),h=Math.max(s.length,l.length);for(let d=0;d<h;d++){let h=null!=(n=l[d])?n:-1,u=null!=(a=Number(s[d]))?a:-1;if(h<u||h===u&&d===s.length-1&&d===l.length-1)return s[d]=(u+("add"===i?t:-t)).toString(),void r.push({originKey:o,targetKey:s.toString(),value:e})}}),r.forEach(({originKey:e,targetKey:t,value:i})=>{this.beforeChangedRecordsMap.delete(e),this.beforeChangedRecordsMap.set(t,i)})}else super.adjustBeforeChangedRecordsMap(e,t,i)}cacheBeforeChangedRecord(e,t){var i;let l=this.getOriginalRecord(e);t.internalProps.groupBy&&(e=this.getOriginRecordIndexForGroup(e)),this.beforeChangedRecordsMap.has(e.toString())||this.beforeChangedRecordsMap.set(e.toString(),null!=(i=(0,n.Z)(l,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}getGroupSeriesNumber(e){let t=this.dataSource.currentIndexedData[e],i=t.length-1,l=t.length,r=1;for(;l>i;r++){let t=this.dataSource.currentIndexedData[e-r];l=(0,o.Z)(t)?1:t.length}return r-1}}},80983:function(e,t,i){"use strict";i.d(t,{o2:()=>C,UN:()=>v,pY:()=>w,NA:()=>f});var l=i(12348),o=i(21264),r=i(77597),n=i(31150),a=i(28071),s=i(18585),h=i(47e3),d=i(45269),u=i(19465),c=i(58977),g=i(61763);let p={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function f(e,t){let i=(0,r.vi)(e);if((0,r.tI)(i)){let e=i.then(e=>(t(e),e));return t(e),e}return i}function b(e,t,i,l,o,n){var d;if(null==e)return;if((0,r.tI)(e))return e.then(e=>b(e,t,i,l,o,n));let u=(d=t,!(r.j6.isObject(d)&&(0,s.Z)(d.get)&&(0,s.Z)(d.set))&&1)?t:t.get;if((void 0===u||""===u)&&Array.isArray(e))return e[i-o.leftRowSeriesNumberCount];if((0,h.Z)(e)&&u in e)return f(e[u],n);if("function"==typeof u)return f(u(e,i,l,o),n);if(Array.isArray(u))return f((0,a.MU)(e,[...u]),n);let c=`${u}`.split(".");return c.length<=1?f(e[u],n):f((0,r.vl)(e,(e,t)=>b(e,t,i,l,o,r.nO),...c),n)}function m(e,t){if(!e)return t;let i=e[t];return(0,s.Z)(i)?i:t}class C extends n.R{static get EVENT_TYPE(){return p}constructor(e,t,i,l,o,r){var n;super(),this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.registerAggregators(),this.dataSourceObj=e,this.dataConfig=t,this._get=null==e?void 0:e.get,this.columns=l,this._source=(null==e?void 0:e.records)?this.processRecords(null==e?void 0:e.records):e,this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},r>=1&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===o&&this.initTreeHierarchyState(),this.rowHierarchyType=o,this.updatePagerData()}initTreeHierarchyState(){var e,t;this._sourceLength=(null==(e=this._source)?void 0:e.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let i=this._sourceLength;for(let e=0;e<i;e++){let o=this.currentIndexedData[e],r=this.getOriginalRecord(o);if(!r)continue;let n=null!=(t=r.filteredChildren)?t:r.children;if((null==n?void 0:n.length)>0){if(this.hierarchyExpandLevel>1?r.hierarchyState||(r.hierarchyState=l.g.expand):r.hierarchyState||(r.hierarchyState=l.g.collapse),this.hasHierarchyStateExpand=!0,r.hierarchyState===l.g.collapse)continue;let t=this.initChildrenNodeHierarchy(o,this.hierarchyExpandLevel,2,r);e+=t,i+=t}else!0!==r.children||r.hierarchyState||(r.hierarchyState=l.g.collapse)}}supplementConfig(e,t,i,l){var o;this.columns=t,this._sourceLength=(null==(o=this._source)?void 0:o.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=e,this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},l>=1&&(this.hierarchyExpandLevel=l),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===i&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(e,t){this.registedAggregators[e]=t}registerAggregators(){this.registerAggregator(o.E.RECORD,g.hT),this.registerAggregator(o.E.SUM,g.__),this.registerAggregator(o.E.COUNT,g.ZP),this.registerAggregator(o.E.MAX,g.Fn),this.registerAggregator(o.E.MIN,g.NF),this.registerAggregator(o.E.AVG,g.ky),this.registerAggregator(o.E.NONE,g.ld),this.registerAggregator(o.E.CUSTOM,g.Js)}updateColumns(e){this.columns=e}_generateFieldAggragations(){let e=this.columns;this.fieldAggregators=[];let t=e=>{delete e.vtable_aggregator;let t=e.field,i=e.aggregation;if(i)if(Array.isArray(i))for(let l of i){let i=new this.registedAggregators[l.aggregationType]({field:t,formatFun:l.formatFun,isRecord:!0,aggregationFun:l.aggregationFun});this.fieldAggregators.push(i),e.vtable_aggregator||(e.vtable_aggregator=[]),e.vtable_aggregator.push(i)}else{let l=new this.registedAggregators[i.aggregationType]({field:t,formatFun:i.formatFun,isRecord:!0,aggregationFun:i.aggregationFun});this.fieldAggregators.push(l),e.vtable_aggregator=l}},i=e=>{if(e&&0!==e.length)for(let l of e)t(l),l.columns&&i(l.columns)};i(e)}processRecords(e){var t,i,l,o,r,n,a,s;this._generateFieldAggragations();let h=[],d=this.fieldAggregators.length>=1;if((null==(i=null==(t=this.dataConfig)?void 0:t.filterRules)?void 0:i.length)>=1||(null==(l=this.lastFilterRules)?void 0:l.length)>=1||d){for(let t=0,i=e.length;t<i;t++){let i=e[t];(null==(r=null==(o=this.dataConfig)?void 0:o.filterRules)?void 0:r.length)>=1?this.filterRecord(i)&&(h.push(i),"tree"===this.rowHierarchyType&&i.children&&(i.filteredChildren=this.filteredChildren(i.children)),d&&this.processRecord(i)):((null==(n=this.lastFilterRules)?void 0:n.length)>=1&&this.clearFilteredChildren(i),d&&this.processRecord(i))}if((null==(s=null==(a=this.dataConfig)?void 0:a.filterRules)?void 0:s.length)>=1)return h}return e}filteredChildren(e){let t=[];for(let i=0,l=e.length;i<l;i++){let l=e[i];this.filterRecord(l)&&(t.push(l),l.children&&(l.filteredChildren=this.filteredChildren(l.children)))}return t}processRecord(e){for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].push(e)}initChildrenNodeHierarchy(e,t,i,o){var r,n,a;let s=0,h=o.filteredChildren?o.filteredChildren.length:null!=(n=null==(r=o.children)?void 0:r.length)?n:0;for(let r=0;r<h;r++){(i<=t||o.hierarchyState===l.g.expand)&&(s+=1);let n=o.filteredChildren?o.filteredChildren[r]:o.children[r],h=Array.isArray(e)?e.concat(r):[e,r];(i<=t||o.hierarchyState===l.g.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+s,0,h),(n.filteredChildren?n.filteredChildren.length>0:(null==(a=n.children)?void 0:a.length)>0)&&(i<t||n.hierarchyState===l.g.expand?(n.hierarchyState||(n.hierarchyState=l.g.expand),this.hasHierarchyStateExpand=!0):n.hierarchyState||(n.hierarchyState=l.g.collapse)),n.hierarchyState===l.g.expand&&(s+=this.initChildrenNodeHierarchy(h,t,i+1,n)),!0!==n.children||n.hierarchyState||(n.hierarchyState=l.g.collapse)}return s}updatePagination(e){this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){let{currentIndexedData:e}=this,{perPageCount:t,currentPage:i}=this.pagination,l=t*(i||0),o=l+t;if(this._currentPagerIndexedData.length=0,e&&e.length>0){let t=-1;for(let i=0;i<e.length;i++)if((Array.isArray(e[i])&&1===e[i].length||!Array.isArray(e[i]))&&t++,t>=l&&t<o)this._currentPagerIndexedData.push(e[i]);else if(t>=o)break}else if(this._sourceLength>0)throw Error("currentIndexedData should has values!")}getRecordIndexPaths(e){return this._currentPagerIndexedData[e]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(e){return this.getOriginalRecord(m(this.currentPagerIndexedData,e))}getRaw(e){return this.getRawRecord(m(this.currentPagerIndexedData,e))}getIndexKey(e){return m(this.currentPagerIndexedData,e)}getTableIndex(e){return Array.isArray(e)?"tree"===this.rowHierarchyType?this.currentPagerIndexedData.findIndex(t=>(0,d.h6)(t,e)):this.currentPagerIndexedData.findIndex(t=>t===e[0]):this.currentPagerIndexedData.findIndex(t=>t===e)}getField(e,t,i,l,o){return this.getOriginalField(m(this.currentPagerIndexedData,e),t,i,l,o)}getRawField(e,t,i,l,o){return this.getRawFieldData(m(this.currentPagerIndexedData,e),t,i,l,o)}hasField(e,t){return this.hasOriginalField(m(this.currentPagerIndexedData,e),t)}getHierarchyState(e){var t;let i=this.getOriginalRecord(this.currentPagerIndexedData[e]);if(null==i?void 0:i.hierarchyState){let e=i.hierarchyState;if((null==(t=i.children)?void 0:t.length)>0||!0===i.children)return e}return null}toggleHierarchyState(e,t,i){let o=this.currentIndexedData.slice(0),r=this.getIndexKey(e),n=this.getHierarchyState(e),s=this.getOriginalRecord(r);if(this.clearSortedIndexMap(),n===l.g.collapse)s.hierarchyState=l.g.expand,this.pushChildrenNode(r,l.g.expand,s),this.hasHierarchyStateExpand=!0;else if(n===l.g.expand){let e=(0,a.pr)(r,n,s);this.currentIndexedData.splice(this.currentIndexedData.indexOf(r)+1,e),s.hierarchyState=l.g.collapse}this.updatePagerData();let h=[],d=[];if(n===l.g.collapse){let t=this.currentIndexedData.length-o.length;for(let i=0;i<t;i++)h.push(e+i+1)}else if(n===l.g.expand){let t=o.length-this.currentIndexedData.length;for(let i=0;i<t;i++)d.push(e+i+1)}return{add:h,remove:d}}pushChildrenNode(e,t,i){var o,r;if(!t||t===l.g.collapse||t===l.g.none)return 0;let n=0,a=i.filteredChildren?i.filteredChildren:i.children;if(a){let t=Array.from({length:a.length},(e,t)=>t);null==(o=this.lastSortStates)||o.forEach(i=>{"normal"!==i.order&&function(e,t,i,l,o,r){let n=function(e,t){let i=Array(t);for(let l=0;l<t;l++)i[l]=e(l);return i}(e,i);n.sort((e,t)=>l(r(e),r(t),o));for(let e=0;e<i;e++)t(e,n[e])}(e=>(0,s.Z)(t[e])?t[e]:t[e]=e,(e,i)=>{t[e]=i},a.length,i.orderFn,i.order,t=>this.getOriginalField(Array.isArray(e)?e.concat([t]):[e,t],i.field))});for(let i=0;i<t.length;i++){n+=1;let o=Array.isArray(e)?e.concat([t[i]]):[e,t[i]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+n,0,o);let s=this.getOriginalRecord(o);!s.hierarchyState&&(null!=(r=s.filteredChildren)?r:s.children)&&(s.hierarchyState=l.g.collapse),n+=this.pushChildrenNode(o,s.hierarchyState,a[t[i]])}}return n}changeFieldValue(e,t,i,l,o,n){var s;if(null!==i&&t>=0){let o=this.getIndexKey(t);if(this.cacheBeforeChangedRecord(o,n),void 0!==i&&""!==i||(i=l-n.leftRowSeriesNumberCount),"string"==typeof i||"number"==typeof i){let t=null==(s=this.beforeChangedRecordsMap.get(o.toString()))?void 0:s[i],l=this.getOriginalRecord(o),n=e;"number"==typeof t&&(0,a.Zf)(e)&&(n=parseFloat(e)),(0,r.tI)(l)?l.then(e=>{e[i]=n}).catch(e=>{}):l?l[i]=n:(this.records[o]={},this.records[o][i]=n)}}}cacheBeforeChangedRecord(e,t){var i;if(!this.beforeChangedRecordsMap.has(e.toString())){let t=this.getOriginalRecord(e);this.beforeChangedRecordsMap.set(e.toString(),null!=(i=(0,u.Z)(t,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}}setRecord(e,t){var i,l;let o=!0;if((null==(l=null==(i=this.dataConfig)?void 0:i.filterRules)?void 0:l.length)>=1&&(this.filterRecord(e)?"tree"===this.rowHierarchyType&&e.children&&(e.filteredChildren=this.filteredChildren(e.children)):o=!1),o&&Array.isArray(this.records)){let i=this.getIndexKey(t);Array.isArray(i)||this.records.splice(i,1,e)}}addRecord(e,t){var i;if(Array.isArray(this.records)){this.records.splice(t,0,e),this.adjustBeforeChangedRecordsMap(t,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].push(e);if("tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:e,currentPage:i}=this.pagination;t<e*(i||0)+e&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(t,1)}}addRecords(e,t){var i;if(Array.isArray(this.records)){if(Array.isArray(e)){this.records.splice(t,0,...e),this.adjustBeforeChangedRecordsMap(t,e.length);for(let t=0;t<e.length;t++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=e.length;for(let t=0;t<this.fieldAggregators.length;t++)for(let i=0;i<e.length;i++)this.fieldAggregators[t].push(e[i])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:e,currentPage:i}=this.pagination;t<e*(i||0)+e&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(t,e.length)}}addRecordForSorted(e){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(e),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(e){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(e)){this.records.push(...e);for(let t=0;t<e.length;t++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=e.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(e,t,i="add"){for(let l=this.beforeChangedRecordsMap.size-1;l>=e;l--){let e=this.beforeChangedRecordsMap.get(l.toString());this.beforeChangedRecordsMap.delete(l.toString()),this.beforeChangedRecordsMap.set((l+("add"===i?t:-t)).toString(),e)}}deleteRecords(e){var t;if(Array.isArray(this.records)){let i=[],l=e.sort((e,t)=>t-e);for(let e=0;e<l.length;e++){let t=l[e];if(t>=this._sourceLength||t<0)continue;this.adjustBeforeChangedRecordsMap(t,1,"delete"),i.push(t);let o=this.records[t];for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].deleteRecord(o);this.records.splice(t,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),(null==(t=this.dataSourceObj)?void 0:t.deleted)&&this.dataSourceObj.deleted(i),i}return[]}deleteRecordsForSorted(e){if(Array.isArray(this.records)){let t=e.sort((e,t)=>t-e);for(let e=0;e<t.length;e++){let i=t[e];if(i>=this._sourceLength||i<0)continue;let l=this.currentIndexedData[i];this.records.splice(l,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(e,t){let i=[];for(let l=0;l<t.length;l++){let o=t[l];if(Array.isArray(o))this.beforeChangedRecordsMap.delete(o.toString()),i.push(o),o.slice(0,-1).reduce((e,t)=>(void 0===e[t]&&(e[t]={}),e[t].children),this.records)[o[o.length-1]]=e[l];else{if(o>=this._sourceLength||o<0)continue;this.beforeChangedRecordsMap.delete(o.toString()),i.push(o);for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].updateRecord(this.records[o],e[l]);this.records[o]=e[l]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(e,t){let i=[];for(let l=0;l<t.length;l++){let o=t[l];if(o>=this._sourceLength||o<0)continue;let r=this.currentIndexedData[o];if("number"!=typeof r)return;this.beforeChangedRecordsMap.delete(r.toString()),i.push(o),this.records[r]=e[l]}this.sortedIndexMap.clear()}sort(e){e=(Array.isArray(e)?e:[e]).filter(e=>{let t=this.columns.find(t=>t.field===e.field);return!1!==(null==t?void 0:t.sort)&&"normal"!==e.order}),this.lastSortStates=e;let t=e.map(e=>this.sortedIndexMap.get(null==e?void 0:e.field)||{asc:[],desc:[],normal:[]}),i=null;if(t.length>0&&(i=e.reduce((e,i,l)=>{var o;let r=null==(o=t[l])?void 0:o[i.order];return r&&r.length>0?r:e},null))&&i.length>0)return this.currentIndexedData=i,this.updatePagerData(),void this.fireListeners(p.CHANGE_ORDER,null);let l=Array.from({length:this._sourceLength},(e,t)=>t);if(l.sort((t,i)=>e.reduce((e,l)=>0!==e?e:(l.orderFn||("desc"!==l.order?(e,t)=>e===t?0:e>t?1:-1:(e,t)=>e===t?0:e<t?1:-1))(this.getOriginalField(t,l.field),this.getOriginalField(i,l.field),l.order),0)),this.currentIndexedData=l,this.hierarchyExpandLevel){let e=l.length;for(let t=0;t<e;t++){let i=this.getOriginalRecord(l[t]),o=this.pushChildrenNode(l[t],i.hierarchyState,this.getOriginalRecord(l[t]));e+=o,t+=o}}if(!t.length){t=e.map(()=>({asc:[],desc:[],normal:[]}));for(let i=0;i<e.length;i++)this.sortedIndexMap.set(e[i].field,t[i])}e.forEach((e,i)=>{t[i][e.order]=l.slice()}),this.updatePagerData(),this.fireListeners(p.CHANGE_ORDER,null)}setSortedIndexMap(e,t){this.sortedIndexMap.set(e,t)}clearFilteredChildren(e){var t,i;e.filteredChildren=void 0;for(let l=0;l<(null!=(i=null==(t=e.children)?void 0:t.length)?i:0);l++)this.clearFilteredChildren(e.children[l])}filterRecord(e){var t,i,l;let o=!0;for(let r=0;r<(null==(t=this.dataConfig.filterRules)?void 0:t.length);r++){let t=null==(i=this.dataConfig)?void 0:i.filterRules[r];if(t.filterKey){let i=e[t.filterKey];if(-1===t.filteredValues.indexOf(i)){o=!1;break}}else if(!(null==(l=t.filterFunc)?void 0:l.call(t,e))){o=!1;break}}return o}updateFilterRulesForSorted(e){var t,i,l;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(i=null==(t=this.dataSourceObj)?void 0:t.records)?i:this.dataSourceObj),this._sourceLength=(null==(l=this._source)?void 0:l.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(e){var t,i,l;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(i=null==(t=this.dataSourceObj)?void 0:t.records)?i:this.dataSourceObj),this._sourceLength=(null==(l=this._source)?void 0:l.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,"tree"===this.rowHierarchyType&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((e,t)=>{this.lastSortStates.some(e=>e.field===t)?this.lastSortStates.forEach(t=>{"asc"===t.order?(e.desc=[],e.normal=[]):"desc"===t.order?(e.asc=[],e.normal=[]):(e.asc=[],e.desc=[])}):this.sortedIndexMap.delete(t)})}get sourceLength(){return this._sourceLength}set sourceLength(e){this._sourceLength!==e&&(this._sourceLength=e,this.fireListeners(p.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var e;null==(e=super.release)||e.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(e=>{e.asc&&(e.asc.length=0),e.desc&&(e.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(e){return f(this.dataSourceObj.records?Array.isArray(e)?v(this.records,e):this.records[e]:this._get(e),t=>{this.recordPromiseCallBack(e,t)})}getRawRecord(e){var t,i;return(null==(t=this.beforeChangedRecordsMap)?void 0:t.has(e.toString()))?null==(i=this.beforeChangedRecordsMap)?void 0:i.get(e.toString()):f(this.dataSourceObj.records?Array.isArray(e)?v(this.records,e):this.records[e]:this._get(e),t=>{this.recordPromiseCallBack(e,t)})}getOriginalField(e,t,i,l,o){if(null!==t)return b(this.getOriginalRecord(e),t,i,l,o,i=>{this.fieldPromiseCallBack(e,t,i)})}getRawFieldData(e,t,i,l,o){if(null!==t)return b(this.getRawRecord(e),t,i,l,o,i=>{this.fieldPromiseCallBack(e,t,i)})}hasOriginalField(e,t){if(null===t)return!1;if("function"==typeof t)return!0;let i=this.getOriginalRecord(e);return!!(i&&t in i)}fieldPromiseCallBack(e,t,i){}recordPromiseCallBack(e,t){}canChangeOrder(e,t){var i;if(null==(i=this.dataSourceObj)?void 0:i.canChangeOrder)return this.dataSourceObj.canChangeOrder(e,t);if(this.hasHierarchyStateExpand){let i=this.currentPagerIndexedData[e],l=this.currentPagerIndexedData[t];if(i=Array.isArray(i)?[...i]:[i],l=Array.isArray(l)?[...l]:[l],t>e&&l.length>i.length){let e=this.currentPagerIndexedData[t+1];(e=Array.isArray(e)?[...e]:[e]).length<l.length&&l.splice(l.length-1,1)}if(i.length===l.length){for(let e=0;e<=i.length-2;e++)if(i[e]!==l[e])return!1;return!0}return!1}return!0}changeOrder(e,t){var i,l,o;if(null==(i=this.dataSourceObj)?void 0:i.changeOrder)this.dataSourceObj.changeOrder(e,t);else if(!(null==(l=this.lastSortStates)?void 0:l.some(e=>"asc"===e.order||"desc"===e.order))&&this.canChangeOrder(e,t))if(this.hasHierarchyStateExpand){let i,l,r=this.currentPagerIndexedData[e],n=this.currentPagerIndexedData[t];if(r=Array.isArray(r)?[...r]:[r],n=Array.isArray(n)?[...n]:[n],r.length>1||n.length>1){if(t>e&&n.length>r.length){let e=this.currentPagerIndexedData[t+1];(e=Array.isArray(e)?[...e]:[e]).length<n.length&&n.splice(n.length-1,1)}if(i=r.splice(r.length-1,1)[0],l=n.splice(n.length-1,1)[0],r.length>=1){let e=this.getOriginalRecord(r);if(e){let t=e.filteredChildren?e.filteredChildren.splice(i,1):e.children.splice(i,1);t.unshift(l,0),Array.prototype.splice.apply(null!=(o=e.filteredChildren)?o:e.children,t)}}else{let e=this.records.splice(i,1);e.unshift(l,0),Array.prototype.splice.apply(this.records,e)}}else{i=this.currentPagerIndexedData[e],l=this.currentPagerIndexedData[t];let o=this.records.splice(i,1);o.unshift(l,0),Array.prototype.splice.apply(this.records,o)}this.restoreTreeHierarchyState(),this.updatePagerData()}else{let i=this.records.splice(e,1);i.unshift(t,0),Array.prototype.splice.apply(this.records,i)}}restoreTreeHierarchyState(){var e,t;if(this.hierarchyExpandLevel){for(let t=0;t<this._sourceLength;t++){let i=this.getOriginalRecord(t);i&&(null!=(e=i.filteredChildren)?e:i.children)&&!i.hierarchyState&&(i.hierarchyState=l.g.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let i=this._sourceLength;for(let e=0;e<i;e++){let o=this.currentIndexedData[e],r=this.getOriginalRecord(o);if(!r)continue;let n=null!=(t=r.filteredChildren)?t:r.children;if((null==n?void 0:n.length)>0&&r.hierarchyState===l.g.expand){this.hasHierarchyStateExpand=!0;let t=this.restoreChildrenNodeHierarchy(o,r);e+=t,i+=t}else!0!==r.children||r.hierarchyState||(r.hierarchyState=l.g.collapse)}}}restoreChildrenNodeHierarchy(e,t){var i,o;let r=0,n=null!=(i=t.filteredChildren)?i:t.children,a=null!=(o=null==n?void 0:n.length)?o:0;for(let i=0;i<a;i++){t.hierarchyState===l.g.expand&&(r+=1);let o=n[i],a=Array.isArray(e)?e.concat(i):[e,i];t.hierarchyState===l.g.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+r,0,a),r+=this.restoreChildrenNodeHierarchy(a,o)}return r}_setNodeStateRecursive(e,t){var i;if(!e)return;let l=null!=(i=e.filteredChildren)?i:e.children;if(l&&(Array.isArray(l)?l.length>0:!0===l)&&(e.hierarchyState=t),l&&Array.isArray(l))for(let e of l)this._setNodeStateRecursive(e,t)}expandAllNodes(){if(Array.isArray(this._source)){for(let e of this._source)this._setNodeStateRecursive(e,l.g.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(let e of this._source)this._setNodeStateRecursive(e,l.g.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}}function v(e,t){var i;let l=e;for(let e=0;e<t.length;e++){let o=t[e];if(!l[o])return;let r=null!=(i=(l=l[o]).filteredChildren)?i:null==l?void 0:l.children;r&&e+1<t.length&&(l=r)}return l}function w(e,t){return e.sort((e,i)=>{var l,o;(0,c.Z)(e)&&(e=[e]),(0,c.Z)(i)&&(i=[i]);let r=Math.max(e.length,i.length);for(let n=0;n<r;n++){let r=null!=(l=e[n])?l:-1,a=null!=(o=i[n])?o:-1;if(r!==a)return 1===t?r-a:a-r}return 0})}C.EMPTY=new C({get(){},length:0})},9284:function(e,t,i){"use strict";i.d(t,{q:()=>s});var l=i(18585),o=i(21264),r=i(61763),n=i(90251);function a(e,t){let i="";for(let l=0;l<e.length;l++)i+=e[l],l!==e.length-1&&(i+=t);return i}class s{constructor(e,t,i,l,o,r,n,a,s,h,d,u,c,g){var p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=null==(p=this.dataConfig)?void 0:p.filterRules,this.rowHierarchyType=null!=a?a:"grid",this.columnHierarchyType=null!=s?s:"grid",this.sortRules=null==(f=this.dataConfig)?void 0:f.sortRules,this.aggregationRules=null==(b=this.dataConfig)?void 0:b.aggregationRules,this.derivedFieldRules=null==(m=this.dataConfig)?void 0:m.derivedFieldRules,this.mappingRules=null==(C=this.dataConfig)?void 0:C.mappingRules,this.calculatedFieldRules=null==(v=this.dataConfig)?void 0:v.calculatedFieldRules,this.calculatedFiledKeys=null!=(y=null==(w=this.calculatedFieldRules)?void 0:w.map(e=>e.key))?y:[],this.calculatedFieldDependIndicatorKeys=null!=(_=null==(x=this.calculatedFieldRules)?void 0:x.reduce((e,t)=>{for(let i=0;i<t.dependIndicatorKeys.length;i++)-1===e.indexOf(t.dependIndicatorKeys[i])&&e.push(t.dependIndicatorKeys[i]);return e},[]))?_:[],this.totals=null==(S=this.dataConfig)?void 0:S.totals,this.rows=t,this.columns=i,this.indicatorKeys=l,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...l];for(let e=0;e<this.calculatedFieldDependIndicatorKeys.length;e++)-1===this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[e])&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[e]);if(this.indicatorsAsCol=r,this.indicators=o,this.customColTree=h,this.customRowTree=d,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=g,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=null!=(A=null==(H=null==(R=this.totals)?void 0:R.column)?void 0:H.grandTotalLabel)?A:"总计",this.colSubTotalLabel=null!=(B=null==(F=null==(M=this.totals)?void 0:M.column)?void 0:F.subTotalLabel)?B:"小计",this.rowGrandTotalLabel=null!=(L=null==(z=null==(T=this.totals)?void 0:T.row)?void 0:z.grandTotalLabel)?L:"总计",this.rowSubTotalLabel=null!=(I=null==(P=null==(k=this.totals)?void 0:k.row)?void 0:P.subTotalLabel)?I:"小计",this.collectValuesBy=null==(E=this.dataConfig)?void 0:E.collectValuesBy,this.needSplitPositiveAndNegative=null!=u&&u,this.rowsIsTotal=Array(null!=(W=null==(D=this.rows)?void 0:D.length)?W:0).fill(!1),this.colsIsTotal=Array(null!=(G=null==(O=this.columns)?void 0:O.length)?G:0).fill(!1),(null==(N=this.totals)?void 0:N.row)&&!1!==this.totals.row.showSubTotals&&this.totals.row.subTotalsDimensions)for(let e=0,t=null!=(j=null==(V=null==(K=null==(Z=this.totals)?void 0:Z.row)?void 0:K.subTotalsDimensions)?void 0:V.length)?j:0;e<t;e++){let t=this.totals.row.subTotalsDimensions[e],i=this.rows.indexOf(t);this.rowsIsTotal[i]=!0}if((null==(U=this.totals)?void 0:U.column)&&!1!==this.totals.column.showSubTotals&&this.totals.column.subTotalsDimensions)for(let e=0,t=null!=(Y=null==(J=null==(X=null==($=this.totals)?void 0:$.column)?void 0:X.subTotalsDimensions)?void 0:J.length)?Y:0;e<t;e++){let t=this.totals.column.subTotalsDimensions[e],i=this.columns.indexOf(t);this.colsIsTotal[i]=!0}this.setRecords(n)}setRecords(e){var t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,e&&(this.records=e,"undefined"!=typeof window&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.totalStatistics(),"undefined"!=typeof window&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),"undefined"!=typeof window&&window.performance.now(),this.sortKeys(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:"tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(t=this.totals)?void 0:t.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(r=null==(o=null==(l=this.totals)?void 0:l.row)?void 0:o.showGrandTotalsOnTop)&&r):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(n=this.totals)?void 0:n.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(d=null==(h=null==(s=this.totals)?void 0:s.row)?void 0:h.showGrandTotalsOnTop)&&d,null!=(g=null==(c=null==(u=this.totals)?void 0:u.row)?void 0:c.showSubTotalsOnTop)&&g),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((e,t)=>this.columnsHasValue[t]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(p=this.totals)?void 0:p.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(C=null==(m=null==(b=this.totals)?void 0:b.column)?void 0:m.showGrandTotalsOnLeft)&&C,null!=(y=null==(w=null==(v=this.totals)?void 0:v.column)?void 0:w.showSubTotalsOnLeft)&&y),"undefined"!=typeof window&&window.performance.now(),(null==(x=this.dataConfig)?void 0:x.isPivotChart)&&this.cacheDeminsionCollectedValues())}registerAggregator(e,t){r.YJ[e]=t}registerAggregators(){this.registerAggregator(o.E.RECORD,r.hT),this.registerAggregator(o.E.SUM,r.__),this.registerAggregator(o.E.COUNT,r.ZP),this.registerAggregator(o.E.MAX,r.Fn),this.registerAggregator(o.E.MIN,r.NF),this.registerAggregator(o.E.AVG,r.ky),this.registerAggregator(o.E.NONE,r.ld),this.registerAggregator(o.E.RECALCULATE,r.U4),this.registerAggregator(o.E.CUSTOM,r.Js)}processCollectedValuesWithSumBy(){var e,t,i,l,o,r;for(let n in this.collectedValues)if(null==(t=null==(e=this.collectValuesBy)?void 0:e[n])?void 0:t.sumBy)for(let e in this.collectedValues[n]){let t,a,s;"sum"===(null==(i=this.collectValuesBy[n])?void 0:i.extendRange)?(t=Object.values(this.collectedValues[n][e]).reduce((e,t)=>e+t.value(),0),t+=Math.round(t/20)):(t=Object.values(this.collectedValues[n][e]).reduce((e,t)=>t.value()>e?t.value():e,Number.MIN_SAFE_INTEGER),"max"===(null==(l=this.collectValuesBy[n])?void 0:l.extendRange)?t+=Math.round(t/20):"number"==typeof(null==(o=this.collectValuesBy[n])?void 0:o.extendRange)&&(t=Math.max(t,null==(r=this.collectValuesBy[n])?void 0:r.extendRange)));let h=Object.values(this.collectedValues[n][e]).reduce((e,t)=>t.value()<e?t.value():e,Number.MAX_SAFE_INTEGER);this.needSplitPositiveAndNegative&&(a=Object.values(this.collectedValues[n][e]).reduce((e,t)=>t.positiveValue()>e?t.positiveValue():e,Number.MIN_SAFE_INTEGER),s=Object.values(this.collectedValues[n][e]).reduce((e,t)=>t.negativeValue()<e?t.negativeValue():e,Number.MAX_SAFE_INTEGER)),this.collectedValues[n][e]={},this.collectedValues[n][e].max=t,this.collectedValues[n][e].min=h,this.needSplitPositiveAndNegative&&(this.collectedValues[n][e].positiveMax=a,this.collectedValues[n][e].negativeMin=s)}}processCollectedValuesWithSortBy(){var e,t;let i=this;for(let l in this.collectedValues)if(null==(t=null==(e=this.collectValuesBy)?void 0:e[l])?void 0:t.sortBy)for(let e in this.collectedValues[l])this.collectedValues[l][e]=this.collectedValues[l][e].sort((e,t)=>{var o,r,n,a;return(null!=(r=null==(o=i.collectValuesBy[l].sortBy)?void 0:o.indexOf(e))?r:-1)-(null!=(a=null==(n=i.collectValuesBy[l].sortBy)?void 0:n.indexOf(t))?a:-1)})}generateCollectedValuesSortRule(){for(let e in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[e]&&!this.collectValuesBy[e].sortBy){let t=[];for(let i in this.collectedValues[e])Array.isArray(this.collectedValues[e][i])&&(t.push(...this.collectedValues[e][i]),t=Array.from(new Set(t)));t.length>0&&(this.collectValuesBy[e].sortBy=t)}}processRecords(){var e,t;let i=!1;if((null!=(t=null==(e=this.filterRules)?void 0:e.length)?t:0)>=1&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let e=0,t=this.records.length;e<t;e++){let t=this.records[e];i&&!this.filterRecord(t)||(this.filteredRecords.push(t),this.processRecord(t))}}else for(let e in this.filteredRecords||(this.filteredRecords={}),this.records)for(let t=0,l=this.records[e].length;t<l;t++){let l=this.records[e][t];i&&!this.filterRecord(l)||(this.filteredRecords[e]||(this.filteredRecords[e]=[]),this.filteredRecords[e].push(l),this.processRecord(l,e))}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(e){var t,i;let l=!0;if(this.filterRules)for(let o=0;o<this.filterRules.length;o++){let r=this.filterRules[o];if(r.filterKey){let i=e[r.filterKey];if(-1===(null==(t=r.filteredValues)?void 0:t.indexOf(i))){l=!1;break}}else if(!(null==(i=r.filterFunc)?void 0:i.call(r,e))){l=!1;break}}return l}processRecord(e,t){var i,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q,Q,ee,et,ei,el,eo,er,en,ea,es,eh,ed,eu,ec,eg,ep,ef,eb,em;for(let t in null==(i=this.derivedFieldRules)||i.forEach((t,i)=>{t.fieldName&&t.derivedFunc&&(e[t.fieldName]=t.derivedFunc(e))}),this.collectValuesBy)if((0,l.Z)(e[t])){this.collectedValues[t]||(this.collectedValues[t]={});let i=this.collectValuesBy[t].by.map(t=>e[t]).join(this.stringJoinChar);if(this.collectedValues[t][i]||(this.collectValuesBy[t].sumBy?this.collectedValues[t][i]={}:this.collectValuesBy[t].range?this.collectedValues[t][i]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[t][i]=[]),this.collectValuesBy[t].sumBy){let l=null==(a=this.collectValuesBy[t].sumBy)?void 0:a.map(t=>e[t]).join(this.stringJoinChar);this.collectedValues[t][i][l]||(this.collectedValues[t][i][l]=new r.YJ[o.E.SUM]({key:t,field:t,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[t][i][l].push(e)}else if(this.collectValuesBy[t].range){let l=this.collectedValues[t][i],o=Math.max(e[t],l.max),r=Math.min(e[t],l.min);isNaN(o)||(l.max=o,l.min=r)}else{let l=this.collectedValues[t][i];-1===l.indexOf(e[t])&&l.push(e[t])}}let eC=!1,ev=[],ew=[];if(!this.parseCustomTreeToMatchRecords||(null==(s=this.dataConfig)?void 0:s.isPivotChart)||!(null==(h=this.customRowTree)?void 0:h.length)||t||this.hasExtensionRowTree){let i=[];ew.push({rowKey:i,indicatorKey:t});for(let t=0,l=this.rows.length;t<l;t++){let l=this.rows[t];if(l in e)this.rowsHasValue[t]=!0,i.push(e[l]);else if(l!==n.ek){if((null==(c=null==(u=null==(d=this.dataConfig)?void 0:d.totals)?void 0:u.row)?void 0:c.showGrandTotals)&&0===t&&!this.rows.find(t=>t in e)){i.push(this.rowGrandTotalLabel),eC=!0;break}if((null==(f=null==(p=null==(g=this.dataConfig)?void 0:g.totals)?void 0:p.row)?void 0:f.subTotalsDimensions)&&(null==(C=null==(m=null==(b=this.dataConfig)?void 0:b.totals)?void 0:m.row)?void 0:C.subTotalsDimensions.indexOf(this.rows[t-1]))>=0){"tree"!==this.rowHierarchyType&&i.push(this.rowSubTotalLabel),eC=!0;break}}}}else{let t=this.getFieldMatchRowDimensionPaths(e);if(t.length>0)for(let e=0,i=t.length;e<i;e++){let i,o=t[e],r=[];for(let e=0,t=o.length;e<t;e++)(0,l.Z)(o[e].indicatorKey)?i=o[e].indicatorKey:r.push(o[e].value);ew.push({rowKey:r,indicatorKey:i})}}if(!this.parseCustomTreeToMatchRecords||(null==(v=this.dataConfig)?void 0:v.isPivotChart)||!(null==(w=this.customColTree)?void 0:w.length)||t||this.hasExtensionRowTree){let i=[];ev.push({colKey:i,indicatorKey:t});for(let t=0,l=this.columns.length;t<l;t++){let l=this.columns[t];if(l in e)this.columnsHasValue[t]=!0,i.push(e[l]);else if(l!==n.ek){if((null==(_=null==(x=null==(y=this.dataConfig)?void 0:y.totals)?void 0:x.column)?void 0:_.showGrandTotals)&&0===t&&!this.columns.find(t=>t in e)){i.push(this.colGrandTotalLabel),eC=!0;break}if((null==(H=null==(R=null==(S=this.dataConfig)?void 0:S.totals)?void 0:R.column)?void 0:H.subTotalsDimensions)&&(null==(F=null==(M=null==(A=this.dataConfig)?void 0:A.totals)?void 0:M.column)?void 0:F.subTotalsDimensions.indexOf(this.columns[t-1]))>=0){i.push(this.colSubTotalLabel),eC=!0;break}}}}else{let t=this.getFieldMatchColDimensionPaths(e);if(t.length>0)for(let e=0,i=t.length;e<i;e++){let i,o=t[e],r=[];for(let e=0,t=o.length;e<t;e++)(0,l.Z)(o[e].indicatorKey)?i=o[e].indicatorKey:r.push(o[e].value);ev.push({colKey:r,indicatorKey:i})}}for(let i=0;i<ew.length;i++){let l,n=ew[i].rowKey;this.indicatorsAsCol||(l=ew[i].indicatorKey);for(let i=0;i<ev.length;i++){let a=ev[i].colKey;this.indicatorsAsCol&&(l=ev[i].indicatorKey);let s=n.join(this.stringJoinChar),h=a.join(this.stringJoinChar);if(eC){this.totalRecordsTree[s]||(this.totalRecordsTree[s]={}),this.totalRecordsTree[s][h]||(this.totalRecordsTree[s][h]=[]);let t=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<t.length;i++)if(this.calculatedFiledKeys.indexOf(t[i])>=0){let l=null==(B=this.calculatedFieldRules)?void 0:B.find(e=>e.key===t[i]);(null==(z=null==(T=this.totalRecordsTree[s])?void 0:T[h])?void 0:z[i])||(this.totalRecordsTree[s][h][i]=new r.YJ[o.E.RECALCULATE]({key:t[i],field:t[i],isRecord:!0,formatFun:null==(k=null==(L=this.indicators)?void 0:L.find(e=>"string"!=typeof e&&e.indicatorKey===t[i]))?void 0:k.format,calculateFun:null==l?void 0:l.calculateFun,dependAggregators:this.totalRecordsTree[s][h],dependIndicatorKeys:null==l?void 0:l.dependIndicatorKeys})),t[i]in e&&(null==(I=null==(P=this.totalRecordsTree[s])?void 0:P[h])||I[i].push(e))}else{let l=this.getAggregatorRule(t[i]);(null==(D=null==(E=this.totalRecordsTree[s])?void 0:E[h])?void 0:D[i])||(this.totalRecordsTree[s][h][i]=new r.YJ[null!=(W=null==l?void 0:l.aggregationType)?W:o.E.SUM]({key:t[i],field:null!=(O=null==l?void 0:l.field)?O:t[i],aggregationFun:null==l?void 0:l.aggregationFun,formatFun:null!=(G=null==l?void 0:l.formatFun)?G:null==(Z=null==(N=this.indicators)?void 0:N.find(e=>"string"!=typeof e&&e.indicatorKey===t[i]))?void 0:Z.format})),t[i]in e&&(null==(V=null==(K=this.totalRecordsTree[s])?void 0:K[h])||V[i].push(e))}return}0!==n.length&&(this.rowFlatKeys[s]||(this.rowKeys.push(n),this.rowFlatKeys[s]=1)),0!==a.length&&(this.colFlatKeys[h]||(this.colKeys.push(a),this.colFlatKeys[h]=1)),this.tree[s]||(this.tree[s]={}),(null==(j=this.tree[s])?void 0:j[h])||(this.tree[s][h]=[]);let d=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<d.length;i++)if(this.calculatedFiledKeys.indexOf(d[i])>=0){let t=null==(U=this.calculatedFieldRules)?void 0:U.find(e=>e.key===d[i]);(null==(X=null==($=this.tree[s])?void 0:$[h])?void 0:X[i])||(this.tree[s][h][i]=new r.YJ[o.E.RECALCULATE]({key:d[i],field:d[i],isRecord:!0,formatFun:null==(Y=null==(J=this.indicators)?void 0:J.find(e=>"string"!=typeof e&&e.indicatorKey===d[i]))?void 0:Y.format,calculateFun:null==t?void 0:t.calculateFun,dependAggregators:this.tree[s][h],dependIndicatorKeys:null==t?void 0:t.dependIndicatorKeys})),null==(Q=null==(q=this.tree[s])?void 0:q[h])||Q[i].push(e)}else{let n=this.getAggregatorRule(d[i]),a=!1;l?t===l?d[i]===l&&(a=!0):d[i]===l&&d[i]in e&&(a=!0):(null==n?void 0:n.field)?"string"==typeof(null==n?void 0:n.field)?(null==n?void 0:n.field)in e&&(a=!0):(null==n?void 0:n.field.find(t=>t in e))&&(a=!0):d[i]in e&&(a=!0),(null==(et=null==(ee=this.tree[s])?void 0:ee[h])?void 0:et[i])||!a||(this.tree[s][h][i]=new r.YJ[null!=(ei=null==n?void 0:n.aggregationType)?ei:o.E.SUM]({key:d[i],field:null!=(el=null==n?void 0:n.field)?el:d[i],aggregationFun:null==n?void 0:n.aggregationFun,formatFun:null!=(eo=null==n?void 0:n.formatFun)?eo:null==(en=null==(er=this.indicators)?void 0:er.find(e=>"string"!=typeof e&&e.indicatorKey===d[i]))?void 0:en.format})),a&&(null==(es=null==(ea=this.tree[s])?void 0:ea[h])||es[i].push(e))}if(this.mappingRules)for(let t=0;t<this.indicatorKeys.length;t++){if(!this.indicatorStatistics[t]){let e=this.getAggregatorRule(this.indicatorKeys[t]);this.indicatorStatistics[t]={max:new r.YJ[o.E.MAX]({key:this.indicatorKeys[t],field:this.indicatorKeys[t]}),min:new r.YJ[o.E.MIN]({key:this.indicatorKeys[t],field:this.indicatorKeys[t]}),total:new r.YJ[null!=(eh=null==e?void 0:e.aggregationType)?eh:o.E.SUM]({key:this.indicatorKeys[t],field:null!=(ed=null==e?void 0:e.field)?ed:this.indicatorKeys[t],aggregationFun:null==e?void 0:e.aggregationFun,formatFun:null!=(eu=null==e?void 0:e.formatFun)?eu:null==(eg=null==(ec=this.indicators)?void 0:ec.find(e=>"string"!=typeof e&&e.indicatorKey===this.indicatorKeys[t]))?void 0:eg.format})}}this.indicatorStatistics[t].max.push(null==(ef=null==(ep=this.tree[s])?void 0:ep[h])?void 0:ef[t].value()),this.indicatorStatistics[t].min.push(null==(em=null==(eb=this.tree[s])?void 0:eb[h])?void 0:em[t].value()),this.indicatorStatistics[t].total.push(e)}}}}updateSortRules(e){var t,i,l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||("tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(t=this.totals)?void 0:t.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(r=null==(o=null==(l=this.totals)?void 0:l.row)?void 0:o.showGrandTotalsOnTop)&&r):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(n=this.totals)?void 0:n.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(d=null==(h=null==(s=this.totals)?void 0:s.row)?void 0:h.showGrandTotalsOnTop)&&d,null!=(g=null==(c=null==(u=this.totals)?void 0:u.row)?void 0:c.showSubTotalsOnTop)&&g)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((e,t)=>this.columnsHasValue[t]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(p=this.totals)?void 0:p.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(C=null==(m=null==(b=this.totals)?void 0:b.column)?void 0:m.showGrandTotalsOnLeft)&&C,null!=(y=null==(w=null==(v=this.totals)?void 0:v.column)?void 0:w.showSubTotalsOnLeft)&&y))}updateFilterRules(e,t=!1){var i,l;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(let e in this.tree)for(let t in this.tree[e])for(let l=0;l<this.tree[e][t].length;l++)null==(i=this.tree[e][t][l])||i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),(null==(l=this.dataConfig)?void 0:l.isPivotChart)&&this.cacheDeminsionCollectedValues()}getAggregatorRule(e){var t;return null==(t=this.aggregationRules)?void 0:t.find((t,i)=>e===t.indicatorKey)}getAggregator(e=[],t=[],i,o=!0,r){var n,s,h,d,u,c,g,p,f,b,m,C,v,w;let y,x,_=this.indicatorKeys.indexOf(i);"string"==typeof e?y=e:(r&&"row"!==r.position||e.map((t,o)=>{t!==i||(0,l.Z)(null==r?void 0:r.index)&&o!==r.index||e.splice(o,1)}),e.length<this.rows.length&&"grid-tree"===this.rowHierarchyType&&(e[0]===this.rowGrandTotalLabel||(null==(s=null==(n=this.totals)?void 0:n.row)?void 0:s.subTotalsDimensions)&&(null==(u=null==(d=null==(h=this.totals)?void 0:h.row)?void 0:d.subTotalsDimensions)?void 0:u.length)>=1&&e[e.length-1]!==this.rowSubTotalLabel&&e.push(this.rowSubTotalLabel)),y=a(e,this.stringJoinChar)),"string"==typeof t?x=t:(r&&"col"!==r.position||t.map((e,o)=>{e!==i||(0,l.Z)(null==r?void 0:r.index)&&o!==r.index||t.splice(o,1)}),t.length<this.columns.length&&"grid-tree"===this.columnHierarchyType&&(t[0]===this.colGrandTotalLabel||(null==(g=null==(c=this.totals)?void 0:c.column)?void 0:g.subTotalsDimensions)&&(null==(b=null==(f=null==(p=this.totals)?void 0:p.column)?void 0:f.subTotalsDimensions)?void 0:b.length)>=1&&t[t.length-1]!==this.colSubTotalLabel&&t.push(this.colSubTotalLabel)),x=a(t,this.stringJoinChar));let S=null==(C=null==(m=this.tree[y])?void 0:m[x])?void 0:C[_];if(o&&(0,l.Z)(null==(w=null==(v=this.changedTree[y])?void 0:v[x])?void 0:w[_])){let e=this.changedTree[y][x][_];return S?{value:()=>e,formatValue:S.formatValue,formatFun:S.formatFun,records:S.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>e,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>e,clearCacheValue(){},reset(){}}}return S||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));let e=this.arrSort(this.columns,!1);this.colKeys.sort(e)}}arrSort(e,t){let i,l=this,o=(function(o){let r=[];for(let o=0,n=e.length;o<n;o++)if(i=e[o],l.sortRules)for(let e=0,n=l.sortRules.length;e<n;e++)l.sortRules[e].sortField===i&&r.push({field:i,fieldIndex:o,sortRule:l.sortRules[e],func:l.getSort(l.sortRules[e],t)});return r}).call(this);return function(i,r){var n,a,s,h;let d,u;for(let c=0;c<o.length;c++){if(null==(n=(u=o[c]).sortRule)?void 0:n.sortByIndicator){let o=i,n=r;u.fieldIndex<e.length-1&&(o=i.slice(0,u.fieldIndex+1),"grid"===l.rowHierarchyType&&t?o.push(l.rowSubTotalLabel):t||o.push(l.colSubTotalLabel),n=r.slice(0,u.fieldIndex+1),"grid"===l.rowHierarchyType&&t?n.push(l.rowSubTotalLabel):t||n.push(l.colSubTotalLabel)),d=u.func(o,n,null==(a=u.sortRule)?void 0:a.sortType)}else d=null==(s=u.func)?void 0:s.call(u,i[u.fieldIndex],r[u.fieldIndex],null==(h=u.sortRule)?void 0:h.sortType);if(0!==d)return d}return 0}}getSort(e,t){let i=this;return e.sortByIndicator?(l,o,n)=>{let a=function(t,l){return"grid"===i.rowHierarchyType&&t.length<i.rows.length&&t[t.length-1]!==i.rowSubTotalLabel&&t[t.length-1]!==i.rowGrandTotalLabel&&t.push(i.rowSubTotalLabel),l.length<i.columns.length&&l[l.length-1]!==i.colSubTotalLabel&&l[l.length-1]!==i.colGrandTotalLabel&&l.push(i.colSubTotalLabel),i.getAggregator(t,l,e.sortByIndicator).value()};return t?e.sortFunc?e.sortFunc(a(l,e.query),a(o,e.query),l,o,n):(0,r.SL)(a(l,e.query),a(o,e.query),n):e.sortFunc?e.sortFunc(a(e.query,l),a(e.query,o),l,o,n):(0,r.SL)(a(e.query,l),a(e.query,o),n)}:e.sortBy?(0,r.MR)(e.sortBy):e.sortFunc?e.sortFunc:e.sortType?r.y4:r.SL}totalStatistics(){var e,t,i,l,n,a,s,h,d,u,c,g,p,f;let b=this,m=(e,t)=>{var i,l,n,a,s,h,d,u,c,g,p,f,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q,Q,ee;if(null==(l=null==(i=this.totalRecordsTree)?void 0:i[e])?void 0:l[t])return this.tree[e]||(this.tree[e]={}),void(this.tree[e][t]=null==(a=null==(n=this.totalRecordsTree)?void 0:n[e])?void 0:a[t]);let et=t.split(this.stringJoinChar);if((null==(h=null==(s=b.totals)?void 0:s.column)?void 0:h.subTotalsDimensions)&&(null==(c=null==(u=null==(d=b.totals)?void 0:d.column)?void 0:u.subTotalsDimensions)?void 0:c.length)>0&&!1!==b.totals.column.showSubTotals)for(let i=0,l=null==(f=null==(p=null==(g=b.totals)?void 0:g.column)?void 0:p.subTotalsDimensions)?void 0:f.length;i<l;i++){let l=b.totals.column.subTotalsDimensions[i],n=b.columns.indexOf(l);if(n>=0){let i=et.slice(0,n+1);i.push(b.colSubTotalLabel);let l=i.join(this.stringJoinChar);if(null==(C=null==(m=this.totalRecordsTree)?void 0:m[e])?void 0:C[l])return void(this.tree[e][l]=null==(w=null==(v=this.totalRecordsTree)?void 0:v[e])?void 0:w[l]);this.tree[e][l]||(this.tree[e][l]=[]);let a=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<a.length;i++)if(this.calculatedFiledKeys.indexOf(a[i])>=0){let n=null==(y=this.calculatedFieldRules)?void 0:y.find(e=>e.key===a[i]);(null==(_=null==(x=this.tree[e])?void 0:x[l])?void 0:_[i])||(this.tree[e][l][i]=new r.YJ[o.E.RECALCULATE]({key:a[i],field:a[i],isRecord:!0,formatFun:null==(R=null==(S=this.indicators)?void 0:S.find(e=>"string"!=typeof e&&e.indicatorKey===a[i]))?void 0:R.format,calculateFun:null==n?void 0:n.calculateFun,dependAggregators:this.tree[e][l],dependIndicatorKeys:null==n?void 0:n.dependIndicatorKeys})),l!==t&&this.tree[e][l][i].push(null==(A=null==(H=b.tree[e])?void 0:H[t])?void 0:A[i])}else{if(!this.tree[e][l][i]){let t=this.getAggregatorRule(a[i]);this.tree[e][l][i]=new r.YJ[null!=(M=null==t?void 0:t.aggregationType)?M:o.E.SUM]({key:a[i],field:null!=(F=null==t?void 0:t.field)?F:a[i],aggregationFun:null==t?void 0:t.aggregationFun,formatFun:null!=(B=null==t?void 0:t.formatFun)?B:null==(z=null==(T=this.indicators)?void 0:T.find(e=>"string"!=typeof e&&e.indicatorKey===a[i]))?void 0:z.format})}l!==t&&this.tree[e][l][i].push(null==(k=null==(L=b.tree[e])?void 0:L[t])?void 0:k[i])}}}if((null==(I=null==(P=b.totals)?void 0:P.column)?void 0:I.showGrandTotals)||0===this.rows.length){let i=b.colGrandTotalLabel;if(null==(D=null==(E=this.totalRecordsTree)?void 0:E[e])?void 0:D[i])return void(this.tree[e][i]=null==(O=null==(W=this.totalRecordsTree)?void 0:W[e])?void 0:O[i]);this.tree[e][i]||(this.tree[e][i]=[]);let l=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let n=0;n<l.length;n++)if(this.calculatedFiledKeys.indexOf(l[n])>=0){let a=null==(G=this.calculatedFieldRules)?void 0:G.find(e=>e.key===l[n]);(null==(Z=null==(N=this.tree[e])?void 0:N[i])?void 0:Z[n])||(this.tree[e][i][n]=new r.YJ[o.E.RECALCULATE]({key:l[n],field:l[n],isRecord:!0,formatFun:null==(V=null==(K=this.indicators)?void 0:K.find(e=>"string"!=typeof e&&e.indicatorKey===l[n]))?void 0:V.format,calculateFun:null==a?void 0:a.calculateFun,dependAggregators:this.tree[e][i],dependIndicatorKeys:null==a?void 0:a.dependIndicatorKeys})),i!==t&&this.tree[e][i][n].push(null==(U=null==(j=b.tree[e])?void 0:j[t])?void 0:U[n])}else{if(!this.tree[e][i][n]){let t=this.getAggregatorRule(l[n]);this.tree[e][i][n]=new r.YJ[null!=($=null==t?void 0:t.aggregationType)?$:o.E.SUM]({key:l[n],field:null!=(X=null==t?void 0:t.field)?X:l[n],formatFun:null!=(J=null==t?void 0:t.formatFun)?J:null==(q=null==(Y=this.indicators)?void 0:Y.find(e=>"string"!=typeof e&&e.indicatorKey===l[n]))?void 0:q.format})}i!==t&&this.tree[e][i][n].push(null==(ee=null==(Q=b.tree[e])?void 0:Q[t])?void 0:ee[n])}}};if((null==(t=null==(e=null==b?void 0:b.totals)?void 0:e.column)?void 0:t.subTotalsDimensions)&&(null==(n=null==(l=null==(i=null==b?void 0:b.totals)?void 0:i.column)?void 0:l.subTotalsDimensions)?void 0:n.length)>=1||(null==(s=null==(a=null==b?void 0:b.totals)?void 0:a.row)?void 0:s.subTotalsDimensions)&&(null==(u=null==(d=null==(h=null==b?void 0:b.totals)?void 0:h.row)?void 0:d.subTotalsDimensions)?void 0:u.length)>=1||(null==(g=null==(c=null==b?void 0:b.totals)?void 0:c.column)?void 0:g.showGrandTotals)||(null==(f=null==(p=null==b?void 0:b.totals)?void 0:p.row)?void 0:f.showGrandTotals)){let e=[];Object.keys(b.tree).forEach(t=>{let i=t.split(this.stringJoinChar);Object.keys(b.tree[t]).forEach(l=>{var n,a,s,h,d,u,c,g,p,f,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E;if((null==(a=null==(n=b.totals)?void 0:n.row)?void 0:a.subTotalsDimensions)&&(null==(d=null==(h=null==(s=b.totals)?void 0:s.row)?void 0:h.subTotalsDimensions)?void 0:d.length)>0&&!1!==b.totals.row.showSubTotals)for(let n=0,a=null==(g=null==(c=null==(u=b.totals)?void 0:u.row)?void 0:c.subTotalsDimensions)?void 0:g.length;n<a;n++){let a=b.totals.row.subTotalsDimensions[n],s=b.rows.indexOf(a);if(s>=0&&s<b.rows.length-1){let n=i.slice(0,s+1);"tree"!==this.rowHierarchyType&&n.push(b.rowSubTotalLabel);let a=n.join(this.stringJoinChar);this.tree[a]||(this.tree[a]={},e.push(a)),this.tree[a][l]||(this.tree[a][l]=[]);let h=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let e=0;e<h.length;e++){if(!this.tree[a][l][e])if(this.calculatedFiledKeys.indexOf(h[e])>=0){let t=null==(p=this.calculatedFieldRules)?void 0:p.find(t=>t.key===h[e]);this.tree[a][l][e]=new r.YJ[o.E.RECALCULATE]({key:h[e],field:h[e],isRecord:!0,formatFun:null==(C=null==(f=this.indicators)?void 0:f.find(t=>"string"!=typeof t&&t.indicatorKey===h[e]))?void 0:C.format,calculateFun:null==t?void 0:t.calculateFun,dependAggregators:this.tree[a][l],dependIndicatorKeys:null==t?void 0:t.dependIndicatorKeys})}else{let t=this.getAggregatorRule(h[e]);this.tree[a][l][e]=new r.YJ[null!=(v=null==t?void 0:t.aggregationType)?v:o.E.SUM]({key:h[e],field:null!=(w=null==t?void 0:t.field)?w:h[e],formatFun:null!=(y=null==t?void 0:t.formatFun)?y:null==(_=null==(x=this.indicators)?void 0:x.find(t=>"string"!=typeof t&&t.indicatorKey===h[e]))?void 0:_.format})}a!==t&&this.tree[a][l][e].push(null==(R=null==(S=b.tree[t])?void 0:S[l])?void 0:R[e])}}}if((null==(A=null==(H=b.totals)?void 0:H.row)?void 0:A.showGrandTotals)||0===this.columns.length){let i=b.rowGrandTotalLabel;this.tree[i]||(this.tree[i]={},e.push(i)),this.tree[i][l]||(this.tree[i][l]=[]);let n=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let e=0;e<n.length;e++){if(!this.tree[i][l][e])if(this.calculatedFiledKeys.indexOf(n[e])>=0){let t=null==(M=this.calculatedFieldRules)?void 0:M.find(t=>t.key===n[e]);this.tree[i][l][e]=new r.YJ[o.E.RECALCULATE]({key:n[e],field:n[e],isRecord:!0,formatFun:null==(B=null==(F=this.indicators)?void 0:F.find(t=>"string"!=typeof t&&t.indicatorKey===n[e]))?void 0:B.format,calculateFun:null==t?void 0:t.calculateFun,dependAggregators:this.tree[i][l],dependIndicatorKeys:null==t?void 0:t.dependIndicatorKeys})}else{let t=this.getAggregatorRule(n[e]);this.tree[i][l][e]=new r.YJ[null!=(T=null==t?void 0:t.aggregationType)?T:o.E.SUM]({key:n[e],field:null!=(z=null==t?void 0:t.field)?z:n[e],formatFun:null!=(L=null==t?void 0:t.formatFun)?L:null==(P=null==(k=this.indicators)?void 0:k.find(t=>"string"!=typeof t&&t.indicatorKey===n[e]))?void 0:P.format})}i!==t&&this.tree[i][l][e].push(null==(E=null==(I=b.tree[t])?void 0:I[l])?void 0:E[e])}}m(t,l)})}),e.forEach(e=>{Object.keys(b.tree[e]).forEach(t=>{m(e,t)})})}for(let e in b.totalRecordsTree)for(let t in b.totalRecordsTree[e])m(e,t)}ArrToTree1(e,t,i,l,o,r){let n=[],a=this.stringJoinChar,s=new Map;function h(e,l){let o,h=[];e.forEach((d,u)=>{var c;h.push(d);let g=h.join(a),p=s.get(g);p||(p={value:d,dimensionKey:t[u],children:u===e.length-1&&(null!=(c=null==i?void 0:i.length)?c:0)>=1?null==i?void 0:i.map(e=>"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[]},s.set(g,p),o?o.children.push(p):r&&l?n.unshift(p):n.push(p)),o=p})}return e.forEach(e=>h(e,!1)),l&&h([o],l),n}ArrToTree(e,t,i,l,o,r,n,a,s){var h;let d=[],u=this.stringJoinChar,c=new Map;if((null==e?void 0:e.length)?e.forEach(e=>(function(e){let o,r=[];e.forEach((a,h)=>{var g,p,f,b;r.push(a);let m=r.join(u),C=c.get(m);if(!C){if(C={value:a,dimensionKey:t[h],children:h===e.length-1&&(null!=(g=null==i?void 0:i.length)?g:0)>=1?null==i?void 0:i.map(e=>"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[]},l[h]){let e=null!=(p=C.children)?p:[],o={value:n,dimensionKey:t[h+1],levelSpan:l.length-h-1,children:(null!=(f=null==i?void 0:i.length)?f:0)>=1?null==i?void 0:i.map(e=>"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[],role:"sub-total"};e.push(o),e=null!=(b=o.children)?b:[]}c.set(m,C),o?l[h-1]&&!s?o.children.splice(o.children.length-1,0,C):o.children.push(C):d.push(C)}o=C})})(e)):i&&(d=null==i?void 0:i.map(e=>{var t;return"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}})),o&&(null==e?void 0:e.length)){let e={value:r,dimensionKey:t[0],levelSpan:l.length,children:null!=(h=null==i?void 0:i.map(e=>"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}))?h:[],role:"grand-total"};a?d.unshift(e):d.push(e)}return d}cacheDeminsionCollectedValues(){for(let e in this.collectValuesBy)"xField"!==this.collectValuesBy[e].type&&"yField"!==this.collectValuesBy[e].type||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=function(e,t){return e.sort((e,i)=>{let l=t.indexOf(e),o=t.indexOf(i);return l<o?-1:+(l>o)})}(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],i,l){var o,n,a,s,h;let d,u,c=this.indicatorKeys.indexOf(i);d="string"==typeof e?e:e.join(this.stringJoinChar),u="string"==typeof t?t:t.join(this.stringJoinChar),"string"==typeof l&&(isNaN(parseFloat(l))||(l=parseFloat(l))),(null==(o=this.changedTree[d])?void 0:o[u])||(this.changedTree[d]||(this.changedTree[d]={}),this.changedTree[d][u]=[]),this.changedTree[d][u][c]=l;let g=null==(a=null==(n=this.tree[d])?void 0:n[u])?void 0:a[c];if(1===(null==g?void 0:g.records.length)&&(g.records[0][this.indicatorKeys[c]]=l),null!=(h=null==(s=this.dataConfig)?void 0:s.updateAggregationOnEditCell)&&h)if(g)g.changedValue=l,this.recalculateTotals(e,t,i);else{let o=new r.__({key:i,field:i,isRecord:!0});o.changedValue=l,this.recalculateTotals(e,t,i,o)}}recalculateTotals(e=[],t=[],i,l){var o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W;if(!this.totals||0===Object.keys(this.tree).length||!((null==(o=this.totals.row)?void 0:o.showGrandTotals)||(null==(r=this.totals.row)?void 0:r.subTotalsDimensions)&&this.totals.row.subTotalsDimensions.length>0&&!1!==this.totals.row.showSubTotals)&&!((null==(n=this.totals.column)?void 0:n.showGrandTotals)||(null==(a=this.totals.column)?void 0:a.subTotalsDimensions)&&this.totals.column.subTotalsDimensions.length>0&&!1!==this.totals.column.showSubTotals))return;let O=Array.isArray(e)?e.join(this.stringJoinChar):e,G=Array.isArray(t)?t.join(this.stringJoinChar):t,N=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(i),Z=new Set,K=new Set,V=O.split(this.stringJoinChar),j=G.split(this.stringJoinChar),U=(e,t,i)=>{e&&(t!==O||i!==G)&&(Z.add(e),t!==O&&i!==G||K.add(e))};if((null==(h=null==(s=this.totals)?void 0:s.row)?void 0:h.subTotalsDimensions)&&!1!==this.totals.row.showSubTotals)for(let e=0;e<this.totals.row.subTotalsDimensions.length;e++){let t=this.totals.row.subTotalsDimensions[e],i=this.rows.indexOf(t);if(i>=0&&i<V.length){let e=V.slice(0,i+1);"tree"!==this.rowHierarchyType&&e.push(this.rowSubTotalLabel);let t=e.join(this.stringJoinChar);if((null==(u=null==(d=this.tree[t])?void 0:d[G])?void 0:u[N])&&U(this.tree[t][G][N],t,G),(null==(g=null==(c=this.totals)?void 0:c.column)?void 0:g.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let e=0;e<this.totals.column.subTotalsDimensions.length;e++){let i=this.totals.column.subTotalsDimensions[e],l=this.columns.indexOf(i);if(l>=0&&l<j.length){let e=j.slice(0,l+1);e.push(this.colSubTotalLabel);let i=e.join(this.stringJoinChar);(null==(f=null==(p=this.tree[t])?void 0:p[i])?void 0:f[N])&&U(this.tree[t][i][N],t,i)}}(null==(m=null==(b=this.totals)?void 0:b.column)?void 0:m.showGrandTotals)&&(null==(v=null==(C=this.tree[t])?void 0:C[this.colGrandTotalLabel])?void 0:v[N])&&U(this.tree[t][this.colGrandTotalLabel][N],t,this.colGrandTotalLabel)}}if(null==(y=null==(w=this.totals)?void 0:w.row)?void 0:y.showGrandTotals){if(null==(_=null==(x=this.tree[this.rowGrandTotalLabel])?void 0:x[G])?void 0:_[N]){if(U(this.tree[this.rowGrandTotalLabel][G][N],this.rowGrandTotalLabel,G),(null==(R=null==(S=this.totals)?void 0:S.column)?void 0:R.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let e=0;e<this.totals.column.subTotalsDimensions.length;e++){let t=this.totals.column.subTotalsDimensions[e],i=this.columns.indexOf(t);if(i>=0&&i<j.length){let e=j.slice(0,i+1);e.push(this.colSubTotalLabel);let t=e.join(this.stringJoinChar);(null==(A=null==(H=this.tree[this.rowGrandTotalLabel])?void 0:H[t])?void 0:A[N])&&U(this.tree[this.rowGrandTotalLabel][t][N],this.rowGrandTotalLabel,t)}}(null==(F=null==(M=this.totals)?void 0:M.column)?void 0:F.showGrandTotals)&&(null==(T=null==(B=this.tree[this.rowGrandTotalLabel])?void 0:B[this.colGrandTotalLabel])?void 0:T[N])&&U(this.tree[this.rowGrandTotalLabel][this.colGrandTotalLabel][N],this.rowGrandTotalLabel,this.colGrandTotalLabel)}if((null==(L=null==(z=this.totals)?void 0:z.column)?void 0:L.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let e=0;e<this.totals.column.subTotalsDimensions.length;e++){let t=this.totals.column.subTotalsDimensions[e],i=this.columns.indexOf(t);if(i>=0&&i<j.length){let e=j.slice(0,i+1);e.push(this.colSubTotalLabel);let t=e.join(this.stringJoinChar);(null==(P=null==(k=this.tree[O])?void 0:k[t])?void 0:P[N])&&U(this.tree[O][t][N],O,t)}}(null==(E=null==(I=this.totals)?void 0:I.column)?void 0:E.showGrandTotals)&&(null==(W=null==(D=this.tree[O])?void 0:D[this.colGrandTotalLabel])?void 0:W[N])&&U(this.tree[O][this.colGrandTotalLabel][N],O,this.colGrandTotalLabel),Z.forEach(e=>{l&&K.has(e)&&e.push(l),e.recalculate()})}}changeRecordFieldValue(e,t,i){let l=!1;for(let t=0;t<this.indicatorKeys.length;t++)this.indicatorKeys[t]===e&&(l=!0);if(!l){if(Array.isArray(this.records))for(let l=0,o=this.records.length;l<o;l++){let o=this.records[l];o[e]===t&&(o[e]=i)}else for(let l in this.records)for(let o=0,r=this.records[l].length;o<r;o++){let r=this.records[l][o];r[e]===t&&(r[e]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let t=0,i=e.length;t<i;t++){let i=e[t];this.processRecord(i)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,t){let i=[],o=this;return null==e||e.forEach(e=>(function e(r,n){var a,s,h;r.virtual||((null==(a=n[n.length-1])?void 0:a.childKeys)&&r.dimensionKey&&-1===n[n.length-1].childKeys.indexOf(r.dimensionKey)&&r.dimensionKey!==n[n.length-1].dimensionKey&&n[n.length-1].childKeys.push(r.dimensionKey),n.push({dimensionKey:(0,l.Z)(r.indicatorKey)?void 0:r.dimensionKey,value:r.value,indicatorKey:r.indicatorKey,virtual:r.virtual})),(null==(s=r.children)?void 0:s.length)>0?("tree"===o.rowHierarchyType&&"row"===t&&(n[n.length-1].childKeys=[],i.push([...n])),null==(h=r.children)||h.forEach(t=>e(t,[...n]))):i.push(n)})(e,[])),i}getFieldMatchColDimensionPaths(e){var t,i;let l=[];for(let o=0;o<(null!=(i=null==(t=this.customColTreeDimensionPaths)?void 0:t.length)?i:0);o++){let t=this.customColTreeDimensionPaths[o],i=!0;for(let l=0;l<t.length;l++){let o=t[l];if(o.dimensionKey&&e[o.dimensionKey]!==o.value||o.indicatorKey&&void 0===e[o.indicatorKey]){i=!1;break}}i&&l.push(t)}return l}getFieldMatchRowDimensionPaths(e){var t,i;let o=[];for(let r=0;r<(null!=(i=null==(t=this.customRowTreeDimensionPaths)?void 0:t.length)?i:0);r++){let t=this.customRowTreeDimensionPaths[r],i=!0;for(let o=0;o<t.length;o++){let r=t[o];if(r.dimensionKey&&e[r.dimensionKey]!==r.value||r.indicatorKey&&void 0===e[r.indicatorKey]||r.childKeys&&o===t.length-1&&r.childKeys.length>0&&r.childKeys.find(t=>(0,l.Z)(e[t]))){i=!1;break}}i&&(this.indicatorsAsCol||"tree"!==this.rowHierarchyType||t.find(e=>e.indicatorKey)||(i=!1)),i&&o.push(t)}return o}}},62482:function(e,t,i){"use strict";i.d(t,{U:()=>o,X:()=>l});let l={};function o(e){if(l[e])return l[e]}},1847:function(e,t,i){"use strict";i.d(t,{b:()=>a});var l=i(32095),o=i(27180);let r=1;class n{constructor(e,t,i){var o;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{let e=this.getSize(),t=!1;e.width===this.lastSize.width&&e.height===this.lastSize.height&&(t=!0),this.lastSize=e,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:t}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=(0,l.D)(this.callBack,this.resizeTime),null==window||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){let e=window.ResizeObserver;this.observer=new e(this.mutationResize),null==(o=this.observer)||o.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){let e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class a{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,i,...l){if("node"===o.X.mode)return -1;let a=r++;if(null==e?void 0:e.addEventListener)if("resize"!==t||e===window)null==e||e.addEventListener(t,i,...l);else{let t=new n(e,i,this.resizeTime);this.reseizeListeners[a]=t}return this.listeners[a]={target:e,type:t,listener:i,options:l},a}once(e,t,i,...l){if("node"===o.X.mode)return -1;let r=this.on(e,t,(...e)=>{this.off(r),i(...e)},...l);return r}off(e){var t;if("node"===o.X.mode||null===e)return;let i=null==(t=this.listeners)?void 0:t[e];i&&(delete this.listeners[e],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(e,t,...i){if("node"!==o.X.mode)for(let l in this.listeners){let o=this.listeners[l];o.target===e&&o.type===t&&o.listener.call(o.target,...i)}}hasListener(e,t){if("node"===o.X.mode)return!1;let i=!1;for(let l in this.listeners){let o=this.listeners[l];o.target===e&&o.type===t&&(i=!0)}return i}clear(){if("node"!==o.X.mode){for(let e in this.listeners){let t=this.listeners[e];t.target.removeEventListener&&t.target.removeEventListener(t.type,t.listener,...t.options)}for(let e in this.reseizeListeners){let t=this.reseizeListeners[e];null==t||t.disConnect()}this.listeners={}}}release(){"node"!==o.X.mode&&(this.clear(),this.listeners={})}}},31150:function(e,t,i){"use strict";i.d(t,{R:()=>r});var l=i(18585);let o=1;class r{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(e,t){let i=this.listenersData.listeners[e]||(this.listenersData.listeners[e]=[]);i.push(t);let l=o++;return this.listenersData.listenerData[l]={type:e,listener:t,remove:()=>{delete this.listenersData.listenerData[l];let o=i.indexOf(t);i.splice(o,1),this.listenersData.listeners[e].length||delete this.listenersData.listeners[e]}},l}off(e,t){var i;if(t)this.removeEventListener(e,t);else{if(!this.listenersData)return;null==(i=this.listenersData.listenerData[e])||i.remove()}}addEventListener(e,t,i){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(let i in this.listenersData.listenerData){let l=this.listenersData.listenerData[i];l.type===e&&l.listener===t&&this.off(i)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){if(!this.listenersData)return[];let i=this.listenersData.listeners[e];return i?i.map(e=>e.call(this,t)).filter(e=>(0,l.Z)(e)):[]}release(){delete this.listenersData}}},63388:function(e,t,i){"use strict";i.d(t,{J$:()=>r,RJ:()=>o,xD:()=>n});var l=i(18585);function o(e){let t={abstractPos:{x:e.viewport.x,y:e.viewport.y}},i=r(e.target);return i&&(t.eventArgs={col:i.col,row:i.row,event:e,targetCell:i,mergeInfo:function(e){if((0,l.Z)(e.mergeStartCol)&&(0,l.Z)(e.mergeStartRow)&&(0,l.Z)(e.mergeEndCol)&&(0,l.Z)(e.mergeEndRow))return{colStart:e.mergeStartCol,colEnd:e.mergeEndCol,rowStart:e.mergeStartRow,rowEnd:e.mergeEndRow}}(i),target:e.target}),t}function r(e){for(;e&&e.parent;){if("cell"===e.role)return e;e=e.parent}return null}let n=/radio-\d+-\d+-(\d+)/},4234:function(e,t,i){"use strict";let l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H;i.d(t,{E6:()=>T,U2:()=>k,ci:()=>L});var A=i(27695),M=i(77597),F=i(4234),B=i(90251);function T(e){var t,i,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$;l=null!=(t=null==e?void 0:e.sort_color)?t:"#282F38",o=null!=(i=null==e?void 0:e.sort_color_opacity)?i:"0.35",r=null!=(A=null==e?void 0:e.sort_color_2)?A:"#416EFF",n=null!=(M=null==e?void 0:e.sort_color_opacity_2)?M:"1",a=null!=(F=null==e?void 0:e.sort_size)?F:16,s=null!=(B=null==e?void 0:e.sort_size_2)?B:22,h=null!=(T=null==e?void 0:e.frozen_color)?T:"#282F38",d=null!=(z=null==e?void 0:e.frozen_color_opacity)?z:"0.35",u=null!=(L=null==e?void 0:e.frozen_color_opacity)?L:"0.2",c=null!=(k=null==e?void 0:e.frozen_color_2)?k:"#416EFF",g=null!=(P=null==e?void 0:e.frozen_color_opacity_2)?P:"1",p=null!=(I=null==e?void 0:e.frozen_size)?I:22,f=null!=(E=null==e?void 0:e.frozen_size_2)?E:22,b=null!=(D=null==e?void 0:e.collapse_color)?D:"#141414",m=null!=(W=null==e?void 0:e.collapse_color_opacity)?W:"0.65",C=null!=(O=null==e?void 0:e.collapse_size)?O:16,v=null!=(G=null==e?void 0:e.frozen_size_2)?G:22,w=null!=(N=null==e?void 0:e.expand_color)?N:"#141414",y=null!=(Z=null==e?void 0:e.expand_color_opacity)?Z:"0.65",x=null!=(K=null==e?void 0:e.expand_size)?K:16,_=null!=(V=null==e?void 0:e.expand_size_2)?V:22,S=null!=(j=null==e?void 0:e.dragReorder_color)?j:"#666666",R=null!=(U=null==e?void 0:e.dragReorder_color_opacity)?U:"1",H=null!=($=null==e?void 0:e.dragReorder_size)?$:20}let z={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${r}"  fill-opacity="${n}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${l}" fill-opacity="${o}"/></svg> `,width:a,height:a,funcType:A.cI.sort,name:"sort_downward",positionType:A.q0.contentRight,marginLeft:3,hover:{width:s,height:s,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${l}"  fill-opacity="${o}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${r}"  fill-opacity="${n}"/> </svg>`,width:a,height:a,funcType:A.cI.sort,positionType:A.q0.contentRight,name:"sort_upward",marginLeft:3,hover:{width:s,height:s,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${l}" fill-opacity="${o}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${l}" fill-opacity="${o}"/></svg> `,width:a,height:a,funcType:A.cI.sort,positionType:A.q0.contentRight,name:"sort_normal",marginLeft:3,hover:{width:s,height:s,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${h}" fill-opacity="${u}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:p,height:p,name:"freeze",funcType:A.cI.frozen,positionType:A.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${h}" fill-opacity="${d}"/></svg>`,width:p,height:p,name:"frozen",funcType:A.cI.frozen,positionType:A.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${c}" fill-opacity="${g}"/></svg>`,width:p,height:p,funcType:A.cI.frozen,positionType:A.q0.right,name:"frozenCurrent",marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:A.cI.dropDown,positionType:A.q0.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:A.cI.play,positionType:A.q0.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:A.cI.damagePic,positionType:A.q0.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:A.q0.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${w}" fill-opacity="${y}"/>
      </svg>`,width:x,height:x,funcType:A.cI.expand,name:"expand",positionType:A.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:_,height:_,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${b}" fill-opacity="${m}"/>
      </svg>`,width:C,height:C,funcType:A.cI.collapse,name:"collapse",positionType:A.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:v,height:v,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:A.q0.absolute,funcType:A.cI.drillDown,svg:B.gm,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:A.q0.absolute,funcType:A.cI.drillUp,svg:B.Zj,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${R}" p-id="5172"></path></svg>`,width:H,height:H,funcType:A.cI.dragReorder,positionType:A.q0.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}},L={};function k(){return(0,M.l7)(z,F.ci)}},51235:function(e,t,i){"use strict";i.d(t,{iN:()=>S,Wm:()=>R,hZ:()=>w,Vp:()=>_,dK:()=>y,V4:()=>M});var l,o,r=i(58977),n=i(91212),a=i(43735),s=i(18585),h=i(33657);function d(e){return 2===e.length&&(0,h.Z)(e[0])&&(0,h.Z)(e[1])&&e[1]>=e[0]}function u(e){let t=e[1]-e[0],i=e[1]*e[0]<0,l=e[0]<=0?0-e[0]:0,o=e[1]>0?e[1]-0:0;return 0===t?e[0]<0?(l=1,o=0):e[0]>0&&(l=0,o=1):(l/=t,o/=t),{total:t,negative:l,positive:o,includeZero:i,domain:e,extendable_min:!0,extendable_max:!0}}function c(e,t){let{positive:i,negative:l,extendable_min:o,extendable_max:r,domain:n}=e,{positive:a,negative:s,extendable_min:h,extendable_max:d,domain:u}=t;if(a>0){if(!h)return!1;let e=l/i;r&&(e=l/Math.max(i,a),n[1]=-n[0]/e),u[0]=-u[1]*e}else if(s>0){if(!d)return!1;let e=i/l;o&&(e=i/Math.max(l,l),n[0]=-n[1]/e),u[1]=-u[0]*e}return!0}function g(e,t){let{extendable_min:i,extendable_max:l,domain:o}=e,{positive:r,negative:n,domain:a}=t;return(0!==r||0!==n)&&!(r>0&&!l)&&!(n>0&&!i)&&(o[0]=a[0],o[1]=a[1],!0)}function p(e,t){let{positive:i,negative:l,extendable_max:o,domain:r}=e,{positive:n,negative:a,extendable_min:s,domain:h}=t;if(o&&s){let e=Math.max(l,a)/Math.max(i,n);r[1]=-r[0]/e,h[0]=-h[1]*e}else if(s)h[0]=-h[1]*(l/i);else{if(!o)return!1;r[1]=-r[0]/(a/n)}return!0}function f(e,t){let{extendable_min:i,domain:l}=e,{extendable_max:o,domain:r}=t;return!(!i||!o)&&(l[0]=-l[1],r[1]=-r[0],!0)}var b=i(75025),m=i(37811),C=i(60232),v=i(53250);function w(e,t,i){var l,o,h,d,u,c,g,p,f,b;if(i._table.isPivotChart())if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&t===i.columnHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount){let l=H("top",e,t+1,e,i.columnHeaderLevelCount-1,e,t,1,i);if(!l)return;let o=i._table._getCellStyle(e,t+1),a=(0,m.u)((0,C.WJ)("padding",o,e,t+1,i._table)),{range:s,ticks:h,axisOption:d,targetTicks:u,targetRange:c,index:g,theme:p}=l;return(0,r.Z)(null==d?void 0:d.min)&&(s.min=d.min,s.min>0&&(d.zero=!1)),(0,r.Z)(null==d?void 0:d.max)&&(s.max=d.max,s.max<0&&(d.zero=!1)),(0,n.Z)({range:s},d,{orient:"top",type:(null==d?void 0:d.type)||"linear",label:{flush:!0},tick:{tickMode:(0,v.h)(u,c,s,g)},__ticksForVTable:h,__vtableChartTheme:p,__vtablePadding:a})}if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount){let l=i.getIndicatorKeyInChartSpec(e,t),o=null;null==l||l.forEach(e=>{let t=i.getIndicatorInfo(e);t&&(o=t)});let a=H("bottom",e,t-1,e,t,e,t,0,i);if(!a)return;let s=i._table._getCellStyle(e,t-1),h=(0,m.u)((0,C.WJ)("padding",s,e,t-1,i._table)),{range:d,ticks:u,axisOption:c,index:g,targetTicks:p,targetRange:f,theme:b}=a;return(0,r.Z)(null==c?void 0:c.min)&&(d.min=c.min,d.min>0&&(c.zero=!1)),(0,r.Z)(null==c?void 0:c.max)&&(d.max=c.max,d.max<0&&(c.zero=!1)),(0,n.Z)({title:{visible:!0,text:null==o?void 0:o.title},range:d},c,{orient:"bottom",type:(null==c?void 0:c.type)||"linear",label:{flush:!0},tick:{tickMode:(0,v.h)(p,f,d,g)},__ticksForVTable:u,__vtableChartTheme:b,__vtablePadding:h})}if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount){let r,u=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,t);(0,a.Z)(u)&&(u=u[0]);let c=null!=(l=i.dataset.collectedValues[u])?l:[],g=i.getRowKeysPath(e,t),v=null!=(o=c[null!=g?g:""])?o:[],{axisOption:w,theme:x,chartType:_}=y(e+1,t,"left",i);if(!1===(null==w?void 0:w.visible))return;let S=i._table._getCellStyle(e+1,t),R=(0,m.u)((0,C.WJ)("padding",S,e+1,t,i._table)),H=i.getRawChartSpec(e+1,t);return(0,n.Z)({domain:"linear"===(null==w?void 0:w.type)?void 0:Array.from(v),range:"linear"===(null==w?void 0:w.type)?v:void 0,title:{autoRotate:!0}},w,{orient:"left",type:null!=(h=null==w?void 0:w.type)?h:"band",__vtableChartTheme:x,inverse:(p=w,f="horizontal"===(null!=(d=null==H?void 0:H.direction)?d:"scatter"===_?"vertical":"horizontal"),r=null==p?void 0:p.inverse,f&&"bottom"!==(b=null==p?void 0:p.orient)&&"top"!==b&&(r=!(0,s.Z)(null==p?void 0:p.inverse)||!(null==p?void 0:p.inverse)),r),__vtablePadding:R})}}else{if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount){let l=i.getIndicatorKeyInChartSpec(e,t),o=null;null==l||l.forEach(e=>{let t=i.getIndicatorInfo(e);t&&(o=t)});let a=H("left",e+1,t,e,t,e,t,0,i);if(!a)return;let s=i._table._getCellStyle(e+1,t),h=(0,m.u)((0,C.WJ)("padding",s,e+1,t,i._table)),{range:d,ticks:u,axisOption:c,index:g,targetTicks:p,targetRange:f,theme:b}=a;return(0,r.Z)(null==c?void 0:c.min)&&(d.min=c.min,d.min>0&&(c.zero=!1)),(0,r.Z)(null==c?void 0:c.max)&&(d.max=c.max,d.max<0&&(c.zero=!1)),(0,n.Z)({title:{visible:!0,text:null==o?void 0:o.title,autoRotate:!0},range:d},c,{orient:"left",type:(null==c?void 0:c.type)||"linear",label:{flush:!0},tick:{tickMode:(0,v.h)(p,f,d,g)},__ticksForVTable:u,__vtableChartTheme:b,__vtablePadding:h})}if(e===i.colCount-i.rightFrozenColCount&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount){let l=H("right",e-1,t,i.rowHeaderLevelCount-1,t,e,t,1,i);if(!l)return;let o=i._table._getCellStyle(e-1,t),a=(0,m.u)((0,C.WJ)("padding",o,e-1,t,i._table)),{range:s,ticks:h,axisOption:d,index:u,targetTicks:c,targetRange:g,theme:p}=l;return(0,r.Z)(null==d?void 0:d.min)&&(s.min=d.min,s.min>0&&(d.zero=!1)),(0,r.Z)(null==d?void 0:d.max)&&(s.max=d.max,s.max<0&&(d.zero=!1)),(0,n.Z)({range:s,title:{autoRotate:!0}},d,{orient:"right",type:(null==d?void 0:d.type)||"linear",label:{flush:!0},tick:{tickMode:(0,v.h)(c,g,s,u)},__ticksForVTable:h,__vtableChartTheme:p,__vtablePadding:a})}if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount){let l=i.getDimensionKeyInChartSpec(e,i.columnHeaderLevelCount);(0,a.Z)(l)&&(l=l[0]);let o=null!=(u=i.dataset.collectedValues[l])?u:[],r=i.getColKeysPath(e,t),s=null!=(c=null==o?void 0:o[null!=r?r:""])?c:[],{axisOption:h,isPercent:d,theme:p,chartType:f}=y(e,t-1,"bottom",i);if(!1===(null==h?void 0:h.visible))return;let b=i._table._getCellStyle(e,t-1),v=(0,m.u)((0,C.WJ)("padding",b,e,t-1,i._table));return(0,n.Z)({domain:"linear"===(null==h?void 0:h.type)?void 0:Array.from(s),range:"linear"===(null==h?void 0:h.type)?s:void 0},h,{orient:"bottom",type:null!=(g=null==h?void 0:h.type)?g:"band",__vtableChartTheme:p,__vtablePadding:v})}}}function y(e,t,i,l){var o,r;let n=l.getRawChartSpec(e,t),h=null!=(o=n.axes)?o:[];if(l._table.pivotChartAxes.forEach(e=>{-1===h.findIndex(t=>e.orient===t.orient)&&h.push(e)}),n&&(0,a.Z)(h)){let e=h.find(e=>e.orient===i);if(e){let t,o,{seriesIndex:h,seriesId:d}=e;(0,s.Z)(d)&&(0,a.Z)(n.series)?t=((0,a.Z)(d)?d:[d]).map(e=>{let t=n.series.findIndex(t=>t.id===e);return t>=0&&(o=n.series[t]),t}):(0,s.Z)(h)&&(0,a.Z)(n.series)&&(t=h);let{isZeroAlign:u,isTickAlign:c}=x(n,i,l);return{axisOption:e,isPercent:n.percent,isZeroAlign:u,isTickAlign:c,seriesIndice:t,theme:n.theme,chartType:null!=(r=null==o?void 0:o.type)?r:n.type}}}let d=l._table.pivotChartAxes.find(e=>e.orient===i),{isZeroAlign:u,isTickAlign:c}=x(n,i,l);return{axisOption:d,isPercent:!1,isZeroAlign:u,isTickAlign:c,theme:n.theme,chartType:n.type}}function x(e,t,i){let l,o=[];"left"===t||"right"===t?o.push("left","right"):"top"!==t&&"bottom"!==t||o.push("top","bottom"),l=e&&(0,a.Z)(e.axes)?e.axes:i._table.pivotChartAxes;let r=!1,n=!1;if((0,a.Z)(l)){let e=[];l.forEach(t=>{o.includes(t.orient)&&e.push(t)});for(let t=0;t<e.length;t++){let i=e[t];i.sync&&i.sync.axisId&&e.find(e=>e.id===i.sync.axisId)&&(r=r||i.sync.zeroAlign,n=n||i.sync.tickAlign)}}return{isZeroAlign:r,isTickAlign:n}}function _(e,t,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&t===i.columnHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount||t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return!0}else if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return!0;return!1}function S(e,t,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return!0}else if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount||e===i.colCount-i.rightFrozenColCount&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return!0;return!1}function R(e,t,i,l){if(!(0,a.Z)(e.axes)||0===e.axes.length)return i&&l||!i&&!l;for(let t=0;t<e.axes.length;t++){let o=e.axes[t];if(!i&&l&&"bottom"===o.orient&&"linear"===o.type||i&&l&&"bottom"===o.orient&&"linear"!==o.type||!i&&!l&&"left"===o.orient&&"linear"!==o.type||i&&!l&&"left"===o.orient&&"linear"===o.type)return!0}if((0,a.Z)(t)&&t.length>0)for(let e=0;e<t.length;e++){let o=t[e];if(!i&&l&&"bottom"===o.orient&&"linear"===o.type||i&&l&&"bottom"===o.orient&&"linear"!==o.type||!i&&!l&&"left"===o.orient&&"linear"!==o.type||i&&!l&&"left"===o.orient&&"linear"===o.type)return!0}return i&&l||!i&&!l}function H(e,t,i,l,o,r,n,a,s){let h,d=s.getIndicatorKeyInChartSpec(l,o);h="top"===e||"bottom"===e?s.getColKeysPath(r,n):s.getRowKeysPath(r,n);let u=A(t,i,a,e,d,h,s);if(!u)return;let c="bottom"===e?"top":"top"===e?"bottom":"left"===e?"right":"left",{targetRange:g,targetTicks:p}=F(t,i,u.index,u.isZeroAlign,u.isTickAlign,u.range,d,c,h,s);if(0!==u.index&&p){let{range:t,ticks:i}=b.F.getFunction("getAxisDomainRangeAndLabels")(u.range.min,u.range.max,u.axisOption,u.isZeroAlign,"bottom"===e||"top"===e?s._table.getColWidth(r)||s._table.tableNoFrameWidth:s._table.getRowHeight(n)||s._table.tableNoFrameHeight,{targetTicks:p,targetRange:g});u.range.min=t[0],u.range.max=t[1],u.ticks=i}return u.targetRange=g,u.targetTicks=p,u}function A(e,t,i,l,o,s,h){let{axisOption:d,isPercent:u,isZeroAlign:c,isTickAlign:g,seriesIndice:p,theme:f,chartType:m}=y(e,t,l,h),C=function e(t,i,l,o,r){var s;if((0,a.Z)(r)){let n={min:1/0,max:-1/0};for(let a=0;a<r.length;a++){let s=e(t,i,l,o,r[a]);s&&(n.min=Math.min(n.min,s.min),n.max=Math.max(n.max,s.max))}return isFinite(n.min)&&isFinite(n.max)?n:null}let h=null==i?void 0:i[r];if((0,a.Z)(h)&&(h=h[0]),!h)return null;let d=t[h],u=(0,n.Z)({},null!=(s=null==d?void 0:d[null!=o?o:""])?s:{min:0,max:1});return u.positiveMax&&u.positiveMax>u.max&&(u.max=u.positiveMax),u.negativeMin&&u.negativeMin<u.min&&(u.min=u.negativeMin),u.min===u.max&&(u.min>0?u.min=0:u.max=0),u}(h.dataset.collectedValues,o,c,s,null!=p?p:i);if(!C)return;u&&(C.min=C.min<0?-1:0,C.max=+(C.max>0)),((null==d?void 0:d.zero)||C.min===C.max)&&(C.min=Math.min(C.min,0),C.max=Math.max(C.max,0));let{range:v,ticks:w}=b.F.getFunction("getAxisDomainRangeAndLabels")(C.min,C.max,d,c,"bottom"===l||"top"===l?h._table.getColWidth(e)||h._table.tableNoFrameWidth:h._table.getRowHeight(t)||h._table.tableNoFrameHeight);return(null==d?void 0:d.nice)&&(C.min=v[0],C.max=v[1]),(0,r.Z)(null==d?void 0:d.min)&&(C.min=d.min),(0,r.Z)(null==d?void 0:d.max)&&(C.max=d.max),{index:null!=p?p:i,range:C,ticks:w,isZeroAlign:c,isTickAlign:g,axisOption:d,theme:f,chartType:m}}function M(e,t,i,l,o,r,a,s){let{range:h,isZeroAlign:d,isTickAlign:u,axisOption:c}=A(e,t,i,l,r,a,s),{targetRange:g,targetTicks:p}=F(e,t,i,d,u,h,r,o,a,s);if(0!==i&&p){let{range:i,ticks:o}=b.F.getFunction("getAxisDomainRangeAndLabels")(h.min,h.max,(0,n.Z)({},c,{nice:!0,tick:{forceTickCount:p.length}}),d,"bottom"===l||"top"===l?s._table.getColWidth(e)||s._table.tableNoFrameWidth:s._table.getRowHeight(t)||s._table.tableNoFrameHeight,{targetTicks:p,targetRange:g});h.min=i[0],h.max=i[1]}return{axisOption:c,range:h,targetTicks:p,targetRange:g}}function F(e,t,i,l,o,r,n,a,s,h){let b,m;if(!l&&!o)return{targetTicks:b,targetRange:m};let C=A(e,t,n.length-1-i,a,n,s,h);if(C){let{range:n,ticks:s}=C;if(m=n,l){let e=function(e,t){let i=[e.min,e.max],l=[t.min,t.max];if(!d(i)||!d(l))return;let o=u(i),r=u(l),{positive:n,negative:a,extendable_min:s,extendable_max:h,includeZero:b}=o,{positive:m,negative:C,extendable_min:v,extendable_max:w,includeZero:y}=r;if(0===n&&0===a){if(!g(o,r))return}else if(0===m&&0===C){if(!g(r,o))return}else if(b||y)if(b&&!y){if(!c(o,r))return}else if(y&&!b){if(!c(r,o))return}else{if(a===C)return;if(a>C){if(!p(o,r))return}else if(!p(r,o))return}else{if(0===a&&0===m){if(!f(o,r))return}else if(0===C&&0===n&&!f(r,o))return;if(0===a&&0===C)if(0===i[0]&&l[0]>0){if(!v)return;l[0]=0}else{if(!(0===l[0]&&i[0]>0)||!s)return;i[0]=0}if(0===n&&0===m)if(0===i[1]&&l[1]>0){if(!w)return;l[1]=0}else{if(!(0===l[1]&&i[1]>0)||!h)return;i[1]=0}}return{range1:i,range2:l}}(r,n);e&&(r.min=e.range1[0],r.max=e.range1[1],m.min=e.range2[0],m.max=e.range2[1])}o&&(b=l?(0,v.r)(m,e,t,i,a,h):s)}return{targetTicks:b,targetRange:m}}(l=o||(o={})).vertical="vertical",l.horizontal="horizontal"},61768:function(e,t,i){"use strict";i.d(t,{K0:()=>m,TF:()=>c,TQ:()=>C,VR:()=>f,YL:()=>w,aw:()=>b,eW:()=>p,ed:()=>u,f_:()=>g,py:()=>v});var l=i(43735),o=i(58977),r=i(91212),n=i(51235),a=i(70656),s=i(79229),h=i(53250);let d="NO_AXISID_FRO_VTABLE";function u(e,t,i){var l,o;let r,n=i.getCellHeaderPaths(e,t);if(i.indicatorsAsCol){let e=null==(l=n.colHeaderPaths.find(e=>e.indicatorKey))?void 0:l.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}else{let e=null==(o=n.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:o.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}let a=null==r?void 0:r.chartSpec;return"function"==typeof a?a({col:e,row:t,dataValue:i._table.getCellOriginValue(e,t)||"",value:i._table.getCellValue(e,t)||"",rect:i._table.getCellRangeRelativeRect(i._table.getCellRange(e,t)),table:i._table}):a}function c(e,t,i){var l,o;let r,n=i.getCellHeaderPaths(e,t);if(i.indicatorsAsCol){let e=null==(l=n.colHeaderPaths.find(e=>e.indicatorKey))?void 0:l.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}else{let e=null==(o=n.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:o.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}return"function"!=typeof(null==r?void 0:r.chartSpec)}function g(e,t,i){var l,o;let r,n=i.getCellHeaderPaths(e,t);if(i.indicatorsAsCol){let e=null==(l=n.colHeaderPaths.find(e=>e.indicatorKey))?void 0:l.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}else{let e=null==(o=n.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:o.indicatorKey;r=i.columnObjects.find(t=>t.indicatorKey===e)}return null==r?void 0:r.noDataRenderNothing}function p(e){let t=!1;for(let i=0;i<e.length;i++){let l=e[i];if(l.chartSpec&&"wordCloud"!==l.chartSpec.type&&"radar"!==l.chartSpec.type&&"gauge"!==l.chartSpec.type&&"pie"!==l.chartSpec.type&&"funnel"!==l.chartSpec.type&&"rose"!==l.chartSpec.type){t=!0;break}}return t}function f(e,t,i){let l=!0,o=i.getRawChartSpec(e,t);return o&&"pie"!==o.type&&"radar"!==o.type&&"gauge"!==o.type&&"wordCloud"!==o.type&&"funnel"!==o.type&&"rose"!==o.type||(l=!1),l}function b(e,t,i,l){let o=!1;if(l.indicatorsAsCol&&"row"===i||!l.indicatorsAsCol&&"col"===i)for(let e=0;e<l.indicatorsDefine.length;e++){let t=l.indicatorsDefine[e];if(t.chartSpec&&"pie"!==t.chartSpec.type&&"wordCloud"!==t.chartSpec.type&&"radar"!==t.chartSpec.type&&"gauge"!==t.chartSpec.type&&"funnel"!==t.chartSpec.type&&"rose"!==t.chartSpec.type){o=!0;break}}else{let i=l.getRawChartSpec(e,t);i?"pie"!==i.type&&"radar"!==i.type&&"gauge"!==i.type&&"wordCloud"!==i.type&&"funnel"!==i.type&&"rose"!==i.type&&(o=!0):o=!1}return o}function m(e,t,i){let o=i.getRawChartSpec(e,t);return o?(i._table.isPivotChart()&&((o=(0,a.u)(o)).sortDataByAxis=!0,(0,l.Z)(o.series)&&o.series.forEach(e=>{e.sortDataByAxis=!0}),"gauge"!==o.type&&"rose"!==o.type&&"radar"!==o.type&&(o.axes=i.getChartAxes(e,t)),o.padding=0,o.dataZoom=[]),o):null}function C(e,t,i){var a,u,c;let g=[];if(i.indicatorsAsCol){let u=i.getIndicatorKeyInChartSpec(e,t),c=i.getColKeysPath(e,t);u.forEach((l,a)=>{let{range:p,targetTicks:f,targetRange:b,axisOption:m}=(0,n.V4)(e,t,a,0===a?"bottom":"top",0===a?"top":"bottom",u,c,i);(0,o.Z)(null==m?void 0:m.min)&&(p.min=m.min),(0,o.Z)(null==m?void 0:m.max)&&(p.max=m.max),y(m,g)||g.push((0,r.Z)({range:p,label:{style:{fontSize:s.$M}}},m,{type:(null==m?void 0:m.type)||"linear",orient:0===a?"bottom":"top",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==m?void 0:m.seriesId)?void 0:a,tick:{tickMode:(0,h.h)(f,b,p,a)},sync:{axisId:d}}))});let p=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,t);(0,l.Z)(p)&&(p=p[0]);let f=i.dataset.cacheCollectedValues[p]||i.dataset.collectedValues[p]||[],b=i.getRowKeysPath(e,t),m=f[null!=b?b:""],{axisOption:C,isPercent:v,chartType:w}=(0,n.dK)(e,t,"left",i);g.push((0,r.Z)({domain:"linear"!==(null==C?void 0:C.type)||Array.isArray(m)?Array.from(null!=m?m:[]):void 0,range:"linear"!==(null==C?void 0:C.type)||Array.isArray(m)?void 0:m,label:{style:{fontSize:s.$M}}},C,{type:null!=(a=null==C?void 0:C.type)?a:"band",orient:"left",label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}else{let a=i.getIndicatorKeyInChartSpec(e,t),p=i.getRowKeysPath(e,t);a.forEach((l,u)=>{let{range:c,targetTicks:f,targetRange:b,axisOption:m}=(0,n.V4)(e,t,u,0===u?"left":"right",0===u?"right":"left",a,p,i);(0,o.Z)(null==m?void 0:m.min)&&(c.min=m.min),(0,o.Z)(null==m?void 0:m.max)&&(c.max=m.max),y(m,g)||g.push((0,r.Z)({range:c,label:{style:{fontSize:s.$M}}},m,{type:(null==m?void 0:m.type)||"linear",orient:0===u?"left":"right",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==m?void 0:m.seriesId)?void 0:u,tick:{tickMode:(0,h.h)(f,b,c,u)},sync:{axisId:d}}))});let f=i.getDimensionKeyInChartSpec(e,i.columnHeaderLevelCount);(0,l.Z)(f)&&(f=f[0]);let b=i.dataset.cacheCollectedValues[f]||i.dataset.collectedValues[f]||[],m=i.getColKeysPath(e,t),C=null!=(u=null==b?void 0:b[null!=m?m:""])?u:[],{axisOption:v,isPercent:w,chartType:x}=(0,n.dK)(e,t,"bottom",i);g.push((0,r.Z)({domain:"linear"!==(null==v?void 0:v.type)||Array.isArray(C)?Array.from(null!=C?C:[]):void 0,range:"linear"!==(null==v?void 0:v.type)||Array.isArray(C)?void 0:C,label:{style:{fontSize:s.$M}}},v,{type:null!=(c=null==v?void 0:v.type)?c:"band",orient:"bottom",visible:!0,label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}return g}function v(e,t,i){var l;let o=i.getRawChartSpec(e,t);if(null==o?void 0:o.series){let e={};return(null==(l=o.data)?void 0:l.id)&&(e[o.data.id]=void 0),null==o||o.series.forEach(t=>{var i,l,r,n,a,s,h,d,u,c,g;if(!(null==(i=t.data)?void 0:i.fromDataId))if(null==(l=t.data)?void 0:l.transforms)e[null!=(g=null!=(u=null==(d=t.data)?void 0:d.id)?u:null==(c=o.data)?void 0:c.id)?g:"data"]=void 0;else{let i="horizontal"===t.direction?t.xField:t.yField;e[null!=(s=null!=(n=null==(r=t.data)?void 0:r.id)?n:null==(a=o.data)?void 0:a.id)?s:"data"]=(null==(h=t.data)?void 0:h.id)?i:void 0}}),e}return o.data.id}function w(e){let t=!1;for(let i=0;i<e.columnObjects.length;i++)if(e.columnObjects[i].chartSpec){t=!0;break}return t}function y(e,t){return!!(e&&(0,l.Z)(e.seriesId))&&!!(e.seriesId.length>0)&&!!(t.filter(t=>!(t.orient!==e.orient||!t.seriesId||t.seriesId.length!==e.seriesId.length||!t.seriesId.every((t,i)=>t===e.seriesId[i]))).length>0)}},53250:function(e,t,i){"use strict";i.d(t,{h:()=>n,r:()=>r});var l=i(75025),o=i(51235);function r(e,t,i,r,n,a){let s=l.F.getFunction("getAxisDomainRangeAndLabels"),{axisOption:h,isZeroAlign:d}=(0,o.dK)(t,i,0===r?"right":"left",a),{ticks:u}=s(e.min,e.max,h,d,"bottom"===n||"top"===n?a._table.getColWidth(t)||a._table.tableNoFrameWidth:a._table.getRowHeight(i)||a._table.tableNoFrameHeight);return u}function n(e,t,i,l){return 0!==l&&e?()=>e.map(e=>{let l=(e-t.min)/(t.max-t.min);return Math.round(100*((i.max-i.min)*l+i.min))/100}):void 0}},43221:function(e,t,i){"use strict";i.d(t,{C1:()=>d,MP:()=>a,N3:()=>u,OT:()=>s,Ul:()=>c,VN:()=>g,WM:()=>h,uu:()=>p});var l=i(43735),o=i(58853),r=i(21264),n=i(20901);function a(e){let t=e.columnObjects;for(let e=0;e<t.length;e++){let i=t[e];if(null==i?void 0:i.aggregation)return!0}return!1}function s(e){let t=e.columnObjects,i=0;for(let e=0;e<t.length;e++){let l=t[e];(null==l?void 0:l.aggregation)&&(Array.isArray(null==l?void 0:l.aggregation)?i=Math.max(i,l.aggregation.filter(e=>e.showOnTop).length):l.aggregation.showOnTop&&(i=Math.max(i,1)))}return i}function h(e){let t=e.columnObjects,i=0;for(let e=0;e<t.length;e++){let l=t[e];(null==l?void 0:l.aggregation)&&(Array.isArray(null==l?void 0:l.aggregation)?i=Math.max(i,l.aggregation.filter(e=>!e.showOnTop).length):l.aggregation.showOnTop||(i=Math.max(i,1)))}return i}function d(e){if(e._table.internalProps.groupBy)return!0;let{columns:t}=e._table.options;if((0,l.Z)(t)&&t.length>0)for(let e=0;e<t.length;e++){let i=t[e];if(!(0,o.Z)(i)&&i.tree)return!0}return!1}function u(e){let{columns:t,rows:i,indicators:r}=e.options;if(e.isPivotTable()){if((0,l.Z)(t)&&t.length>0)for(let e=0;e<t.length;e++){let i=t[e];if(!(0,o.Z)(i)&&("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}if((0,l.Z)(i)&&i.length>0)for(let e=0;e<i.length;e++){let t=i[e];if(!(0,o.Z)(t)&&("image"===t.headerType||"video"===t.headerType||"function"==typeof t.headerType)&&t.imageAutoSizing)return!0}if((0,l.Z)(r)&&r.length>0)for(let e=0;e<r.length;e++){let t=r[e];if(!(0,o.Z)(t)&&(("image"===t.cellType||"video"===t.cellType||"function"==typeof t.cellType)&&t.imageAutoSizing||("image"===t.headerType||"video"===t.headerType||"function"==typeof t.headerType)&&t.imageAutoSizing))return!0}}else if((0,l.Z)(t)&&t.length>0)for(let e=0;e<t.length;e++){let i=t[e];if(("image"===i.cellType||"video"===i.cellType||"function"==typeof i.cellType)&&i.imageAutoSizing||("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}return!1}function c(e,t){var i,l,o,a,s,h,d,u,c,p,f,b,m,C,v;let w,y;t.columnTree&&(!1!==e.options.indicatorsAsCol&&!1!==e.options.supplementIndicatorNodes&&(e.internalProps.columnTree=g(e.internalProps.columnTree,t.indicators)),w=new n.KO(null!=(i=e.internalProps.columnTree)?i:[],e.layoutNodeId,e.options.columnHierarchyType,"grid"!==e.options.columnHierarchyType?null!=(l=e.options.columnExpandLevel)?l:1:void 0)),t.rowTree&&(!1===e.options.indicatorsAsCol&&!1!==e.options.supplementIndicatorNodes&&(e.internalProps.rowTree=g(e.internalProps.rowTree,t.indicators)),y=new n.KO(null!=(o=e.internalProps.rowTree)?o:[],e.layoutNodeId,e.options.rowHierarchyType,"grid"!==e.options.rowHierarchyType?null!=(a=e.options.rowExpandLevel)?a:1:void 0));let x=(null==(s=null==y?void 0:y.dimensionKeys)?void 0:s.count)?y.dimensionKeys.valueArr():null!=(d=null==(h=t.rows)?void 0:h.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?d:[],_=(null==(u=null==w?void 0:w.dimensionKeys)?void 0:u.count)?w.dimensionKeys.valueArr():null!=(p=null==(c=t.columns)?void 0:c.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?p:[],S=null!=(b=null==(f=t.indicators)?void 0:f.reduce((t,i)=>{var l;return"string"==typeof i?t.push(i):(t.push(i.indicatorKey),(i.chartSpec||i.sparklineSpec)&&((null==(l=e.internalProps.dataConfig)?void 0:l.aggregationRules)?e.internalProps.dataConfig.aggregationRules.find(e=>e.indicatorKey===i.indicatorKey)||e.internalProps.dataConfig.aggregationRules.push({field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:r.E.NONE}):e.internalProps.dataConfig?e.internalProps.dataConfig.aggregationRules=[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:r.E.NONE}]:e.internalProps.dataConfig={aggregationRules:[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:r.E.NONE}]})),t},[]))?b:[];return"grid"!==t.rowHierarchyType&&(null!=(C=null==(m=t.extensionRows)?void 0:m.length)?C:0)>=1&&(null==(v=t.extensionRows)||v.forEach(e=>{let t=[];e.rows.forEach(e=>{"string"==typeof e?t.push(e):t.push(e.dimensionKey)}),x.push(...t)})),{rowKeys:x,columnKeys:_,indicatorKeys:S,columnDimensionTree:w,rowDimensionTree:y}}function g(e,t){let i=(e,l)=>{e.forEach(e=>{var o;e.indicatorKey||l||(null==(o=e.children)?void 0:o.length)&&e.children?e.children&&Array.isArray(e.children)&&i(e.children,l||!!e.indicatorKey):e.children=null==t?void 0:t.map(e=>{var t;return"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}})})};return(null==e?void 0:e.length)?i(e,!1):e=null==t?void 0:t.map(e=>{var t;return"string"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}}),e}function p(e,t,i,l){let o=[];for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];(null==i?void 0:i.hide)&&o.push(i)}(o.length||i)&&(0,n.gD)(e,[],o,i,l)}},2714:function(e,t,i){"use strict";i.d(t,{z:()=>p});var l=i(28071),o=i(12348),r=i(90251),n=i(61768),a=i(20901),s=i(43735),h=i(19465),d=i(18585),u=i(37811),c=i(75025);let g={startInTotal:0,afterSpanLevel:0};class p{constructor(e,t,i,o){var n,a,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=r.ek,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,this._table=e,"tree"===e.options.rowHierarchyType&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=null!=(n=e.internalProps.rows)?n:[],this.columnsDefine=null!=(a=e.internalProps.columns)?a:[],this.indicatorsDefine=null!=(h=e.internalProps.indicators)?h:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=null==(d=e.options.indicatorsAsCol)||d,this.hideIndicatorName=null!=(u=e.options.hideIndicatorName)&&u,this.showRowHeader=null==(c=e.options.showRowHeader)||c,this.showColumnHeader=null==(g=e.options.showColumnHeader)||g,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=null!=(p=e.options.rowHierarchyType)?p:"grid",this.columnHierarchyType=null!=(f=e.options.columnHierarchyType)?f:"grid",this.rowExpandLevel=null!=(b=e.options.rowExpandLevel)?b:1,this.columnExpandLevel=null!=(m=e.options.columnExpandLevel)?m:1,this.rowHierarchyIndent=null!=(C=e.options.rowHierarchyIndent)?C:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},e.options.corner),(null==(w=null==(v=this._table.options)?void 0:v.customConfig)?void 0:w.enablePivotPathCache)&&(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),null==(y=this.indicatorsDefine)||y.forEach(e=>{"string"==typeof e?this.indicatorKeys.push(e):this.indicatorKeys.push(e.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=o,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(e=>{var t,i;if(e.chartSpec&&e.chartSpec.series&&e.chartSpec.series.length>1){let l=null!=(i=null!=(t=e.chartSpec.axes)?t:this._table.pivotChartAxes)?i:[];if(!l.length||l.every(e=>e.orient!==(this.indicatorsAsCol?"top":"right")||!1!==e.visible))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,l.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===e.options.rowHierarchyType&&(null==(x=this.extensionRows)?void 0:x.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(e=>{let t=[];e.rows.forEach(e=>{"string"==typeof e?t.push(e):t.push(e.dimensionKey)}),this._extensionRowDimensionKeys.push(t),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(t)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let M,F=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||0!==(null!=(S=null==(_=this.dataset.records)?void 0:_.length)?S:0)||this.dataset.customColTree||(F=this.columnsDefine.map(e=>"string"==typeof e?e:e.dimensionKey),this.indicatorsAsCol&&F.push(this.indicatorDimensionKey)),F=this.columnHeaderTitle?[""].concat(F):F;let B=[];if("tree"===this.rowHierarchyType&&(null==(R=this.extensionRows)?void 0:R.length)>=1){let e=[];e.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(t=>{e.push(t[0])}),B=this.extensionRows.reduce((e,t)=>e.concat(t.rows),[]),M=this.rowHeaderTitle?[""].concat(e):e}else M=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||0!==(null!=(A=null==(H=this.dataset.records)?void 0:H.length)?A:0)||this.dataset.customRowTree||(M=this.rowsDefine.map(e=>"string"==typeof e?e:e.dimensionKey),this.indicatorsAsCol||M.push(this.indicatorDimensionKey)),M=this.rowHeaderTitle?[""].concat(M):M;this.cornerHeaderObjs=this._addCornerHeaders(F,M,this.columnsDefine.concat(...this.rowsDefine,...B)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(e=>{var t,i,l,o,r,n,a,h;(null==(t=null==e?void 0:e.style)?void 0:t.padding)&&(this._chartPadding=e.style.padding),(null==(i=e.chartSpec)?void 0:i.barWidth)&&"number"==typeof e.chartSpec.barWidth&&(this._chartItemSpanSize=null==(l=e.chartSpec)?void 0:l.barWidth);let d=null==(r=null==(o=e.chartSpec)?void 0:o.axes)?void 0:r.find(e=>"band"===e.type);return(null==d?void 0:d.bandSize)&&(this._chartItemBandSize=null==d?void 0:d.bandSize,this._chartPaddingInner=null!=(n=(0,s.Z)(d.paddingInner)?d.paddingInner[0]:d.paddingInner)?n:0,this._chartPaddingOuter=null!=(a=(0,s.Z)(d.paddingOuter)?d.paddingOuter[0]:d.paddingOuter)?a:0),this._chartItemSpanSize>0||(null==(h=e.chartSpec.series)||h.find(e=>(e.barWidth&&"number"==typeof e.barWidth&&(this._chartItemSpanSize=e.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(e=>{var t;return{id:"",title:e.title,define:e,cellType:null!=(t=e.cellType)?t:"text",headerType:e.cellType&&"radio"!==e.cellType?e.cellType:"text",width:e.width,style:e.style,format:e.format,field:e.field,icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:"",title:e.title,define:e,cellType:null!=(t=e.cellType)?t:"text",headerType:e.cellType&&"radio"!==e.cellType?e.cellType:"text",style:e.style,width:e.width,format:e.format,field:"",icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t,i,l,o,r,n,a;if((null==(e=this.columnDimensionTree.tree.children)?void 0:e.length)>=1)if("grid-tree"===this.columnHierarchyType)this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1);else{let e=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(t=this.dataset.records)?void 0:t.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this._getColumnHeaderTreeExpandedMaxLevelCount()<this.columnHeaderLevelCount){e=this.columnHeaderLevelCount-this._getColumnHeaderTreeExpandedMaxLevelCount();for(let t=0;t<e;t++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,e,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let e=++this.sharedVar.seqId,t=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(e);this._columnHeaderCellFullPathIds.unshift(t);let i={id:e,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(o=null==(l=this.columnHeaderTitle)?void 0:l.headerType)?o:"text",style:null==(r=this.columnHeaderTitle)?void 0:r.headerStyle,define:{id:e,disableHeaderHover:!!(null==(n=this.columnHeaderTitle)?void 0:n.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(i),this._headerObjects[e]=i}}_generateRowHeaderIds(){var e,t,i,l,o,r,n,a,s,h;if((null==(e=this.rowDimensionTree.tree.children)?void 0:e.length)>=1)if("tree"===this.rowHierarchyType)this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else if("grid-tree"===this.rowHierarchyType)this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0);else{let e=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(t=this.dataset.records)?void 0:t.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this._getRowHeaderTreeExpandedMaxLevelCount()<this.rowHeaderLevelCount){e=this.rowHeaderLevelCount-this._getRowHeaderTreeExpandedMaxLevelCount();for(let t=0;t<e;t++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,e,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let e=++this.sharedVar.seqId,t=Array(null!=(o=null==(l=this._rowHeaderCellFullPathIds_FULL[0])?void 0:l.length)?o:this.rowDimensionTree.tree.size).fill(e);this._rowHeaderCellFullPathIds_FULL.unshift(t);let i={id:e,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(n=null==(r=this.rowHeaderTitle)?void 0:r.headerType)?n:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{id:e,disableHeaderHover:!!(null==(s=this.rowHeaderTitle)?void 0:s.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[e]=i}}_getRowHeaderTreeExpandedMaxLevelCount(){return"tree"===this.rowHierarchyType?1:"grid-tree"===this.rowHierarchyType?"row"===this.cornerSetting.titleOnDimension?this.rowDimensionTree.totalLevel:this.indicatorsAsCol?this.rowDimensionTree.expandedMaxLevel:this.rowDimensionTree.expandedMaxLevel+1:this.rowDimensionTree.totalLevel}_getColumnHeaderTreeExpandedMaxLevelCount(){return"grid-tree"===this.columnHierarchyType?"column"===this.cornerSetting.titleOnDimension?this.columnDimensionTree.totalLevel:!1===this.indicatorsAsCol?this.columnDimensionTree.expandedMaxLevel:this.columnDimensionTree.expandedMaxLevel+1:this.columnDimensionTree.totalLevel}_addHeaders(e,t,i,l,o){let r=this;e[t]||function(t){let i=e[t]=[];if(0===r.colIndex)return;let l=e[t-1];for(let e=0;e<(null==l?void 0:l.length);e++)i[e]=l[e]}(t);for(let r=0;r<i.length;r++){let n=i[r];(0,a.g3)(n,e,o,l,t,this)}}_addHeadersForTreeMode(e,t,i,l,o,r,n,s){let h=this;e[t]||function(t){let i=e[t]=[];if(0===h.colIndex)return;let l=e[t-1];for(let e=0;e<(null==l?void 0:l.length);e++)i[e]=l[e]}(t);for(let h=0;h<i.length;h++){let d=i[h];(0,a.py)(d,e,s,l,t,o,r,n,this)}}_addHeadersForGridTreeMode(e,t,i,l,o,r,n,s,h,d){let u=this;e[t]||function(t){let i=e[t]=[];if(0===u.colIndex)return;let l=e[t-1];for(let e=0;e<(null==l?void 0:l.length);e++)i[e]=l[e]}(t);for(let u=0;u<i.length;u++){let c=i[u];(0,a.jS)(c,e,h,l,t,o,r,n,s,d,this.indicatorsAsCol,this)}}_addCornerHeaders(e,t,i){var l,o,r,n,a,s,h,d,u,c;this._cornerHeaderCellFullPathIds=[];let g=[],p="grid-tree"===this.columnHierarchyType&&this._getColumnHeaderTreeExpandedMaxLevelCount()||this.columnHeaderLevelCount,f="grid-tree"===this.rowHierarchyType&&this._getRowHeaderTreeExpandedMaxLevelCount()||this.rowHeaderLevelCount;if(0===p||0===f)return g;if("all"===this.cornerSetting.titleOnDimension)if(this.indicatorsAsCol){if(e)for(let t=0;t<p;t++){let r=e[t],n=++this.sharedVar.seqId,a=i.find(e=>"string"!=typeof e&&e.dimensionKey===r),s={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(l=this.cornerSetting.headerType)?l:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==a?void 0:a.title)?o:"",dimensionKey:r,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};g[n]=s,this._headerObjects[n]=s,this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]);for(let e=0;e<f;e++)this._cornerHeaderCellFullPathIds[t][e]=n}if(t)for(let e=0;e<f;e++){let l=t[e],o=++this.sharedVar.seqId,a=i.find(e=>"string"!=typeof e&&e.dimensionKey===l),s={id:o,title:l===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===l?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:null!=(r=this.cornerSetting.headerType)?r:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:l,id:o,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(n=null==a?void 0:a.title)?n:"",dimensionKey:l,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};g[o]=s,this._headerObjects[o]=s,this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]||(this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]=[]),this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1][e]=o}}else{if(t)for(let e=0;e<f;e++){let l=t[e],o=++this.sharedVar.seqId,r=i.find(e=>"string"!=typeof e&&e.dimensionKey===l),n={id:o,title:l===this.indicatorDimensionKey?this.indicatorTitle:r?r.title:"axis"===l?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:null!=(a=this.cornerSetting.headerType)?a:"text",showSort:null==r?void 0:r.showSortInCorner,sort:null==r?void 0:r.sort,define:{showSort:null==r?void 0:r.showSortInCorner,sort:null==r?void 0:r.sort,dimensionKey:l,id:o,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==r?void 0:r.cornerDropDownMenu,headerIcon:null==r?void 0:r.cornerHeaderIcon,pivotInfo:{value:null!=(s=null==r?void 0:r.title)?s:"",dimensionKey:l,isPivotCorner:!0},description:null==r?void 0:r.cornerDescription};g[o]=n,this._headerObjects[o]=n;for(let t=0;t<p;t++)this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]),this._cornerHeaderCellFullPathIds[t][e]=o}if(e)for(let t=0;t<p;t++){let l=e[t],o=++this.sharedVar.seqId,r=i.find(e=>"string"!=typeof e&&e.dimensionKey===l),n={id:o,title:l===this.indicatorDimensionKey?this.indicatorTitle:r?r.title:"axis"===l?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:null!=(h=this.cornerSetting.headerType)?h:"text",showSort:null==r?void 0:r.showSortInCorner,sort:null==r?void 0:r.sort,define:{showSort:null==r?void 0:r.showSortInCorner,sort:null==r?void 0:r.sort,dimensionKey:l,id:o,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==r?void 0:r.cornerDropDownMenu,headerIcon:null==r?void 0:r.cornerHeaderIcon,pivotInfo:{value:null!=(d=null==r?void 0:r.title)?d:"",dimensionKey:l,isPivotCorner:!0},description:null==r?void 0:r.cornerDescription};g[o]=n,this._headerObjects[o]=n,this._cornerHeaderCellFullPathIds[t][this._cornerHeaderCellFullPathIds[t].length-1]=o}}else if("row"===this.cornerSetting.titleOnDimension||"column"===this.cornerSetting.titleOnDimension){let l="row"===(null==(u=this.cornerSetting)?void 0:u.titleOnDimension)?t:e;l&&l.forEach((e,t)=>{var l,o;let r=++this.sharedVar.seqId,n=i.find(t=>"string"!=typeof t&&t.dimensionKey===e),a={id:r,title:e===this.indicatorDimensionKey?this.indicatorTitle:n?n.title:"axis"===e?"":e,field:e,style:this.cornerSetting.headerStyle,headerType:null!=(l=this.cornerSetting.headerType)?l:"text",showSort:null==n?void 0:n.showSortInCorner,sort:null==n?void 0:n.sort,define:{showSort:null==n?void 0:n.showSortInCorner,sort:null==n?void 0:n.sort,dimensionKey:e,id:r,value:e,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==n?void 0:n.cornerDropDownMenu,headerIcon:null==n?void 0:n.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==n?void 0:n.title)?o:"",dimensionKey:e,isPivotCorner:!0},description:null==n?void 0:n.cornerDescription};if(g[r]=a,this._headerObjects[r]=a,"column"===this.cornerSetting.titleOnDimension){this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]);for(let e=0;e<this.rowHeaderLevelCount;e++)this._cornerHeaderCellFullPathIds[t][e]=r}else if("row"===this.cornerSetting.titleOnDimension)for(let e=0;e<this.columnHeaderLevelCount;e++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][t]=r})}else{let e=++this.sharedVar.seqId,t={id:e,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:null!=(c=this.cornerSetting.headerType)?c:"text",define:{dimensionKey:"维度名称",id:e,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};g[e]=t,this._headerObjects[e]=t;for(let t=0;t<this.columnHeaderLevelCount;t++)for(let i=0;i<this.rowHeaderLevelCount;i++)this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]),this._cornerHeaderCellFullPathIds[t][i]=e}return g}generateExtensionRowTree(){this.extensionRows.forEach((e,t)=>{let i=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],i.forEach((t,i)=>{let l,o,r=t[t.length-1];if(this.colIndex=0,"function"==typeof e.rowTree){let i=this.findFullCellIds(t);l=e.rowTree(i.map(e=>({dimensionKey:this._headerObjects[e].field,value:this._headerObjects[e].title})))}else l=(0,h.Z)(e.rowTree);this._rowHeaderExtensionTree[r]?(this._rowHeaderExtensionTree[r].reset(this._rowHeaderExtensionTree[r].tree.children),o=this._rowHeaderExtensionTree[r]):(o=new a.KO(null!=l?l:[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[r]=o);let n=[];this._addHeadersForTreeMode(n,0,o.tree.children,[],o.totalLevel,!0,e.rows,this.rowHeaderObjs);for(let e=0;e<n[0].length;e++)this._rowHeaderCellFullPathIds_FULL.push(t.concat(n[0][e]))})})}setColumnWidths(){var e,t,i;let l=Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(l[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(l[0+this.leftRowSeriesNumberColumnCount]={}),"tree"===this.rowHierarchyType){let i=this.rowDimensionKeys[0];if(i){let t=null==(e=this.rowsDefine)?void 0:e.find(e=>"string"!=typeof e&&e.dimensionKey===i);t&&(l[0+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth})}null==(t=this._extensionRowDimensionKeys)||t.forEach((e,t)=>{var i;let o=e[0];if(o){let e=null==(i=this.extensionRows[t].rows)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===o);e&&(l[t+1+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(e=>"string"==typeof e?e:e.dimensionKey)).forEach((e,t)=>{var i;let o=null==(i=this.rowsDefine)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===e);o&&(l[t+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:o.width,minWidth:o.minWidth,maxWidth:o.maxWidth})});if(this.indicatorsAsCol)for(let e=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;e<this.colCount;e++){let t=this.getBody(e,this.columnHeaderLevelCount);l[e]={width:null==t?void 0:t.width,minWidth:null==t?void 0:t.minWidth,maxWidth:null==t?void 0:t.maxWidth}}else{let e,t,o,r=0;null==(i=this._indicators)||i.forEach((i,l)=>{var n,a;"number"==typeof i.width?r=Math.max(i.width,r):"auto"===i.width&&(o=!0),"number"==typeof i.minWidth&&(t=Math.max(i.minWidth,null!=(n=t)?n:0)),"number"==typeof i.maxWidth&&(e=Math.min(i.maxWidth,null!=(a=e)?a:Number.MAX_VALUE))}),r=r>0?r:o?"auto":void 0,l.fill({width:r,minWidth:t,maxWidth:e},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=l}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?"cornerHeader":this.isColumnHeader(e,t)?"columnHeader":this.isRowHeader(e,t)?"rowHeader":"body"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=0&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return e>=0&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if((0,d.Z)(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if((0,d.Z)(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if((0,d.Z)(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if((0,d.Z)(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=0&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var e,t,i,l,o,r,a,s,h,d,u;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(null==(t=null==(e=this.dataset)?void 0:e.colKeys)?void 0:t.length)&&0===(null==(l=null==(i=this.columnDimensionTree)?void 0:i.tree)?void 0:l.level)&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let c=this._getColumnHeaderTreeExpandedMaxLevelCount();return this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey&&c--,0!==c||!this.dataset||(null==(o=this.dataset.customColTree)?void 0:o.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(d=null==(h=this.dataset.records)?void 0:h.length)?d:0)||this.dataset.customColTree||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(u=this.columnsDefine.length)?u:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++):("row"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||0!==(null!=(a=null==(r=this.dataset.records)?void 0:r.length)?a:0)||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(s=this.columnsDefine.length)?s:0),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&(0,n.eW)(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?+!this.hideIndicatorName:0}resetRowHeaderLevelCount(){var e,t,i,l,o,r,n,a;if(this.showHeader&&this.showRowHeader){if("tree"===this.rowHierarchyType){let i=null!=(t=null==(e=this.extensionRows)?void 0:e.length)?t:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=1+ +!!this.rowDimensionTree.totalLevel+i):void(this.rowHeaderLevelCount=+!!this.rowDimensionTree.totalLevel+i)}let s=this._getRowHeaderTreeExpandedMaxLevelCount(),h=s;return 0!==h||!this.dataset||(null==(i=this.dataset.customRowTree)?void 0:i.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(a=null==(n=this.dataset.records)?void 0:n.length)?a:0)||this.dataset.customRowTree||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(h=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||h++):("column"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?h=1:this._table.isPivotChart()||0!==(null!=(o=null==(l=this.dataset.records)?void 0:l.length)?o:0)||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(h=null!=(r=this.rowsDefine.length)?r:0),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(h=s-1),this.rowHeaderTitle&&(h+=1),void(this.rowHeaderLevelCount=h)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e,t,i,l;return(this._getColumnHeaderTreeExpandedMaxLevelCount()>0||this._table.isPivotChart()||(null==(e=this.dataset.records)?void 0:e.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?(null!=(i=null==(t=this._columnHeaderCellIds[0])?void 0:t.length)?i:this.columnDimensionTree.tree.size)||+((null==(l=this._indicators)?void 0:l.length)>0):0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e,t,i,l;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&(null==(e=this._indicators)?void 0:e.length)>0&&!(null==(t=this._rowHeaderCellIds)?void 0:t.length)?1:null!=(l=null==(i=this._rowHeaderCellIds)?void 0:i.length)?l:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&(0,n.eW)(this.indicatorsDefine)){let e=this._table.pivotChartAxes.find(e=>"bottom"===e.orient);return!1===(null==e?void 0:e.visible)?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;let e=this._table.pivotChartAxes.find(e=>"right"===e.orient);return!1===(null==e?void 0:e.visible)||this.indicatorsAsCol?0:+!!this.hasTwoIndicatorAxes}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var i,l,o,r,n;if(t>=0&&e>=0){if(this.isSeriesNumber(e,t))return"";if(this.isCornerHeader(e,t))return null==(i=this._cornerHeaderCellIds[t])?void 0:i[e-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(e,t))return null==(l=this._columnHeaderCellIds[t])?void 0:l[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(e,t))return null==(o=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])?void 0:o[e-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(e,t))return null==(r=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])?void 0:r[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(e,t))return null==(n=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])?void 0:n[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(e,t){var i;if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);let l=this.getCellId(e,t);return null!=(i=this._headerObjectMap[l])?i:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(e,t){var i,l;let o=this.getCellId(e,t);return(null==(i=this._headerObjectMap[o])?void 0:i.field)||(null==(l=this.getBody(e,t))?void 0:l.field)}getHeaderCellAdressById(e){for(let t=0;t<this._columnHeaderCellIds.length;t++){let i=this._columnHeaderCellIds[t];for(let l=0;l<i.length;l++)if(i[l]===e)return{col:l+this._table.frozenColCount,row:t}}for(let t=0;t<this._rowHeaderCellIds.length;t++){let i=this._rowHeaderCellIds[t];for(let l=0;l<i.length;l++)if(i[l]===e)return{col:l,row:t+this._table.frozenRowCount}}for(let t=0;t<this._cornerHeaderCellIds.length;t++){let i=this._cornerHeaderCellIds[t];for(let l=0;l<i.length;l++)if(i[l]===e)return{col:l,row:t}}}getHeaderCellAddressByField(e){let t=this.headerObjects.find(t=>t&&t.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){var i,l,o,r,n,a,s,h,u,c;let g=this.getBodyWidthCache(e,t);if(g)return g;if(this.isSeriesNumber(e,t)){let i=this.getSeriesNumberBody(e,t);return this.setBodyWidthCache(e,t,i),i}let p=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){let a=null==(l=null==(i=p.colHeaderPaths)?void 0:i.find(e=>e.indicatorKey))?void 0:l.indicatorKey,s=(0,d.Z)(a)&&null!=(n=null!=(r=null==(o=this._indicators)?void 0:o.find(e=>e.indicatorKey===a))?r:this._indicators[0])?n:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,s),s}let f=null==(s=null==(a=p.rowHeaderPaths)?void 0:a.find(e=>e.indicatorKey))?void 0:s.indicatorKey,b=(0,d.Z)(f)&&null!=(c=null!=(u=null==(h=this._indicators)?void 0:h.find(e=>e.indicatorKey===f))?u:this._indicators[0])?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,b),b}getCellRange(e,t){var i,l;let o={start:{col:e,row:t},end:{col:e,row:t}};if(!this.isHeader(e,t)||-1===e||-1===t||this.isRightFrozenColumn(e,t)||this.isBottomFrozenRow(e,t))return o;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(e,t))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let i=0;i<this._largeCellRangeCache.length;i++){let l=this._largeCellRangeCache[i];if(e>=l.start.col&&e<=l.end.col&&t>=l.start.row&&t<=l.end.row)return l}if(this.isHeader(e,t)&&-1!==e&&-1!==t){let r=this.getCellId(e,t);for(let i=e-1;i>=0&&r===this.getCellId(i,t);i--)o.start.col=i;for(let l=e+1;l<(null!=(i=this.colCount)?i:0)&&r===this.getCellId(l,t);l++)o.end.col=l;for(let i=t-1;i>=0&&r===this.getCellId(e,i);i--)o.start.row=i;for(let i=t+1;i<(null!=(l=this.rowCount)?l:0)&&!(r!==this.getCellId(e,i)||this.isSeriesNumberInHeader(e,t)&&i>=this.columnHeaderLevelCount);i++)o.end.row=i}return(o.end.col-o.start.col>100||o.end.row-o.start.row>100)&&this._largeCellRangeCache.push(o),o}isCellRangeEqual(e,t,i,l){let o=this.getCellRange(e,t),r=this.getCellRange(i,l);return o.start.col===r.start.col&&o.end.col===r.end.col&&o.start.row===r.start.row&&o.end.row===r.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let i=0;i<this._largeCellRangeCache.length;i++){let l=this._largeCellRangeCache[i];if(e>=l.start.col&&e<=l.end.col&&t>=l.start.row&&t<=l.end.row)break}let i=this.getColHeaderPathCache(e,t),l=this.getRowHeaderPathCache(e,t),o=this.getBodyIndexByCol(e),r=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!i&&t>=0&&o>=0){if(i=[],"grid-tree"===this.columnHierarchyType){let e=[];this._columnHeaderCellFullPathIds.map(t=>{e.push(t[o])});let t=this.getTreePathByCellIds(e);i.push(...t)}else i=this.columnDimensionTree.getTreePath(o,this.showHeader&&this.showColumnHeader?t-!!this.columnHeaderTitle:this.columnDimensionTree.totalLevel);this.setColHeaderPathCache(e,t,i)}if(!l&&e>=0&&r>=0){if(l=[],"tree"===this.rowHierarchyType){let e=this._rowHeaderCellFullPathIds[r],t=this.rowDimensionTree,i=0;for(;t&&e;){let o=[],r=e[i];for(o.push(r);;){let e=this._headerObjectMap[r];if(!(null==e?void 0:e.parentCellId))break;o.unshift(e.parentCellId),r=e.parentCellId}let n=this.getTreePathByCellIds(o);l.push(...n),t=this._rowHeaderExtensionTree[e[i]],i++}}else if("grid-tree"===this.rowHierarchyType){let e=this._rowHeaderCellFullPathIds[r],t=this.getTreePathByCellIds(e);l.push(...t)}else l=this.rowDimensionTree.getTreePath(r,this.showHeader&&this.showRowHeader?e-!!this.rowHeaderTitle-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,l)}return{colHeaderPaths:i,rowHeaderPaths:l,cellLocation:this.getCellLocation(e,t)}}getTreePathByCellIds(e){let t=[];for(let i=0;i<e.length;i++){let l=e[i];if(i>0&&l===e[i-1])continue;let o=this._headerObjects[l];(null==o?void 0:o.define)&&t.push(o.define)}return t}getCellHeaderPaths(e,t){var i,l;let o=this.getCellHeaderPathsWithTreeNode(e,t),r={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:o.cellLocation};return null==(i=o.colHeaderPaths)||i.forEach(e=>{var t,i,l;let o={};o.dimensionKey=e.dimensionKey,o.indicatorKey=e.indicatorKey,o.value=null!=(l=null!=(t=e.value)?t:null==(i=this.getIndicatorInfoByIndicatorKey(e.indicatorKey))?void 0:i.title)?l:"",o.virtual=e.virtual,o.role=e.role,r.colHeaderPaths.push(o)}),null==(l=o.rowHeaderPaths)||l.forEach(e=>{var t,i,l;if("axis"!==e.dimensionKey){let o={};o.dimensionKey=e.dimensionKey,o.indicatorKey=e.indicatorKey,o.value=null!=(l=null!=(t=e.value)?t:null==(i=this.getIndicatorInfoByIndicatorKey(e.indicatorKey))?void 0:i.title)?l:"",o.virtual=e.virtual,o.role=e.role,r.rowHeaderPaths.push(o)}}),r}getIndicatorInfoByIndicatorKey(e){var t;return null==(t=this.indicatorsDefine)?void 0:t.find(t=>"string"!=typeof t&&!!e&&t.indicatorKey===e)}findFullCellIds(e){let t=[];for(let i=0;i<e.length;i++){let l=e[i];for(t.push(l);;){let e=this._headerObjectMap[l];if(!(null==e?void 0:e.parentCellId))break;t.unshift(e.parentCellId),l=e.parentCellId}}return t}getHeaderDimension(e,t){var i,l,o;if(this.isHeader(e,t)){let r=this.getHeader(e,t);return null!=(l=null==(i=this.rowsDefine)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===r.field))?l:null==(o=this.columnsDefine)?void 0:o.find(e=>"string"!=typeof e&&e.dimensionKey===r.field)}}isColumnIndicatorHeader(e,t){return"column"===this._indicatorShowType&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return"row"===this._indicatorShowType&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}_rebuildRowLayout(){var e,t,i,o,r,n;if(this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[...this.rowDimensionKeys],"tree"===this.rowHierarchyType?this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let l=++this.sharedVar.seqId,n=Array(this.rowCount-this.columnHeaderLevelCount).fill(l);this._rowHeaderCellFullPathIds_FULL.unshift(n);let a={id:l,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(t=null==(e=this.rowHeaderTitle)?void 0:e.headerType)?t:"text",style:null==(i=this.rowHeaderTitle)?void 0:i.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(o=this.rowHeaderTitle)?void 0:o.disableHeaderHover),disableHeaderSelect:!!(null==(r=this.rowHeaderTitle)?void 0:r.disableHeaderSelect)}};this.rowHeaderObjs.push(a),this._headerObjects[l]=a}this._rowHeaderCellFullPathIds_FULL=(0,l.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(n=this.extensionRows)?void 0:n.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths()}_rebuildColumnLayout(){var e,t,i,l,o;if(this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let r=++this.sharedVar.seqId,n=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(r);this._columnHeaderCellFullPathIds.unshift(n);let a={id:r,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(t=null==(e=this.columnHeaderTitle)?void 0:e.headerType)?t:"text",style:null==(i=this.columnHeaderTitle)?void 0:i.headerStyle,define:{id:r,disableHeaderHover:!!(null==(l=this.columnHeaderTitle)?void 0:l.disableHeaderHover),disableHeaderSelect:!!(null==(o=this.columnHeaderTitle)?void 0:o.disableHeaderSelect)}};this.columnHeaderObjs.push(a),this._headerObjects[r]=a}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths()}toggleHierarchyState(e,t){var i,r,n,a,s,h,d;let u;this.colIndex=0;let c=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount,g=this._rowHeaderCellFullPathIds_FULL.slice(0),p=g.map((t,i)=>({col:e,row:i+this.columnHeaderLevelCount})),f=this.getHeader(e,t);if((f.define.hierarchyState=f.define.hierarchyState===o.g.collapse?o.g.expand:o.g.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),"tree"===this.rowHierarchyType)?((null==(i=this.extensionRows)?void 0:i.length)>0&&this.extensionRows.forEach(e=>{var t;let i=(null==(t=e.rows)?void 0:t.map(e=>"string"==typeof e?e:e.dimensionKey))||[];this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(i)}),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs)):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let e=++this.sharedVar.seqId,t=Array(this.rowCount-this.columnHeaderLevelCount).fill(e);this._rowHeaderCellFullPathIds_FULL.unshift(t);let i={id:e,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(n=null==(r=this.rowHeaderTitle)?void 0:r.headerType)?n:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(s=this.rowHeaderTitle)?void 0:s.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[e]=i}if(this._rowHeaderCellFullPathIds_FULL=(0,l.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(d=this.extensionRows)?void 0:d.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,"tree"===this.rowHierarchyType)u=function(e,t,i,l,o,r){let n=r.columnHeaderLevelCount,a=[],s=[];for(let e=0;e<i.length;e++)l.includes(i[e])||s.push(o[e]);for(let t=0;t<l.length;t++)if(!i.includes(l[t])){let i={col:e,row:n+t};a.push(i)}let h=r.getParentCellId(e,t),d=r.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);h;)(h=r.getParentCellId(d.col,d.row))&&u.push(d=r.getRowHeaderCellAddressByCellId(h));return u.some(i=>i.col===e&&i.row===t)||u.push({col:e,row:t}),{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:s,updateCellPositionsRowDirection:u}}(e,t,g.map(t=>t[e-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(t=>t[e-this.leftRowSeriesNumberColumnCount]),p,this);else{let i=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount;u=function(e,t,i,l,o,r){let n=r.columnHeaderLevelCount,a=[],s=[];for(let e=0;e<i.length;e++)l.includes(i[e])||s.push(o[e]);for(let t=0;t<l.length;t++)if(!i.includes(l[t])){let i={col:e,row:n+t};a.push(i)}let h=r.getParentCellId(e,t),d=r.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);h;)(h=r.getParentCellId(d.col,d.row))&&u.push(d=r.getRowHeaderCellAddressByCellId(h));let c=[],g=[];if("grid-tree"===r.rowHierarchyType&&"column"===r.cornerSetting.titleOnDimension&&r.rowHeaderLevelCount!==r._cornerHeaderCellIds[0].length)if(r.rowHeaderLevelCount>r._cornerHeaderCellIds[0].length)for(let e=r._cornerHeaderCellIds[0].length;e<r.rowHeaderLevelCount;e++)c.push({col:e,row:t});else for(let e=r.rowHeaderLevelCount;e<r._cornerHeaderCellIds[0].length;e++)g.push({col:e,row:t});return{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:s,updateCellPositionsRowDirection:u,addCellPositionsColumnDirection:c,removeCellPositionsColumnDirection:g}}(e,t,g.map(e=>e[c]),this._rowHeaderCellFullPathIds_FULL.map(e=>e[i]),p,this)}return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths(),u}toggleHierarchyStateForColumnTree(e,t){var i,l,r,n,a;this.colIndex=0;let s=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,h=this._columnHeaderCellFullPathIds.slice(0),d=h[this.columnHeaderLevelCount-1].map((e,i)=>({col:i+this.rowHeaderLevelCount,row:t})),u=this.getHeader(e,t);if(u.define.hierarchyState=u.define.hierarchyState===o.g.collapse?o.g.expand:o.g.collapse,this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let e=++this.sharedVar.seqId,t=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(e);this._columnHeaderCellFullPathIds.unshift(t);let o={id:e,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((e,t)=>"string"==typeof t?e:e+(e?`/${t.title}`:`${t.title}`),""),field:void 0,headerType:null!=(l=null==(i=this.columnHeaderTitle)?void 0:i.headerType)?l:"text",style:null==(r=this.columnHeaderTitle)?void 0:r.headerStyle,define:{id:e,disableHeaderHover:!!(null==(n=this.columnHeaderTitle)?void 0:n.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(o),this._headerObjects[e]=o}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;let c=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,g=function(e,t,i,l,o,r){let n=r.rowHeaderLevelCount,a=[],s=[];for(let e=0;e<i.length;e++)l.includes(i[e])||s.push(o[e]);for(let e=0;e<l.length;e++)if(!i.includes(l[e])){let i={col:n+e,row:t};a.push(i)}let h=r.getParentCellId(e,t),d=r.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);d&&h;)(h=r.getParentCellId(d.col,d.row))&&u.push(d=r.getRowHeaderCellAddressByCellId(h));let c=[],g=[];if("grid-tree"===r.columnHierarchyType&&"row"===r.cornerSetting.titleOnDimension&&r.columnHeaderLevelCount!==r._cornerHeaderCellIds.length)if(r.columnHeaderLevelCount>r._cornerHeaderCellIds.length)for(let t=r._cornerHeaderCellIds.length;t<r.columnHeaderLevelCount;t++)c.push({col:e,row:t});else for(let t=r.columnHeaderLevelCount;t<r._cornerHeaderCellIds.length;t++)g.push({col:e,row:t});return{addCellPositionsColumnDirection:a,removeCellPositionsColumnDirection:s,updateCellPositionsColumnDirection:u,addCellPositionsRowDirection:c,removeCellPositionsRowDirection:g}}(e,t,h[s],this._columnHeaderCellFullPathIds[c],d,this);return this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths(),g}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(e){var t;if(!Array.isArray(e))return;let i,l,o=this.rowTree,r=this.columnTree;for(let n=0;n<e.length;n++){let a=e[n];if((a.isPivotCorner||!(0,d.Z)(a.value))&&n===e.length-1){if("row"===(null==(t=null==this?void 0:this.cornerSetting)?void 0:t.titleOnDimension)){let e=0;return"grid"===this.rowHierarchyType&&(e=this.rowDimensionKeys.indexOf(a.dimensionKey)),-1===e?void 0:{col:(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount,row:0}}let e=this.colDimensionKeys.indexOf(a.dimensionKey);return -1===e?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?e+1:e}}let s=!1;for(let e=0;e<r.length;e++){let t=r[e];if(((0,d.Z)(a.dimensionKey)&&t.dimensionKey===a.dimensionKey||(0,d.Z)(a.indicatorKey)&&t.indicatorKey===a.indicatorKey)&&t.value===a.value){r=t.children,l=t,s=!0;break}}if(!s)for(let e=0;e<o.length;e++){let t=o[e];if(((0,d.Z)(a.dimensionKey)&&t.dimensionKey===a.dimensionKey||(0,d.Z)(a.indicatorKey)&&t.indicatorKey===a.indicatorKey)&&t.value===a.value){o=t.children,i=t;break}}}let n=0,a=0;if(i){a=this.columnHeaderLevelCount;let{startInTotal:e,afterSpanLevel:t}=i;return a+=e,{col:n="grid"===this.rowHierarchyType?(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,row:a}}if(l){n=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:e,afterSpanLevel:t}=l;return{col:n+=e,row:a=this.columnHeaderTitle?t+1:t}}}getPivotDimensionInfo(e,t){var i;let{colHeaderPaths:l,rowHeaderPaths:o}=this.getCellHeaderPaths(e,t),r=[];return l.length?l.forEach((e,t)=>{r.push({dimensionKey:e.dimensionKey,value:e.value,isPivotCorner:!1,indicatorKey:e.indicatorKey})}):o.length?o.forEach((e,t)=>{r.push({dimensionKey:e.dimensionKey,value:e.value,isPivotCorner:!1,indicatorKey:e.indicatorKey})}):this.isCornerHeader(e,t)&&("row"===(null==(i=null==this?void 0:this.cornerSetting)?void 0:i.titleOnDimension)?r.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):r.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),r}getIndicatorKey(e,t){var i;return null==(i=this.getBody(e,t))?void 0:i.indicatorKey}getParentCellId(e,t){if(0!==t)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(e){let t,i;if(this._rowHeaderCellIds.find((l,o)=>!!l.find((i,l)=>i===e&&(t=l,!0))&&(i=o,!0)),(0,d.Z)(t)&&(0,d.Z)(i))return{col:t,row:i+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)return!1;this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);let i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,i.start.row)===this.getParentCellId(t.col,i.start.row);if(this.isRowHeader(e.col,e.row)){if("tree"!==this.rowHierarchyType)return this.getParentCellId(i.start.col,e.row)===this.getParentCellId(i.start.col,t.row);{let i=(0,h.Z)(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),l=(0,h.Z)(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(i.pop(),l.pop(),i.length<=l.length){if(i.length===l.length)return!i.find((e,t)=>e.dimensionKey!==l[t].dimensionKey||e.value!==l[t].value);if(i.length>0){for(let e=0;e<i.length;e++)if(i[e].startInTotal!==l[e].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(e,t){var i,l;if((!(null==(i=this._table.options.dragOrder)?void 0:i.validateDragOrderOnEnd)||(null==(l=this._table.options.dragOrder)?void 0:l.validateDragOrderOnEnd(e,t)))&&this.canMoveHeaderPosition(e,t)&&!this.isCellRangeEqual(e.col,e.row,t.col,t.row)){let i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){let l,o=i.end.col-i.start.col+1,r=this.getCellRange(t.col,i.start.row);if((l=t.col>=e.col?r.end.col-o+1:r.start.col)===i.start.col)return null;for(let e=0;e<this._columnHeaderCellFullPathIds.length;e++){let t=this._columnHeaderCellFullPathIds[e].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,o);t.unshift(l-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[e],t)}let n=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,o);return n.unshift(l-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,n),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(e.col,e.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,r.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:l,sourceSize:o,targetSize:r.end.col-r.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)){let l,o=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,r=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,n=o[o.length-1],a=r[o.length-1],s=n.size;if((l=t.row>=e.row?a.startInTotal+a.size-s:a.startInTotal)===i.start.row-this.columnHeaderLevelCount)return null;let h=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,s);h.unshift(l-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,h);let d=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,s);d.unshift(l-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,d);let u=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,s);u.unshift(l,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,u);let c=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,s);return c.unshift(l,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,c),this.rowDimensionTree.movePosition(o.length-1,i.start.row-this.columnHeaderLevelCount,l+(t.row>e.row?n.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:l+this.columnHeaderLevelCount,sourceSize:s,targetSize:a.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(e){var t,i,l,o,r,n;let a,s,h=!1,u=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;a=e.filter(e=>this.colDimensionKeys.indexOf(e.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&e.indicatorKey),s=e.filter(e=>this.rowDimensionKeys.indexOf(e.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&e.indicatorKey)}else a=e.colHeaderPaths,s=e.rowHeaderPaths,"body"===(null==e?void 0:e.cellLocation)&&this._table.isPivotTable()&&(u=!0);if(!Array.isArray(a)&&!Array.isArray(s))return;if(null==a||a.sort((e,t)=>{var i,l;return this.colDimensionKeys.indexOf(null!=(i=e.dimensionKey)?i:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf(null!=(l=t.dimensionKey)?l:this.indicatorDimensionKey)}),null==s||s.sort((e,t)=>{var i,l;return this.fullRowDimensionKeys.indexOf(null!=(i=e.dimensionKey)?i:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf(null!=(l=t.dimensionKey)?l:this.indicatorDimensionKey)}),null==a||a.forEach(e=>{e.isPivotCorner&&(h=!0)}),null==s||s.forEach(e=>{e.isPivotCorner&&(h=!0)}),h){if("all"===this.cornerSetting.titleOnDimension&&this.indicatorsAsCol&&0===a.length){for(let e=0;e<this.rowDimensionKeys.length;e++)if((null==(t=s[0])?void 0:t.dimensionKey)===this.rowDimensionKeys[e])return{col:e+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol||0!==s.length){if("row"!==this.cornerSetting.titleOnDimension&&("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol)){for(let e=0;e<this.colDimensionKeys.length;e++)if((null==(o=a[0])?void 0:o.dimensionKey)===this.colDimensionKeys[e])return{col:0,row:e}}else for(let e=0;e<this.rowDimensionKeys.length;e++)if((null==(l=s[0])?void 0:l.dimensionKey)===this.rowDimensionKeys[e])return{col:e+this.leftRowSeriesNumberColumnCount,row:0}}else for(let e=0;e<this.colDimensionKeys.length;e++)if((null==(i=a[0])?void 0:i.dimensionKey)===this.colDimensionKeys[e])return{col:this.rowHeaderLevelCount-1,row:e}}let c,p,f,b,m=!1,C=!1;(null==a?void 0:a.length)>=1&&(null==s?void 0:s.length)>=1&&(m=!0,C=!0),a.length>=this._getColumnHeaderTreeExpandedMaxLevelCount()&&(m=!0),s.length>=this._getRowHeaderTreeExpandedMaxLevelCount()&&(C=!0);let v,w,y=this.rowTree,x=this.columnTree;if(a)for(let e=0;e<a.length;e++){let t=a[e];for(let e=0;e<x.length;e++){let i=x[e];if(!(0,d.Z)(t.indicatorKey)&&i.dimensionKey===t.dimensionKey&&i.value===t.value||(0,d.Z)(t.indicatorKey)&&i.indicatorKey===t.indicatorKey&&((0,d.Z)(i.value)&&(0,d.Z)(t.value)&&t.value===i.value||!(0,d.Z)(i.value)||!(0,d.Z)(t.value))){x=i.children,(!m||(null==x?void 0:x.length))&&m||(w=i);break}}}if((null==s?void 0:s.length)>=1)if("tree"===this.rowHierarchyType){let e=s[s.length-1],t=this.headerObjects.filter(t=>((null==t?void 0:t.field)===e.dimensionKey||(null==t?void 0:t.field)===e.indicatorKey)&&(null==t?void 0:t.title)===e.value).map(e=>e.id),i=this._rowHeaderCellIds.filter(e=>t.indexOf(e[e.length-1])>=0).find(e=>{let t=this.findFullCellIds(e);return t.length===s.length&&t.every(e=>{let t=this._headerObjectMap[e];return s.find(e=>e.dimensionKey===t.field&&e.value===t.title)})});p=this._rowHeaderCellIds.indexOf(i)+this.columnHeaderLevelCount}else for(let e=0;e<s.length;e++){let t=s[e];for(let e=0;e<y.length;e++){let i=y[e];if(!(0,d.Z)(t.indicatorKey)&&i.dimensionKey===t.dimensionKey&&i.value===t.value||(0,d.Z)(t.indicatorKey)&&i.indicatorKey===t.indicatorKey&&(!(0,d.Z)(t.value)||i.value===t.value)){y=i.children,(!C||(null==y?void 0:y.length)&&!y.some(e=>"axis"===e.dimensionKey))&&C||(v=i);break}}}if(u||!m||!C||(v||(0,d.Z)(p))&&w){if(v||u){p=this.columnHeaderLevelCount;let{startInTotal:e,afterSpanLevel:t}=null!=(r=v)?r:g;p+=null!=e?e:0,f="grid"===this.rowHierarchyType?(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount:0}if(w||u){c=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:e,afterSpanLevel:t}=null!=(n=w)?n:g;c+=null!=e?e:0,b=this.columnHeaderTitle?t+1:t}return(0,d.Z)(c)||(0,d.Z)(p)?{col:null!=c?c:f,row:null!=p?p:b}:void 0}}setChartInstance(e,t,i){var l,o,r,n;let a,s=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){let e=null==(l=s.colHeaderPaths.find(e=>e.indicatorKey))?void 0:l.indicatorKey;a=null==(o=this._indicators)?void 0:o.find(t=>t.indicatorKey===e)}else{let e=null==(r=s.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;a=null==(n=this._indicators)?void 0:n.find(t=>t.indicatorKey===e)}"function"!=typeof(null==a?void 0:a.chartSpec)&&a&&(a.chartInstance=i)}getChartInstance(e,t){var i,l,o,r;let n,a=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){let e=null==(i=a.colHeaderPaths.find(e=>e.indicatorKey))?void 0:i.indicatorKey;n=null==(l=this._indicators)?void 0:l.find(t=>t.indicatorKey===e)}else{let e=null==(o=a.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:o.indicatorKey;n=null==(r=this._indicators)?void 0:r.find(t=>t.indicatorKey===e)}return null==n?void 0:n.chartInstance}checkHasChart(){return(0,n.YL)(this)}getDimension(e,t){var i,l;return"column"===t?null==(i=this.columnsDefine)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===e):"row"===t?null==(l=this.rowsDefine)?void 0:l.find(t=>"string"!=typeof t&&t.dimensionKey===e):void 0}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&(0,n.aw)(e,t,"row",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&(0,n.aw)(e,t,"col",this)){let i=c.F.getFunction("getAxisConfigInPivotChart")(e,t,this);if(!1!==(null==i?void 0:i.visible))return i}}isEmpty(e,t){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(e,t)||!!this.isRightBottomCorner(e,t)||!!this.isRightTopCorner(e,t))}isAxisCell(e,t){return!!this._table.isPivotChart()&&(!!(this.indicatorKeys.length>=1&&(0,n.eW)(this.indicatorsDefine)&&(this.isBottomFrozenRow(e,t)&&(0,n.aw)(e,t,"col",this)||this.isRightFrozenColumn(e,t)&&(0,n.aw)(e,t,"row",this)||this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&(0,n.aw)(e,t,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&(0,n.aw)(e,t,"col",this)))||!1)}getChartAxes(e,t){if((0,n.VR)(e,t,this)||this.isAxisCell(e,t))return(0,n.TQ)(e,t,this)}getRawChartSpec(e,t){return(0,n.ed)(e,t,this)}getChartSpec(e,t){return(0,n.K0)(e,t,this)}isShareChartSpec(e,t){return(0,n.TF)(e,t,this)}getChartDataId(e,t){return(0,n.py)(e,t,this)}isNoChartDataRenderNothing(e,t){return(0,n.f_)(e,t,this)}setPagination(e){var t,i,l,o,r,n,a;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,"grid"===this.rowHierarchyType&&(0,d.Z)(null==(t=this.pagination)?void 0:t.perPageCount)&&(0,d.Z)(null==(i=this.pagination)?void 0:i.currentPage)){!1===this.indicatorsAsCol&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);let{perPageCount:e,currentPage:t}=this.pagination;this.currentPageStartIndex=e*(t||0),this.currentPageEndIndex=this.currentPageStartIndex+e,this._rowHeaderCellIds=null==(l=this._rowHeaderCellIds_FULL)?void 0:l.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(o=this._rowHeaderCellFullPathIds_FULL)?void 0:o.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=null==(r=this._rowHeaderCellIds_FULL)?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(n=this._rowHeaderCellFullPathIds_FULL)?void 0:n.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=null==(a=this._rowHeaderCellIds_FULL)?void 0:a.length)}release(){var e;let t=this._table._getActiveChartInstance();null==t||t.release(),null==(e=this._indicators)||e.forEach(e=>{var t;null==(t=e.chartInstance)||t.release()})}getHeadNode(e,t){var i,l,o;let r,n=this.getCellHeaderPaths(e,t);return n.rowHeaderPaths&&(null!=(l=null==(i=n.rowHeaderPaths)?void 0:i.length)?l:0)>0?r=null==(o=n.rowHeaderPaths)?void 0:o.slice(0,n.rowHeaderPaths.length):n.colHeaderPaths&&n.colHeaderPaths.length>0&&(r=n.colHeaderPaths.slice(0,n.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(r,e,t)}getHeadNodeByRowOrColDimensions(e,t,i){var l;if(!Array.isArray(e))return;let o,r,n=this.rowTree,a=this.columnTree;if((0,d.Z)(i)&&(0,d.Z)(t)&&"tree"===this.rowHierarchyType&&this.extensionRows&&t>=1+this.leftRowSeriesNumberColumnCount){let e=this.getCellId(t-1,i);n=this._rowHeaderExtensionTree[e].tree.children}for(let t=0;t<e.length;t++){let i=e[t];if((i.isPivotCorner||!(0,d.Z)(i.value))&&t===e.length-1)return;let s=!1;for(let e=0;e<a.length;e++){let t=a[e];if((0,d.Z)(i.dimensionKey)&&t.dimensionKey===i.dimensionKey&&t.value===i.value||(0,d.Z)(i.indicatorKey)&&t.indicatorKey===i.indicatorKey&&(t.value===i.value||!(0,d.Z)(i.value)||!(0,d.Z)(t.value))){a=t.children,r=t,s=!0;break}}if(!s)for(let e=0;e<(null!=(l=null==n?void 0:n.length)?l:0);e++){let t=n[e];if((0,d.Z)(i.dimensionKey)&&t.dimensionKey===i.dimensionKey&&t.value===i.value||(0,d.Z)(i.indicatorKey)&&t.indicatorKey===i.indicatorKey&&(t.value===i.value||!(0,d.Z)(i.value)||!(0,d.Z)(t.value))){n=t.children,o=t;break}}}return o||r||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){var i,l,o,r,n,a;let s;if(!1===this.indicatorsAsCol)for(let e=0;e<this.indicatorsDefine.length;e++){let t=this.indicatorsDefine[e].chartSpec;if(t&&(s=null!=(i=t.xField)?i:null==(o=null==(l=null==t?void 0:t.series)?void 0:l[0])?void 0:o.xField))return s}else for(let e=0;e<this.indicatorsDefine.length;e++){let t=this.indicatorsDefine[e].chartSpec;if(t&&(s=null!=(r=t.yField)?r:null==(a=null==(n=null==t?void 0:t.series)?void 0:n[0])?void 0:a.yField))return s}return null}_generateChartState(){return{vtable_selected:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(t=>{for(let i in t)if("object"!=typeof t[i]&&t[i]!==e[i])return!1;return!0}):null!=(t=this._table._selectedDimensionInChart)&&!!t.length&&!!this._table._selectedDimensionInChart.every(t=>"object"==typeof t.value||e[t.key]===t.value)}},vtable_selected_reverse:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(t=>{for(let i in t)if("object"!=typeof t[i]&&t[i]!==e[i])return!1;return!0}):null!=(t=this._table._selectedDimensionInChart)&&!!t.length&&!this._table._selectedDimensionInChart.every(t=>"object"==typeof t.value||e[t.key]===t.value)}}}}updateDataStateToChartInstance(e){var t;if(!1!==(null==(t=null==e?void 0:e.getSpec().select)?void 0:t.enable)){e||(e=this._table._getActiveChartInstance());let t=this._generateChartState();this._indicators.forEach(e=>{var i;let l=e.chartInstance;!1!==(null==(i=e.chartSpec.select)?void 0:i.enable)&&l.updateState(t)}),null==e||e.updateState(t)}}updateDataStateToActiveChartInstance(e){var t;if(!1!==(null==(t=null==e?void 0:e.getSpec().select)?void 0:t.enable)){e||(e=this._table._getActiveChartInstance());let t=this._generateChartState();null==e||e.updateState(t)}}getIndicatorKeyInChartSpec(e,t){let i=this.getRawChartSpec(e,t),l=[];if(i){if(i.series||i.xField||i.yField)return!1===this.indicatorsAsCol?i.series?i.series.forEach(e=>{let t=e.yField;l.push(t)}):l.push(i.yField):i.series?i.series.forEach(e=>{let t=e.xField;l.push(t)}):l.push(i.xField),l;if(i.valueField&&l.push(i.valueField),l.length>=1)return l}return null}getOptimunHeightForChart(e){var t,i,l,o,r;let n,a,s=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;for(let e in this.dataset.collectValuesBy)if("yField"===this.dataset.collectValuesBy[e].type&&!this.dataset.collectValuesBy[e].range){n=null==(t=this.dataset.collectedValues[e])?void 0:t[s.map(e=>e.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)a=f(null!=(i=null==n?void 0:n.length)?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let e=this._chartItemSpanSize||25;a=(null!=(l=null==n?void 0:n.length)?l:0)*(e+e/3)}let h=(0,u.u)(null!=(r=null!=(o=this._chartPadding)?o:this._table.theme.bodyStyle.padding)?r:0);return a+h[0]+h[2]}getOptimunWidthForChart(e){var t,i,l,o,r;let n,a,s=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;for(let e in this.dataset.collectValuesBy)if("xField"===this.dataset.collectValuesBy[e].type&&!this.dataset.collectValuesBy[e].range){n=null==(t=this.dataset.collectedValues[e])?void 0:t[s.map(e=>e.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)a=f(null!=(i=null==n?void 0:n.length)?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let e=this._chartItemSpanSize||25;a=(null!=(l=null==n?void 0:n.length)?l:0)*(e+e/3)}let h=(0,u.u)(null!=(r=null!=(o=this._chartPadding)?o:this._table.theme.bodyStyle.padding)?r:0);return a+h[1]+h[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;let e=this._table.pivotChartAxes.find(e=>"left"===e.orient);return!1===(null==e?void 0:e.visible)?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;let e=this._table.pivotChartAxes.find(e=>"top"===e.orient);return!1===(null==e?void 0:e.visible)?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){let i=this.getCellHeaderPaths(e,t),l=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(e=>{e.dimensionKey&&l.push(e.value)}),null==l?void 0:l.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){let i=this.getCellHeaderPaths(e,t),l=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(e=>{e.dimensionKey&&l.push(e.value)}),null==l?void 0:l.join(this.dataset.stringJoinChar)}getIndicatorInfo(e,t=""){var i;return null==(i=this.indicatorsDefine)?void 0:i.find(i=>"string"!=typeof i&&(e?i.indicatorKey===e:!!t&&i.title===t))}getLayoutColumnTree(){let e=[],t=this.columnDimensionTree.tree.children;return(0,a.LC)(e,t),e}getLayoutRowTree(){let e=[],t=this.rowDimensionTree.tree.children;return(0,a.LC)(e,t),e}getLayoutColumnTreeCount(){let e=this.columnDimensionTree.tree.children;return(0,a.p$)(e,"tree"===this.rowHierarchyType)}getLayoutRowTreeCount(){var e;let t=this.rowDimensionTree.tree.children,i=(0,a.p$)(t,"tree"===this.rowHierarchyType);return null==(e=this.extensionRows)||e.forEach(e=>{if("function"!=typeof e.rowTree){let t=(0,a.p$)(e.rowTree,!0);i*=t}}),i}resetHeaderTree(){var e,t,i;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];let o=this.dataset;this.rowTree=o.rowHeaderTree,this.columnTree=o.colHeaderTree;let r=this.rowDimensionTree.tree.children;null==(e=this.rowTree)||e.forEach((e,t)=>{let i=r.find(t=>t.dimensionKey===e.dimensionKey&&t.value===e.value);i&&this._table._syncHierarchyState(i,e)}),this.columnDimensionTree=new a.KO(null!=(t=this.columnTree)?t:[],this.sharedVar,this.columnHierarchyType,"grid"!==this.columnHierarchyType?this.columnExpandLevel:void 0),this.rowDimensionTree=new a.KO(null!=(i=this.rowTree)?i:[],this.sharedVar,this.rowHierarchyType,"grid"!==this.rowHierarchyType?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,l.p4)(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){return!!((0,d.Z)(e)&&(0,d.Z)(t))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=0)&&!!(e<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:Object.assign({},this._table.internalProps.theme.cornerHeaderStyle,this._table.internalProps.rowSeriesNumber.headerStyle)}):this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,i){this.getHeadNode(e,t).value=i;let l=this.getCellId(e,t);this._headerObjectMap[l].title=i}changeCornerTitle(e,t,i){if(this.isCornerHeader(e,t)){let l=this.getCellId(e,t);this._headerObjectMap[l].title=i}}generateCellIdsConsiderHideHeader(){var e,t,i,l;if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let e=this.colDimensionKeys.indexOf(r.ek),t=this._columnHeaderCellIds.splice(e,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(t[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((e,t)=>{let i=e.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[t]=i});else{let e=this.rowDimensionKeys.indexOf(r.ek);this._rowHeaderCellIds_FULL.forEach((t,i)=>{let l=t.slice(),o=l.splice(e,1);l.splice(0,l.length),l.push(o[0]),this._rowHeaderCellIds_FULL[i]=l})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),0===this.rowHeaderLevelCount||0===this.columnHeaderLevelCount)this._cornerHeaderCellIds=[];else if("row"!==this.cornerSetting.titleOnDimension||this.showRowHeader){if("column"===this.cornerSetting.titleOnDimension&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let e=this.colDimensionKeys.indexOf(r.ek),t=this._cornerHeaderCellIds.splice(e,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(t[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((e,t)=>{let i=e.slice();i.splice(0,i.length),this._cornerHeaderCellIds[t]=i});else{let e=this.rowDimensionKeys.indexOf(r.ek);this._cornerHeaderCellIds.forEach((t,i)=>{let l=t.slice(),o=l.splice(e,1);l.splice(0,l.length),l.push(o[0]),this._cornerHeaderCellIds[i]=l})}if("grid-tree"===this.rowHierarchyType&&"column"===this.cornerSetting.titleOnDimension)this._cornerHeaderCellIds[0].length<this._rowHeaderCellIds[0].length?this._cornerHeaderCellIds.forEach((e,t)=>{let i=e.length;e.length=this._rowHeaderCellIds[0].length,e.fill(e[0],i)}):this._cornerHeaderCellIds[0].length>this._rowHeaderCellIds[0].length&&this._cornerHeaderCellIds.forEach((e,t)=>{e.length=this._rowHeaderCellIds[0].length});else if("grid-tree"===this.columnHierarchyType&&"row"===this.cornerSetting.titleOnDimension)if((null==(e=this._cornerHeaderCellIds)?void 0:e.length)<(null==(t=this._columnHeaderCellIds)?void 0:t.length)){let e=this._cornerHeaderCellIds.length;this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length,this._cornerHeaderCellIds.fill(this._cornerHeaderCellIds[0],e)}else(null==(i=this._cornerHeaderCellIds)?void 0:i.length)>(null==(l=this._columnHeaderCellIds)?void 0:l.length)&&(this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length)}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){var e,t;(null==(t=null==(e=this._table.options)?void 0:e.customConfig)?void 0:t.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}disableUseHeaderPathCache(){var e,t;(null==(t=null==(e=this._table.options)?void 0:e.customConfig)?void 0:t.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,i){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,i):this._getBodyCache.set(t,i))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,i)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,i)}clearHeaderPathCache(){this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}isAggregation(e,t){if(this.isHeader(e,t))return!1;let i=this.getCellHeaderPaths(e,t);for(let e of i.colHeaderPaths)if("sub-total"===e.role||"grand-total"===e.role)return!0;for(let e of i.rowHeaderPaths)if("sub-total"===e.role||"grand-total"===e.role)return!0;return!1}expandAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(o.g.expand),this._rebuildRowLayout())}collapseAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(o.g.collapse),this._rebuildRowLayout())}expandAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(o.g.expand),this._rebuildColumnLayout())}collapseAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(o.g.collapse),this._rebuildColumnLayout())}}function f(e,t,i,l){var o,r,n;let a;1===i&&(i=0);let s=(o=e,r=i,n=l,a=1===o?o+2*n:o-r+2*n,o?a>0?a:1:0);return Math.ceil(t/(1-i)*s)}},20901:function(e,t,i){"use strict";i.d(t,{KO:()=>s,LC:()=>function e(t,i){null==i||i.forEach(i=>{var l,o;let r={dimensionKey:i.dimensionKey,indicatorKey:i.indicatorKey,value:i.value,hierarchyState:i.hierarchyState,children:void 0,virtual:null!=(l=i.virtual)&&l,levelSpan:null!=(o=i.levelSpan)?o:1};t.push(r),i.children&&(r.children=[],e(r.children,i.children))})},g3:()=>h,gD:()=>function e(t,i,l,o,r){var n;for(let a=t.length-1;a>=0;a--){let s=t[a];if(i.push(s),o&&s.hide)t.splice(a,1);else if(s.indicatorKey){let e=null==(n=null==l?void 0:l.find(e=>e.indicatorKey===s.indicatorKey))?void 0:n.hide;"function"==typeof e?e({dimensionPaths:i,table:r})&&t.splice(a,1):e&&t.splice(a,1)}else s.children&&s.children.length>0&&e(s.children,i,l,o,r);i.pop()}},jS:()=>d,p$:()=>function e(t,i){let l=0;return null==t||t.forEach(t=>{i?l++:t.children&&0!==t.children.length||l++,t.children&&(l+=e(t.children,i))}),l},py:()=>u});var l=i(19465),o=i(18585),r=i(89445),n=i(90251),a=i(12348);class s{constructor(e,t,i="grid",l){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new r.B,this.dimensionKeysIncludeVirtual=new r.B,this.cache=new Map,this.sizeIncludeParent=null!=l,this.setExpandLevel=l,this.hierarchyType=i,this.sharedVar=t,this.reset(e)}reset(e){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new r.B,this.dimensionKeysIncludeVirtual=new r.B,this.tree.children=e,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(e,t,i){var l,o,r,s;e.startIndex=t,e.startInTotal=(null!=(l=i.startInTotal)?l:0)+e.startIndex,e.hide&&(this.hasHideNode=!0),(null!=(o=e.dimensionKey)?o:e.indicatorKey)&&(e.virtual||this.dimensionKeys.contain(e.indicatorKey?n.ek:e.dimensionKey)||this.dimensionKeys.put(e.level,e.indicatorKey?n.ek:e.dimensionKey),this.dimensionKeysIncludeVirtual.contain(e.indicatorKey?n.ek:e.dimensionKey)||this.dimensionKeysIncludeVirtual.put(e.level,e.indicatorKey?n.ek:e.dimensionKey),e.id||(e.id=++this.sharedVar.seqId));let h=e.dimensionKey&&this.sizeIncludeParent?1:0,d=e.children||e.columns;return"grid"===this.hierarchyType||null===this.hierarchyType?(null==d?void 0:d.length)>=1?d.forEach(t=>{var i,l,o;t.level=(null!=(i=e.level)?i:0)+1,"grid"===this.hierarchyType&&(t.afterSpanLevel=(null!=(l=e.afterSpanLevel)?l:0)+(null!=(o=e.levelSpan)?o:1)),this.totalLevel=Math.max(this.totalLevel,t.level+1),h+=this.setTreeNode(t,h,e)}):h=+(-1!==e.level):e.hierarchyState===a.g.expand&&(null==d?void 0:d.length)>=1?d.forEach(t=>{var i;t.level=(null!=(i=e.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,t.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,t.level+1),h+=this.setTreeNode(t,h,e)}):e.hierarchyState===a.g.collapse&&(null==d?void 0:d.length)>=1?d.forEach(t=>{var i;t.level=(null!=(i=e.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,t.level+1),this.setTreeNode(t,h,e)}):!e.hierarchyState&&e.level+1<this.setExpandLevel&&((null==d?void 0:d.length)>=1||!0===d)?((null==(r=d[0])?void 0:r.indicatorKey)&&"grid-tree"===this.hierarchyType||(e.hierarchyState=a.g.expand),(null==d?void 0:d.length)>=1&&d.forEach(t=>{var i;t.level=(null!=(i=e.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,t.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,t.level+1),h+=this.setTreeNode(t,h,e)})):(null==d?void 0:d.length)>=1||!0===d?((null==(s=d[0])?void 0:s.indicatorKey)&&"grid-tree"===this.hierarchyType||(e.hierarchyState=a.g.collapse),(null==d?void 0:d.length)>=1&&d.forEach(t=>{var i;t.level=(null!=(i=e.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,t.level+1),this.setTreeNode(t,h,e)})):(e.hierarchyState=a.g.none,h=+(-1!==e.level)),e.size=h,h}getTreePath(e,t=30){let i=[];return this.searchPath(e,this.tree,i,t),i.shift(),i}findNodeById(e,t){return e.find(e=>e.id===t)}searchPath(e,t,i,l){if(!t||e<t.startIndex||e>=t.startIndex+t.size||(i.push(t),!t.children||0===t.children.length||t.level>=l))return;let o=e-t.startIndex;if(this.cache.has(t.level+1)){let e=this.cache.get(t.level+1);if(o>=e.startIndex&&o<e.startIndex+e.size)return void this.searchPath(o,e,i,l)}let r=0,n=t.children.length-1;for(;r<=n;){let e=Math.floor((r+n)/2),a=t.children[e];if(o>=a.startIndex&&o<a.startIndex+a.size){this.cache.set(a.level,a);let e=[];this.cache.forEach((t,i)=>{i>a.level&&e.push(i)}),e.forEach(e=>{this.cache.delete(e)}),this.searchPath(o,a,i,l);break}o<a.startIndex?n=e-1:r=e+1}}movePosition(e,t,i){let l,o,r,n=(a,s)=>{if(void 0!==o&&void 0!==r)return;a.level===e&&(a.startInTotal===t&&(o=s),a.startInTotal<=i&&i<=a.startInTotal+a.size-1&&(r=s));let h=a.children||a.columns;if(h&&a.level<e){l=a;for(let e=0;e<h.length;e++)(t>=h[e].startInTotal&&t<=h[e].startInTotal+h[e].size||i>=h[e].startInTotal&&i<=h[e].startInTotal+h[e].size)&&n(h[e],e)}};n(this.tree,0);let a=l.children||l.columns,s=a.splice(o,1);s.unshift(r,0),Array.prototype.splice.apply(a,s)}getCopiedTree(){let e=(0,l.Z)(this.tree.children);return function e(t){for(let i=0;i<t.length;i++){let l=t[i];delete l.level,delete l.startIndex,delete l.id,delete l.levelSpan,delete l.size,delete l.startInTotal;let o=l.children||l.columns;o&&e(o)}}(e),e}setAllNodesState(e){this._updateNodeHierarchyState(this.tree,e)}_updateNodeHierarchyState(e,t){e.children&&e.children.length>0&&e.children[0].dimensionKey?(-1!==e.level&&(e.hierarchyState=t),e.children.forEach(e=>{this._updateNodeHierarchyState(e,t)})):e.hierarchyState=a.g.none}}function h(e,t,i,l,r,n){var a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B;let T=e.id,z=null!=(s=null==(a=n.rowsDefine)?void 0:a.find(t=>"string"!=typeof t&&t.dimensionKey===e.dimensionKey))?s:null==(h=n.columnsDefine)?void 0:h.find(t=>"string"!=typeof t&&t.dimensionKey===e.dimensionKey),L=null==(d=n.indicatorsDefine)?void 0:d.find(t=>"string"!=typeof t&&(e.indicatorKey?t.indicatorKey===e.indicatorKey:t.title===e.value&&!e.dimensionKey)),k={id:T,title:null!=(u=e.value)?u:null==L?void 0:L.title,field:e.dimensionKey,style:"function"==typeof(null==(c=null!=L?L:z)?void 0:c.headerStyle)?null==(g=null!=L?L:z)?void 0:g.headerStyle:Object.assign({},null==(p=null!=L?L:z)?void 0:p.headerStyle),headerType:null!=(b=null!=(f=null==L?void 0:L.headerType)?f:null==z?void 0:z.headerType)?b:"text",headerIcon:null!=(m=null==L?void 0:L.headerIcon)?m:null==z?void 0:z.headerIcon,define:Object.assign({},e,null!=L?L:Object.assign({},z,{sort:void 0})),fieldFormat:null!=(C=null==L?void 0:L.headerFormat)?C:null==z?void 0:z.headerFormat,dropDownMenu:null!=(v=null==L?void 0:L.dropDownMenu)?v:null==z?void 0:z.dropDownMenu,pivotInfo:{value:e.value,dimensionKey:e.dimensionKey,isPivotCorner:!1},width:null==z?void 0:z.width,minWidth:null==z?void 0:z.minWidth,maxWidth:null==z?void 0:z.maxWidth,showSort:null!=(w=null==L?void 0:L.showSort)?w:null==z?void 0:z.showSort,sort:null==L?void 0:L.sort,description:null==z?void 0:z.description};L?(L.customRender&&(e.customRender=L.customRender),(0,o.Z)(null==(y=n._indicators)?void 0:y.find(e=>e.indicatorKey===L.indicatorKey))||null==(x=n._indicators)||x.push({id:++n.sharedVar.seqId,indicatorKey:L.indicatorKey,field:L.indicatorKey,fieldFormat:null==L?void 0:L.format,cellType:null!=(S=null!=(_=null==L?void 0:L.cellType)?_:null==L?void 0:L.columnType)?S:"text",chartModule:"chartModule"in L?L.chartModule:null,chartSpec:"chartSpec"in L?L.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in L&&L.noDataRenderNothing,sparklineSpec:"sparklineSpec"in L?L.sparklineSpec:null,style:null==L?void 0:L.style,icon:null==L?void 0:L.icon,define:Object.assign({},e,L,{dragHeader:null==z?void 0:z.dragHeader}),width:null==L?void 0:L.width,minWidth:null==L?void 0:L.minWidth,maxWidth:null==L?void 0:L.maxWidth,disableColumnResize:null==L?void 0:L.disableColumnResize})):e.indicatorKey&&((0,o.Z)(null==(R=n._indicators)?void 0:R.find(t=>t.indicatorKey===e.indicatorKey))||null==(H=n._indicators)||H.push({id:++n.sharedVar.seqId,indicatorKey:e.indicatorKey,field:e.indicatorKey,cellType:"text",define:Object.assign({},e)})),i[T]=k,n._headerObjects[T]=k;for(let e=r-1;e>=0;e--)t[e][n.colIndex]=l[e];if(t[r][n.colIndex]=T,e.levelSpan>1)for(let i=1;i<e.levelSpan;i++){if(!t[r+i]){t[r+i]=[];for(let e=0;e<n.colIndex;e++)t[r+i][e]=t[r][e]}t[r+i][n.colIndex]=T}if((null==(A=e.children)?void 0:A.length)>=1)n._addHeaders(t,r+(null!=(M=e.levelSpan)?M:1),null!=(F=e.children)?F:[],[...l,...Array(null!=(B=e.levelSpan)?B:1).fill(T)],i);else{for(let e=r+1;e<t.length;e++)t[e][n.colIndex]=T;n.colIndex++}}function d(e,t,i,l,r,n,s,h,d,u,c,g){var p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q;let Q=e.id,ee=null!=(f=null==(p=g.rowsDefine)?void 0:p.find(t=>"string"!=typeof t&&t.dimensionKey===e.dimensionKey))?f:null==(b=g.columnsDefine)?void 0:b.find(t=>"string"!=typeof t&&t.dimensionKey===e.dimensionKey),et=null==(m=g.indicatorsDefine)?void 0:m.find(t=>"string"!=typeof t&&(e.indicatorKey?t.indicatorKey===e.indicatorKey:t.title===e.value&&!e.dimensionKey)),ei={id:Q,title:null!=(C=e.value)?C:null==et?void 0:et.title,field:e.dimensionKey,style:"function"==typeof(null==(v=null!=et?et:ee)?void 0:v.headerStyle)?null==(w=null!=et?et:ee)?void 0:w.headerStyle:Object.assign({},null==(y=null!=et?et:ee)?void 0:y.headerStyle),headerType:null!=(_=null!=(x=null==et?void 0:et.headerType)?x:null==ee?void 0:ee.headerType)?_:"text",headerIcon:null!=(S=null==et?void 0:et.headerIcon)?S:null==ee?void 0:ee.headerIcon,define:Object.assign(e,{linkJump:null==(R=null!=et?et:ee)?void 0:R.linkJump,linkDetect:null==(H=null!=et?et:ee)?void 0:H.linkDetect,templateLink:null==(A=null!=et?et:ee)?void 0:A.templateLink,keepAspectRatio:null!=(F=null==(M=null!=et?et:ee)?void 0:M.keepAspectRatio)&&F,imageAutoSizing:null==(B=null!=et?et:ee)?void 0:B.imageAutoSizing,headerCustomRender:null==(T=null!=et?et:ee)?void 0:T.headerCustomRender,headerCustomLayout:null==(z=null!=et?et:ee)?void 0:z.headerCustomLayout,dragHeader:null==ee?void 0:ee.dragHeader,disableHeaderHover:!!(null==(L=null!=et?et:ee)?void 0:L.disableHeaderHover),disableHeaderSelect:!!(null==(k=null!=et?et:ee)?void 0:k.disableHeaderSelect),showSort:null!=(P=null==et?void 0:et.showSort)?P:null==ee?void 0:ee.showSort,hide:null==et?void 0:et.hide}),fieldFormat:null!=(I=null==et?void 0:et.headerFormat)?I:null==ee?void 0:ee.headerFormat,dropDownMenu:null!=(E=null==et?void 0:et.dropDownMenu)?E:null==ee?void 0:ee.dropDownMenu,pivotInfo:{value:e.value,dimensionKey:e.dimensionKey,isPivotCorner:!1},hierarchyLevel:e.level,dimensionTotalLevel:n,hierarchyState:e.hierarchyState,width:null==ee?void 0:ee.width,minWidth:null==ee?void 0:ee.minWidth,maxWidth:null==ee?void 0:ee.maxWidth,showSort:null!=(D=null==et?void 0:et.showSort)?D:null==ee?void 0:ee.showSort,sort:null==et?void 0:et.sort,description:null==ee?void 0:ee.description,parentCellId:l[l.length-1]};et?(et.customRender&&(e.customRender=et.customRender),(0,o.Z)(null==(W=g._indicators)?void 0:W.find(e=>e.indicatorKey===et.indicatorKey))||null==(O=g._indicators)||O.push({id:++g.sharedVar.seqId,indicatorKey:et.indicatorKey,field:et.indicatorKey,fieldFormat:null==et?void 0:et.format,cellType:null!=(N=null!=(G=null==et?void 0:et.cellType)?G:null==et?void 0:et.columnType)?N:"text",chartModule:"chartModule"in et?et.chartModule:null,chartSpec:"chartSpec"in et?et.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in et&&et.noDataRenderNothing,sparklineSpec:"sparklineSpec"in et?et.sparklineSpec:null,style:null==et?void 0:et.style,icon:null==et?void 0:et.icon,define:Object.assign({},e,et,{dragHeader:null==ee?void 0:ee.dragHeader}),width:null==et?void 0:et.width,minWidth:null==et?void 0:et.minWidth,maxWidth:null==et?void 0:et.maxWidth,disableColumnResize:null==et?void 0:et.disableColumnResize})):e.indicatorKey&&((0,o.Z)(null==(Z=g._indicators)?void 0:Z.find(t=>t.indicatorKey===e.indicatorKey))||null==(K=g._indicators)||K.push({id:++g.sharedVar.seqId,indicatorKey:e.indicatorKey,field:e.indicatorKey,cellType:"text",define:Object.assign({},e)})),i[Q]=ei,g._headerObjects[Q]=ei;for(let e=r-1;e>=0;e--)t[e][g.colIndex]=l[e];t[r][g.colIndex]=Q;let el=Math.min((u?c:!c)?s:s-1,null!=(V=e.levelSpan)?V:1e3);if(el>0)for(let e=r+1;e<el;e++){if(!t[e]){t[e]=[];for(let i=0;i<g.colIndex;i++)t[e][i]=t[r][i]}t[e][g.colIndex]=Q}if((null==(j=(e.hierarchyState===a.g.expand&&e).children)?void 0:j.length)>=1)g._addHeadersForGridTreeMode(t,r+(null!=(U=e.levelSpan)?U:1),null!=($=e.children)?$:[],[...l,...Array(null!=(X=e.levelSpan)?X:1).fill(Q)],n,s,h&&e.hierarchyState===a.g.expand,d,i,u);else{let o=(u?c:!c)?s:s-1;for(let e=r+1;e<o;e++)t[e]||(t[e]=[]),t[e][g.colIndex]=Q;if(r<=o-1&&(u&&!1===c||!u&&!0===c)){let a=e;for(;a&&!(null==(J=a.children)?void 0:J[0].indicatorKey);)a=a.children[0];g._addHeadersForGridTreeMode(t,s-1,null!=(Y=a.children)?Y:[],[...l,...Array(Math.max(o-r,null!=(q=e.levelSpan)?q:1)).fill(Q)],n,s,!0,d,i,u)}else g.colIndex++}}function u(e,t,i,l,r,n,s,h,d){var u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W;let O=e.id,G=h.find(t=>"string"!=typeof t&&t.dimensionKey===e.dimensionKey),N=null==(u=d.indicatorsDefine)?void 0:u.find(t=>"string"!=typeof t&&(e.indicatorKey?t.indicatorKey===e.indicatorKey:t.title===e.value)),Z={id:O,title:null!=(c=e.value)?c:N.title,field:e.dimensionKey,style:e.level+1===n||"function"==typeof(null==(g=null!=N?N:G)?void 0:g.headerStyle)?null==(p=null!=N?N:G)?void 0:p.headerStyle:Object.assign({},null==(f=null!=N?N:G)?void 0:f.headerStyle,{textAlign:"left"}),headerType:null!=(m=null!=(b=null==N?void 0:N.headerType)?b:null==G?void 0:G.headerType)?m:"text",headerIcon:null!=(C=null==N?void 0:N.headerIcon)?C:null==G?void 0:G.headerIcon,define:Object.assign(e,{linkJump:null==(v=null!=N?N:G)?void 0:v.linkJump,linkDetect:null==(w=null!=N?N:G)?void 0:w.linkDetect,templateLink:null==(y=null!=N?N:G)?void 0:y.templateLink,keepAspectRatio:null!=(_=null==(x=null!=N?N:G)?void 0:x.keepAspectRatio)&&_,imageAutoSizing:null==(S=null!=N?N:G)?void 0:S.imageAutoSizing,headerCustomRender:null==(R=null!=N?N:G)?void 0:R.headerCustomRender,headerCustomLayout:null==(H=null!=N?N:G)?void 0:H.headerCustomLayout,dragHeader:null==G?void 0:G.dragHeader,disableHeaderHover:!!(null==(A=null!=N?N:G)?void 0:A.disableHeaderHover),disableHeaderSelect:!!(null==(M=null!=N?N:G)?void 0:M.disableHeaderSelect),showSort:null!=(F=null==N?void 0:N.showSort)?F:null==G?void 0:G.showSort,hide:null==N?void 0:N.hide}),fieldFormat:null!=(B=null==N?void 0:N.headerFormat)?B:null==G?void 0:G.headerFormat,dropDownMenu:null!=(T=null==N?void 0:N.dropDownMenu)?T:null==G?void 0:G.dropDownMenu,pivotInfo:{value:e.value,dimensionKey:e.dimensionKey,isPivotCorner:!1},hierarchyLevel:e.level,dimensionTotalLevel:n,hierarchyState:e.hierarchyState,width:null==G?void 0:G.width,minWidth:null==G?void 0:G.minWidth,maxWidth:null==G?void 0:G.maxWidth,parentCellId:l[l.length-1]};N?(N.customRender&&(e.customRender=N.customRender),(0,o.Z)(null==(z=d._indicators)?void 0:z.find(e=>e.indicatorKey===N.indicatorKey))||null==(L=d._indicators)||L.push({id:++d.sharedVar.seqId,indicatorKey:N.indicatorKey,field:N.indicatorKey,fieldFormat:null==N?void 0:N.format,cellType:null!=(P=null!=(k=null==N?void 0:N.cellType)?k:null==N?void 0:N.columnType)?P:"text",chartModule:"chartModule"in N?N.chartModule:null,chartSpec:"chartSpec"in N?N.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in N&&N.noDataRenderNothing,sparklineSpec:"sparklineSpec"in N?N.sparklineSpec:null,style:null==N?void 0:N.style,icon:null==N?void 0:N.icon,define:Object.assign({},e,N,{dragHeader:null==G?void 0:G.dragHeader}),width:null==N?void 0:N.width,minWidth:null==N?void 0:N.minWidth,maxWidth:null==N?void 0:N.maxWidth,disableColumnResize:null==N?void 0:N.disableColumnResize})):e.indicatorKey&&((0,o.Z)(null==(I=d._indicators)?void 0:I.find(t=>t.indicatorKey===e.indicatorKey))||null==(E=d._indicators)||E.push({id:++d.sharedVar.seqId,indicatorKey:e.indicatorKey,field:e.indicatorKey,cellType:"text",define:Object.assign({},e)})),i[O]=Z,d._headerObjects[O]=Z,t[r][d.colIndex]=O;for(let e=r-1;e>=0;e--)t[e][d.colIndex]=l[e];if(e.hierarchyState===a.g.expand&&(null==(D=e.children)?void 0:D.length)>=1)s&&d.colIndex++,d._addHeadersForTreeMode(t,r,null!=(W=e.children)?W:[],[...l,O],n,s&&e.hierarchyState===a.g.expand,h,i);else{s&&d.colIndex++;for(let e=r+1;e<t.length;e++)t[e][d.colIndex]=O}}},52110:function(e,t,i){"use strict";i.d(t,{Wg:()=>s,wh:()=>h,zf:()=>d});var l=i(70506),o=i(91212),r=i(18585),n=i(60072),a=i(75025);class s{constructor(e,t,i){this.table=e,this.customCellStyle=t,this.customCellStyleArrangement=i}getCustomCellStyle(e,t){let i=this.getCustomCellStyleIds(e,t);if(i.length){let r=[];return i.forEach(i=>{let o=this.getCustomCellStyleOption(i);if((0,l.Z)(null==o?void 0:o.style)){let i=o.style({col:e,row:t,table:this.table,value:this.table.getCellValue(e,t),dataValue:this.table.getCellOriginValue(e,t),cellHeaderPaths:this.table.getCellHeaderPaths(e,t)});r.push(i)}else(null==o?void 0:o.style)&&r.push(o.style)}),(0,o.Z)({},...r)}}getCustomCellStyleIds(e,t){let i=[],l=this.table.getCellRange(e,t);for(let e=l.start.col;e<=l.end.col;e++)for(let t=l.start.row;t<=l.end.row;t++)this.customCellStyleArrangement.forEach(l=>{l.cellPosition.range?l.cellPosition.range.start.col<=e&&l.cellPosition.range.end.col>=e&&l.cellPosition.range.start.row<=t&&l.cellPosition.range.end.row>=t&&i.push(l.customStyleId):l.cellPosition.col===e&&l.cellPosition.row===t&&i.push(l.customStyleId)});return i}getCustomCellStyleOption(e){return this.customCellStyle.find(t=>t.id===e)}registerCustomCellStyle(e,t){let i=this.customCellStyle.findIndex(t=>t.id===e);-1===i?this.customCellStyle.push({id:e,style:t}):this.customCellStyle[i]={id:e,style:t},this.customCellStyleArrangement.forEach(t=>{let i=t.cellPosition;if(t.customStyleId===e)if(i.range)for(let e=Math.max(0,i.range.start.col);e<=Math.min(this.table.colCount-1,i.range.end.col);e++)for(let t=Math.max(0,i.range.start.row);t<=Math.min(this.table.rowCount-1,i.range.end.row);t++)this.table.scenegraph.updateCellContent(e,t);else this.table.scenegraph.updateCellContent(i.col,i.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(e,t,i){var l;let o=this.customCellStyleArrangement.findIndex(t=>t.cellPosition.range&&e.range?t.cellPosition.range.start.col===e.range.start.col&&t.cellPosition.range.start.row===e.range.start.row&&t.cellPosition.range.end.col===e.range.end.col&&t.cellPosition.range.end.row===e.range.end.row:t.cellPosition.col===e.col&&t.cellPosition.row===e.row);if(-1===o&&!t)return;if(-1===o&&t)this.customCellStyleArrangement.push({cellPosition:{col:e.col,row:e.row,range:e.range},customStyleId:t});else{if(this.customCellStyleArrangement[o].customStyleId===t)return;t?this.customCellStyleArrangement[o].customStyleId=t:this.customCellStyleArrangement.splice(o,1)}let r=null==(l=this.getCustomCellStyleOption(t))?void 0:l.style;if(r){for(let e in i=!0,r)if(-1===n.n.indexOf(e)){i=!1;break}}if(e.range)for(let t=Math.max(0,e.range.start.col);t<=Math.min(this.table.colCount-1,e.range.end.col);t++)for(let l=Math.max(0,e.range.start.row);l<=Math.min(this.table.rowCount-1,e.range.end.row);l++){let e=this.table.getCellRange(t,l);for(let t=e.start.col;t<=e.end.col;t++)for(let l=e.start.row;l<=e.end.row;l++)this.table.scenegraph.updateCellContent(t,l,i)}else this.table.scenegraph.updateCellContent(e.col,e.row,i);this.table.scenegraph.updateNextFrame()}updateCustomCell(e,t){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,e.forEach(e=>{this.registerCustomCellStyle(e.id,e.style)}),t.forEach(e=>{this.arrangeCustomCellStyle(e.cellPosition,e.customStyleId)})}hasCustomCellStyle(e){return this.customCellStyle.some(t=>t.id===e)}}function h(e,t){for(let i in e=e.clone(),t){let l=t[i];(0,r.Z)(l)&&(e[`_${i}`]=l)}return e}let d=()=>{a.F.registerComponent("customCellStylePlugin",s)}},61240:function(e,t,i){"use strict";i.d(t,{Q:()=>l});class l{constructor(e,t){var i;this.plugins=new Map,this.table=e,null==(i=t.plugins)||i.map(e=>{this.register(e),this._bindTableEventForPlugin(e)})}register(e){this.plugins.set(e.id,e)}registerAll(e){e.forEach(e=>this.register(e))}getPlugin(e){return this.plugins.get(e)}getPluginByName(e){return Array.from(this.plugins.values()).find(t=>t.name===e)}_bindTableEventForPlugin(e){var t;null==(t=e.runTime)||t.forEach(t=>{this.table.on(t,(...i)=>{var l;null==(l=e.run)||l.call(e,...i,t,this.table)})})}updatePlugins(e){Array.from(this.plugins.values()).filter(t=>!(null==e?void 0:e.some(e=>e.id===t.id))).forEach(e=>{this.release(),this.plugins.delete(e.id)}),this.plugins.forEach(e=>{e.update&&e.update()});let t=null==e?void 0:e.filter(e=>!this.plugins.has(e.id));null==t||t.forEach(e=>{this.register(e),this._bindTableEventForPlugin(e)})}release(){this.plugins.forEach(e=>{var t;null==(t=e.release)||t.call(e,this.table)})}}},94751:function(e,t,i){"use strict";i.r(t),i.d(t,{aggregator:()=>g,chartModule:()=>u,clearAll:()=>f,editor:()=>c,icon:()=>d,theme:()=>h});var l=i(4234),o=i(88607),r=i(80363),n=i(62482),a=i(61763);function s(e,t,i){let l=e[t];return e[t]=i,l}function h(e,t){return null!=t?s(o.n,e,t):o.n[e]}function d(e,t){return null!=t?s(l.ci,e,t):l.ci[e]}function u(e,t){return null!=t?s(r.f,e,t):r.f[e]}function c(e,t){return null!=t?s(n.X,e,t):n.X[e]}function g(e,t){null!=t&&s(a.YJ,e,t)}function p(e){for(let t in e)delete e[t]}function f(){p(o.n),p(l.ci),p(r.f),p(n.X),p(a.YJ)}},31604:function(e,t,i){"use strict";i.d(t,{FH:()=>v,Jp:()=>_,cd:()=>w,nH:()=>S,ws:()=>y});var l=i(53068),o=i(11971),r=i(28651),n=i(29411),a=i(21054),s=i(73208),h=i(52812),d=i(70506),u=i(18585),c=i(58853),g=i(47e3),p=i(43735),f=i(1669),b=i(57752),m=i(63388);let C="_custom_",v="custom-container",w=C+"_0";function y(e,t,i,h,g,p,m,w,y,H,A){var M,F,B;let T,z,L,k,P=!0,I=!1;if("react-custom-layout"===e&&(e=(null==(M=A.reactCustomLayout)?void 0:M.getCustomLayoutFunc(i,h))||b.D),"function"==typeof e){let t=e({col:null!=(F=null==H?void 0:H.start.col)?F:i,row:null!=(B=null==H?void 0:H.start.row)?B:h,dataValue:A.getCellOriginValue(i,h),value:A.getCellValue(i,h)||"",rect:{left:0,top:0,right:g,bottom:p,width:g,height:p},table:A,originCol:i,originRow:h});if(!t)return{renderDefault:!0};t.rootContainer&&(t.rootContainer=S(t.rootContainer,A.animationManager.timeline)),t.rootContainer instanceof l.ZA&&((k=t.rootContainer).name=v,k.col=i,k.row=h),P=t.renderDefault,I=t.enableCellPadding}else if("function"==typeof t){let e=t({col:i,row:h,dataValue:A.getCellOriginValue(i,h),value:A.getCellValue(i,h)||"",rect:{left:0,top:0,right:g,bottom:p,width:g,height:p},table:A});e&&(L=e.elements,P=e.renderDefault,T=e.expectedWidth,z=e.expectedHeight)}else t&&(T=t.expectedWidth,z=t.expectedHeight,L=t.elements,P=t.renderDefault);return L&&(k=function(e,t,i,h){let g=new l.ZA({x:0,y:0,width:t,height:i,fill:!1,stroke:!1,pickable:!1});return g.name=v,(function(e,t,i,l){let o=[];for(let r=0;r<e.length;r++){let n=Object.assign({},e[r]);for(let e in n)n.hasOwnProperty(e)&&(0,d.Z)(n[e])&&(n[e]=n[e](l));(0,u.Z)(n.x)&&(n.x=(0,c.Z)(n.x)?x(n.x,t-0):Number(n.x)),(0,u.Z)(n.y)&&(n.y=(0,c.Z)(n.y)?x(n.y,i-0):Number(n.y)),"width"in n&&(n.width=(0,c.Z)(n.width)?x(n.width,t-0):Number(n.width)),"height"in n&&(n.height=(0,c.Z)(n.height)?x(n.height,i-0):Number(n.height)),"radius"in n&&(n.radius=(0,c.Z)(n.radius)?x(n.radius,Math.min(t-0,i-0)):Number(n.radius)),"hover"in n&&(n.hover.x=(0,c.Z)(n.hover.x)?x(n.hover.x,t-0):Number(n.hover.x),n.hover.y=(0,c.Z)(n.hover.y)?x(n.hover.y,i-0):Number(n.hover.y),n.hover.width=(0,c.Z)(n.hover.width)?x(n.hover.width,t-0):Number(n.hover.width),n.hover.height=(0,c.Z)(n.hover.height)?x(n.hover.height,i-0):Number(n.hover.height),n.hover.x+=0,n.hover.y+=0),n.x=n.x+0,n.y=n.y+0,o.push(n)}return o})(e,t,i,h).forEach(e=>{var t,i,l,h,d,u,c,p,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P;switch(e.clickable&&(e.pickable=e.clickable),e.type){case"arc":let I=(0,o.Q)({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(i=e.dy)?i:0,fill:e.fill,stroke:e.stroke,outerRadius:e.radius,startAngle:e.startAngle,endAngle:e.endAngle,pickable:!!e.pickable,cursor:e.cursor});I.name=e.name,g.appendChild(I);break;case"text":if(e.background){let t=null!=(h=null==(l=e.background)?void 0:l.expandX)?h:0,i=null!=(u=null==(d=e.background)?void 0:d.expandY)?u:0,o=(0,r.f)({x:e.x-t,y:e.y-i,dx:null!=(c=e.dx)?c:0,dy:null!=(p=e.dy)?p:0,width:e.width+2*t,height:e.height+2*i,cornerRadius:null!=(m=null==(b=e.background)?void 0:b.cornerRadius)?m:0,fill:null!=(v=null==(C=e.background)?void 0:C.fill)?v:"#888"});g.appendChild(o)}let E=new n.x(Object.assign({pickable:!!e.pickable,fill:null!=(w=e.color)?w:e.fill},e));E.name=e.name,g.appendChild(E);break;case"rect":let D=(0,r.f)({x:e.x,y:e.y,dx:null!=(y=e.dx)?y:0,dy:null!=(x=e.dy)?x:0,width:e.width,height:e.height,cornerRadius:e.radius,fill:e.fill,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});D.name=e.name,g.appendChild(D);break;case"circle":let W=(0,a.y)({x:e.x,y:e.y,dx:null!=(_=e.dx)?_:0,dy:null!=(S=e.dy)?S:0,radius:e.radius,fill:e.fill,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});W.name=e.name,g.appendChild(W);break;case"icon":let O=new f.J({x:e.x,y:e.y,dx:null!=(R=e.dx)?R:0,dy:null!=(H=e.dy)?H:0,width:e.width,height:e.height,image:e.svg,backgroundWidth:e.hover?null!=(A=e.hover.width)?A:e.width:void 0,backgroundHeight:e.hover?null!=(M=e.hover.width)?M:e.width:void 0,backgroundColor:e.hover?null!=(F=e.hover.bgColor)?F:"rgba(22,44,66,0.2)":void 0,pickable:!!e.pickable,cursor:e.cursor});O.name=e.name,O.role="icon-custom",g.appendChild(O);break;case"image":let G=new f.J({x:e.x,y:e.y,dx:null!=(B=e.dx)?B:0,dy:null!=(T=e.dy)?T:0,width:e.width,height:e.height,image:e.src,backgroundWidth:e.hover?null!=(z=e.hover.width)?z:e.width:void 0,backgroundHeight:e.hover?null!=(L=e.hover.width)?L:e.width:void 0,backgroundColor:e.hover?null!=(k=e.hover.bgColor)?k:"rgba(22,44,66,0.2)":void 0,pickable:!!e.pickable,cursor:e.cursor,shape:e.shape});G.name=e.name,G.role="image-custom",g.appendChild(G);break;case"line":let N=(0,s.W)({points:e.points,lineWidth:null!=(P=e.lineWidth)?P:1,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});N.name=e.name,g.appendChild(N)}}),g}(L,m?T:g,w?z:p,A.getCellValue(i,h))),I&&k.setAttributes({x:y[3],y:y[0],width:g-y[1]-y[3],height:p-y[0]-y[2]}),_(k,g,p),H&&(H.start.col!==H.end.col||H.start.row!==H.end.row)&&function e(t,i,l,o,r){t&&(t.name=`${C}${null!=r?r:""}_${o}`,t.onBeforeAttributeUpdate=R,"group"===t.type&&t.childrenCount&&t.forEachChildren((t,n)=>{e(t,i,l,n,(null!=r?r:"")+"_"+o)}))}(k,i,h,0),{elementsGroup:k,renderDefault:P}}function x(e,t){return e.endsWith("px")?parseInt(e,10):e.endsWith("%")&&t?parseInt(e,10)/100*t:parseInt(e,10)}function _(e,t,i){e&&e.forEachChildren(e=>{var l,o;e&&((0,g.Z)(e.attribute.width)&&e.attribute.width.percent&&e.setAttribute("width",Math.max(0,e.attribute.width.percent/100*t+(null!=(l=e.attribute.width.delta)?l:0))),e.attribute.width<0&&e.setAttribute("width",0),(0,g.Z)(e.attribute.height)&&e.attribute.height.percent&&e.setAttribute("height",Math.max(0,e.attribute.height.percent/100*i+(null!=(o=e.attribute.height.delta)?o:0))),e.attribute.height<0&&e.setAttribute("height",0),"group"===e.type&&_(e,e.attribute.width,e.attribute.height))})}function S(e,t){if(!e||!(0,u.Z)(e.$$typeof)&&!(0,u.Z)(e.vtype))return e;let i=e.type,{attribute:l,children:o,stateProxy:r,animation:n}=e.props,a=i({attribute:l});if(function(e,t){let i=!1;switch(e.type){case"richtext":case"rich/image":break;default:i=!0}i&&Object.keys(t).forEach(i=>{let l=h.Nv[i];l&&e.on(l,t[i])})}(a,e.props),r&&(a.stateProxy=r),a.id=l.id,a.name=l.name,(0,p.Z)(o)?o.forEach(e=>{let i=S(e,t);i&&i.type&&a.add(i)}):o&&a.add(S(o,t)),(0,p.Z)(n)&&t){let e=a.animate();e.setTimeline(t),n.forEach(t=>{e[t[0]](...t.slice(1))})}return a}function R(e,t){if(this.skipMergeUpdate)return;let i=(0,m.J$)(this);if(!i||!i.stage)return;let l=i.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:o,mergeEndCol:r,mergeStartRow:n,mergeEndRow:a}=i;if((0,u.Z)(o)&&(0,u.Z)(r)&&(0,u.Z)(n)&&(0,u.Z)(a)&&(o!==r||n!==a)){for(let t=o;t<=r;t++)for(let o=n;o<=a;o++){if(t===i.col&&o===i.row)continue;let r=l.scenegraph.highPerformanceGetCell(t,o);if("cell"===r.role){let t=r.getChildByName(this.name,!0);if(!t||t.skipAttributeUpdate)continue;for(let i in e)e[i]!==t.attribute[i]&&"dx"!==i&&"dy"!==i&&t.setAttribute(i,e[i])}}this.skipAttributeUpdate=void 0}}},22672:function(e,t,i){"use strict";i.d(t,{e:()=>s,k:()=>h});var l=i(42915),o=i(28651),r=i(91212),n=i(22295),a=i(23149);let s=(0,l.Gg)();class h extends o.U{constructor(e,t){if(super(t),this.type="chart",this.numberType=s,this.isShareChartSpec=e,t.chartInstance)this.chartInstance=t.chartInstance;else{let e=this.chartInstance=new t.ClassType(t.spec,(0,r.Z)({},this.attribute.tableChartOption,{renderCanvas:t.canvas,mode:"node"===this.attribute.mode?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:t.dpr,interactive:!1,animation:!1,autoFit:!1}));e.renderSync(),e.getStage().enableDirtyBounds(),t.chartInstance=this.chartInstance=e}}activate(e){var t,i,l,o;this.active=!0;let{col:s,row:d}=this.parent,u=(0,a.J)(this.parent,e),{x1:c,y1:g,x2:p,y2:f}=this.getViewBox(),b=(function(e,t,i){var l,o,r,a,s,h,d,u;let{layoutMap:c}=i.internalProps,g=new n.YZ,p=i.scenegraph.tableGroup.globalAABBBounds;return g.x1=p.x1,g.x2=p.x2,g.y1=p.y1,g.y2=p.y2,c.isLeftBottomCorner(e,t)||c.isRightTopCorner(e,t)||c.isLeftTopCorner(e,t)||c.isRightBottomCorner(e,t)||(c.isFrozenColumn(e,t)?(g.y1=p.y1+i.getFrozenRowsHeight(),g.y2=p.y2-i.getBottomFrozenRowsHeight()):c.isFrozenRow(e,t)?(g.x1=p.x1+i.getFrozenColsWidth(),g.x2=p.x2-i.getRightFrozenColsWidth()):c.isRightFrozenColumn(e,t)?(g.y1=p.y1+i.getFrozenRowsHeight(),g.y2=p.y2-i.getBottomFrozenRowsHeight()):c.isBottomFrozenRow(e,t)?(g.x1=p.x1+i.getFrozenColsWidth(),g.x2=p.x2-i.getRightFrozenColsWidth()):c.isFrozenColumn(e,t)||c.isRightFrozenColumn(e,t)||(g.x1=p.x1+i.getFrozenColsWidth(),g.x2=p.x2-i.getRightFrozenColsWidth(),g.y1=p.y1+i.getFrozenRowsHeight(),g.y2=p.y2-i.getBottomFrozenRowsHeight())),g.x1=g.x1+(null!=(o=null==(l=i.options.viewBox)?void 0:l.x1)?o:0),g.x2=g.x2+(null!=(a=null==(r=i.options.viewBox)?void 0:r.x1)?a:0),g.y1=g.y1+(null!=(h=null==(s=i.options.viewBox)?void 0:s.y1)?h:0),g.y2=g.y2+(null!=(u=null==(d=i.options.viewBox)?void 0:d.y1)?u:0),g})(s,d,e).intersect({x1:c-e.scrollLeft,x2:p-e.scrollLeft,y1:g-e.scrollTop,y2:f-e.scrollTop});null==(t=this.activeChartInstance)||t.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,(0,r.Z)({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:p-c,y1:0,y2:f-g},dpr:e.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:t=>{let i=this.stage,l=t.window.getContext(),o=i.window.getViewBoxTransform(),r=i.window.getViewBox();l.inuse=!0,l.clearMatrix(),l.setTransform(o.a,o.b,o.c,o.d,o.e,o.f,!0),l.translate(r.x1,r.y1),l.setTransformForCurrent(!0),l.beginPath(),l.rect(b.x1,b.y1,b.x2-b.x1,b.y2-b.y1),l.clip(),l.clearMatrix(),e.options.canvas&&!t.needRender&&(t.pauseRender(),e.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),e.scenegraph.updateNextFrame())},afterRender(e){e.window.getContext().inuse=!1,e.needRender=!1,m.resumeRender()},renderHooks:{afterClearRect(e){let{context:t,layer:i,viewBox:l}=e;i.main&&e.clear&&(t.beginPath(),t.fillStyle=u,t.rect(l.x1,l.y1,l.x2-l.x1,l.y2-l.y1),t.fill())}}}));let m=this.activeChartInstance.getStage(),C=this.globalTransMatrix.clone(),v=this.stage.window.getViewBoxTransform();C.multiply(v.a,v.b,v.c,v.d,v.e,v.f),m.window.setViewBoxTransform&&m.window.setViewBoxTransform(C.a,C.b,C.c,C.d,C.e,C.f),this.activeChartInstance.renderSync(),null==(l=null==(i=e.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||l.call(i,this.activeChartInstance),this.activeChartInstance.on("click",t=>{var i;!1===(null==(i=this.attribute.spec.select)?void 0:i.enable)?e.scenegraph.updateChartState(null):h.temp&&e.scenegraph.updateChartState(null==t?void 0:t.datum)}),this.activeChartInstance.on("brushEnd",t=>{var i;e.scenegraph.updateChartState(null==(i=null==t?void 0:t.value)?void 0:i.inBrushData),h.temp=0,setTimeout(()=>{h.temp=1},0)}),null==(o=e._bindChartEvent)||o.call(e,this.activeChartInstance)}deactivate(){var e,t;this.active=!1,null==(e=this.activeChartInstance)||e.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),null==(t=this.activeChartInstance)||t.release(),this.activeChartInstance=null}updateData(e){this.attribute.data=e}getViewBox(){var e,t,i,l,o,r,n,a;let s=this.parent,h=this.attribute.cellPadding,d=this.stage.table,{x1:u,y1:c,x2:g,y2:p}=s.globalAABBBounds;return{x1:Math.ceil(u+h[3]+d.scrollLeft+(null!=(t=null==(e=d.options.viewBox)?void 0:e.x1)?t:0)),x2:Math.ceil(u+s.attribute.width-h[1]+d.scrollLeft+(null!=(l=null==(i=d.options.viewBox)?void 0:i.x1)?l:0)),y1:Math.ceil(c+h[0]+d.scrollTop+(null!=(r=null==(o=d.options.viewBox)?void 0:o.y1)?r:0)),y2:Math.ceil(c+s.attribute.height-h[2]+d.scrollTop+(null!=(a=null==(n=d.options.viewBox)?void 0:n.y1)?a:0))}}}h.temp=1},62727:function(e,t,i){"use strict";i.d(t,{A8:()=>a,H6:()=>g,LO:()=>s,Ry:()=>c,Up:()=>b,a5:()=>p,eO:()=>function e(t){u=!0,s.length>0?h=requestAnimationFrame(()=>{let i=s.splice(0,d);a.splice(0,d),i.forEach(e=>{f(e),e.addUpdateBoundTag()}),t.render(),e(t)}):u=!1},pF:()=>f});var l=i(93279),o=i(52650),r=i(18585),n=i(22295);let a=[],s=[],h,d=5,u=!1;function c(e){(0,r.Z)(e)&&(d=e)}function g(){a=[],s=[],u=!1,cancelAnimationFrame(h)}function p(){return u}function f(e){var t,i,l,o,r,n,a;let{axes:s,dataId:h,data:d,spec:u,ClassType:c,canvas:g,mode:p,modeParams:f,dpr:m}=e.attribute,{chartInstance:C}=e;C||((C=new c(u,{renderCanvas:g,mode:"node"===p?"node":"desktop-browser",modeParams:f,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:m,interactive:!1,animation:!1,autoFit:!1})).renderSync(),e.chartInstance=C);let v=e.getViewBox();v.x2<=v.x1&&(v.x2=v.x1+1),v.y2<=v.y1&&(v.y2=v.y1+1),C.updateViewBox({x1:0,x2:v.x2-v.x1,y1:0,y2:v.y2-v.y1},!1,!1);let w=C.getStage(),y=e.globalTransMatrix,x=e.stage.window.getViewBoxTransform().clone();x.multiply(y.a,y.b,y.c,y.d,y.e,y.f),w.window.setViewBoxTransform&&w.window.setViewBoxTransform(x.a,x.b,x.c,x.d,x.e,x.f);let{table:_}=e.getRootNode(),S=!1;if(_.options.specFormat){let i=_.options.specFormat(e.attribute.spec,C,e);if(i.needFormatSpec&&i.spec){let e=i.spec;C.updateSpecSync(e),S=null==(t=i.updateSpec)||t}}if(!S)if(null==s||s.forEach((e,t)=>{var i,l,o,r,n;"band"===e.type?C.updateModelSpec({type:"axes",index:t},{domain:e.domain.slice(0)},!0):C.updateModelSpecSync({type:"axes",index:t},{min:null!=(l=null==(i=e.range)?void 0:i.min)?l:0,max:null!=(r=null==(o=e.range)?void 0:o.max)?r:0,tick:{tickMode:null==(n=e.tick)?void 0:n.tickMode}},!0)}),null==(l=null==(i=_.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||l.call(i,C),"string"==typeof h)C.updateDataSync(h,null!=d?d:[]);else{let e=[];for(let t in h){let i=h[t],l=u.series.find(e=>{var i;return(null==(i=null==e?void 0:e.data)?void 0:i.id)===t});e.push({id:t,values:i?null!=(o=null==d?void 0:d.filter(e=>e.hasOwnProperty(i)))?o:[]:null!=d?d:[],fields:null==(r=null==l?void 0:l.data)?void 0:r.fields}),C.updateFullDataSync||C.updateDataSync(t,i?null!=(n=null==d?void 0:d.filter(e=>e.hasOwnProperty(i)))?n:[]:null!=d?d:[])}null==(a=C.updateFullDataSync)||a.call(C,e)}_.fireListeners("before_cache_chart_image",{chartInstance:C}),b(C.getStage(),e)}function b(e,t){var i;let{viewWidth:l,viewHeight:o}=e;if(l<2e3&&o<2e3)return t.cacheCanvas=m(e),void(t.isShareChartSpec||(null==(i=t.chartInstance)||i.release(),t.chartInstance=null,t.setAttribute("chartInstance",null)));let r=Math.ceil(o/2e3),a=Math.ceil(l/2e3),s=[];for(let t=0;t<r;t++)for(let i=0;i<a;i++){let r=2e3*i,a=2e3*t,h=r+2e3>l?l:r+2e3,d=a+2e3>o?o:a+2e3,u=h-r,c=d-a,g=new n.YZ;g.setValue(r,a,h,d);let p=m(e,!1,g);s.push({canvas:p,x:r,y:a,width:u,height:c})}t.cacheCanvas=s}function m(e,t=!0,i){if("released"===e.releaseStatus)return null;let r=(function(e,t=!0,i){let r=e.window.getViewBoxTransform(),n=l.n.get(o.Oo),a=i?-i.x1:0,s=i?-i.y1:0,h=i?i.x2:e.viewWidth,d=i?i.y2:e.viewHeight,u=i?i.width():e.viewWidth,c=i?i.height():e.viewHeight;return n.create({viewBox:{x1:a,y1:s,x2:h,y2:d},width:u*r.a,height:c*r.d,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""}),n.setViewBoxTransform(r.a,r.b,r.c,r.d,0,0),e.renderTo(n),n})(e,t,i).getNativeHandler();return r.nativeCanvas?r.nativeCanvas:null}},38512:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(53068);class o extends l.ZA{clear(){this.removeAllChild()}getChildByName(e,t){let i=null;return this.forEachChildren(t=>t.name===e&&(i=t,!0)),t&&this.forEachChildren(t=>{if(t.getChildByName){let l=t.getChildByName(e,!0);if(l)return i=l,!0}return!1}),i}get width(){var e;let t=this.AABBBounds.width();return t!==1/0&&t!==-1/0||(t=0),Math.max(t,null!=(e=this.attribute.width)?e:0)}get height(){var e;let t=this.AABBBounds.height();return t!==1/0&&t!==-1/0||(t=0),Math.max(t,null!=(e=this.attribute.height)?e:0)}setDeltaWidth(e){var t;0!==e&&(this.setAttribute("width",(null!=(t=this.attribute.width)?t:0)+e),this.border&&(this.border.setAttribute("width",this.border.attribute.width+e),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+e)))}setDeltaHeight(e){var t;0!==e&&(this.setAttribute("height",(null!=(t=this.attribute.height)?t:0)+e),this.border&&(this.border.setAttribute("height",this.border.attribute.height+e),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+e)))}setDeltaX(e){0!==e&&this.setAttribute("x",this.attribute.x+e)}setDeltaY(e){0!==e&&this.setAttribute("y",this.attribute.y+e)}forEachChildrenSkipChild(e,t="border-rect",i=!1){if(i){let i=this._lastChild,l=0;for(;i;){if(i.name!==t&&e(i,l++))return;i=i._prev}}else{let i=this._firstChild,l=0;for(;i;){if(i.name!==t&&e(i,l++))return;i=i._next}}}getColGroup(e){let t=this._firstChild;if(!t)return null;for(let i=0;i<this.childrenCount;i++){if(t.col===e)return t;t=t._next}return null}getRowGroup(e){let t=this._firstChild;if(!t)return null;for(let i=0;i<this.childrenCount;i++){if(t.row===e)return t;t=t._next}return null}addCellGroup(e){if(0===this.childrenCount||this.lastChild.row===e.row-1)this.addChild(e);else{let t=this._firstChild;for(let i=0;i<this.childrenCount;i++){if(t.row===e.row-1)return void this.insertAfter(e,t);t=t._next}this.addChild(e)}}getChildAt(e){let t=super.getChildAt(e);return t&&"border-rect"===t.name?t._next:t}tryUpdateAABBBounds(){if("cell"===this.role){var e,t;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;let i=this.shouldSelfChangeUpdateAABBBounds(),l=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),e=this,t=i,e.stage&&e.stage.dirtyBounds&&e.stage.renderCount&&(e.isContainer&&!t||e.stage.dirty(e.globalAABBBounds)),l}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if("cell"===this.role){let{x:e,y:t,width:i,height:l}=this.attribute;return this._AABBBounds.setValue(e,t,e+i,t+l),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return"body"===this.role||"row-header"===this.role||"col-header"===this.role||"right-frozen"===this.role||"bottom-frozen"===this.role||"corner-header"===this.role||"corner-right-top-header"===this.role||"corner-right-bottom-header"===this.role||"corner-left-bottom-header"===this.role?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(e){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,e):this.rowNumber=e}updateColumnHeight(e){this.colHeight?this.colHeight+=e:this.colHeight=e}}},1669:function(e,t,i){"use strict";i.d(t,{J:()=>s,V:()=>h});var l=i(19427),o=i(77502),r=i(29411),n=i(29216),a=i(4234);class s extends l.E{constructor(e){super(e),this.failCallback=()=>{let{svg:e,src:t}=a.U2().damage_pic||{},i=e||t;i&&(super.image=i)},"mouseenter_cell"!==this.attribute.visibleTime&&"click_cell"!==this.attribute.visibleTime||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,o.h.GetFile(this.attribute.gif+"?role=gif"+`&radom=${Math.random()}`,"arrayBuffer").then(e=>{let t=(0,n.parseGIF)(e),i=(0,n.decompressFrames)(t,!0);this.renderGIF(i),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(e=>{})}get backgroundWidth(){var e,t;return null!=(t=null!=(e=this.attribute.backgroundWidth)?e:this.attribute.width)?t:0}get backgroundHeight(){var e,t;return null!=(t=null!=(e=this.attribute.backgroundHeight)?e:this.attribute.height)?t:0}renderGIF(e){this.loadedFrames=e,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=e[0].dims.width,this.gifCanvas.height=e[0].dims.height,this.playing=!0,this.lastTime=(new Date).getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(e,t,i){let l=this.loadedFrames[this.frameIndex||0];2===l.disposalType&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(l),this.manipulate(e,t,i);let o=(new Date).getTime()-this.lastTime;l.delay<o&&(this.frameIndex++,this.lastTime=(new Date).getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(e){let t=e.dims;this.frameImageData&&t.width===this.frameImageData.width&&t.height===this.frameImageData.height||(this.tempCanvas.width=t.width,this.tempCanvas.height=t.height,this.frameImageData=this.tempCtx.createImageData(t.width,t.height)),this.frameImageData.data.set(e.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,t.left,t.top)}manipulate(e,t,i){e.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,t,i,this.attribute.width,this.attribute.height)}setAttribute(e,t,i,l){super.setAttribute(e,t,i,l),"gif"===e&&this.loadGif()}setAttributes(e,t,i){super.setAttributes(e,t,i),e.gif&&this.loadGif()}}class h extends r.x{constructor(e){var t,i,l,o,r;e.fill=null!=(t=e.fill)?t:"#00F",e.fontSize=null!=(i=e.fontSize)?i:12,e.underline=null!=(l=e.underline)?l:1,e.textBaseline=null!=(o=e.textBaseline)?o:"top",e.cursor=null!=(r=e.cursor)?r:"pointer",super(e)}}},17097:function(e,t,i){"use strict";i.d(t,{pZ:()=>S,l7:()=>H,kE:()=>v,NQ:()=>R,wW:()=>y});var l=i(90251),o=i(31604),r=i(60232),n=i(50071),a=i(77597),s=i(60740),h=i(75025),d=i(81668),u=i(37811),c=i(49277),g=i(58977),p=i(43735),f=i(33291),b=i(18585);function m(e,t){var i,l;if(this.shadowRoot&&this.shadowRoot.childrenCount&&((0,b.Z)(e.width)||(0,b.Z)(e.height))){let t=this.shadowRoot.findChildrenByName("shadow-rect")[0];t&&t.setAttributes({width:null!=(i=e.width)?i:t.attribute.width,height:null!=(l=e.height)?l:t.attribute.height})}}var C=i(5569);function v(e,t,i,o,n,s,d,u,c,g,p,f,b,C,v,y,x,_){var S,R;let H,A=!1;if((0,a.tI)(t)){if("cell"!==o.scenegraph.highPerformanceGetCell(n,s).role)return H;t=o.getCellValue(n,s),A=!0}if("checkbox"===e&&i.tree)H=h.F.getFunction("createCheckboxCellGroup")(null,g,0,p,n,s,d,u,c,f,b,C,v,o,y,i,x,A,!0);else if("text"===e||"link"===e||_){if("link"===e){let h=t,d=o.getCellOriginValue(n,s),u=o._getCellStyle(n,s);"link"===e&&("templateLink"in i&&i.templateLink||!("linkDetect"in i)||!(0,a.vi)(i.linkDetect,{col:n,row:s,table:o,value:h,dataValue:d,cellHeaderPaths:void 0})||l.tP.test(h))&&(y?(y.text.fill=(0,r.WJ)("linkColor",u,n,s,o),y.group.cursor="pointer"):y={text:{fill:(0,r.WJ)("linkColor",u,n,s,o)},group:{cursor:"pointer"}})}let{customElementsGroup:m,renderDefault:R}=w(o,i,n,s,u,c,f,x,_);H=h.F.getFunction("createTextCellGroup")(o,t,g,0,p,n,s,d,u,c,f,b,C,v,m,R,y,x,A);let M=o.internalProps.layoutMap.getAxisConfigInPivotChart(n,s);if(M){let e=new(h.F.getComponent("axis"))(M,H.attribute.width,H.attribute.height,null!=(S=M.__vtablePadding)?S:f,o);H.clear(),H.appendChild(e.component),e.overlap()}else o.internalProps.layoutMap.isEmpty(n,s)?(H.setAttributes({fill:!1,stroke:!1}),H.clear()):o.internalProps.layoutMap.isAxisCell(n,s)&&H.clear()}else if("image"===e)H=h.F.getFunction("createImageCellGroup")(g,0,p,n,s,u,c,i.keepAspectRatio,i.imageAutoSizing,f,b,C,v,o,y,x,A);else if("video"===e)H=h.F.getFunction("createVideoCellGroup")(g,0,p,n,s,u,c,i.keepAspectRatio,i.imageAutoSizing,f,b,C,v,o,y,x,A);else if("chart"===e){let e=o.internalProps.layoutMap.getChartInstance(n,s);H=h.F.getFunction("createChartCellGroup")(null,g,0,p,n,s,u,c,f,t,i.chartModule,o.internalProps.layoutMap.getChartSpec(n,s),e,null!=(R=o.internalProps.layoutMap.getChartDataId(n,s))?R:"data",o,y,o.internalProps.layoutMap.isShareChartSpec(n,s),A,o.internalProps.layoutMap.isNoChartDataRenderNothing(n,s))}else if("progressbar"===e){let{customElementsGroup:e,renderDefault:l}=w(o,i,n,s,u,c,f,x,_),r=o._getCellStyle(n,s),a=o.getCellOriginValue(n,s);H=h.F.getFunction("createTextCellGroup")(o,t,g,0,p,n,s,d,u,c,f,b,C,v,e,l,y,x,A);let m=h.F.getFunction("createProgressBarCell")(i,r,d,t,a,n,s,f,o,x);H.firstChild?H.insertBefore(m,H.firstChild):H.appendChild(m)}else if("sparkline"===e)H=h.F.getFunction("createSparkLineCellGroup")(null,g,0,p,n,s,u,c,f,o,y,A);else if("checkbox"===e){let e="isAggregation"in o.internalProps.layoutMap&&o.internalProps.layoutMap.isAggregation(n,s),l=o.internalProps.layoutMap.isSeriesNumber(n,s);H=e&&l?h.F.getFunction("createTextCellGroup")(o,t,g,0,p,n,s,d,u,c,f,b,C,!1,void 0,!0,y,x,A):h.F.getFunction("createCheckboxCellGroup")(null,g,0,p,n,s,d,u,c,f,b,C,v,o,y,i,x,A,!1)}else"radio"===e?H=h.F.getFunction("createRadioCellGroup")(null,g,0,p,n,s,d,u,c,f,b,C,o,y,i,x):"switch"===e?H=h.F.getFunction("createSwitchCellGroup")(null,g,0,p,n,s,d,u,c,f,b,C,v,o,y,i,x,A):"button"===e&&(H=h.F.getFunction("createButtonCellGroup")(null,g,0,p,n,s,d,u,c,f,b,C,v,o,y,i,x,A));return H.onBeforeAttributeUpdate=m,H}function w(e,t,i,l,r,n,a,s,h){let d,u=!0;if(h)d=h.elementsGroup,u=h.renderDefault;else if((null==s?void 0:s.isCustom)&&!e.isCornerHeader(i,l));else{let h,c;if("body"!==e.getCellLocation(i,l)?(h=null==t?void 0:t.headerCustomRender,c=null==t?void 0:t.headerCustomLayout):(h=(null==t?void 0:t.customRender)||e.customRender,c=null==t?void 0:t.customLayout),c||h){let t=(0,o.ws)(c,h,i,l,r,n,!1,e.isAutoRowHeight(l),a,s,e);d=t.elementsGroup,u=t.renderDefault}}return{customElementsGroup:d,renderDefault:u}}function y(e,t,i,l,h,g){var p,b,m,v,w,y,H,A,M,F,B,T,z,L,k,P,I,E;let D,W,O,G=i.scenegraph.highPerformanceGetCell(e,t,!0);if("cell"!==G.role&&!l)return;let N=i.getCellLocation(e,t),Z,K,V,j,U=i.getCellValue(e,t),$=!1;if(i.internalProps.customMergeCell){let l=i.getCustomMerge(e,t);if(l){let{range:e,text:r,style:n,customLayout:a,customRender:s}=l;Z=(K=e).start.col!==K.end.col||K.start.row!==K.end.row,U=r,V=n,(a||s)&&(j=(0,o.ws)(a,s,e.start.col,e.start.row,i.getColsWidth(e.start.col,e.end.col),i.getRowsHeight(e.start.row,e.end.row),!1,i.isAutoRowHeight(t),[0,0,0,0],K,i)),$=!0}}let X=e,J=t;K&&(X=K.start.col,J=K.start.row);let Y="body"!==N?i.getHeaderDefine(X,J):i.getBodyColumnDefine(X,J),q="body"!==N||(null==Y?void 0:Y.dragOrder)||!!(null==Y?void 0:Y.icon)||!!(null==Y?void 0:Y.tree);!K&&(i.internalProps.enableTreeNodeMerge||"body"!==N||(null==Y?void 0:Y.mergeCell))&&(Z=(K=i.getCellRange(e,t)).start.col!==K.end.col||K.start.row!==K.end.row);let Q=!1;if(i.internalProps.enableTreeNodeMerge&&Z){let l=i.getCellRawRecord(K.start.col,K.start.row),{vtableMergeName:r,vtableMerge:n}=null!=l?l:{};Q=n,n&&(q=!0,i.internalProps.groupTitleCustomLayout&&(j=(0,o.ws)(i.internalProps.groupTitleCustomLayout,void 0,K.start.col,K.start.row,i.getColsWidth(K.start.col,K.end.col),i.getRowsHeight(K.start.row,K.end.row),!1,i.isAutoRowHeight(t),[0,0,0,0],K,i)),i.internalProps.groupTitleFieldFormat?U=i.internalProps.groupTitleFieldFormat(l,e,t,i):void 0!==r&&(U=r))}let ee=V||i._getCellStyle(K?K.start.col:e,K?K.start.row:t),et=null!=(p=ee.autoWrapText)?p:i.internalProps.autoWrapText,ei=(0,n.RT)(ee,i,Z?K.start.col:e,Z?K.start.row:t,r.WJ).theme;if(ei.group.cornerRadius=(0,n.xv)(e,t,i),!l&&!Z&&!((null==Y?void 0:Y.customLayout)||(null==Y?void 0:Y.customRender)||(null==Y?void 0:Y.headerCustomLayout)||(null==Y?void 0:Y.headerCustomRender))&&(g||function(e,t,i,l,o,r){var n;let s=r.getBodyColumnType(e,t),h=r.isAutoRowHeight(t),d=r.getCellValue(e,t);return!(r.isHeader(e,t)||"cell"!==i.role||"text"!==s||l||h||o||"text"!==(null==(n=i.firstChild)?void 0:n.type)||(0,a.tI)(d))}(e,t,G,et,q,i))){let l=i.getColWidth(e),o=i.getRowHeight(t),n=(0,C.d)(e,t,ei,i);G.setAttributes({width:l,height:o,lineWidth:null!=(m=null==(b=null==ei?void 0:ei.group)?void 0:b.lineWidth)?m:void 0,fill:null!=(w=null==(v=null==ei?void 0:ei.group)?void 0:v.fill)?w:void 0,stroke:null!=(H=null==(y=null==ei?void 0:ei.group)?void 0:y.stroke)?H:void 0,strokeArrayWidth:null!=n?n:void 0,strokeArrayColor:null!=(M=null==(A=null==ei?void 0:ei.group)?void 0:A.strokeArrayColor)?M:void 0,cursor:null!=(B=null==(F=null==ei?void 0:ei.group)?void 0:F.cursor)?B:void 0,cornerRadius:null!=(z=null==(T=null==ei?void 0:ei.group)?void 0:T.cornerRadius)?z:0,lineDash:null!=(k=null==(L=null==ei?void 0:ei.group)?void 0:L.lineDash)?k:void 0,y:i.scenegraph.getCellGroupY(t)}),G.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})});let a=G.getChildByName("text");if(g&&a){let l=ei.text.textAlign,o=(0,d.L)(e,t,i),r={textBaseline:"top",dx:"left"===l?o:0};a.setAttributes(ei.text?Object.assign({},ei.text,r):r)}else if(a){let n=i.getCellValue(e,t),{text:s,moreThanMaxCharacters:h}=(0,f.$)(n,i),c=(0,d.L)(e,t,i),g=ee.lineClamp,p=null!=(P=(0,u.u)((0,r.WJ)("padding",ee,e,t,i)))?P:[0,0,0,0],b=ei.text.textAlign,m=0;m="center"===b?p[3]+(l-(p[1]+p[3]))/2:"right"===b?p[3]+l-(p[1]+p[3]):p[3];let C={text:1!==s.length||et?s:s[0],moreThanMaxCharacters:h,maxLineWidth:l-(p[1]+p[3]+c),textBaseline:"top",autoWrapText:et,lineClamp:g,wordBreak:"break-word",heightLimit:o-Math.floor(p[0]+p[2]),pickable:!1,dx:"left"===b?c:0,x:m};if(a.setAttributes(ei.text?Object.assign({},ei.text,C):C),a.attribute.text){let e=ei.text.textBaseline,t=o-(p[0]+p[2]),i=0;i="middle"===e?p[0]+(t-a.AABBBounds.height())/2:"bottom"===e?p[0]+t-a.AABBBounds.height():p[0],a.setAttributes({y:i})}}return G}if(!l&&"empty"===G.role)return;let el=Q||$?"text":i.isHeader(e,t)?null!=(I=i._getHeaderLayoutMap(e,t).headerType)?I:"text":null!=(E=i.getBodyColumnType(e,t))?E:"text",eo=ei._vtable.padding,er=ei.text.textAlign,en=ei.text.textBaseline;if(K?(W=i.getColsWidth(K.start.col,K.end.col),O=i.getRowsHeight(K.start.row,K.end.row)):(W=i.getColWidth(e),O=i.getRowHeight(t)),(0,a.tI)(U)?(G.removeAllChild(),(0,s.K)(U,i,_.bind(null,{type:el,value:U,define:Y,table:i,col:e,row:t,cellWidth:W,cellHeight:O,oldCellGroup:G,padding:eo,textAlign:er,textBaseline:en,mayHaveIcon:q,addNew:l,range:K,customResult:j,customStyle:V}))):D=x(el,U,Y,i,e,t,W,O,G,eo,er,en,q,l,ei,K,j),Z){let{width:e}=D.attribute,{height:t}=D.attribute;D.contentWidth=e,D.contentHeight=t,h?function(e,t,i,l,o,r,n,a){let{col:s,row:h}=a;e.start.row!==e.end.row&&a.contentHeight!==i&&(0,c.Zl)(a,i,i,n.isAutoRowHeight(h),l,o,r,n),e.start.col!==e.end.col&&a.contentWidth!==t&&(0,c.qs)(a,t,i,0,n.isAutoRowHeight(h),l,o,r,n.scenegraph),a.contentWidth=t,a.contentHeight=i;let d=n.getRowHeight(h);R(a,n.getColWidth(s),d,e,n)}(K,W,O,eo,er,en,i,D):S(K,W,O,eo,er,en,i)}return D}function x(e,t,i,l,o,r,n,s,h,d,u,c,p,f,b,m,C){var w,y;if((0,a.tI)(t)&&(t=l.getCellValue(o,r)),!f&&(h.row!==r||h.col!==o))return null;if(!f&&h.parent&&l.reactCustomLayout){let e=h.getChildByName("custom-container");if(e){let{col:t,row:i}=e;(0,g.Z)(t)&&(0,g.Z)(i)&&l.reactCustomLayout.removeCustomCell(t,i)}}let x=v(e,t,i,l,o,r,l.getColWidth(o),n,s,f?l.scenegraph.getColGroup(o):h.parent,f?0:l.scenegraph.getCellGroupY(r),d,u,c,p,b,m,C);return!f&&h.parent&&(h.parent.insertAfter(x,h),h.parent.removeChild(h),h.release(!0),(null==(w=l.scenegraph)?void 0:w.proxy.cellCache.get(o))&&(null==(y=l.scenegraph)||y.proxy.cellCache.set(o,x))),x}function _(e){let{type:t,value:i,define:l,table:o,col:a,row:s,cellWidth:h,cellHeight:d,oldCellGroup:u,padding:c,textAlign:g,textBaseline:p,mayHaveIcon:f,addNew:b,range:m,customResult:C,customStyle:v}=e,w=v||o._getCellStyle(m?m.start.col:a,m?m.start.row:s),y=(0,n.RT)(w,o,m?m.start.col:a,m?m.start.row:s,r.WJ).theme;y.group.cornerRadius=(0,n.xv)(a,s,o),x(t,i,l,o,a,s,h,d,u,c,g,p,f,b,y,m,C)}function S(e,t,i,l,o,r,n){for(let a=e.start.col;a<=e.end.col;a++)for(let s=e.start.row;s<=e.end.row;s++){let h=n.scenegraph.highPerformanceGetCell(a,s,!0);if("cell"!==h.role)continue;e.start.row!==e.end.row&&h.contentHeight!==i&&(0,c.Zl)(h,i,i,n.isAutoRowHeight(s),l,o,r,n),e.start.col!==e.end.col&&h.contentWidth!==t&&(0,c.qs)(h,t,i,0,n.isAutoRowHeight(s),l,o,r,n.scenegraph),h.contentWidth=t,h.contentHeight=i;let d=n.getRowHeight(s);R(h,n.getColWidth(a),d,e,n)}}function R(e,t,i,l,o){var r,n;let{col:a,row:s}=e,h=-o.getColsWidth(l.start.col,a-1),d=0;if(null==(r=o.options.customConfig)?void 0:r._disableColumnAndRowSizeRound)for(let e=l.start.row;e<=s-1;e++)d-=o.getRowHeight(e);else d=-o.getRowsHeight(l.start.row,s-1);e.forEachChildren(e=>{var t,i,l,o,r,n;"number"==typeof e._dx?(e.skipMergeUpdate=!0,e.setAttributes({dx:(null!=(t=e._dx)?t:0)+h})):(e._dx=null!=(i=e.attribute.dx)?i:0,e.skipMergeUpdate=!0,e.setAttributes({dx:(null!=(l=e.attribute.dx)?l:0)+h})),e.skipMergeUpdate=!1,"number"==typeof e._dy?(e.skipMergeUpdate=!0,e.setAttributes({dy:(null!=(o=e._dy)?o:0)+d})):(e._dy=null!=(r=e.attribute.dy)?r:0,e.skipMergeUpdate=!0,e.setAttributes({dy:(null!=(n=e.attribute.dy)?n:0)+d})),e.skipMergeUpdate=!1});let u=null!=(n=e.attribute.strokeArrayWidth)?n:e.attribute.lineWidth,c=(0,p.Z)(u),g=[0,0,0,0];a===l.start.col&&(g[3]=c?u[3]:u),s===l.start.row&&(g[0]=c?u[0]:u),a===l.end.col&&(g[1]=c?u[1]:u),s===l.end.row&&(g[2]=c?u[2]:u);let f=t!==e.attribute.width,b=i!==e.attribute.height;return e.skipMergeUpdate=!0,e.setAttributes({width:t,height:i,strokeArrayWidth:g}),e.skipMergeUpdate=!1,e.mergeStartCol=l.start.col,e.mergeStartRow=l.start.row,e.mergeEndCol=l.end.col,e.mergeEndRow=l.end.row,{widthChange:f,heightChange:b}}function H(e,t,i,l){if(l.internalProps.customMergeCell){let r=l.getCustomMerge(e,t);if(r){let{range:n,text:a,style:s,customLayout:h,customRender:d}=r;if(h||d){let r=(0,o.ws)(h,d,n.start.col,n.start.row,l.getColsWidth(n.start.col,n.end.col),l.getRowsHeight(n.start.row,n.end.row),!1,l.isAutoRowHeight(t),[0,0,0,0],n,l).elementsGroup;i.childrenCount>0&&r?i.insertBefore(r,i.firstChild):r&&i.appendChild(r);let a=l.getRowHeight(t),s=l.getColWidth(e),{width:u}=i.attribute,{height:c}=i.attribute;return i.contentWidth=u,i.contentHeight=c,R(i,s,a,n,l),n}}}}},74431:function(e,t,i){"use strict";i.d(t,{Gb:()=>m,LP:()=>p,SI:()=>b,Ui:()=>g,km:()=>f});var l=i(19427),o=i(4234),r=i(38512),n=i(50871),a=i(93743),s=i(60232),h=i(18585),d=i(37811),u=i(5569),c=i(49277);function g(e,t,i,n,a,g,p,b,m,v,w,y,x,_,S,R,H){var A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q,Q,ee,et,ei;let el,eo,er=_._getCellStyle(n,a),en=(0,s.vp)("padding",er,n,a,_);(null==(A=_.options.customConfig)?void 0:A.imageMargin)?v=(0,d.u)(null==(M=_.options.customConfig)?void 0:M.imageMargin):(0,h.Z)(en)&&(v=en),(null==(F=null==S?void 0:S.text)?void 0:F.textAlign)&&(w=null==(B=null==S?void 0:S.text)?void 0:B.textAlign),(null==(T=null==S?void 0:S.text)?void 0:T.textBaseline)&&(y=null==(z=null==S?void 0:S.text)?void 0:z.textBaseline);let ea=(0,u.d)(n,a,S,_);if(H&&(el=_.scenegraph.highPerformanceGetCell(n,a,!0))&&"cell"===el.role&&el.setAttributes({x:t,y:i,width:g,height:p,lineWidth:null!=(k=null==(L=null==S?void 0:S.group)?void 0:L.lineWidth)?k:void 0,fill:null!=(I=null==(P=null==S?void 0:S.group)?void 0:P.fill)?I:void 0,stroke:null!=(D=null==(E=null==S?void 0:S.group)?void 0:E.stroke)?D:void 0,strokeArrayWidth:null!=ea?ea:void 0,strokeArrayColor:null!=(O=null==(W=null==S?void 0:S.group)?void 0:W.strokeArrayColor)?O:void 0,cursor:null!=(N=null==(G=null==S?void 0:S.group)?void 0:G.cursor)?N:void 0,lineDash:null!=(K=null==(Z=null==S?void 0:S.group)?void 0:Z.lineDash)?K:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius}),el&&"cell"===el.role||((el=new r.Z({x:t,y:i,width:g,height:p,lineWidth:null!=(j=null==(V=null==S?void 0:S.group)?void 0:V.lineWidth)?j:void 0,fill:null!=($=null==(U=null==S?void 0:S.group)?void 0:U.fill)?$:void 0,stroke:null!=(J=null==(X=null==S?void 0:S.group)?void 0:X.stroke)?J:void 0,strokeArrayWidth:null!=ea?ea:void 0,strokeArrayColor:null!=(q=null==(Y=null==S?void 0:S.group)?void 0:Y.strokeArrayColor)?q:void 0,cursor:null!=(ee=null==(Q=null==S?void 0:S.group)?void 0:Q.cursor)?ee:void 0,lineDash:null!=(ei=null==(et=null==S?void 0:S.group)?void 0:et.lineDash)?ei:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius})).role="cell",el.col=n,el.row=a,null==e||e.addCellGroup(el)),x){let e=n,t=a;R&&(e=R.start.col,t=R.start.row),eo=_.getCellIcons(e,t)}let es=0,eh=0,ed=0;if(Array.isArray(eo)&&0!==eo.length){let{leftIconWidth:e,rightIconWidth:t,absoluteLeftIconWidth:i,absoluteRightIconWidth:l}=(0,c.M4)(eo,el,R,_);es=e+t,eh=e,ed=t,el.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+v[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+g-t-v[1]):"icon-absolute-right"===e.role&&e.setAttribute("x",e.attribute.x+g-l-v[1])}),el.forEachChildren(e=>{"middle"===y?e.setAttribute("y",(p-e.AABBBounds.height())/2):"bottom"===y?e.setAttribute("y",p-e.AABBBounds.height()-v[2]):e.setAttribute("y",v[0])}),el._cellLeftIconWidth=eh,el._cellRightIconWidth=ed}let eu=_.getCellValue(n,a),ec=(0,l.B)({x:v[3],y:v[0],width:g-v[1]-v[3]-es,height:p-v[0]-v[2],image:eu,cursor:"pointer"});return ec.name="image",ec.keepAspectRatio=b,ec.textAlign=w,ec.textBaseline=y,b||m?ec.resources&&ec.resources.has(ec.attribute.image)&&"success"===ec.resources.get(ec.attribute.image).state?(ec.setAttribute("opacity",0),setTimeout(()=>{ec.setAttribute("opacity",1),C(m,b,v,w,y,ec,el,_),_.scenegraph.updateNextFrame()},0)):ec.successCallback=()=>{C(m,b,v,w,y,ec,el,_),_.scenegraph.updateNextFrame()}:ec.resources&&ec.resources.has(ec.attribute.image)&&"success"===ec.resources.get(ec.attribute.image).state?f(el,n,a,0,0,_):ec.successCallback=()=>{f(el,n,a,0,0,_)},ec.failCallback=()=>{ec.image=o.U2().damage_pic.svg},el.appendChild(ec),el}function p(e,t,i,l,o,r,n){let a=!1,s=null,h=null,{width:d,height:u,isMerge:c}=b(n,o.table);if(d<i+r[1]+r[3]&&(s=i+r[1]+r[3],a=!0),u<l+r[2]+r[0]&&(h=l+r[2]+r[0],a=!0),a){if("number"==typeof s)if(c)for(let e=n.mergeStartCol;e<=n.mergeEndCol;e++)o.setColWidth(e,s/(n.mergeEndCol-n.mergeStartCol+1));else o.setColWidth(e,s);if("number"==typeof h)if(c)for(let e=n.mergeStartRow;e<=n.mergeEndRow;e++)o.setRowHeight(e,h/(n.mergeEndRow-n.mergeStartRow+1));else o.setRowHeight(t,h);return o.component.updateScrollBar(),!0}return!1}function f(e,t,i,l,o,r){var h,u,c,g,p,f,C,v,w,y,x,_;let S,R=e.getChildByName("image");if(!R)return;let H="string"!=typeof R.attribute.image&&R.attribute.image||(null==(h=R.resources)?void 0:h.get(R.attribute.image).data);if(!H)return;let A=r._getCellStyle(t,i),M=null!=(u=(0,s.WJ)("textAlign",A,t,i,r))?u:"left",F=null!=(c=(0,s.WJ)("textBaseline",A,t,i,r))?c:"middle";S=(null==(g=r.options.customConfig)?void 0:g.imageMargin)?(0,d.u)(null==(p=r.options.customConfig)?void 0:p.imageMargin):null!=(f=(0,d.u)((0,s.WJ)("padding",A,t,i,r)))?f:[0,0,0,0];let{width:B,height:T,isMerge:z}=b(e,r),L=null!=(C=e.mergeStartCol)?C:e.col,k=null!=(v=e.mergeStartRow)?v:e.row,P=null!=(w=e.mergeEndCol)?w:e.col,I=null!=(y=e.mergeEndCol)?y:e.row,E=null!=(x=e._cellLeftIconWidth)?x:0,D=null!=(_=e._cellRightIconWidth)?_:0;if(R.keepAspectRatio){let{width:e,height:t}=(0,n.f)(H.width||H.videoWidth,H.height||H.videoHeight,B-(S[1]+S[3]),T-(S[0]+S[2])),i=(0,a.W)(0,0,B,T,e,t,M,F,S);for(let l=L;l<=P;l++)for(let o=k;o<=I;o++){let n=r.scenegraph.getCell(l,o).getChildByName("image");null==n||n.setAttributes({x:i.x,y:i.y,width:e,height:t})}}else for(let e=L;e<=P;e++)for(let t=k;t<=I;t++){let i=r.scenegraph.getCell(e,t).getChildByName("image");null==i||i.setAttributes({x:E+S[3],y:S[0],width:B-S[1]-S[3]-D-E,height:T-S[0]-S[2]})}if(e.getChildByName("play-icon")){let{width:t,height:i}=b(e,r),l=Math.floor(Math.min(t-S[1]-S[3],i-S[2]-S[0])/2),o=0+(t>R.attribute.width?R.attribute.x-0+R.attribute.width/2:t/2),n=0+(i>R.attribute.height?R.attribute.y-0+R.attribute.height/2:i/2);for(let e=L;e<=P;e++)for(let t=k;t<=I;t++)r.scenegraph.getCell(e,t).getChildByName("play-icon").setAttributes({x:o-l/2,y:n-l/2,width:l,height:l})}e.forEachChildren(e=>{"icon-left"===e.role||("icon-right"===e.role||"icon-absolute-right"===e.role)&&e.setAttribute("x",e.attribute.x+l)}),e.forEachChildren(e=>{("rect"===e.type||e.role&&e.role.startsWith("icon"))&&("middle"===F?e.setAttribute("y",S[0]+(T-S[0]-S[2]-e.AABBBounds.height())/2):"bottom"===F?e.setAttribute("y",S[0]+T-S[0]-S[2]-e.AABBBounds.height()):e.setAttribute("y",S[0]))}),z&&m(e.mergeStartCol,e.mergeEndCol,e.mergeStartRow,e.mergeEndRow,r)}function b(e,t){return"cell"===e.role&&(0,h.Z)(e.mergeStartCol)&&(0,h.Z)(e.mergeEndCol)&&(0,h.Z)(e.mergeStartRow)&&(0,h.Z)(e.mergeEndRow)?{width:t.getColsWidth(e.mergeStartCol,e.mergeEndCol),height:t.getRowsHeight(e.mergeStartRow,e.mergeEndRow),isMerge:!0}:{width:e.attribute.width,height:e.attribute.height,isMerge:!1}}function m(e,t,i,l,o){for(let r=e;r<=t;r++)for(let e=i;e<=l;e++){let t=o.scenegraph.getCell(r,e);if(t){let i=t.getChildByName("image");i&&i.setAttributes({dx:-o.getColsWidth(t.mergeStartCol,r-1),dy:-o.getRowsHeight(t.mergeStartRow,e-1)});let l=t.getChildByName("play-icon");l&&l.setAttributes({dx:-o.getColsWidth(t.mergeStartCol,r-1),dy:-o.getRowsHeight(t.mergeStartRow,e-1)})}}}function C(e,t,i,l,o,r,s,h){let d=r.resources.get(r.attribute.image).data,{col:u,row:c}=s;if(e&&!v(r)&&p(u,c,d.width,d.height,h.scenegraph,i,s),t||v(r)){let{width:e,height:t,isMerge:u}=b(s,h),{width:c,height:g}=(0,n.f)(d.width,d.height,e-i[1]-i[3],t-i[0]-i[2]),p=(0,a.W)(0,0,e,t,c,g,l,o,i);r.setAttributes({x:p.x,y:p.y,width:c,height:g}),u&&m(s.mergeStartCol,s.mergeEndCol,s.mergeStartRow,s.mergeEndRow,h)}}function v(e){let t=o.U2();return e.attribute.image===t.damage_pic.svg}},66209:function(e,t,i){"use strict";i.d(t,{LQ:()=>em,dB:()=>eS,ge:()=>eR,ah:()=>e_,Jy:()=>ey,yR:()=>eC,pk:()=>ev,VT:()=>ex,au:()=>eH,m4:()=>ew});var l=i(75025),o=i(38512),r=i(22672),n=i(80363),a=i(60232),s=i(18585),h=i(5569);function d(e,t,i,l,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S){var R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X;let J=n.U()[b],Y=w._getCellStyle(d,u),q=(0,a.vp)("padding",Y,d,u,w);if((0,s.Z)(q)&&(p=q),!e){let r=(0,h.d)(d,u,y,w);_&&(e=w.scenegraph.highPerformanceGetCell(d,u,!0))&&"cell"===e.role&&e.setAttributes({x:i,y:l,width:c,height:g,lineWidth:null!=(H=null==(R=null==y?void 0:y.group)?void 0:R.lineWidth)?H:void 0,fill:null!=(M=null==(A=null==y?void 0:y.group)?void 0:A.fill)?M:void 0,stroke:null!=(B=null==(F=null==y?void 0:y.group)?void 0:F.stroke)?B:void 0,strokeArrayWidth:r,strokeArrayColor:null!=(z=null==(T=null==y?void 0:y.group)?void 0:T.strokeArrayColor)?z:void 0,cursor:null!=(k=null==(L=null==y?void 0:y.group)?void 0:L.cursor)?k:void 0,lineDash:null!=(I=null==(P=null==y?void 0:y.group)?void 0:P.lineDash)?I:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius}),e&&"cell"===e.role||((e=new o.Z({x:i,y:l,width:c,height:g,lineWidth:null!=(D=null==(E=null==y?void 0:y.group)?void 0:E.lineWidth)?D:void 0,fill:null!=(O=null==(W=null==y?void 0:y.group)?void 0:W.fill)?O:void 0,stroke:null!=(N=null==(G=null==y?void 0:y.group)?void 0:G.stroke)?N:void 0,strokeArrayWidth:r,strokeArrayColor:null!=(K=null==(Z=null==y?void 0:y.group)?void 0:Z.strokeArrayColor)?K:void 0,cursor:null!=(j=null==(V=null==y?void 0:y.group)?void 0:V.cursor)?j:void 0,lineDash:null!=($=null==(U=null==y?void 0:y.group)?void 0:U.lineDash)?$:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",e.col=d,e.row=u,null==t||t.addCellGroup(e))}if(e.AABBBounds.width(),S&&Array.isArray(w.getCellValue(d,u))||!S){let t=new r.k(x,{stroke:!1,x:p[3],y:p[0],canvas:null!=(X=w.canvas)?X:w.scenegraph.stage.window.getContext().canvas,mode:w.options.mode,modeParams:w.options.modeParams,spec:w.options.specTransformInCell?w.options.specTransformInCell(m,d,u):m,ClassType:J,width:c-p[3]-p[1],height:g-p[2]-p[0],chartInstance:C,dataId:v,data:w.getCellValue(d,u)||[],cellPadding:p,dpr:w.internalProps.pixelRatio,axes:w.isPivotChart()?w.internalProps.layoutMap.getChartAxes(d,u):[],tableChartOption:w.options.chartOption,col:d,row:u});e.appendChild(t),w.internalProps.layoutMap.setChartInstance(d,u,t.chartInstance)}return e}var u=i(27695),c=i(47e3),g=i(74294),p=i(81668),f=i(77597),b=i(49277);class m extends o.Z{constructor(e){super(e),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new o.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new o.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new o.Z({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(e){var t,i,l;e.setAttribute("x",this._leftGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._leftGroup.appendChild(e),this._leftGroup.setDeltaWidth((null!=(i=e.attribute.marginLeft)?i:0)+(null!=(l=e.attribute.marginRight)?l:0)+e.attribute.width)}addRightOccupyingIcon(e){var t,i,l;e.setAttribute("x",this._rightGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._rightGroup.appendChild(e),this._rightGroup.setDeltaWidth((null!=(i=e.attribute.marginLeft)?i:0)+(null!=(l=e.attribute.marginRight)?l:0)+e.attribute.width)}addCheckbox(e){this._checkboxGroup.appendChild(e)}setCheckboxContentOption(e){this._autoWidth=e.autoWidth,this._autoHeight=e.autoHeight,this._cellWidth=e.cellWidth,this._originCellWidth=e.cellWidth,this._cellHeight=e.cellHeight,this._align=e.align,this._baseline=e.baseline}layout(){let e=this._leftGroup.width;e===1/0&&(e=0);let t=this._rightGroup.width;if(t===-1/0&&(t=0),this._autoWidth){let i=this._checkboxGroup.width;this._cellWidth=e+t+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-e-t;this.updateCenterLayout(i);let l=this._checkboxGroup.width;this._cellWidth=e+t+l,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,l=this._rightGroup.height,o=this._checkboxGroup.height;this._cellHeight=Math.max(i,l,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(e){let t=e;this._checkboxGroup.forEachChildren(e=>{e instanceof g.J&&(t-=e.AABBBounds.width())});let i=this._checkboxGroup.getChildByName("checkbox-content");i instanceof g.J&&i.setAttribute("width",t);let l=0;this._checkboxGroup.forEachChildren(e=>{e.setAttribute("x",l),l+=e.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(e=>{e.setAttribute("y",(this._leftGroup.height-e.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(e=>{e.setAttribute("y",(this._rightGroup.height-e.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(e=>{e.setAttribute("y",this._leftGroup.height-e.AABBBounds.height())}),this._rightGroup.forEachChildren(e=>{e.setAttribute("y",this._rightGroup.height-e.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}var C=i(31604);function v(e,t,i,l,r,n,s,d,v,w,y,x,_,S,R,H,A,M,F){var B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q,Q;let ee;if(!e){let a=(0,h.d)(r,n,R,S);M&&(e=S.scenegraph.highPerformanceGetCell(r,n,!0))&&"cell"===e.role&&e.setAttributes({x:i,y:l,width:d,height:v,lineWidth:null!=(T=null==(B=null==R?void 0:R.group)?void 0:B.lineWidth)?T:void 0,fill:null!=(L=null==(z=null==R?void 0:R.group)?void 0:z.fill)?L:void 0,stroke:null!=(P=null==(k=null==R?void 0:R.group)?void 0:k.stroke)?P:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(E=null==(I=null==R?void 0:R.group)?void 0:I.strokeArrayColor)?E:void 0,cursor:null!=(W=null==(D=null==R?void 0:R.group)?void 0:D.cursor)?W:void 0,lineDash:null!=(G=null==(O=null==R?void 0:R.group)?void 0:O.lineDash)?G:void 0,lineCap:"butt",clip:!0,cornerRadius:R.group.cornerRadius}),e&&"cell"===e.role||((e=new o.Z({x:i,y:l,width:d,height:v,lineWidth:null!=(Z=null==(N=null==R?void 0:R.group)?void 0:N.lineWidth)?Z:void 0,fill:null!=(V=null==(K=null==R?void 0:R.group)?void 0:K.fill)?V:void 0,stroke:null!=(U=null==(j=null==R?void 0:R.group)?void 0:j.stroke)?U:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(X=null==($=null==R?void 0:R.group)?void 0:$.strokeArrayColor)?X:void 0,cursor:null!=(Y=null==(J=null==R?void 0:R.group)?void 0:J.cursor)?Y:void 0,lineDash:null!=(Q=null==(q=null==R?void 0:R.group)?void 0:q.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:R.group.cornerRadius})).role="cell",e.col=r,e.row=n,null==t||t.addCellGroup(e))}if(_){let e=r,t=n;A&&(e=A.start.col,t=A.start.row),ee=S.getCellIcons(e,t)}let et=0,ei=0,el=0,eo=0,er=[];if(Array.isArray(ee)&&0!==ee.length){let{leftIconWidth:t,rightIconWidth:i,contentLeftIcons:l,contentRightIcons:o,absoluteLeftIconWidth:r,absoluteRightIconWidth:n}=(0,b.M4)(ee,e,A,S);et=t+i,ei=t,el=i,er=l,eo=n,e.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+w[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+d-i-w[1]):"icon-absolute-right"===e.role&&e.setAttribute("x",e.attribute.x+d-n-w[1])}),e.forEachChildren(e=>{"middle"===x?e.setAttribute("y",(v-e.AABBBounds.height())/2):"bottom"===x?e.setAttribute("y",v-e.AABBBounds.height()-w[2]):e.setAttribute("y",w[0])})}let en=function(e,t,i,l,o,r,n,s,h,d){var u,b,m;let C=h._getCellStyle(e,t),v=(0,a.WJ)("size",C,e,t,h),w=(0,a.WJ)("spaceBetweenTextAndIcon",C,e,t,h),y=(0,a.WJ)("defaultFill",C,e,t,h),x=(0,a.WJ)("defaultStroke",C,e,t,h),_=(0,a.WJ)("disableFill",C,e,t,h),S=(0,a.WJ)("checkedFill",C,e,t,h),R=(0,a.WJ)("checkedStroke",C,e,t,h),H=(0,a.WJ)("disableCheckedFill",C,e,t,h),A=(0,a.WJ)("disableCheckedStroke",C,e,t,h),M=(0,a.WJ)("checkIconImage",C,e,t,h),F=(0,a.WJ)("indeterminateIconImage",C,e,t,h),B=h.getCellValue(e,t),T=h.getCellOriginValue(e,t),z,L,k=null!=B?B:"";if((0,c.Z)(B)?(z=B.checked,L=B.disable,k=null!=(u=B.text)?u:""):"boolean"==typeof B&&(z=B,k=""),h.internalProps.layoutMap.isSeriesNumber(e,t)){let i=h.getFieldData(s.field,e,t);i&&("string"==typeof i||("object"==typeof i?(z=i.checked,L=i.disable):"boolean"==typeof i&&(z=i)))}z=h.stateManager.syncCheckedState(e,t,s.field,z);let P=(0,p.L)(e,t,h),I=h._getCellStyle(e,t),E=null!=(b=I.autoWrapText)?b:h.internalProps.autoWrapText,{lineClamp:D}=I,{checked:W,disable:O}=s;if(null==z||"function"==typeof z){let i=(0,f.vi)(W,{col:e,row:t,table:h,context:null,value:B,dataValue:T});z=h.stateManager.syncCheckedState(e,t,s.field,i)}let G=(0,f.vi)(O,{col:e,row:t,table:h,context:null,value:B,dataValue:T}),N=h.isAutoRowHeight(t),Z={text:1===k.length?k[0]:k,maxLineWidth:"auto"===i?1/0:l-(r[1]+r[3]+P)-v-w,textAlign:"left",textBaseline:"top",autoWrapText:E,lineClamp:D,wordBreak:"break-word",heightLimit:N?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:d?0:P,whiteSpace:1!==k.length||E?"normal":"no-wrap"},K={x:0,y:0,text:n.text?Object.assign({},n.text,Z):Z,icon:{width:Math.floor(v/1.4),height:Math.floor(v/1.4)},box:{width:v,height:v},dx:d?P:0,spaceBetweenTextAndIcon:w,disabled:null!=(m=null!=L?L:G)&&m};"indeterminate"===z?(K.checked=void 0,K.indeterminate=!0):(K.checked=z,K.indeterminate=void 0),y&&(K.box.fill=y),x&&(K.box.stroke=x),_&&(K.box.disableFill=_),S&&(K.box.checkedFill=S),R&&(K.box.checkedStroke=R),H&&(K.box.disableCheckedFill=H),A&&(K.box.disableCheckedStroke=A),M&&(K.icon.checkIconImage=M),F&&(K.icon.indeterminateIconImage=F);let V=new g.J(K);return V.name="checkbox",V}(r,n,s-et,d,v,w,R,H,S,F);if(1!==er.length||er[0].name!==u.up.expandIconName&&er[0].name!==u.up.collapseIconName)en&&e.appendChild(en),en.render();else{let t=new m({x:0,y:0,fill:!1,stroke:!1,pickable:!1});t.name="checkbox-content",t.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:d-(w[1]+w[3]),cellHeight:v-w[0]-w[2],align:y,baseline:x});let i={addedHierarchyOffset:0};er.forEach(l=>{let o=(0,b.Bg)(l,void 0,e.col,e.row,A,S,i);o.role="icon-content-left",o.name=l.name,t.addLeftOccupyingIcon(o)}),en&&t.addCheckbox(en),e.appendChild(t),t.layout(),t.AABBBounds.width(),t.AABBBounds.height();let l=d-(w[1]+w[3]),o=v-(w[0]+w[2]);e.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+w[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+l-el+w[3]):"icon-absolute-right"===e.role?e.setAttribute("x",e.attribute.x+l-eo+w[3]+w[1]):"content"!==e.name&&"checkbox-content"!==e.name||("center"===y&&"richtext"!==e.type?e.setAttribute("x",w[3]+ei+(l-ei-el)/2):"right"===y&&"richtext"!==e.type?e.setAttribute("x",w[3]+l-el):e.setAttribute("x",w[3]+ei))}),e.forEachChildren(e=>{e.name!==C.FH&&("middle"===x?(null==e?void 0:e._checkboxGroup)&&e._leftGroup.setAttribute("y",w[0]+(o-e._checkboxGroup.AABBBounds.height())/2):"bottom"===x?e.setAttribute("y",w[0]+o-e.AABBBounds.height()):e.setAttribute("y",w[0]))})}return d-=w[1]+w[3]+et,v-=w[0]+w[2],"center"===y?en.setAttribute("x",w[3]+ei+(d-en.AABBBounds.width())/2):"right"===y?en.setAttribute("x",w[3]+ei+d-en.AABBBounds.width()):en.setAttribute("x",w[3]+ei),"middle"===x?en.setAttribute("y",w[0]+(v-en.AABBBounds.height())/2):"bottom"===x?en.setAttribute("y",w[0]+v-en.AABBBounds.height()):en.setAttribute("y",w[0]),e}var w=i(74431),y=i(58977),x=i(43735),_=i(47105),S=i(91212),R=i(66707);function H(e,t,i,l,r,n,s,d,u,c,g,f,b,m,C,v){var w,_,S,R,H,M,F,B,T,z,L,k;if(!e){let a=(0,h.d)(r,n,m,b);(e=new o.Z({x:i,y:l,width:d,height:u,lineWidth:null!=(_=null==(w=null==m?void 0:m.group)?void 0:w.lineWidth)?_:void 0,fill:null!=(R=null==(S=null==m?void 0:m.group)?void 0:S.fill)?R:void 0,stroke:null!=(M=null==(H=null==m?void 0:m.group)?void 0:H.stroke)?M:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(B=null==(F=null==m?void 0:m.group)?void 0:F.strokeArrayColor)?B:void 0,cursor:null!=(z=null==(T=null==m?void 0:m.group)?void 0:T.cursor)?z:void 0,lineDash:null!=(k=null==(L=null==m?void 0:m.group)?void 0:L.lineDash)?k:void 0,lineCap:"butt",clip:!0,cornerRadius:m.group.cornerRadius})).role="cell",e.col=r,e.row=n,null==t||t.addCellGroup(e)}let{width:P,height:I}=function(e,t,i,l,o,r,n,s,h,d,u){var c,g,f,b;let m=u._getCellStyle(e,t),C=(0,a.WJ)("size",m,e,t,u),v=(0,a.WJ)("innerRadius",m,e,t,u),w=(0,a.WJ)("outerRadius",m,e,t,u),_=(0,a.WJ)("spaceBetweenTextAndIcon",m,e,t,u),S=(0,a.WJ)("spaceBetweenRadio",m,e,t,u),R=(0,a.WJ)("defaultFill",m,e,t,u),H=(0,a.WJ)("defaultStroke",m,e,t,u),M=(0,a.WJ)("disableFill",m,e,t,u),F=(0,a.WJ)("checkedFill",m,e,t,u),B=(0,a.WJ)("checkedStroke",m,e,t,u),T=(0,a.WJ)("disableCheckedFill",m,e,t,u),z=(0,a.WJ)("disableCheckedStroke",m,e,t,u);(0,y.Z)(w)?C=2*w:w=Math.round(C/2),(!(0,y.Z)(v)||v<0)&&(v=Math.round(w/7*3));let L=u.getCellValue(e,t),k=u.getCellOriginValue(e,t),P=(0,p.L)(e,t,u),I=u._getCellStyle(e,t),E=null!=(c=I.autoWrapText)?c:u.internalProps.autoWrapText,{lineClamp:D}=I,W=u.isAutoRowHeight(t),O={maxLineWidth:"auto"===i?1/0:l-(r[1]+r[3]+P)-C-_,textAlign:"left",textBaseline:"top",autoWrapText:E,lineClamp:D,wordBreak:"break-word",heightLimit:W?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:P},G={x:0,y:0,text:n.text?Object.assign({},n.text,O):O,circle:{innerRadius:v,outerRadius:w},spaceBetweenTextAndIcon:_};R&&(G.circle.fill=R),H&&(G.circle.stroke=H),M&&(G.circle.disableFill=M),F&&(G.circle.checkedFill=F),B&&(G.circle.checkedStroke=B),T&&(G.circle.disableCheckedFill=T),z&&(G.circle.disableCheckedStroke=z);let N=0,Z=0,K=null!=(g=s.radioDirectionInCell)?g:"vertical";if((0,x.Z)(L))L.forEach((i,l)=>{var o,r;let n=A(i,k,l,e,t,s,E,G,u);n&&h.appendChild(n),n.id=`radio-${null!=(o=null==d?void 0:d.start.col)?o:e}-${null!=(r=null==d?void 0:d.start.row)?r:t}-${l}`,n.render();let a=n.AABBBounds;"vertical"===K?(n.setAttribute("y",Z),Z+=a.height()+(l!==L.length-1?S:0),N=Math.max(N,a.width())):"horizontal"===K&&(n.setAttribute("x",N),N+=a.width()+(l!==L.length-1?S:0),Z=Math.max(Z,a.height()))});else{let i=A(L,k,void 0,e,t,s,E,G,u);i&&h.appendChild(i),i.id=`radio-${null!=(f=null==d?void 0:d.start.col)?f:e}-${null!=(b=null==d?void 0:d.start.row)?b:t}`,i.render();let l=i.AABBBounds;N=l.width(),Z=l.height()}return{width:N,height:Z}}(r,n,s,d,u,c,m,C,e,v,b);return d-=c[1]+c[3],u-=c[0]+c[2],e.forEachChildren(e=>{"center"===g?e.setAttribute("x",c[3]+e.attribute.x+(d-P)/2):"right"===g?e.setAttribute("x",c[3]+e.attribute.x+d-P):e.setAttribute("x",c[3]+e.attribute.x),"middle"===f?e.setAttribute("y",c[0]+e.attribute.y+(u-I)/2):"bottom"===f?e.setAttribute("y",c[0]+e.attribute.y+u-I):e.setAttribute("y",c[0]+e.attribute.y)}),e}function A(e,t,i,l,o,r,n,a,s){let h=function(e,t,i,l,o,r,n){var a,s;let h,d,u=null!=(a=r.radioCheckType)?a:"column";return(0,c.Z)(e)?h=e.checked:"boolean"==typeof e&&(h=e),null!=(h=n.stateManager.syncRadioState(l,o,r.field,u,i,h))&&"function"!=typeof h||(d=(0,f.vi)(r.checked,{col:l,row:o,table:n,context:null,value:e,dataValue:t}),h=n.stateManager.syncRadioState(l,o,r.field,u,i,d)),null!=(s=null!=h?h:d)&&s}(e,t,i,l,o,r,s),d=function(e,t,i,l,o,r){var n;let a;(0,c.Z)(e)&&(a=e.disable);let s=(0,f.vi)(o.disable,{col:i,row:l,table:r,context:null,value:e,dataValue:t});return null!=(n=null!=a?a:s)&&n}(e,t,l,o,r,s),u=(0,c.Z)(e)?e.text:(0,_.Z)(e)?"":null!=e?e:"",g=(0,S.Z)({},a,{checked:h,disabled:d,text:{text:1===u.length?u[0]:u,whiteSpace:1!==u.length||n?"normal":"no-wrap"},boundsPadding:0}),p=new R.Y(g);return p.name="radio",p}var M=i(95950),F=i(28076),B=i(28651),T=i(21054),z=i(29411),L=i(51129),k=i(29624),P=i(23112),I=i(2316),E=i(47979);(0,L.M)(),(0,k.k)(),(0,P.g)(),(0,I.f)();class D extends F.k{constructor(e,t){super((null==t?void 0:t.skipDefault)?e:(0,M.Z)({},D.defaultAttributes,e)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this._dispatchEvent("switch_state_change",{eventType:"switch_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(e,t,i)=>{"interactive"in e&&this.setAttribute("pickable",e.interactive),"disabled"in e&&this.setAttribute("cursor",e.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderCircle(),this.renderText(),this.layout()}renderBox(){this._box=new B.U((0,M.Z)({},this.attribute.box)),this.attribute.disabled&&this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill}):this.attribute.disabled&&!this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableUncheckedFill}):this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.checkedFill}):this._box.setAttributes({fill:this.attribute.box.uncheckedFill}),this.appendChild(this._box)}renderCircle(){this._circle=new T.C((0,M.Z)({},this.attribute.circle)),this.appendChild(this._circle)}renderText(){var e,t,i;this._text=new z.x((0,M.Z)({},null!=(e=this.attribute.text)?e:{})),this.attribute.checked&&(null==(t=this.attribute.text)?void 0:t.checkedText)?this._text.setAttributes({text:this.attribute.text.checkedText}):(null==(i=this.attribute.text)?void 0:i.uncheckedText)&&this._text.setAttributes({text:this.attribute.text.uncheckedText}),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){var e,t,i,l,o,r,n,a,s,h;let d=this.attribute.spaceBetweenTextAndCircle,u=this.attribute.circle.radius,c=this.attribute.box.height,g=2*u,p=this._text.AABBBounds.height(),f=Math.max(c,g,p),b=this.attribute.box.width,m=2*u,C=(0,E.fe)((null!=(i=null==(t=null==(e=this.attribute.text)?void 0:e.checkedText)?void 0:t.length)?i:0)>(null!=(r=null==(o=null==(l=this.attribute.text)?void 0:l.uncheckedText)?void 0:o.length)?r:0)?null!=(a=null==(n=this.attribute.text)?void 0:n.checkedText)?a:"":null!=(h=null==(s=this.attribute.text)?void 0:s.uncheckedText)?h:"",this._text.attribute).width,v=Math.max(b,m+C+3*d),w=c/2-m/2+u,y=w+u+d;this._box.setAttributes({width:v,height:f}),this._circle.setAttributes({y:f/2-g/2+u,x:this.attribute.checked?v-w:w}),this._text.setAttributes({x:this.attribute.checked?v-y-C:y,y:f/2-p/2})}initAttributes(e,t){e=(null==t?void 0:t.skipDefault)?e:(0,M.Z)({},D.defaultAttributes,e),super.initAttributes(e),this.renderGroup(),this.render()}}function W(e,t,i,l,r,n,s,d,u,g,m,C,v,w,y,x,_,S){var R,H,A,M,F,B,T,z,L,k,P,I,E,W,O,G,N,Z,K,V,j,U,$,X;let J;if(!e){let a=(0,h.d)(r,n,y,w);S&&(e=w.scenegraph.highPerformanceGetCell(r,n,!0))&&"cell"===e.role&&e.setAttributes({x:i,y:l,width:d,height:u,lineWidth:null!=(H=null==(R=null==y?void 0:y.group)?void 0:R.lineWidth)?H:void 0,fill:null!=(M=null==(A=null==y?void 0:y.group)?void 0:A.fill)?M:void 0,stroke:null!=(B=null==(F=null==y?void 0:y.group)?void 0:F.stroke)?B:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(z=null==(T=null==y?void 0:y.group)?void 0:T.strokeArrayColor)?z:void 0,cursor:null!=(k=null==(L=null==y?void 0:y.group)?void 0:L.cursor)?k:void 0,lineDash:null!=(I=null==(P=null==y?void 0:y.group)?void 0:P.lineDash)?I:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius}),e&&"cell"===e.role||((e=new o.Z({x:i,y:l,width:d,height:u,lineWidth:null!=(W=null==(E=null==y?void 0:y.group)?void 0:E.lineWidth)?W:void 0,fill:null!=(G=null==(O=null==y?void 0:y.group)?void 0:O.fill)?G:void 0,stroke:null!=(Z=null==(N=null==y?void 0:y.group)?void 0:N.stroke)?Z:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(V=null==(K=null==y?void 0:y.group)?void 0:K.strokeArrayColor)?V:void 0,cursor:null!=(U=null==(j=null==y?void 0:y.group)?void 0:j.cursor)?U:void 0,lineDash:null!=(X=null==($=null==y?void 0:y.group)?void 0:$.lineDash)?X:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",e.col=r,e.row=n,null==t||t.addCellGroup(e))}if(v){let e=r,t=n;_&&(e=_.start.col,t=_.start.row),J=w.getCellIcons(e,t)}let Y=0,q=0;if(Array.isArray(J)&&0!==J.length){let{leftIconWidth:t,rightIconWidth:i,absoluteLeftIconWidth:l,absoluteRightIconWidth:o}=(0,b.M4)(J,e,_,w);Y=t+i,q=t,e.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+g[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+d-i-g[1]):"icon-absolute-right"===e.role&&e.setAttribute("x",e.attribute.x+d-o-g[1])}),e.forEachChildren(e=>{"middle"===C?e.setAttribute("y",(u-e.AABBBounds.height())/2):"bottom"===C?e.setAttribute("y",u-e.AABBBounds.height()-g[2]):e.setAttribute("y",g[0])})}let Q=function(e,t,i,l,o,r,n,s,h){var d,u,g;let b=h._getCellStyle(e,t),m=(0,a.WJ)("spaceBetweenTextAndCircle",b,e,t,h),C=(0,a.WJ)("circleRadius",b,e,t,h),v=(0,a.WJ)("boxWidth",b,e,t,h),w=(0,a.WJ)("boxHeight",b,e,t,h),y=(0,a.WJ)("checkedFill",b,e,t,h),x=(0,a.WJ)("uncheckedFill",b,e,t,h),_=(0,a.WJ)("disableCheckedFill",b,e,t,h),S=(0,a.WJ)("disableUncheckedFill",b,e,t,h),R=(0,a.WJ)("circleFill",b,e,t,h),H=h.getCellValue(e,t),A=h.getCellOriginValue(e,t),M,F,B=null!=H?H:"";(0,c.Z)(H)?(M=H.checked,F=H.disable,B=null!=(d=H.text)?d:""):"boolean"==typeof H&&(M=H,B=""),M=h.stateManager.syncCheckedState(e,t,s.field,M);let T=(0,p.L)(e,t,h),z=h._getCellStyle(e,t),L=null!=(u=z.autoWrapText)?u:h.internalProps.autoWrapText,{lineClamp:k}=z,{checked:P,disable:I,uncheckedText:E,checkedText:W}=s;if(null==M||"function"==typeof M){let i=(0,f.vi)(P,{col:e,row:t,table:h,context:null,value:H,dataValue:A});M=h.stateManager.syncCheckedState(e,t,s.field,i)}let O=(0,f.vi)(I,{col:e,row:t,table:h,context:null,value:H,dataValue:A}),G=(0,f.vi)(W,{col:e,row:t,table:h,context:null,value:H,dataValue:A}),N=(0,f.vi)(E,{col:e,row:t,table:h,context:null,value:H,dataValue:A}),Z=h.isAutoRowHeight(t),K={text:1===B.length?B[0]:B,maxLineWidth:"auto"===i?1/0:l-(r[1]+r[3]+T)-2*C-m,textAlign:"left",textBaseline:"top",autoWrapText:L,lineClamp:k,wordBreak:"break-word",heightLimit:Z?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:T,whiteSpace:1!==B.length||L?"normal":"no-wrap",checkedText:G,uncheckedText:N},V={x:0,y:0,text:n.text?Object.assign({},n.text,K):K,circle:{radius:C},box:{width:v,height:w},spaceBetweenTextAndCircle:m,disabled:null!=(g=null!=F?F:O)&&g};V.checked=M,x&&(V.box.uncheckedFill=x),S&&(V.box.disableUncheckedFill=S),y&&(V.box.checkedFill=y),_&&(V.box.disableCheckedFill=_),R&&(V.circle.fill=R);let j=new D(V);return j.name="switch",j}(r,n,s-Y,d,u,g,y,x,w);return Q&&e.appendChild(Q),Q.render(),d-=g[1]+g[3]+Y,u-=g[0]+g[2],"center"===m?Q.setAttribute("x",g[3]+q+(d-Q.AABBBounds.width())/2):"right"===m?Q.setAttribute("x",g[3]+q+d-Q.AABBBounds.width()):Q.setAttribute("x",g[3]+q),"middle"===C?Q.setAttribute("y",g[0]+(u-Q.AABBBounds.height())/2):"bottom"===C?Q.setAttribute("y",g[0]+u-Q.AABBBounds.height()):Q.setAttribute("y",g[0]),e}D.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",circle:{radius:8,fill:"#FFF",pickable:!1},box:{width:40,height:24,cornerRadius:12,uncheckedFill:"rgb(201,205,212)",checkedFill:"#165DFF",disableUncheckedFill:"rgb(242,243,245)",disableCheckedFill:"rgb(148,191,255)",pickable:!1},text:{textAlign:"left",textBaseline:"top",pickable:!1},spaceBetweenTextAndCircle:6};var O=i(14861),G=i(73208),N=i(84168),Z=i(44787);class K extends Z.j{constructor(e){super(!1),this.type=N._f.Point,this._padding=0,this.paddingInner(1,e),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}var V=i(32889);let j=new K,U=new V.f;function $(e,t,i,l,r,n,a,d,u,c,g,p){var f,b,m,C,v,w,y,x,_,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D;if(!e){let s=(0,h.d)(r,n,g,c);p&&(e=c.scenegraph.highPerformanceGetCell(r,n,!0))&&"cell"===e.role&&e.setAttributes({x:i,y:l,width:a,height:d,lineWidth:null!=(b=null==(f=null==g?void 0:g.group)?void 0:f.lineWidth)?b:void 0,fill:null!=(C=null==(m=null==g?void 0:g.group)?void 0:m.fill)?C:void 0,stroke:null!=(w=null==(v=null==g?void 0:g.group)?void 0:v.stroke)?w:void 0,strokeArrayWidth:s,strokeArrayColor:null!=(x=null==(y=null==g?void 0:g.group)?void 0:y.strokeArrayColor)?x:void 0,cursor:null!=(S=null==(_=null==g?void 0:g.group)?void 0:_.cursor)?S:void 0,lineDash:null!=(H=null==(R=null==g?void 0:g.group)?void 0:R.lineDash)?H:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),e&&"cell"===e.role||((e=new o.Z({x:i,y:l,width:a,height:d,lineWidth:null!=(M=null==(A=null==g?void 0:g.group)?void 0:A.lineWidth)?M:void 0,fill:null!=(B=null==(F=null==g?void 0:g.group)?void 0:F.fill)?B:void 0,stroke:null!=(z=null==(T=null==g?void 0:g.group)?void 0:T.stroke)?z:void 0,strokeArrayWidth:s,strokeArrayColor:null!=(k=null==(L=null==g?void 0:g.group)?void 0:L.strokeArrayColor)?k:void 0,cursor:null!=(I=null==(P=null==g?void 0:g.group)?void 0:P.cursor)?I:void 0,lineDash:null!=(D=null==(E=null==g?void 0:g.group)?void 0:E.lineDash)?D:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",e.col=r,e.row=n,null==t||t.addCellGroup(e))}let W=function(e,t,i,l,o,r){let n,a,h,d,u=r.internalProps.layoutMap.getBody(e,t).sparklineSpec,c=r.getCellValue(e,t);if(!Array.isArray(c))return;let g=o[3],p=o[0];i-=o[1]+o[3];let f=l-=o[0]+o[2];"function"==typeof u?a=X(n=u({col:e,row:t,dataValue:r.getCellOriginValue(e,t)||"",value:r.getCellValue(e,t)||"",rect:r.getCellRangeRelativeRect(r.getCellRange(e,t)),table:r}),g,p,i,l):(n=u,a=X(u,g,p,i,l));let b=[],m=[];if("object"==typeof n.xField)j.domain(n.xField.domain),h=n.xField.field;else if("string"==typeof n.xField){let e=c.map(e=>e[n.xField]);j.domain(e),h=n.xField}else Array.isArray(c)&&(j.domain(Array.from({length:c.length},(e,t)=>t)),h=n.xField);if(j.range([0,i]),"object"==typeof n.yField)U.domain(n.yField.domain),d=n.yField.field;else if("string"==typeof n.yField){let e=J(c,n.yField);U.domain([Math.min(...e),Math.max(...e)]),d=n.yField}else if(Array.isArray(c)){let e=J(c);U.domain([Math.min(...e),Math.max(...e)]),d=n.yField}if(U.range([0,l]),"object"==typeof n.xField&&Array.isArray(n.xField.domain)){let e=c.map(e=>e[n.xField.field]),t=n.xField.domain;for(let i=0;i<t.length;i++){let l=!1;for(let o=0;o<e.length;o++)if(t[i]===e[o]){let e=c[o];if(!(0,s.Z)(e[h])||!(0,s.Z)(e[d]))break;b.push({x:0+j.scale(e[h]),y:f-U.scale(e[d]),defined:(0,s.Z)(e[d])}),m.push(e),l=!0;break}l||(b.push({x:0+j.scale(t[i]),y:0,defined:!1}),m.push({[h]:t[i],[d]:null}))}}else for(let e=0;e<c.length;e++){let t=c[e];b.push({x:0+j.scale(h?t[h]:e),y:f-U.scale(d?t[d]:t),defined:(0,s.Z)(d?t[d]:t),rawData:t}),m.push(t)}let C=a.getChildByName("sparkline-line");C&&C.setAttribute("points",b),C.bandwidth=j.step(),C.min=U.range()[0],C.max=U.range()[1];let v=a.getChildByName("sparkline-symbol-group");if(v){let e="isolatedPoint"===n.pointShowRule;if("all"===n.pointShowRule)for(let e=0;e<b.length;e++){let{x:t,y:i,defined:l}=b[e];if(l){let e=(0,O.t)({x:t,y:i});v.appendChild(e)}}else if(e)for(let e=0;e<b.length;e++){let{x:t,y:i,defined:l}=b[e];if(l&&(!b[e-1]||!b[e-1].defined)&&(!b[e+1]||!b[e+1].defined)){let e=(0,O.t)({x:t,y:i});v.appendChild(e)}}}return a}(r,n,a,d,u,c);return W&&e.appendChild(W),e}function X(e,t,i,l,r){var n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x,_,S,R,H,A;let M;M="function"==typeof e?e(null):e;let F=new o.Z({x:t,y:i,width:l,height:r,stroke:!1,fill:!1});if(F.name="sparkline","line"===M.type){let e=(0,G.W)({x:0,y:0,curveType:M.smooth?"monotoneX":"linear",stroke:null!=(s=null==(a=null==(n=M.line)?void 0:n.style)?void 0:a.stroke)?s:"blue",lineWidth:null!=(u=null==(d=null==(h=M.line)?void 0:h.style)?void 0:d.strokeWidth)?u:2});e.name="sparkline-line",F.addChild(e),M.crosshair&&(e.hover=null!=(g=null==(c=M.crosshair)?void 0:c.style)?g:{stroke:"#000",interpolate:"linear"});let t=new o.Z({x:0,y:0,width:l,height:r,stroke:!1,fill:!1});t.name="sparkline-symbol-group",t.setTheme({symbol:{stroke:null!=(b=null==(f=null==(p=M.point)?void 0:p.style)?void 0:f.stroke)?b:"#000",lineWidth:null!=(v=null==(C=null==(m=M.point)?void 0:m.style)?void 0:C.strokeWidth)?v:1,fill:null!=(x=null==(y=null==(w=M.point)?void 0:w.style)?void 0:y.fill)?x:"#000",size:2*(null!=(R=null==(S=null==(_=M.point)?void 0:_.style)?void 0:S.size)?R:3),symbolType:"circle"}}),F.addChild(t),t.hover=null!=(A=null==(H=M.point)?void 0:H.hover)&&A}return F}function J(e,t){let i=[];for(let l=0;l<e.length;l++){let o=e[l];(0,s.Z)(t)&&(0,s.Z)(o[t])?i.push(o[t]):!(0,s.Z)(t)&&(0,s.Z)(o)&&i.push(o)}return i}var Y=i(19427),q=i(4234),Q=i(50871),ee=i(1669),et=i(93743),ei=i(37811);let el=q.U2();function eo(e,t,i,l,r,n,d,u,c,g,p,f,m,C,v,y,x){var _,S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,q,eo;let er,en,ea=C._getCellStyle(l,r),es=(0,a.vp)("padding",ea,l,r,C);(null==(_=C.options.customConfig)?void 0:_.imageMargin)?g=(0,ei.u)(null==(S=C.options.customConfig)?void 0:S.imageMargin):(0,s.Z)(es)&&(g=es),(null==(R=null==v?void 0:v.text)?void 0:R.textAlign)&&(p=null==(H=null==v?void 0:v.text)?void 0:H.textAlign),(null==(A=null==v?void 0:v.text)?void 0:A.textBaseline)&&(f=null==(M=null==v?void 0:v.text)?void 0:M.textBaseline);let eh=(0,h.d)(l,r,v,C);if(x&&(er=C.scenegraph.highPerformanceGetCell(l,r,!0))&&"cell"===er.role&&er.setAttributes({x:t,y:i,width:n,height:d,lineWidth:null!=(B=null==(F=null==v?void 0:v.group)?void 0:F.lineWidth)?B:void 0,fill:null!=(z=null==(T=null==v?void 0:v.group)?void 0:T.fill)?z:void 0,stroke:null!=(k=null==(L=null==v?void 0:v.group)?void 0:L.stroke)?k:void 0,strokeArrayWidth:eh,strokeArrayColor:null!=(I=null==(P=null==v?void 0:v.group)?void 0:P.strokeArrayColor)?I:void 0,cursor:null!=(D=null==(E=null==v?void 0:v.group)?void 0:E.cursor)?D:void 0,lineDash:null!=(O=null==(W=null==v?void 0:v.group)?void 0:W.lineDash)?O:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),er&&"cell"===er.role||((er=new o.Z({x:t,y:i,width:n,height:d,lineWidth:null!=(N=null==(G=null==v?void 0:v.group)?void 0:G.lineWidth)?N:void 0,fill:null!=(K=null==(Z=null==v?void 0:v.group)?void 0:Z.fill)?K:void 0,stroke:null!=(j=null==(V=null==v?void 0:v.group)?void 0:V.stroke)?j:void 0,strokeArrayWidth:eh,strokeArrayColor:null!=($=null==(U=null==v?void 0:v.group)?void 0:U.strokeArrayColor)?$:void 0,cursor:null!=(J=null==(X=null==v?void 0:v.group)?void 0:X.cursor)?J:void 0,lineDash:null!=(eo=null==(q=null==v?void 0:v.group)?void 0:q.lineDash)?eo:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})).role="cell",er.col=l,er.row=r,null==e||e.addCellGroup(er)),m){let e=l,t=r;y&&(e=y.start.col,t=y.start.row),en=C.getCellIcons(e,t)}let ed=0,eu=0;if(Array.isArray(en)&&0!==en.length){let{leftIconWidth:e,rightIconWidth:t,absoluteLeftIconWidth:i,absoluteRightIconWidth:l}=(0,b.M4)(en,er,y,C);ed=e,eu=t,er.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+g[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+n-t-g[1]):"icon-absolute-right"===e.role&&e.setAttribute("x",e.attribute.x+n-l-g[1])}),er.forEachChildren(e=>{"middle"===f?e.setAttribute("y",(d-e.AABBBounds.height())/2):"bottom"===f?e.setAttribute("y",d-e.AABBBounds.height()-g[2]):e.setAttribute("y",g[0])}),er._cellLeftIconWidth=ed,er._cellRightIconWidth=eu}let ec=C.getCellValue(l,r),eg=document.createElement("video");eg.addEventListener("loadeddata",()=>{c&&(0,w.LP)(l,r,eg.videoWidth,eg.videoHeight,C.scenegraph,g,er);let{width:e,height:t,isMerge:i}=(0,w.SI)(er,C);if(u){let{width:i,height:l}=(0,Q.f)(eg.videoWidth,eg.videoHeight,e-g[1]-g[3],t-g[0]-g[2]),o=(0,et.W)(0,0,e,t,i,l,p,f,g);ep.setAttributes({width:i,height:l,x:o.x,y:o.y,dx:0})}else ep.setAttributes({x:g[3],y:g[0],width:e-g[1]-g[3],height:t-g[2]-g[0],dy:0});i&&(0,w.Gb)(er.mergeStartCol,er.mergeEndCol,er.mergeStartRow,er.mergeEndRow,C);let{width:o,height:n}=(0,w.SI)(er,C),a=Math.floor(Math.min(o-g[1]-g[3],n-g[2]-g[0])/2),s=0+(o>ep.attribute.width?ep.attribute.x-0+ep.attribute.width/2:o/2),h=0+(n>ep.attribute.height?ep.attribute.y-0+ep.attribute.height/2:n/2),{dx:d,dy:b}=er.getChildByName("image",!0).attribute,m=new ee.J({x:s-a/2,y:h-a/2,width:a,height:a,image:el.play.svg,cursor:el.play.cursor,dx:d,dy:b});m.name="play-icon",er.appendChild(m),C.scenegraph.updateNextFrame()}),eg.onerror=()=>{ep.image=el.damage_pic.svg},eg.src=ec,eg.setAttribute("preload","auto");let ep=(0,Y.B)({x:g[3],y:g[0],width:n-g[1]-g[3],height:d-g[2]-g[0],image:eg,cursor:"pointer"});return ep.name="image",ep.keepAspectRatio=u,ep.textAlign=p,ep.textBaseline=f,er.appendChild(ep),er}var er=i(11971),en=i(50730);function ea(e,t,i,l,r,n,d,u,c,g,p,f,m,C,v,w,y,x,_){var S,R,H,A,M,F,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U,$,X,J,Y,q,Q,ee,et,ei,el;let eo,ea=e._getCellStyle(n,d),es=(0,a.vp)("padding",ea,n,d,e);(0,s.Z)(es)&&(p=es),(null==(S=null==y?void 0:y.text)?void 0:S.textAlign)&&(f=null==(R=null==y?void 0:y.text)?void 0:R.textAlign),(null==(H=null==y?void 0:y.text)?void 0:H.textBaseline)&&(m=null==(A=null==y?void 0:y.text)?void 0:A.textBaseline);let eh=e.isAutoRowHeight(d),ed=null!=(M=ea.autoWrapText)?M:e.internalProps.autoWrapText,eu=ea.lineClamp,ec=(0,h.d)(n,d,y,e);if(_&&(eo=e.scenegraph.getCell(n,d,!0))&&"cell"===eo.role&&eo.setAttributes({x:l,y:r,width:c,height:g,lineWidth:null!=(T=null==(F=null==y?void 0:y.group)?void 0:F.lineWidth)?T:void 0,fill:null!=(L=null==(z=null==y?void 0:y.group)?void 0:z.fill)?L:void 0,stroke:null!=(P=null==(k=null==y?void 0:y.group)?void 0:k.stroke)?P:void 0,strokeArrayWidth:null!=ec?ec:void 0,strokeArrayColor:null!=(E=null==(I=null==y?void 0:y.group)?void 0:I.strokeArrayColor)?E:void 0,cursor:null!=(W=null==(D=null==y?void 0:y.group)?void 0:D.cursor)?W:void 0,lineDash:null!=(G=null==(O=null==y?void 0:y.group)?void 0:O.lineDash)?G:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius}),eo&&"cell"===eo.role||((eo=new o.Z({x:l,y:r,width:c,height:g,lineWidth:null!=(Z=null==(N=null==y?void 0:y.group)?void 0:N.lineWidth)?Z:void 0,fill:null!=(V=null==(K=null==y?void 0:y.group)?void 0:K.fill)?V:void 0,stroke:null!=(U=null==(j=null==y?void 0:y.group)?void 0:j.stroke)?U:void 0,strokeArrayWidth:null!=ec?ec:void 0,strokeArrayColor:null!=(X=null==($=null==y?void 0:y.group)?void 0:$.strokeArrayColor)?X:void 0,cursor:null!=(Y=null==(J=null==y?void 0:y.group)?void 0:J.cursor)?Y:void 0,lineDash:null!=(Q=null==(q=null==y?void 0:y.group)?void 0:q.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",eo.col=n,eo.row=d,null==i||i.addCellGroup(eo)),v&&eo.appendChild(v),w){let i;if(C){let t=n,l=d;x&&(t=x.start.col,l=x.start.row),i=e.getCellIcons(t,l)}(0,b.Rd)(eo,i,t,p,"auto"===u,eh,ed,"number"==typeof eu?eu:void 0,eo.attribute.width,eo.attribute.height,f,m,e,y,x),(null==(ee=null==y?void 0:y._vtable)?void 0:ee.marked)&&function(e,t,i){if("boolean"==typeof e){let e=(0,er.Q)({x:t.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});e.name="mark",t.appendChild(e)}else{let i,l,o,r,n,a,{bgColor:s="#3073F2",shape:h="sector",position:d="right-top",size:u=10,offset:c=0}=e;if("sector"===h)"right-top"===d?(i=t.attribute.width-c,l=c,o=Math.PI/2,r=Math.PI):"left-top"===d?(i=c,l=c,o=0,r=Math.PI/2):"right-bottom"===d?(i=t.attribute.width-c,l=t.attribute.height-c,o=Math.PI,r=Math.PI/2*3):"left-bottom"===d&&(i=c,l=t.attribute.height-c,o=Math.PI/2*3,r=2*Math.PI),n=s,a=(0,er.Q)({x:i,y:l,startAngle:o,endAngle:r,outerRadius:u,fill:n,pickable:!1});else if("triangle"===h){let e,o,r,h;"right-top"===d?(i=t.attribute.width-c,l=c,e=i-u,o=l,r=i,h=l+u):"left-top"===d?(i=c,l=c,e=i+u,o=l,r=i,h=l+u):"right-bottom"===d?(i=t.attribute.width-c,l=t.attribute.height-c,e=i-u,o=l,r=i,h=l-u):"left-bottom"===d&&(i=c,l=t.attribute.height-c,e=i+u,o=l,r=i,h=l-u),n=s,a=(0,en.p)({points:[{x:i,y:l},{x:e,y:o},{x:r,y:h}],fill:n,pickable:!1})}else"rect"===h&&("right-top"===d?(i=t.attribute.width-u-c,l=c):"left-top"===d?(i=c,l=c):"right-bottom"===d?(i=t.attribute.width-u-c,l=t.attribute.height-u-c):"left-bottom"===d&&(i=c,l=t.attribute.height-u-c),n=s,a=(0,B.f)({x:i,y:l,width:u,height:u,fill:n,pickable:!1}));a.name="mark",t.appendChild(a)}}(null==(et=null==y?void 0:y._vtable)?void 0:et.marked,eo,0)}return v&&eo.setAttributes({width:Math.max(eo.attribute.width,null!=(ei=v.attribute.width)?ei:0),height:Math.max(eo.attribute.height,null!=(el=v.attribute.height)?el:0)}),eo}function es(e,t,i,l,r,n,s,h,d,u){var c,g,p,b,m;if(e.dependField){let t=(0,f.vi)(e.dependField,{col:n,row:s,table:d,value:l,dataValue:r,cellHeaderPaths:void 0});r=null!=(g=null==(c=d.getCellOriginRecord(n,s))?void 0:c[t])?g:r}let C=null!=(p=(0,f.vi)(e.barType,{col:n,row:s,table:d,value:l,dataValue:r,cellHeaderPaths:void 0}))?p:"default",v=null!=(b=(0,f.vi)(e.min,{col:n,row:s,table:d,value:l,dataValue:r,cellHeaderPaths:void 0}))?b:0,w=null!=(m=(0,f.vi)(e.max,{col:n,row:s,table:d,value:l,dataValue:r,cellHeaderPaths:void 0}))?m:v+100,x=0;x=u?d.getRowsHeight(u.start.row,u.end.row):d.getRowHeight(s);let _=i,S=x,R=0;(0,y.Z)(d.theme._contentOffset)&&(R=d.theme._contentOffset);let H=new o.Z({x:-R,y:-R,width:_,height:S});H.name="progress-bar";let{showBar:A,barColor:M,barBgColor:F,barPositiveColor:T,barNegativeColor:z,barAxisColor:L,barRightToLeft:k,showBarMark:P,barMarkPositiveColor:I,barMarkNegativeColor:E,barMarkWidth:D,barMarkPosition:W,barMarkInBar:O}=t,{barHeight:N,barBottom:Z,barPadding:K}=t;1===K.length?K=[K[0],K[0],K[0],K[0]]:2===K.length?K=[K[0],K[1],K[0],K[1]]:3===K.length&&(K=[K[0],K[1],K[2],K[1]]),K=K.map((e,t)=>{if("string"==typeof e&&f.Bd.endsWith(e,"%")){let l=Number(e.substr(0,e.length-1));return 0===t||2===t?x*l/100:i*l/100}return Number(e)});let V=(0,ei.u)((0,a.WJ)("borderLineWidth",t,n,s,d)),j=Math.max(K[0],Math.ceil(V[0]/2)),U=Math.max(K[1],Math.floor(V[1]/2)),$=Math.max(K[2],Math.floor(V[2]/2)),X=Math.max(K[3],Math.ceil(V[3]/2));P&&D>0&&"right"===W&&!1===O&&(U+=D,X+=D),_-=U+X,S-=$+j,s===d.rowCount-1&&[0,"0"].includes(Z)&&(S-=1);let J=X,Y=_;if(N="string"==typeof N&&f.Bd.endsWith(N,"%")?S*(N=Number(N.substr(0,N.length-1)))/100:Number(N),Z="string"==typeof Z&&f.Bd.endsWith(Z,"%")?S*(Z=Number(Z.substr(0,Z.length-1)))/100:Number(Z),(0,f.vi)(A,{col:n,row:s,table:d,context:null,value:l,dataValue:r})){let e=`${r}`;f.Bd.endsWith(e,"%")&&(e=e.substr(0,e.length-1));let t=Number(e);if(isNaN(t))return H;if("default"===(null!=C?C:"default")){let e=t<v?0:t>w?1:(t-v)/(w-v),i=_,o=j+S-N-Z,a=Math.min(i*e,i),h=k?J+Y-a:J;n!==d.colCount-1||1!==e||k||(a-=1);let u=(0,f.vi)(F,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:e});if(u){let e=(0,B.f)({x:h,y:o,width:i,height:N,fill:u});H.addChild(e)}let c=(0,f.vi)(M,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:e})||"#20a8d8",g=(0,B.f)({x:h,y:o,width:a,height:N,fill:c});H.addChild(g)}else if("negative"===C){let e=v<0?-v:0,i=w>0?w:0,o=e/(e+i),a=1-o,h=t>0?t/i:0,u=t<0?-t/e:0,c=_,g=j+S-N-Z,p=(0,f.vi)(F,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:h});if(p){let e=(0,B.f)({x:J,y:g,width:c,height:N,fill:p});H.addChild(e)}let b=k?a*c:o*c,m=Math.min(c*o*u,c),C=k?{left:J+b,top:g,width:m,height:N}:{left:J+b-m,top:g,width:m,height:N},y=(0,f.vi)(z,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:u})||"#20a8d8",R=(0,B.f)({x:C.left,y:C.top,width:C.width,height:C.height,fill:y});H.addChild(R);let A=Math.min(c*a*h,c);n!==d.colCount-1||1!==h||k||(A-=1);let M=k?{left:J+b-A,top:g,width:A,height:N}:{left:J+b,top:g,width:A,height:N},K=(0,f.vi)(T,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:h})||"#20a8d8",V=(0,B.f)({x:M.left,y:M.top,width:M.width,height:M.height,fill:K});H.addChild(V);let U=k?C.left:M.left,$=(0,f.vi)(L,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:h}),X=(0,G.W)({x:0,y:0,stroke:$,lineWidth:1,lineDash:[2,2],points:[{x:U,y:0},{x:U,y:x}]});if(H.addChild(X),P&&(h||u)){let e,t=[];if(h>0)if(e=(0,f.vi)(I,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:h})||"#20a8d8","right"===W){let e=k?M.left+D/2:M.left+M.width+(O?-D/2:D/2);t.push({x:e,y:M.top}),t.push({x:e,y:M.top+M.height})}else"bottom"===W&&(t.push({x:M.left,y:M.top+M.height-D/2}),t.push({x:M.left+M.width,y:M.top+M.height-D/2}));else if(u>0)if(e=(0,f.vi)(E,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:u})||"#20a8d8","right"===W){let e=k?C.left+C.width-D/2:C.left+D/2;t.push({x:e,y:C.top}),t.push({x:e,y:C.top+C.height})}else"bottom"===W&&(t.push({x:C.left,y:C.top+C.height-D/2}),t.push({x:C.left+C.width,y:C.top+C.height-D/2}));let i=(0,G.W)({x:0,y:0,stroke:e,lineWidth:D,points:t});H.addChild(i)}}else if("negative_no_axis"===C){let e,i=Math.max(v<0?-v:0,w>0?w:0),o=0===i?0:Math.abs(t)/i,a=_,h=Math.min(a*o,a);n!==d.colCount-1||1!==o||k||(h-=1);let u=j+S-N-Z,c=k?J+Y-h:J,g=(0,f.vi)(F,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:o});if(g){let e=(0,B.f)({x:c,y:u,width:a,height:N,fill:g});H.addChild(e)}let p={left:c,top:u,width:h,height:N};e=t>=0?(0,f.vi)(T,{col:n,row:s,table:d,context:null,value:l,percentile:o,dataValue:r})||"#20a8d8":(0,f.vi)(z,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:o})||"#20a8d8";let b=(0,B.f)({x:p.left,y:p.top,width:p.width,height:p.height,fill:e});if(H.addChild(b),P&&t){let e,i=[];if(e=t>=0?(0,f.vi)(I,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:o})||"#20a8d8":(0,f.vi)(E,{col:n,row:s,table:d,context:null,value:l,dataValue:r,percentile:o})||"#20a8d8","right"===W){let e=k?p.left+D/2:p.left+p.width-D/2;i.push({x:e,y:p.top}),i.push({x:e,y:p.top+p.height})}else"bottom"===W&&(i.push({x:p.left,y:p.top+p.height-D/2}),i.push({x:p.left+p.width,y:p.top+p.height-D/2}));let a=(0,G.W)({x:0,y:0,stroke:e,lineWidth:D,points:i});H.addChild(a)}}}return H}var eh=i(37352),ed=i(25777),eu=i(70506),ec=i(29753),eg=i(79229);function ep(e,t,i,l,o,r){var n,a,h,d,u,c,g,p,f,b,m,C,v,w,x,_,S,R;let H,A;if((null==i?void 0:i.zero)&&(e=Math.min(e,0),t=Math.max(t,0)),null==i?void 0:i.expand){let l=e,o=t;(0,s.Z)(i.expand.min)&&(e=l-(o-l)*i.expand.min),(0,s.Z)(i.expand.max)&&(t=o+(o-l)*i.expand.max)}if((0,y.Z)(null==i?void 0:i.min)&&(e=i.min),(0,y.Z)(null==i?void 0:i.max)&&(t=i.max),"log"===(null==i?void 0:i.type)?(H=new eh.Y).base(null!=(n=null==i?void 0:i.base)?n:10):"symlog"===(null==i?void 0:i.type)?(H=new ed.g).constant(null!=(a=null==i?void 0:i.constant)?a:10):H=new V.f,H.domain([e,t],!!(null==i?void 0:i.nice)),r){S=H,R=r,S.niceMax(R.targetTicks.length)}else if(null==i?void 0:i.nice){let e=null!=(c=null!=(d=null==(h=i.tick)?void 0:h.forceTickCount)?d:null==(u=i.tick)?void 0:u.tickCount)?c:10;(0,eu.Z)(e)&&(e=e({axisLength:o,labelStyle:null!=(p=null==(g=null==i?void 0:i.label)?void 0:g.style)?p:{fontSize:eg.Zu.LABEL_FONT_SIZE}})),"accurateFirst"===i.niceType&&(e=Math.max(10,e)),(0,ec.Z)(i.min)&&(0,ec.Z)(i.max)?H.nice(e):(0,s.Z)(i.min)&&(0,ec.Z)(i.max)?H.niceMax(e):(0,ec.Z)(i.min)&&(0,s.Z)(i.max)&&H.niceMin(e)}return delete H._niceType,A=(null!=(b=null==(f=null==r?void 0:r.targetTicks)?void 0:f.length)?b:null==(m=null==i?void 0:i.tick)?void 0:m.forceTickCount)?H.forceTicks(null!=(v=null==(C=null==r?void 0:r.targetTicks)?void 0:C.length)?v:null==(w=null==i?void 0:i.tick)?void 0:w.forceTickCount):H.ticks((0,y.Z)(null==(x=null==i?void 0:i.tick)?void 0:x.tickCount)?i.tick.tickCount:5,{noDecimals:null==(_=null==i?void 0:i.tick)?void 0:_.noDecimals}),{range:H.domain(),ticks:A}}var ef=i(46293);function eb(e,t,i,l,r,n,s,d,u,c,g,m,C,v,w,y,x,_){var S,R,H,A,M,F,B,T,z,L,k,P,I,E,D,W,O,G,N,Z,K,V,j,U;let $;if(!e){let a=(0,h.d)(r,n,w,v);_&&(e=v.scenegraph.highPerformanceGetCell(r,n,!0))&&"cell"===e.role&&e.setAttributes({x:i,y:l,width:d,height:u,lineWidth:null!=(R=null==(S=null==w?void 0:w.group)?void 0:S.lineWidth)?R:void 0,fill:null!=(A=null==(H=null==w?void 0:w.group)?void 0:H.fill)?A:void 0,stroke:null!=(F=null==(M=null==w?void 0:w.group)?void 0:M.stroke)?F:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(T=null==(B=null==w?void 0:w.group)?void 0:B.strokeArrayColor)?T:void 0,cursor:null!=(L=null==(z=null==w?void 0:w.group)?void 0:z.cursor)?L:void 0,lineDash:null!=(P=null==(k=null==w?void 0:w.group)?void 0:k.lineDash)?P:void 0,lineCap:"butt",clip:!0,cornerRadius:w.group.cornerRadius}),e&&"cell"===e.role||((e=new o.Z({x:i,y:l,width:d,height:u,lineWidth:null!=(E=null==(I=null==w?void 0:w.group)?void 0:I.lineWidth)?E:void 0,fill:null!=(W=null==(D=null==w?void 0:w.group)?void 0:D.fill)?W:void 0,stroke:null!=(G=null==(O=null==w?void 0:w.group)?void 0:O.stroke)?G:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(Z=null==(N=null==w?void 0:w.group)?void 0:N.strokeArrayColor)?Z:void 0,cursor:null!=(V=null==(K=null==w?void 0:w.group)?void 0:K.cursor)?V:void 0,lineDash:null!=(U=null==(j=null==w?void 0:w.group)?void 0:j.lineDash)?U:void 0,lineCap:"butt",clip:!0,cornerRadius:w.group.cornerRadius})).role="cell",e.col=r,e.row=n,null==t||t.addCellGroup(e))}if(C){let e=r,t=n;x&&(e=x.start.col,t=x.start.row),$=v.getCellIcons(e,t)}let X=0,J=0;if(Array.isArray($)&&0!==$.length){let{leftIconWidth:t,rightIconWidth:i,absoluteLeftIconWidth:l,absoluteRightIconWidth:o}=(0,b.M4)($,e,x,v);X=t+i,J=t,e.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+c[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+d-i-c[1]):"icon-absolute-right"===e.role&&e.setAttribute("x",e.attribute.x+d-o-c[1])}),e.forEachChildren(e=>{"middle"===m?e.setAttribute("y",(u-e.AABBBounds.height())/2):"bottom"===m?e.setAttribute("y",u-e.AABBBounds.height()-c[2]):e.setAttribute("y",c[0])})}let Y=function(e,t,i,l,o,r,n,s,h){var d,u;let c=h._getCellStyle(e,t),g=(0,a.WJ)("buttonColor",c,e,t,h),b=(0,a.WJ)("buttonBorderColor",c,e,t,h),m=(0,a.WJ)("buttonLineWidth",c,e,t,h),C=(0,a.WJ)("buttonBorderRadius",c,e,t,h),v=(0,a.WJ)("buttonHoverColor",c,e,t,h),w=(0,a.WJ)("buttonHoverBorderColor",c,e,t,h),y=(0,a.WJ)("buttonPadding",c,e,t,h),x=(0,a.WJ)("buttonTextHoverColor",c,e,t,h),_=(0,a.WJ)("buttonDisableColor",c,e,t,h),S=(0,a.WJ)("buttonDisableBorderColor",c,e,t,h),R=(0,a.WJ)("buttonTextDisableColor",c,e,t,h),H=h.getCellValue(e,t),A=h.getCellOriginValue(e,t),M=(0,p.L)(e,t,h),F=h._getCellStyle(e,t),B=null!=(d=F.autoWrapText)?d:h.internalProps.autoWrapText,{lineClamp:T}=F,z=h.isAutoRowHeight(t),{disable:L,text:k}=s,P=(0,f.vi)(L,{col:e,row:t,table:h,context:null,value:H,dataValue:A}),I=(0,f.vi)(k,{col:e,row:t,table:h,context:null,value:H,dataValue:A}),E=null!=(u=null!=I?I:H)?u:"",D={maxLineWidth:"auto"===i?1/0:l-(r[1]+r[3]+M),textAlign:"left",textBaseline:"top",autoWrapText:B,lineClamp:T,wordBreak:"break-word",heightLimit:z?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:M,whiteSpace:1!==E.length||B?"normal":"no-wrap"},W=n.text?Object.assign({},n.text,D):D,O={x:0,y:0,cursor:P?"not-allowed":"pointer",disable:P,childrenPickable:!1,text:1===E.length?E[0]:E,textStyle:W,padding:y,panel:{visible:!0,fill:P?_:g,stroke:P?S:b,lineWidth:m,cornerRadius:C},state:{text:{hover:{}},panel:{hover:{fill:v,stroke:w}}}};R&&(O.state.text.fill=R),x&&(O.state.text.hover.fill=x);let G=new ef.V(O);return G.name="button",P||(G.addEventListener("mouseenter",()=>{G.addState("hover",!0,!1),G.stage.renderNextFrame()}),G.addEventListener("mouseleave",()=>{G.removeState("hover",!1),G.stage.renderNextFrame()})),G}(r,n,s-X,d,u,c,w,y,v);return Y&&e.appendChild(Y),d-=c[1]+c[3]+X,u-=c[0]+c[2],"center"===g?Y.setAttribute("x",c[3]+J+(d-Y.AABBBounds.width())/2):"right"===g?Y.setAttribute("x",c[3]+J+d-Y.AABBBounds.width()):Y.setAttribute("x",c[3]+J),"middle"===m?Y.setAttribute("y",c[0]+(u-Y.AABBBounds.height())/2):"bottom"===m?Y.setAttribute("y",c[0]+u-Y.AABBBounds.height()):Y.setAttribute("y",c[0]),e}let em=()=>{l.F.registerFunction("createChartCellGroup",d),l.F.registerFunction("getAxisDomainRangeAndLabels",ep)},eC=()=>{l.F.registerFunction("createCheckboxCellGroup",v)},ev=()=>{l.F.registerFunction("createImageCellGroup",w.Ui)},ew=()=>{l.F.registerFunction("createProgressBarCell",es)},ey=()=>{l.F.registerFunction("createRadioCellGroup",H)},ex=()=>{l.F.registerFunction("createSwitchCellGroup",W)},e_=()=>{l.F.registerFunction("createButtonCellGroup",eb)},eS=()=>{l.F.registerFunction("createSparkLineCellGroup",$)},eR=()=>{l.F.registerFunction("createTextCellGroup",ea)},eH=()=>{l.F.registerFunction("createVideoCellGroup",eo)}},78958:function(e,t,i){"use strict";i.d(t,{al:()=>C,j8:()=>w,rj:()=>m});var l=i(12348),o=i(27695),r=i(37811),n=i(60232),a=i(75025),s=i(18585),h=i(70506),d=i(47e3),u=i(43735),c=i(58977),g=i(31604),p=i(33291),f=i(57752),b=i(77597);function m(e,t,i,l){var o,r,n,a,s,h,d,u;e.internalProps.columnWidthConfig&&e._parseColumnWidthConfig(e.internalProps.columnWidthConfig),e.isPivotTable()&&e.internalProps.columnWidthConfigForRowHeader&&e._parseColumnWidthConfigForRowHeader(e.internalProps.columnWidthConfigForRowHeader),t=null!=t?t:0,i=null!=i?i:e.colCount-1,0===t&&i===e.colCount-1&&e._clearColRangeWidthsMap();let c=e.internalProps.layoutMap;e.isPivotTable()&&(c.enableUseGetBodyCache(),c.enableUseHeaderPathCache());let g=[],p=[];if(l)for(let t=0;t<e.colCount;t++)g[t]=e.getColWidth(t);for(let s=t;s<=i;s++){let t;if(!e.internalProps.transpose&&("only-header"===(null==(r=null==(o=e.internalProps.layoutMap.columnObjects)?void 0:o[s])?void 0:r.columnWidthComputeMode)||"only-header"===e.columnWidthComputeMode)&&"showHeader"in e.internalProps.layoutMap){let i=e.internalProps.layoutMap.showHeader;e.internalProps.layoutMap.showHeader=!0,t=C(s,0,e.internalProps.layoutMap.headerLevelCount-1,e),e.internalProps.layoutMap.showHeader=i}else t=e.internalProps.transpose||"only-body"!==(null==(a=null==(n=e.internalProps.layoutMap.columnObjects)?void 0:n[s])?void 0:a.columnWidthComputeMode)&&"only-body"!==e.columnWidthComputeMode?C(s,0,e.rowCount-1,e):C(s,e.internalProps.layoutMap.getBodyRange().start.row,e.internalProps.layoutMap.getBodyRange().end.row,e);e._setColContentWidth(s,t),e.getColWidth(s)!==t&&e._clearColRangeWidthsMap(s),l?p[s]=Math.round(e._adjustColWidth(s,t)):e._setColWidth(s,e._adjustColWidth(s,t),!1,!0)}if("adaptive"===e.widthMode){e._clearColRangeWidthsMap();let t=e.tableNoFrameWidth,i=0,o=0,r=e.colCount;if("only-body"===e.widthAdaptiveMode){for(let t=0;t<e.colCount;t++){let o=l&&null!=(s=p[t])?s:e.getColWidth(t);(t<e.rowHeaderLevelCount||e.isPivotChart()&&t>=e.colCount-e.rightFrozenColCount)&&(i+=o)}o=e.rowHeaderLevelCount,r=e.isPivotChart()?e.colCount-e.rightFrozenColCount:e.colCount}w(t-i,o,r,l,p,e)}else if(e.autoFillWidth){e._clearColRangeWidthsMap();let t=e.tableNoFrameWidth,i=0,o=0;for(let t=0;t<e.colCount;t++){let r=l&&null!=(h=p[t])?h:e.getColWidth(t);(t<e.rowHeaderLevelCount+e.leftRowSeriesNumberCount||e.isPivotChart()&&t>=e.colCount-e.rightFrozenColCount)&&(i+=r),o+=r}o<t&&o>i&&w(t-i,e.rowHeaderLevelCount+e.leftRowSeriesNumberCount,e.isPivotChart()?e.colCount-e.rightFrozenColCount:e.colCount,l,p,e)}if(l){for(let t=0;t<e.colCount;t++){let i=null!=(u=null!=(d=p[t])?d:e.getColWidth(t))?u:e.getColWidth(t);i!==g[t]&&e._setColWidth(t,i,!1,!0)}e.stateManager.checkFrozen();for(let t=0;t<e.colCount;t++){let i=e.getColWidth(t);i!==g[t]&&e.scenegraph.updateColWidth(t,i-g[t],!0,!0)}e.scenegraph.updateContainer(!0)}e.isPivotTable()&&(c.disableUseGetBodyCache(),c.disableUseHeaderPathCache())}function C(e,t,i,l,o=!1){let r=function(e,t){let i=t.getColWidthDefined(e);return t.internalProps._widthResizedColMap.has(e)?t.getColWidth(e):i}(e,l);return l.internalProps.transpose&&"auto"===r&&("only-header"===l.columnWidthComputeMode&&e>=l.rowHeaderLevelCount||"only-body"===l.columnWidthComputeMode&&e<l.rowHeaderLevelCount)&&(r=l.getDefaultColumnWidth(e)),o&&!l.internalProps.transpose?v(r,e,t,i,o,l):"number"==typeof r?r:"auto"!==r&&"string"==typeof r?l._adjustColWidth(e,l._colWidthDefineToPxWidth(r)):v(r,e,t,i,o,l)}function v(e,t,i,m,C,v){var w,y,x,_,S;let R=0,H=1,A=1;if(m-i>5e3&&(A=Math.ceil((m-i)/5e3)),v.isPivotChart()&&t>=v.rowHeaderLevelCount&&t<v.colCount-v.rightFrozenColCount){if(v.internalProps.layoutMap.indicatorsAsCol)return v.defaultColWidth;{let e=v.internalProps.layoutMap.getOptimunWidthForChart(t);if(e>0)return e}}for(let M=i;M<=m;M+=H){if(v.isPivotChart()){let e=v.internalProps.layoutMap,i=e.getAxisConfigInPivotChart(t,M);if(i){let e=a.F.getFunction("computeAxisComponentWidth")(i,v);if("number"==typeof e){R=Math.max(e,R);continue}}else if(e.isLeftBottomCorner(t,M)||e.isRightTopCorner(t,M)||e.isRightBottomCorner(t,M))continue}let i=function(e,t,i){var l,o,a,s,d,u,c,p,b,m;let C=i.getCustomRender(e,t),v=i.getCustomLayout(e,t);if(C||v){let w,y=1,x=0,_=!1,S=!1;(i.isHeader(e,t)||(null==(l=i.getBodyColumnDefine(e,t))?void 0:l.mergeCell)||i.hasCustomMerge())&&(y=(w=i.getCellRange(e,t)).end.col-w.start.col+1);let R={col:null!=(o=null==w?void 0:w.start.col)?o:e,row:null!=(a=null==w?void 0:w.start.row)?a:t,dataValue:i.getCellOriginValue(e,t),value:i.getCellValue(e,t)||"",rect:(p=e,b=t,{left:0,top:0,right:(m=i).getColWidth(p),bottom:m.getRowHeight(b),width:null,height:null}),table:i,originCol:e,originRow:t,forComputation:!0};if("react-custom-layout"===v&&(v=(null==(s=i.reactCustomLayout)?void 0:s.getCustomLayoutFunc(e,t))||f.D),(0,h.Z)(v)){let e=v(R);if(e.rootContainer){e.rootContainer=(0,g.nH)(e.rootContainer),(0,g.Jp)(e.rootContainer,0,i.getRowHeight(t));let l=e.rootContainer.attribute.width;e.rootContainer.setStage(i.scenegraph.stage),x=l>0?l:null!=(d=e.rootContainer.AABBBounds.width())?d:0,_=e.renderDefault,S=e.enableCellPadding}else x=0,_=e.renderDefault,S=e.enableCellPadding}else if("function"==typeof C){let e=C(R);x=null!=(u=null==e?void 0:e.expectedWidth)?u:0,_=null==e?void 0:e.renderDefault}else x=null!=(c=null==C?void 0:C.expectedWidth)?c:0,_=null==C?void 0:C.renderDefault;if(x=Math.ceil(x),S){let l=i._getCellStyle(e,t),o=(0,r.u)((0,n.WJ)("padding",l,e,t,i));x+=o[1]+o[3]}return{width:x/y,renderDefault:_}}}(t,M,v);if(i&&(R=Math.max(i.width,R),!i.renderDefault))continue;if("number"==typeof e&&"standard"===v.widthMode&&!C){R=Math.max(e,R);continue}let m=v.isHeader(t,M)?null==(w=v._getHeaderLayoutMap(t,M))?void 0:w.headerType:v.getBodyColumnType(t,M);if((0,s.Z)(m)&&"text"!==m&&"link"!==m&&"progressbar"!==m&&"checkbox"!==m&&"radio"!==m&&"switch"!==m&&"button"!==m){R=Math.max(R,v.getColWidthDefinedNumber(t)||0);continue}let F=0,B=v.internalProps.layoutMap;if(B.isHeader(t,M)){let e=B.getHeader(t,M);if("only-body"===(null==(y=null==e?void 0:e.define)?void 0:y.columnWidthComputeMode))continue;(0,s.Z)(null==e?void 0:e.hierarchyLevel)&&(F=(null!=(x=e.hierarchyLevel)?x:0)*("tree"===B.rowHierarchyType&&null!=(_=B.rowHierarchyIndent)?_:0),B.rowHierarchyTextStartAlignment&&!v.internalProps.headerHelper.getHierarchyIcon(t,M)&&(F+=v.internalProps.headerHelper.getHierarchyIconWidth()))}else if(v.isListTable()){H=A;let e=v.getBodyColumnDefine(t,M);if(null==e?void 0:e.tree){let e=v.dataSource.getIndexKey(v.getRecordShowIndexByCell(t,M));F=Array.isArray(e)&&v.getHierarchyState(t,M)!==l.g.none?(e.length-1)*(null!=(S=B.hierarchyIndent)?S:0):0,B.hierarchyTextStartAlignment&&!v.internalProps.bodyHelper.getHierarchyIcon(t,M)&&(F+=v.internalProps.headerHelper.getHierarchyIconWidth())}}R=Math.max(function(e,t,i,l){var a,s,h,g;let f,m=0,C=l.getCellValue(e,t),v=l._getCellStyle(e,t),w=0,y=!1;if("body"!==l.getCellLocation(e,t))y=!0;else{let i=l.getBodyColumnDefine(e,t);y=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(y){let i=l.getCellIcons(e,t);null==i||i.forEach(e=>{var t,i,l;e.positionType!==o.q0.absoluteRight&&(w+=(null!=(t=e.width)?t:0)+(null!=(i=e.marginLeft)?i:0)+(null!=(l=e.marginRight)?l:0))})}let x=1;if(l.isHeader(e,t)||(null==(a=l.getBodyColumnDefine(e,t))?void 0:a.mergeCell)||l.hasCustomMerge()){let i=l.getCellRange(e,t);x=i.end.col-i.start.col+1}let _=(0,r.u)((0,n.WJ)("padding",v,e,t,l)),S=_[1]+_[3],R=(0,n.WJ)("fontSize",v,e,t,l),H=(0,n.WJ)("fontFamily",v,e,t,l),A=(0,n.WJ)("fontWeight",v,e,t,l);if("checkbox"===i)f=(0,d.Z)(C)?C.text:C;else if("radio"===i)if((0,u.Z)(C)){f="";let i=l.getBodyColumnDefine(e,t),o=null!=(s=null==i?void 0:i.radioDirectionInCell)?s:"vertical";"vertical"===o?C.forEach(e=>{f+=((0,d.Z)(e)?e.text:e).toString()+"\n"}):"horizontal"===o&&C.forEach(e=>{f+=((0,d.Z)(e)?e.text:e).toString()})}else f=(0,d.Z)(C)?C.text:C;else if("button"===i){let i=l.getBodyColumnDefine(e,t),o=(0,b.vi)(i.text,{col:e,row:t,table:l,context:null,value:C,dataValue:l.getCellOriginValue(e,t)});f=null!=(h=null!=o?o:C)?h:""}else f=C;let M=(0,p.$)(f,l).text;if(M.length>=1&&(1!==M.length||""!==M[0])?M.forEach(e=>{m=Math.max((l.measureText(e,{fontSize:R,fontFamily:H,fontWeight:A}).width+S+4+w)/x,m)}):m=Math.max((S+4+w)/x,m),!1!==l.internalProps.limitMaxAutoWidth&&(m=Math.min("number"==typeof l.internalProps.limitMaxAutoWidth?l.internalProps.limitMaxAutoWidth:450,m)),"checkbox"===i){let i=(0,n.WJ)("size",v,e,t,l);if(m+=i,f){let i=(0,n.WJ)("spaceBetweenTextAndIcon",v,e,t,l);m+=i}}else if("radio"===i){let i=(0,n.WJ)("size",v,e,t,l),o=(0,n.WJ)("outerRadius",v,e,t,l),r=(0,c.Z)(o)?2*o:i,a=(0,n.WJ)("spaceBetweenTextAndIcon",v,e,t,l);if((0,u.Z)(C)){let i=l.getBodyColumnDefine(e,t),o=(0,n.WJ)("spaceBetweenRadio",v,e,t,l),s=null!=(g=null==i?void 0:i.radioDirectionInCell)?g:"vertical";"vertical"===s?(m+=r,m+=a):"horizontal"===s&&(m+=(r+a)*C.length,m+=o*(C.length-1))}else m+=r,f&&(m+=a)}else if("switch"===i)m=(0,n.WJ)("boxWidth",v,e,t,l);else if("button"===i){let i=(0,n.WJ)("buttonPadding",v,e,t,l);m+=2*i}return m}(t,M,m,v)+F,R),H>1&&v.bottomFrozenRowCount>0&&M<v.rowCount-v.bottomFrozenRowCount&&M+H>=v.rowCount-v.bottomFrozenRowCount&&(M=v.rowCount-v.bottomFrozenRowCount-H,H=1,A=1)}let M=v.getMinColWidth(t),F=v.getMaxColWidth(t);return R<M?M:R>F?F:(R<=0&&(R=v.defaultColWidth),R)}function w(e,t,i,l,o,r,n){var a,s,h,d;let u=0,c=[],g=[],p=0,f=new Map,b=new Map;for(let e=t;e<i;e++){let t=l&&null!=(a=o[e])?a:r.getColWidth(e),i=r.getMaxColWidth(e),n=r.getMinColWidth(e);u+=t,c.push(e),i===t?f.set(e,t):n===t&&b.set(e,t),(null==(s=r.options.customConfig)?void 0:s.shrinkSparklineFirst)&&"sparkline"===r.getBodyColumnType(e,0)&&(g.push({col:e,width:t}),p+=t-r.defaultColWidth)}if(u>e)for(let[t,i]of b){e-=i,u-=i;let l=c.indexOf(t);-1!==l&&c.splice(l,1)}else if(u<e)for(let[t,i]of f){e-=i,u-=i;let l=c.indexOf(t);-1!==l&&c.splice(l,1)}let m=e/u;if((null==(h=r.options.customConfig)?void 0:h.shrinkSparklineFirst)&&m<1&&u-e<p)for(let t=0;t<g.length;t++){let{col:i,width:a}=g[t],s=Math.floor(a-(u-e)/g.length);l?o[i]=r._adjustColWidth(i,s):n?r.scenegraph.setColWidth(i,r._adjustColWidth(i,s)):r._setColWidth(i,r._adjustColWidth(i,s),!1,!0)}else for(let t=0;t<c.length;t++){let i,a=c[t];i=t===c.length-1?e-c.reduce((e,t,i)=>{var n;return t!==a?e+(l?null!=(n=o[t])?n:r.getColWidth(a):r.getColWidth(t)):e},0):Math.round((l&&null!=(d=o[a])?d:r.getColWidth(a))*m),l?o[a]=r._adjustColWidth(a,i):n?r.scenegraph.setColWidth(a,r._adjustColWidth(a,i)):r._setColWidth(a,r._adjustColWidth(a,i),!1,!0)}}},9649:function(e,t,i){"use strict";i.d(t,{P:()=>B,Y:()=>F});var l=i(93342),o=i(27695),r=i(60232),n=i(37811),a=i(49277),s=i(75025),h=i(43735),d=i(18585),u=i(58977),c=i(70506),g=i(31604),p=i(13224),f=i(81668),b=i(47e3),m=i(28071),C=i(74294),v=i(66707),w=i(46293);let y=new C.J({}),x=new v.Y({}),_=new w.V({});function S(e,t,i,l,o,n,a,s,h,d,c,g,p,f,C){let v=(0,b.Z)(e)?e.text:e,w=(0,m.cw)(v).split("\n")||[],y=C.getColsWidth(t,l),_=(0,r.WJ)("size",o,t,i,C),S=(0,r.WJ)("outerRadius",o,t,i,C),R=(0,u.Z)(S)?2*S:_,H=0;if(n){let e=(0,r.WJ)("spaceBetweenTextAndIcon",o,t,i,C),l=y-(f[1]+f[3])-a-R-e;(0,u.Z)(S)||(S=Math.round(_/2)),x.setAttributes({text:{maxLineWidth:l,text:w,fontSize:s,fontStyle:h,fontWeight:d,fontFamily:c,lineHeight:g,wordBreak:"break-word",lineClamp:p},circle:{outerRadius:S},spaceBetweenTextAndIcon:e}),x.render(),H=x.AABBBounds.height()}else H=Math.max(_,w.length*g);return H}var R=i(85021),H=i(33291),A=i(57752);let M=new l.H({width:0,height:0,textConfig:[]});function F(e,t,i,l=!0,o){var r,n,a,s,u,c,g,f,b,m,C;"undefined"!=typeof window&&window.performance.now();let v=[],w=[];if(o)for(let l=t;l<=i;l++)v[l]=e.getRowHeight(l);let y=e.internalProps.layoutMap;e.isPivotTable()&&(y.enableUseGetBodyCache(),y.enableUseHeaderPathCache()),e.defaultHeaderRowHeight,e.defaultHeaderColWidth;let x="auto"===e.defaultHeaderRowHeight||(0,h.Z)(e.defaultHeaderRowHeight)&&e.defaultHeaderRowHeight.some(e=>"auto"===e),_=e.isAutoRowHeight(t)||"adaptive"===e.heightMode&&!1!==e.options.autoHeightInAdaptiveMode,S="auto"===e.options.defaultRowHeight;if(_||x||S){t=null!=t?t:0,i=null!=i?i:e.rowCount-1,(0===t&&i===e.rowCount-1||l)&&e._clearRowRangeHeightsMap();for(let i=t;i<e.columnHeaderLevelCount;i++){let t=0,l=e.colCount-1;if((e.isPivotTable()&&!e.isPivotChart()||e.isPivotChart()&&!e.internalProps.layoutMap.indicatorsAsCol)&&function(e,t){var i,l,o;let{layoutMap:r}=e.internalProps;if(e.internalProps.autoWrapText&&(e.isAutoRowHeight(t)||"adaptive"===e.options.heightMode))return!1;let n=r.getHeader(e.rowHeaderLevelCount,t);if("function"==typeof n.style||"function"==typeof n.icons||(null==(i=n.define)?void 0:i.headerCustomRender)||(null==(l=n.define)?void 0:l.headerCustomLayout)||"function"==typeof(null==(o=n.define)?void 0:o.icon))return!1;let a=e._getCellStyle(e.rowHeaderLevelCount,t);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(e,i)&&!(0,p.Z)(e,e.rowHeaderLevelCount,i)&&(t=0,l=e.rowHeaderLevelCount),_||"auto"===e.getDefaultRowHeight(i)){let r=B(i,t,l,e);w[i]=Math.round(r),"only-body"!==e.heightAdaptiveMode&&o||e._setRowHeight(i,r)}}for(let t=e.rowCount-e.bottomFrozenRowCount;t<=i;t++)if(_||"auto"===e.getDefaultRowHeight(t)){let i=B(t,0,e.colCount-1,e);o?w[t]=Math.round(i):e._setRowHeight(t,i)}if(!(i<e.columnHeaderLevelCount)&&(_||S))if(e.internalProps.transpose||e.isPivotTable()&&!e.internalProps.layoutMap.indicatorsAsCol||e.options.customComputeRowHeight||!function(e,t){var i,l,o;let{layoutMap:r}=e.internalProps,n=e.columnHeaderLevelCount;if((e.internalProps.autoWrapText||e.internalProps.enableLineBreak||e.isPivotChart())&&(e.isAutoRowHeight(t)||"adaptive"===e.options.heightMode))return!1;for(let t=0;t<e.colCount;t++){let a=r.getBody(t,n);if("radio"===a.cellType||"function"==typeof a.style||"function"==typeof a.icon||(null==(i=a.define)?void 0:i.customRender)||(null==(l=a.define)?void 0:l.customLayout)||"function"==typeof(null==(o=a.define)?void 0:o.icon))return!1;let s=e._getCellStyle(t,n);if("function"==typeof s.padding||"function"==typeof s.fontSize||"function"==typeof s.lineHeight||!0===s.autoWrapText)return!1}return!0}(e,t))if(e.internalProps.transpose||e.isPivotTable()&&!e.internalProps.layoutMap.indicatorsAsCol)for(let l=Math.max(t,e.columnHeaderLevelCount);l<=i;l++){let t;t=!function(e,t){var i,l,o;let{layoutMap:r}=e.internalProps;if((e.internalProps.autoWrapText||e.internalProps.enableLineBreak)&&(e.isAutoRowHeight(t)||"adaptive"===e.options.heightMode))return!1;let n=r.getBody(e.rowHeaderLevelCount,t);if("function"==typeof n.style||"function"==typeof n.icon||(null==(i=n.define)?void 0:i.customRender)||(null==(l=n.define)?void 0:l.customLayout)||"function"==typeof(null==(o=n.define)?void 0:o.icon))return!1;let a=e._getCellStyle(e.rowHeaderLevelCount,t);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(e,l)?B(l,0,e.colCount-1,e):B(l,0,e.rowHeaderLevelCount,e),o?w[l]=Math.round(t):e._setRowHeight(l,t)}else for(let l=Math.max(t,e.columnHeaderLevelCount);l<=i;l++){let t=B(l,0,e.colCount-1,e);o?w[l]=Math.round(t):e._setRowHeight(l,t)}else{!function(e,t,i,l,o){if(!l.internalProps.useOneRowHeightFillAll){for(let r=t;r<=i;r++)o?o[r]=e:l._setRowHeight(r,e);l.internalProps.useOneRowHeightFillAll=!0}}(B(e.columnHeaderLevelCount,0,e.colCount-1,e),e.columnHeaderLevelCount,e.rowCount-1-e.bottomFrozenRowCount,e,o?w:void 0);for(let t=e.rowCount-e.bottomFrozenRowCount;t<=i;t++){let i=B(t,0,e.colCount-1,e);o?w[t]=Math.round(i):e._setRowHeight(t,i)}}}else if(("adaptive"===e.heightMode||e.autoFillHeight)&&e.clearRowHeightCache(),o)for(let l=t;l<=i;l++)w[l]=e.getRowHeight(l);if((0===t&&i===e.rowCount-1||l)&&e._clearRowRangeHeightsMap(),"adaptive"===e.heightMode){e._clearRowRangeHeightsMap();let t=e.tableNoFrameHeight,i=0,l=e.rowCount;if("only-body"===e.heightAdaptiveMode){let o=e.getRowsHeight(0,e.columnHeaderLevelCount-1),r=e.isPivotChart()?e.getBottomFrozenRowsHeight():0;t=e.tableNoFrameHeight-o-r,i=e.columnHeaderLevelCount,l=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount}let a=0;for(let t=i;t<l;t++)a+=o&&null!=(r=w[t])?r:e.getRowHeight(t);let s=t/a;for(let r=i;r<l;r++){let a;a=r===l-1?t-(o?w.reduce((e,t,o)=>o>=i&&o<=l-2?e+t:e,0):e.getRowsHeight(i,l-2)):Math.round((o&&null!=(n=w[r])?n:e.getRowHeight(r))*s),o?w[r]=a:e._setRowHeight(r,a,!1)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();let t=e.tableNoFrameHeight,i=0,l=0;for(let t=0;t<e.rowCount;t++){let r=o&&null!=(a=w[t])?a:e.getRowHeight(t);(t<e.columnHeaderLevelCount||e.isPivotChart()&&t>=e.rowCount-e.bottomFrozenRowCount)&&(l+=r),i+=r}if(e.scenegraph._dealAutoFillHeightOriginRowsHeight=i,i<t&&i-l>0){let r=e.columnHeaderLevelCount,n=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,a=(t-l)/(i-l);for(let i=r;i<n;i++){let h;h=i===n-1?t-l-(o?w.reduce((e,t,i)=>i>=r&&i<=n-2?e+t:e,0):e.getRowsHeight(r,n-2)):Math.round((o&&null!=(s=w[i])?s:e.getRowHeight(i))*a),o?w[i]=h:e._setRowHeight(i,h,!1)}}}if(o){for(let l=t;l<=i;l++){let t=null!=(u=w[l])?u:e.getRowHeight(l);(0,d.Z)(t)&&e._setRowHeight(l,t)}for(let t=0;t<=e.frozenRowCount-1;t++){let i=e.getRowHeight(t);i!==(null!=(c=v[t])?c:e.getRowHeight(t))&&e.scenegraph.updateRowHeight(t,i-(null!=(g=v[t])?g:e.getRowHeight(t)),!0)}for(let t=e.rowCount-e.bottomFrozenRowCount;t<=e.rowCount-1;t++){let i=e.getRowHeight(t);i!==(null!=(f=v[t])?f:e.getRowHeight(t))&&e.scenegraph.updateRowHeight(t,i-(null!=(b=v[t])?b:e.getRowHeight(t)),!0)}for(let t=e.scenegraph.proxy.rowStart;t<=e.scenegraph.proxy.rowEnd;t++){let i=e.getRowHeight(t);i!==(null!=(m=v[t])?m:e.getRowHeight(t))&&e.scenegraph.updateRowHeight(t,i-(null!=(C=v[t])?C:e.getRowHeight(t)),!0)}}e.isPivotTable()&&(y.disableUseGetBodyCache(),y.disableUseHeaderPathCache())}function B(e,t,i,l){var p;let C;if(!(l.isAutoRowHeight(e)||"adaptive"===l.heightMode&&!1!==l.options.autoHeightInAdaptiveMode)&&"auto"!==l.getDefaultRowHeight(e))return l.getDefaultRowHeight(e);if(l.options.customComputeRowHeight){let t=l.options.customComputeRowHeight({row:e,table:l});if("number"==typeof t)return t;if("auto"!==t)return l.getDefaultRowHeight(e)}if(l.isPivotChart()&&e>=l.columnHeaderLevelCount&&e<l.rowCount-l.bottomFrozenRowCount)if(l.internalProps.layoutMap.indicatorsAsCol){let t=l.internalProps.layoutMap.getOptimunHeightForChart(e);if(t>0)return t}else{let t=l.getDefaultRowHeight(e);if((0,u.Z)(t))return t}for(let u=t;u<=i;u++){let t=function(e,t,i){var l,o,a,s,h,d,u,p,f,b;let m=i.getCustomRender(e,t),C=i.getCustomLayout(e,t);if(m||C){let v,w=1,y=0,x=!1,_=!1;(i.isHeader(e,t)||(null==(l=i.getBodyColumnDefine(e,t))?void 0:l.mergeCell)||i.hasCustomMerge())&&(w=(v=i.getCellRange(e,t)).end.row-v.start.row+1);let S={col:null!=(o=null==v?void 0:v.start.col)?o:e,row:null!=(a=null==v?void 0:v.start.row)?a:t,dataValue:i.getCellOriginValue(e,t),value:i.getCellValue(e,t)||"",rect:(p=e,f=t,{left:0,top:0,right:(b=i).getColWidth(p),bottom:b.getRowHeight(f),width:b.getColWidth(p),height:0}),table:i,originCol:e,originRow:t,forComputation:!0};if("react-custom-layout"===C&&(C=(null==(s=i.reactCustomLayout)?void 0:s.getCustomLayoutFunc(e,t))||A.D),(0,c.Z)(C)){let t=C(S);t.rootContainer?(t.rootContainer=(0,g.nH)(t.rootContainer),(0,g.Jp)(t.rootContainer,i.getColWidth(e),0),t.rootContainer.setStage(i.scenegraph.stage),y=null!=(h=t.rootContainer.AABBBounds.height())?h:0):y=0,x=t.renderDefault,_=t.enableCellPadding}else if("function"==typeof m){let e=m(S);y=null!=(d=null==e?void 0:e.expectedHeight)?d:0,x=null==e?void 0:e.renderDefault}else y=null!=(u=null==m?void 0:m.expectedHeight)?u:0,x=null==m?void 0:m.renderDefault;if(_){let l=i._getCellStyle(e,t),o=(0,n.u)((0,r.WJ)("padding",l,e,t,i));y+=o[0]+o[2]}return{height:y/w,renderDefault:x}}}(u,e,l);if(t&&(C=(0,d.Z)(C)?Math.max(t.height,C):t.height,!t.renderDefault))continue;if(l.isPivotChart()){let t=l.internalProps.layoutMap.getAxisConfigInPivotChart(u,e);if(t){let e=s.F.getFunction("computeAxisComponentHeight")(t,l);if("number"==typeof e){C=(0,d.Z)(C)?Math.max(e,C):e;continue}}}if(l.isPivotChart()&&(l.isLeftFrozenColumn(u)&&l.isBottomFrozenRow(e)||l.isRightFrozenColumn(u)&&l.isBottomFrozenRow(e)))continue;let i=function(e,t,i,l){var s,d,u,c,g;let p=0,C=l.getCellValue(e,t),v=l._getCellStyle(e,t),w=0,A=0,F=[],B=0,T=[],z=0,L=!1;if("body"!==l.getCellLocation(e,t))L=!0;else{let i=l.getBodyColumnDefine(e,t);L=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(L){let i=l.getCellIcons(e,t);null==i||i.forEach(e=>{var t,i,l,r,n,a,s,h,d,u;e.positionType!==o.q0.absoluteRight&&e.positionType!==o.q0.inlineFront&&e.positionType!==o.q0.inlineEnd?(A+=(null!=(t=e.width)?t:0)+(null!=(i=e.marginLeft)?i:0)+(null!=(l=e.marginRight)?l:0),w=Math.max(w,null!=(r=e.height)?r:0)):e.positionType===o.q0.inlineFront?(F.push(e),B=Math.max(B,(null!=(n=e.height)?n:0)+(null!=(a=e.marginLeft)?a:0)+(null!=(s=e.marginRight)?s:0))):e.positionType===o.q0.inlineEnd&&(T.push(e),z=Math.max(z,(null!=(h=e.height)?h:0)+(null!=(d=e.marginLeft)?d:0)+(null!=(u=e.marginRight)?u:0)))})}let k=1,P=e;if(l.isHeader(e,t)||(null==(s=l.getBodyColumnDefine(e,t))?void 0:s.mergeCell)||l.hasCustomMerge()){let i=l.getCellRange(e,t);k=i.end.row-i.start.row+1,e=i.start.col,P=i.end.col}let I=(0,n.u)((0,r.WJ)("padding",v,e,t,l)),E=(0,r.WJ)("fontSize",v,e,t,l),D=(0,r.WJ)("fontStyle",v,e,t,l),W=(0,r.WJ)("fontWeight",v,e,t,l),O=null!=(d=(0,r.WJ)("lineHeight",v,e,t,l))?d:E,G=(0,r.WJ)("fontFamily",v,e,t,l),N=(0,r.WJ)("autoWrapText",v,e,t,l),Z=(0,r.WJ)("lineClamp",v,e,t,l),K=(0,r.WJ)("underline",v,e,t,l),V=null!=(u=(0,r.WJ)("underlineOffset",v,e,t,l))?u:0;if("text"!==i&&"link"!==i&&"progressbar"!==i&&"checkbox"!==i&&"radio"!==i&&"switch"!==i&&"button"!==i)p=O;else if("checkbox"===i)p=function(e,t,i,l,o,n,a,s,h,d,u,c,g,p,f){let C=(0,b.Z)(e)?e.text:e,v=(0,m.cw)(C).split("\n")||[],w=f.getColsWidth(t,l),x=(0,r.WJ)("size",o,t,i,f),_=0;if(n){let e=(0,r.WJ)("spaceBetweenTextAndIcon",o,t,i,f),l=w-(p[1]+p[3])-a-x-e;y.setAttributes({text:{maxLineWidth:l,text:v,fontSize:s,fontStyle:h,fontWeight:d,fontFamily:u,lineHeight:c,wordBreak:"break-word",lineClamp:g},icon:{width:Math.floor(x/1.4),height:Math.floor(x/1.4)},box:{width:x,height:x},spaceBetweenTextAndIcon:e}),y.render(),_=y.AABBBounds.height()}else _=Math.max(x,v.length*c);return _}(C,e,t,P,v,N,A,E,D,W,G,O,Z,I,l);else if("radio"===i)p=function(e,t,i,l,o,n,a,s,d,u,c,g,p,f,b){var m;if((0,h.Z)(e)){let h=0,C=b.getBodyColumnDefine(t,i),v=(0,r.WJ)("spaceBetweenRadio",o,t,i,b),w=null!=(m=null==C?void 0:C.radioDirectionInCell)?m:"vertical";return"vertical"===w?e.forEach((r,m)=>{let C=S(r,t,i,l,o,n,a,s,d,u,c,g,p,f,b);h+=C,m!==e.length-1&&(h+=v)}):"horizontal"===w&&e.forEach(e=>{h=Math.max(S(e,t,i,l,o,n,a,s,d,u,c,g,p,f,b),h)}),h}return S(e,t,i,l,o,n,a,s,d,u,c,g,p,f,b)}(C,e,t,P,v,N,A,E,D,W,G,O,Z,I,l);else if("switch"===i)g=e,p=(0,r.WJ)("boxWidth",v,g,t,l);else if("button"===i)p=function(e,t,i,l,o,n,a,s,h,d,u,c,g,p,f){let C=(0,b.Z)(e)?e.text:e,v=(0,m.cw)(C).split("\n")||[],w=f.getColsWidth(t,l),y=(0,r.WJ)("buttonPadding",o,t,i,f),S=(0,r.WJ)("buttonLineWidth",o,t,i,f),R=0;if(n){let e=w-(p[1]+p[3]);_.setAttributes({text:v,textStyle:{maxLineWidth:e,fontSize:s,fontStyle:h,fontWeight:d,fontFamily:u,lineHeight:c,wordBreak:"break-word",lineClamp:g},padding:y,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:S}}),x.render(),R=x.AABBBounds.height()}else R=v.length*c+2*y;return R}(C,e,t,P,v,N,0,E,D,W,G,O,Z,I,l);else{let i=(0,H.$)(C,l).text,o=l.getColsWidth(e,P);if(F.length||T.length)if(N){let e=Object.assign({text:null==C?void 0:C.toString(),fontFamily:G,fontSize:E,fontStyle:D,fontWeight:W,lineHeight:O});e.textBaseline="middle";let t=[...F.map(e=>(0,a.vQ)(e)),e,...T.map(e=>(0,a.vQ)(e))];M.setAttributes({width:o-(I[1]+I[3])-A,height:0,textConfig:t}),p=M.AABBBounds.height()}else p=0,i.forEach((e,t)=>{var o;(null==(o=l.options.customConfig)?void 0:o.multilinesForXTable)&&0!==t||(0===t&&F.length?p+=Math.max(O,B):t===i.length-1&&T.length?p+=Math.max(O,z):p+=O)});else if(N){let r=(0,f.L)(e,t,l),n=o-(I[1]+I[3])-A-r;p=((0,R.Rc)({maxLineWidth:n,text:i,fontSize:E,fontStyle:D,fontWeight:W,fontFamily:G,lineHeight:O,wordBreak:"break-word",whiteSpace:1!==i.length||N?"normal":"no-wrap",lineClamp:Z}).height()||("number"==typeof O?O:E))+(K?V:0)}else p=(null==(c=l.options.customConfig)?void 0:c.multilinesForXTable)?O:i.length*O}return(Math.max(p,w)+I[0]+I[2])/k}(u,e,l.isHeader(u,e)?null==(p=l._getHeaderLayoutMap(u,e))?void 0:p.headerType:l.getBodyColumnType(u,e),l);C=(0,d.Z)(C)?Math.max(i,C):i}if((0,d.Z)(C))return C;let v=l.getDefaultRowHeight(e);return(0,u.Z)(v)?v:l.defaultRowHeight}},42365:function(e,t,i){"use strict";i.d(t,{KP:()=>d,RW:()=>h,kl:()=>s,s8:()=>c,s9:()=>a,zO:()=>u});var l=i(8611),o=i(75025),r=i(37811),n=i(60232);function a(e,t){let{table:i}=e,l=i.internalProps.layoutMap,o=-1===t?"all":i.internalProps.columnResizeType;if("column"===o){let l=e.getColGroup(t),o=e.getColGroup(t,!0),r=e.getColGroupInBottom(t,!0);if(null==l||l.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==o||o.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==r||r.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),"adaptive"===i.widthMode&&t<i.colCount-1){let l=e.getColGroup(t+1),o=e.getColGroup(t+1,!0),r=e.getColGroupInBottom(t+1,!0);null==l||l.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==o||o.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==r||r.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))})}}else{let r,n,a,s=i.rowHeaderLevelCount,h=i.colCount-1;if("indicator"===o)if(l.indicatorsAsCol)r=l.getIndicatorKey(t,i.columnHeaderLevelCount);else{let e=l.getCellHeaderPaths(t,i.columnHeaderLevelCount-1),o=e.colHeaderPaths[e.colHeaderPaths.length-1];n=o.dimensionKey,a=o.value}else if("indicatorGroup"===o){let e=i.internalProps.layoutMap,t=e.getCellHeaderPaths(i.stateManager.columnResize.col,i.columnHeaderLevelCount),l=e.getHeadNodeByRowOrColDimensions(t.colHeaderPaths.slice(0,t.colHeaderPaths.length-1));s=l.startInTotal+i.frozenColCount,h=l.startInTotal+i.frozenColCount+l.size-1}for(let t=s;t<=h;t++){let s=e.getColGroup(t),h=e.getColGroup(t,!0),d=e.getColGroupInBottom(t,!0);if(s){if("indicator"===o){let e=l.getIndicatorKey(t,i.columnHeaderLevelCount);if(l.indicatorsAsCol&&e!==r)continue;if(!l.indicatorsAsCol){let e=l.getCellHeaderPaths(t,i.columnHeaderLevelCount-1),o=null==e?void 0:e.colHeaderPaths[e.colHeaderPaths.length-1];if(!o||n!==o.dimensionKey||a!==o.value)continue}}s.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==h||h.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))}),null==d||d.forEachChildren(e=>{p(e,i.getColWidth(e.col),i.getRowHeight(e.row))})}}}}function s(e,t){var i;let{table:l}=e,o=l.internalProps.layoutMap,r=l.stateManager,n=-1===t?"all":l.internalProps.rowResizeType,a,s,h,d=l.columnHeaderLevelCount,u=l.rowCount-1;if("indicator"===n)if(o.indicatorsAsCol){let e=o.getCellHeaderPaths(l.rowHeaderLevelCount-1,t),r=null==(i=e.rowHeaderPaths)?void 0:i[e.rowHeaderPaths.length-1];s=null==r?void 0:r.dimensionKey,h=null==r?void 0:r.value}else a=o.getIndicatorKey(l.rowHeaderLevelCount,t);else if("indicatorGroup"===n){let e=l.internalProps.layoutMap,i=e.getCellHeaderPaths(l.rowHeaderLevelCount,t),o=e.getHeadNodeByRowOrColDimensions(i.rowHeaderPaths.slice(0,i.rowHeaderPaths.length-1));d=o.startInTotal+l.frozenRowCount,u=o.startInTotal+l.frozenRowCount+o.size-1}let c=[{startCol:e.proxy.colStart,endCol:e.proxy.colEnd}];l.frozenColCount&&c.push({startCol:0,endCol:l.frozenColCount-1}),l.rightFrozenColCount&&c.push({startCol:l.colCount-l.rightFrozenColCount,endCol:l.colCount-1}),c.forEach(({startCol:i,endCol:c})=>{for(let g=i;g<=c;g++)if("row"===n){let i=e.highPerformanceGetCell(g,t);if("cell"!==i.role)continue;if(p(i,l.getColWidth(i.col),l.getRowHeight(i.row)),"adaptive"===l.heightMode&&t<l.rowCount-1){let i=e.highPerformanceGetCell(g,t+1);p(i,l.getColWidth(i.col),l.getRowHeight(i.row))}}else for(let t=d;t<=u;t++){if("indicator"===n){let e=o.getIndicatorKey(r.table.rowHeaderLevelCount,t);if(!o.indicatorsAsCol&&e!==a)continue;if(o.indicatorsAsCol){let e=o.getCellHeaderPaths(r.table.rowHeaderLevelCount-1,t),i=null==e?void 0:e.rowHeaderPaths[e.rowHeaderPaths.length-1];if(!i||s!==i.dimensionKey||h!==i.value)continue}}let i=e.highPerformanceGetCell(g,t);"cell"===i.role&&p(i,l.getColWidth(i.col),l.getRowHeight(i.row))}})}function h(e){var t;for(let i=e.proxy.colStart;i<=e.proxy.colEnd;i++){let l=e.getColGroup(i);null==(t=null==l?void 0:l.getChildren())||t.forEach(e=>{e.children.forEach(e=>{"chart"===e.type&&(e.cacheCanvas=null,e.addUpdateBoundTag())})})}}function d(e,t,i){i.getCell(e,t).children.forEach(e=>{"chart"===e.type&&(e.cacheCanvas=null,e.addUpdateBoundTag())})}function u(e){var t;let i=e.table;for(let l=e.proxy.colStart;l<=e.proxy.colEnd;l++){let o=e.getColGroup(l);null==(t=null==o?void 0:o.getChildren())||t.forEach(e=>{let t=e.col,l=e.row;e.children.forEach(e=>{if("chart"===e.type){e.updateData(i.getCellValue(t,l));let o=e.attribute.spec,r=o.type;if("gauge"!==r&&"rose"!==r&&"radar"!==r){let r=i.internalProps.layoutMap.getChartAxes(t,l);e.setAttribute("axes",r),o.axes=r}e.setAttribute("spec",o)}})})}g(e.rowHeaderGroup,e.table),g(e.colHeaderGroup,e.table),g(e.rightFrozenGroup,e.table),g(e.bottomFrozenGroup,e.table)}function c(e,t){let i=e.table;if(i.isPivotChart()){let o=i._selectedDataItemsInChart.length;if((null===t||0===(null==t?void 0:t.length)||0===Object.keys(t).length)&&0===o)return;let r=[];if(Array.isArray(t))t.forEach(e=>{if(e&&0!==e.key&&Object.keys(e).length>0){let t={};for(let i in e)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(t[i]=e[i]);r.push(t)}});else if(t&&0!==t.key&&Object.keys(t).length>0){let e={};for(let i in t)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(e[i]=t[i]);r.push(e)}(0,l.X)(i._selectedDataItemsInChart,r)||(i._selectedDataItemsInChart=r,i.internalProps.layoutMap.updateDataStateToChartInstance(),h(e),i.scenegraph.updateNextFrame())}}function g(e,t){e.forEachChildren(e=>{"column"===e.role&&e.forEachChildren(e=>{var i;if("cell"===e.role){let l=!1;if(e.forEachChildren(e=>"axis"===e.name&&(l=!0,!0)),l){let l=t.internalProps.layoutMap.getAxisConfigInPivotChart(e.col,e.row),a=t._getCellStyle(e.col,e.row),s=(0,r.u)((0,n.WJ)("padding",a,e.col,e.row,t)),h=new(o.F.getComponent("axis"))(l,e.attribute.width,e.attribute.height,null!=(i=l.__vtablePadding)?i:s,t);e.clear(),e.appendChild(h.component),h.overlap()}}})})}function p(e,t,i){e.forEachChildren(e=>{"chart"===e.type&&(e.cacheCanvas=null,e.setAttributes({width:Math.ceil(t-e.attribute.cellPadding[3]-e.attribute.cellPadding[1]),height:Math.ceil(i-e.attribute.cellPadding[0]-e.attribute.cellPadding[2])}))})}},33291:function(e,t,i){"use strict";i.d(t,{$:()=>r});var l=i(58853),o=i(28071);function r(e,t){var i,r;let n,a=!1;for((0,l.Z)(e)&&e.length>(t.options.maxCharactersNumber||200)&&(e=e.slice(0,t.options.maxCharactersNumber||200)+"…",a=!0),n=t.internalProps.enableLineBreak||(null==(i=t.options.customConfig)?void 0:i.multilinesForXTable)?(0,o.m7)(e).replace(/\r?\n/g,"\n").replace(/\r/g,"\n").split("\n")||[]:[(0,o.m7)(e)];n.length&&n.length>1&&!n[n.length-1];)n.pop();if((null==(r=t.options.customConfig)?void 0:r.multilinesForXTable)&&!t.internalProps.autoWrapText)for(;n.length&&n.length>1&&!n[0];)n.shift();return{text:n,moreThanMaxCharacters:a}}},5569:function(e,t,i){"use strict";i.d(t,{d:()=>o});var l=i(97811);function o(e,t,i,o){var r,n,a,s,h,d,u,c,g,p,f,b,m,C,v,w,y,x;let _=null!=(n=null==(r=null==i?void 0:i.group)?void 0:r.strokeArrayWidth)?n:void 0;return o.theme.cellInnerBorder||!(0,l.z5)(o.theme.frameStyle.borderLineWidth)||(0,l.KV)(o.theme.frameStyle.borderLineWidth)||(0===e&&((_=null!=_?_:[null==(a=null==i?void 0:i.group)?void 0:a.lineWidth,null==(s=null==i?void 0:i.group)?void 0:s.lineWidth,null==(h=null==i?void 0:i.group)?void 0:h.lineWidth,null==(d=null==i?void 0:i.group)?void 0:d.lineWidth])[3]=0),e===o.colCount-1&&((_=null!=_?_:[null==(u=null==i?void 0:i.group)?void 0:u.lineWidth,null==(c=null==i?void 0:i.group)?void 0:c.lineWidth,null==(g=null==i?void 0:i.group)?void 0:g.lineWidth,null==(p=null==i?void 0:i.group)?void 0:p.lineWidth])[1]=0),0===t&&((_=null!=_?_:[null==(f=null==i?void 0:i.group)?void 0:f.lineWidth,null==(b=null==i?void 0:i.group)?void 0:b.lineWidth,null==(m=null==i?void 0:i.group)?void 0:m.lineWidth,null==(C=null==i?void 0:i.group)?void 0:C.lineWidth])[0]=0),t===o.rowCount-1&&((_=null!=_?_:[null==(v=null==i?void 0:i.group)?void 0:v.lineWidth,null==(w=null==i?void 0:i.group)?void 0:w.lineWidth,null==(y=null==i?void 0:i.group)?void 0:y.lineWidth,null==(x=null==i?void 0:i.group)?void 0:x.lineWidth])[2]=0)),_}},93743:function(e,t,i){"use strict";function l(e,t,i,o,r,n,a="left",s="middle",h=[0,0,0,0],d=0,u=0,c=0,g=0){let p=e+h[3]+d;"right"===a||"end"===a?p=e+i-r-h[1]-u:"center"===a&&(p=e+(i-r+d-u)/2);let f=t+h[0]+c;return"bottom"===s||"alphabetic"===s||"ideographic"===s?f=t+o-n-h[2]-g:"middle"===s&&(f=t+(o-n+c-g)/2),{x:p,y:f}}i.d(t,{W:()=>l})},60740:function(e,t,i){"use strict";function l(e,t,i){e.then(()=>{i(),t.scenegraph.updateNextFrame()}).catch(e=>{})}i.d(t,{K:()=>l})},13224:function(e,t,i){"use strict";function l(e,t,i){var l;if(e.internalProps.customMergeCell){let l=e.getCustomMerge(t,i);if(l)return l.range}if(!e.internalProps.enableTreeNodeMerge&&!e.isHeader(t,i)&&!(null==(l=e.getBodyColumnDefine(t,i))?void 0:l.mergeCell))return!1;let o=e.getCellRange(t,i);return(o.start.col!==o.end.col||o.start.row!==o.end.row)&&o}i.d(t,{Z:()=>l})},81668:function(e,t,i){"use strict";i.d(t,{L:()=>n});var l=i(18585),o=i(43735),r=i(12348);function n(e,t,i){var n,a,s,h,d;let u=0,c=i.internalProps.layoutMap;if(c.isHeader(e,t)){let o=c.getHeader(e,t);(0,l.Z)(null==o?void 0:o.hierarchyLevel)&&(u=(null!=(n=o.hierarchyLevel)?n:0)*("tree"===c.rowHierarchyType&&null!=(a=c.rowHierarchyIndent)?a:0),c.rowHierarchyTextStartAlignment&&!i.internalProps.headerHelper.getHierarchyIcon(e,t)&&(u+=i.internalProps.headerHelper.getHierarchyIconWidth()))}else if(i.internalProps.groupBy||(null==(s=i.getBodyColumnDefine(e,t))?void 0:s.tree)){let l=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(e,t)),n=null!=(h=i.dataSource.getGroupLength())?h:0,a=(0,o.Z)(l)?l.length-1:0;n>0&&a===n&&(a=0),u=Array.isArray(l)&&i.getHierarchyState(e,t)!==r.g.none?a*(null!=(d=c.hierarchyIndent)?d:0):0,c.hierarchyTextStartAlignment&&!i.internalProps.bodyHelper.getHierarchyIcon(e,t)&&(u+=i.internalProps.bodyHelper.getHierarchyIconWidth())}return u}},60232:function(e,t,i){"use strict";i.d(t,{WJ:()=>o,vp:()=>r});var l=i(18585);function o(e,t,i,o,r){let n=t&&(0,l.Z)(t[e])?t[e]:void 0;return"function"==typeof n?n({col:i,row:o,table:r,value:r.getCellValue(i,o),dataValue:r.getCellOriginValue(i,o),cellHeaderPaths:r.getCellHeaderPaths(i,o)}):n}function r(e,t,i,o,r){let n=t&&(0,l.Z)(t[e])?t[e]:void 0;if("function"==typeof n)return n({col:i,row:o,table:r,value:r.getCellValue(i,o),dataValue:r.getCellOriginValue(i,o),cellHeaderPaths:r.getCellHeaderPaths(i,o)})}},50871:function(e,t,i){"use strict";function l(e,t,i,l){let o,r,n=e/t;return n>i/l?(l-(r=(o=i)/n))/2:(i-(o=(r=l)*n))/2,{width:o,height:r}}i.d(t,{f:()=>l})},37811:function(e,t,i){"use strict";i.d(t,{u:()=>a});var l=i(37967),o=i(58977),r=i(58853),n=i(43735);function a(e){var t,i,a,s;if((0,o.Z)(e)||(0,r.Z)(e)||(0,n.Z)(e)){let t=(0,l.dj)(e);return"number"==typeof t||"string"==typeof t?t=[t,t,t,t]:Array.isArray(t)&&(t=t.slice(0)),t}return e&&(isFinite(e.bottom)||isFinite(e.left)||isFinite(e.right)||isFinite(e.top))?[null!=(t=e.top)?t:0,null!=(i=e.right)?i:0,null!=(a=e.bottom)?a:0,null!=(s=e.left)?s:0]:[0,0,0,0]}},49277:function(e,t,i){"use strict";i.d(t,{vQ:()=>w,qs:()=>y,M4:()=>_,Zl:()=>x,Bg:()=>v,Rd:()=>C});var l=i(29411),o=i(93342),r=i(27695),n=i(38512),a=i(1669);class s extends n.Z{constructor(e){super(e),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(e){this._autoWidth=e.autoWidth,this._autoHeight=e.autoHeight,this._cellWidth=e.cellWidth,this._originCellWidth=e.cellWidth,this._cellHeight=e.cellHeight,this._align=e.align,this._baseline=e.baseline}addLeftOccupyingIcon(e){var t,i,l;e.setAttribute("x",this._leftGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._leftGroup.appendChild(e),this._leftGroup.setDeltaWidth((null!=(i=e.attribute.marginLeft)?i:0)+(null!=(l=e.attribute.marginRight)?l:0)+e.attribute.width)}addRightOccupyingIcon(e){var t,i,l;e.setAttribute("x",this._rightGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._rightGroup.appendChild(e),this._rightGroup.setDeltaWidth((null!=(i=e.attribute.marginLeft)?i:0)+(null!=(l=e.attribute.marginRight)?l:0)+e.attribute.width)}addContent(e){let t=this._centerGroup.lastChild;t&&e.setAttributes({x:t.attribute.x+t.AABBBounds.width()}),this._centerGroup.appendChild(e),e instanceof l.x&&(this._centerGroup.setAttribute("pickable",!1),e.setAttribute("textAlign","left"))}layout(){let e=this._leftGroup.width;e===1/0&&(e=0);let t=this._rightGroup.width;if(t===-1/0&&(t=0),this._autoWidth){let i=this._centerGroup.width;this._cellWidth=e+t+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-e-t;this.updateCenterLayout(i);let l=this._centerGroup.width;this._cellWidth=e+t+l,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,l=this._rightGroup.height,o=this._centerGroup.height;this._cellHeight=Math.max(i,l,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(e){let t=e;this._centerGroup.forEachChildren(e=>{(e instanceof a.J||e instanceof a.V)&&(t-=e.AABBBounds.width())});let i=this._centerGroup.getChildByName("text");i instanceof o.H?i.setAttribute("width",t):i instanceof l.x&&i.setAttribute("maxLineWidth",t);let r=0;this._centerGroup.forEachChildren(e=>{e.setAttribute("x",r),r+=e.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(e=>{e.setAttribute("y",(this._leftGroup.height-e.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(e=>{e.setAttribute("y",(this._rightGroup.height-e.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(e=>{e.setAttribute("y",this._leftGroup.height-e.AABBBounds.height())}),this._rightGroup.forEachChildren(e=>{e.setAttribute("y",this._rightGroup.height-e.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(e){this._cellWidth=e,this._originCellWidth=e,this.layout()}updateHeight(e){this._cellHeight=e,this._cellWidth=this._originCellWidth;let t=this.getChildByName("text",!0);t&&t.setAttribute("heightLimit",e),this.layout()}}var h=i(13224),d=i(81668),u=i(58977),c=i(18585),g=i(91212),p=i(33657),f=i(33291),b=i(31604),m=i(63388);function C(e,t,i,r,n,a,h,g,p,m,C,y,x,R,H){var A,M,F,B,T,z,L,k,P;let I,E=0,D=0,W=0;if(Array.isArray(t)&&0!==t.length){let c,{inlineFrontIcons:b,inlineEndIcons:A,contentLeftIcons:M,contentRightIcons:F,leftIconWidth:O,rightIconWidth:G,absoluteRightIconWidth:N}=_(t,e,H,x);if(E=O,D=G,W=N,0===b.length&&0===A.length){let t=0;(0,u.Z)(x.theme._contentOffset)&&("left"===C?t=x.theme._contentOffset:"right"===C&&(t=-x.theme._contentOffset));let o=H?(0,d.L)(H.start.col,H.start.row,x):(0,d.L)(e.col,e.row,x),{text:s,moreThanMaxCharacters:b}=(0,f.$)(i,x),v={text:1===s.length?s[0]:s,moreThanMaxCharacters:b,maxLineWidth:n?1/0:p-(r[1]+r[3])-E-D-o,textBaseline:"top",heightLimit:!1!==(null==(B=x.options.customConfig)?void 0:B.limitContentHeight)&&(!a||(null==(T=x.options.customConfig)?void 0:T.multilinesForXTable))?m-Math.floor(r[0]+r[2]):-1,pickable:!1,autoWrapText:h,lineClamp:g,wordBreak:"break-word",whiteSpace:!1===(null==(z=x.options.customConfig)?void 0:z.limitContentHeight)||1!==s.length||h?"normal":"no-wrap",dx:("left"===C?M.length?0:o:0)+t,keepCenterInLine:!0},w=new l.x(R.text?Object.assign({},R.text,v):v);w.name="text",c=w}else{let t=Object.assign({text:null==i?void 0:i.toString()},(null==(P=null==(k=null==(L=e.parent)?void 0:L.theme)?void 0:k.userTheme)?void 0:P.text)||{});R.text&&Object.assign(t,R.text),t.textBaseline="middle";let l=[...b.map(e=>w(e)),t,...A.map(e=>w(e))];l[0].textAlign=C;let s=new o.H({width:n?0:p-(r[1]+r[3])-E-D,height:a&&h?0:Math.ceil(m-(r[0]+r[2])),textConfig:l,verticalDirection:a&&h?"top":y,ellipsis:t.ellipsis});s.name="text",c=s,s.bindIconEvent(),H&&(H.start.col!==H.end.col||H.start.row!==H.end.row)&&(s.onBeforeAttributeUpdate=S)}if(0!==M.length||0!==F.length){let t=new s({x:0,y:0,fill:!1,stroke:!1,pickable:!1});t.name="content",t.setCellContentOption({autoWidth:n,autoHeight:a,cellWidth:p-(r[1]+r[3])-E-D,cellHeight:m-(r[0]+r[2]),align:C,baseline:y});let i={addedHierarchyOffset:0};M.forEach(l=>{let o=v(l,void 0,e.col,e.row,H,x,i);o.role="icon-content-left",o.name=l.name,t.addLeftOccupyingIcon(o)}),F.forEach(l=>{let o=v(l,void 0,e.col,e.row,H,x,i);o.role="icon-content-right",o.name=l.name,t.addRightOccupyingIcon(o)}),t.addContent(c),e.appendChild(t),t.layout(),I=t.AABBBounds.width(),t.AABBBounds.height()}else e.firstChild?e.insertBefore(c,e.firstChild):e.appendChild(c),I=c.AABBBounds.width(),c.AABBBounds.height()}else if((0,c.Z)(i)){let{text:t,moreThanMaxCharacters:o}=(0,f.$)(i,x),s=H?(0,d.L)(H.start.col,H.start.row,x):(0,d.L)(e.col,e.row,x),c=0;(0,u.Z)(x.theme._contentOffset)&&("left"===C?c=x.theme._contentOffset:"right"===C&&(c=-x.theme._contentOffset));let b={text:1===t.length?t[0]:t,moreThanMaxCharacters:o,maxLineWidth:n?1/0:p-(r[1]+r[3]+s),textBaseline:"top",autoWrapText:h,lineClamp:g,wordBreak:"break-word",heightLimit:!1!==(null==(A=x.options.customConfig)?void 0:A.limitContentHeight)&&(!a||(null==(M=x.options.customConfig)?void 0:M.multilinesForXTable))?m-Math.floor(r[0]+r[2]):-1,pickable:!1,dx:("left"===C?s:0)+c,whiteSpace:!1===(null==(F=x.options.customConfig)?void 0:F.limitContentHeight)||1!==t.length||h?"normal":"no-wrap",keepCenterInLine:!0},v=new l.x(R.text?Object.assign({},R.text,b):b);v.name="text",v.textBaseline=y,e.appendChild(v),I=v.AABBBounds.width(),v.AABBBounds.height()}let O=n?E+I+D:p-(r[1]+r[3]),G=m-(r[0]+r[2]);e.forEachChildren(e=>{"icon-left"===e.role?e.setAttribute("x",e.attribute.x+r[3]):"icon-right"===e.role?e.setAttribute("x",e.attribute.x+O-D+r[3]):"icon-absolute-right"===e.role?e.setAttribute("x",e.attribute.x+O-W+r[3]+r[1]):"content"!==e.name&&"text"!==e.name||("center"===C&&"richtext"!==e.type?e.setAttribute("x",r[3]+E+(O-E-D)/2):"right"===C&&"richtext"!==e.type?e.setAttribute("x",r[3]+O-D):e.setAttribute("x",r[3]+E))}),e.forEachChildren(e=>{e.name!==b.FH&&("middle"===y?e.setAttribute("y",r[0]+(G-e.AABBBounds.height())/2):"bottom"===y?e.setAttribute("y",r[0]+G-e.AABBBounds.height()):e.setAttribute("y",r[0]))}),e.setAttributes({width:O+r[1]+r[3],height:G+r[0]+r[2]})}function v(e,t,i,l,o,n,s){var h,c,p,f,b,m;let C={};"image"===e.type?(e.isGif&&(C.gif=e.src),C.image=e.src):("svg"===e.type||"svg"in e)&&(C.image=e.svg),C.width=e.width,C.height=e.height,C.visibleTime=null!=(h=e.visibleTime)?h:"always",C.funcType=e.funcType,C.interactive=e.interactive,C.isGif=e.isGif;let v,w=0;return(!s||0===(null==s?void 0:s.addedHierarchyOffset))&&(0,u.Z)(i)&&(0,u.Z)(l)&&n&&(e.funcType===r.cI.collapse||e.funcType===r.cI.expand||e.positionType===r.q0.contentLeft||e.positionType===r.q0.contentRight)&&(w=o?(0,d.L)(o.start.col,o.start.row,n):(0,d.L)(i,l,n),s&&(s.addedHierarchyOffset=1)),C.marginLeft=(null!=(c=e.marginLeft)?c:0)+w,C.marginRight=null!=(p=e.marginRight)?p:0,!1===e.interactive&&(C.pickable=!1),e.hover&&(C.backgroundWidth=null!=(f=e.hover.width)?f:e.width,C.backgroundHeight=null!=(b=e.hover.width)?b:e.width,C.backgroundColor=null!=(m=e.hover.bgColor)?m:"rgba(22,44,66,0.2)",C.hoverImage=e.hover.image),e.cursor&&(C.cursor=e.cursor),"shape"in e&&"circle"===e.shape&&(C.shape=e.shape),t?(t.setAttributes(C),t.loadImage(C.image),t.tooltip=e.tooltip,t.name=e.name,t):("text"===e.type?(C.text=e.content,(0,g.Z)(C,e.style),(v=new a.V(C)).tooltip=e.tooltip):(v=new a.J(C)).tooltip=e.tooltip,v.name=e.name,v)}function w(e){var t,i,l,o,r,n;let a={};return"image"===e.type?a.image=e.src:("svg"===e.type||"svg"in e)&&(a.image=e.svg),a.visibleTime=null!=(t=e.visibleTime)?t:"always",a.funcType=e.funcType,a.id=e.name,a.width=e.width,a.height=e.height,(e.marginRight||e.marginLeft)&&(a.margin=[0,null!=(i=e.marginRight)?i:0,0,null!=(l=e.marginLeft)?l:0]),e.hover&&(a.backgroundWidth=null!=(o=e.hover.width)?o:e.width,a.backgroundHeight=null!=(r=e.hover.height)?r:e.height,a.backgroundShowMode="hover",a.hoverImage=e.hover.image,a.backgroundStroke=!1,a.backgroundFill=null!=(n=e.hover.bgColor)?n:"rgba(22,44,66,0.2)"),e.cursor&&(a.cursor=e.cursor),a.tooltip=e.tooltip,a}function y(e,t,i,r,n,a,s,d,u){var c,g,f,m;let C;(0,p.Z)(e.contentWidth)&&(r=t-(null!=(c=e.contentWidth)?c:e.attribute.width));let v,w=0,y=0,x=0,_=0;e.forEachChildren(e=>{var t,i,l,o;"icon-left"===e.role?(w+=e.AABBBounds.width()+(null!=(t=e.attribute.marginLeft)?t:0)+(null!=(i=e.attribute.marginRight)?i:0),y=Math.max(y,e.AABBBounds.height())):"icon-right"===e.role&&(x+=e.AABBBounds.width()+(null!=(l=e.attribute.marginLeft)?l:0)+(null!=(o=e.attribute.marginRight)?o:0),_=Math.max(_,e.AABBBounds.height()))});let S=e.getChildByName("text"),R=e.getChildByName("content");S instanceof l.x?(v=S.AABBBounds.height(),S.setAttribute("maxLineWidth",t-w-x-(a[1]+a[3])-(null!=(g=S.attribute.dx)?g:0)-(null!=(f=u.table.theme._contentOffset)?f:0)),C=S.AABBBounds.height()):S instanceof o.H?(v=S.AABBBounds.height(),S.setAttribute("width",t-w-x-(a[1]+a[3])),C=S.AABBBounds.height()):R&&(v=R.AABBBounds.height(),R.updateWidth(t-w-x-(a[1]+a[3])),C=R.AABBBounds.height());let H=Math.round(Math.max(y,_,v)+a[0]+a[2]);if(e.forEachChildren(i=>{var l;if("icon-left"===i.role);else if("icon-right"===i.role)i.setAttribute("x",i.attribute.x+r);else if("icon-absolute-right"===i.role)i.setAttribute("x",i.attribute.x+r);else if("content"===i.name||"text"===i.name&&"richtext"!==i.type){let e=null!=(l=i.attribute.textAlign)?l:s;"center"===e?i.setAttribute("x",a[3]+w+(t-(a[1]+a[3])-w-x)/2):"right"===e&&i.setAttribute("x",a[3]+t-(a[1]+a[3])-x)}else"mark"===i.name&&i.setAttribute("x",e.attribute.width)}),n){let t=Math.max(y,C,_);if(function(e,t,i,l){let o=e.table,r=(0,h.Z)(o,t.col,t.row);if(r&&r.end.row-r.start.row){l/=r.end.row-r.start.row+1,i/=r.end.row-r.start.row+1;for(let e=r.start.row;e<=r.end.row;e++){let t=o.getRowHeight(e);if(t===l&&i!==t||i>t)return!0}}else{let e=o.getRowHeight(t.row);if(e===l&&i!==e||i>e)return!0}return!1}(u,e,Math.round(t+a[0]+a[2]),H))return!0;t=(null!=(m=e.contentHeight)?m:i)-(a[0]+a[2]),e.forEachChildren(e=>{"rect"!==e.type&&"chart"!==e.type&&e.name!==b.FH&&("mark"===e.name?e.setAttribute("y",0):"middle"===d?e.setAttribute("y",a[0]+(t-e.AABBBounds.height())/2):"bottom"===d?e.setAttribute("y",a[0]+t-e.AABBBounds.height()):e.setAttribute("y",a[0]))})}else"middle"!==d&&"bottom"!==d||e.forEachChildren(e=>{"rect"!==e.type&&"chart"!==e.type&&e.name!==b.FH&&("mark"===e.name?e.setAttribute("y",0):"middle"===d?e.setAttribute("y",(i-a[2]+a[0]-e.AABBBounds.height())/2):"bottom"===d?e.setAttribute("y",i-e.AABBBounds.height()-a[2]):e.setAttribute("y",a[0]))});return!1}function x(e,t,i,r,n,a,s,h){var d;let u=t-Math.floor(n[0]+n[2]),c=e.getChildByName("text");c instanceof l.x&&!r?c.setAttributes({heightLimit:!1===(null==(d=h.options.customConfig)?void 0:d.limitContentHeight)?-1:u}):c instanceof o.H&&!r?c.setAttributes({height:u}):e.getChildByName("content")&&e.getChildByName("content").updateHeight(u),e.forEachChildren(e=>{e.setAttribute("dy",0),"rect"===e.type||"chart"===e.type||e.name===b.FH||("mark"===e.name?e.setAttribute("y",0):"middle"===s?e.setAttribute("y",n[0]+(u-e.AABBBounds.height())/2):"bottom"===s?e.setAttribute("y",n[0]+u-e.AABBBounds.height()):e.setAttribute("y",n[0]))})}function _(e,t,i,l){let o=[],n=[],a=[],s=[],h=[],d=[],u=[],c=[],g=0,p=0,f=0,b=0,m=0,C=0;return e.forEach(e=>{switch(e.positionType){case r.q0.left:o.push(e);break;case r.q0.right:n.push(e);break;case r.q0.contentLeft:a.push(e);break;case r.q0.contentRight:s.push(e);break;case r.q0.absoluteRight:c.push(e);break;case r.q0.inlineFront:h.push(e);break;case r.q0.inlineEnd:d.push(e)}}),o.forEach(e=>{var o,r,n;let a=v(e,void 0,t.col,t.row,i,l);a.role="icon-left",a.name=e.name,a.setAttribute("x",g+(null!=(o=a.attribute.marginLeft)?o:0)),g+=a.AABBBounds.width()+(null!=(r=a.attribute.marginLeft)?r:0)+(null!=(n=a.attribute.marginRight)?n:0),p=Math.max(p,a.AABBBounds.height()),t.appendChild(a)}),n.forEach(e=>{var o,r,n;let a=v(e,void 0,t.col,t.row,i,l);a.role="icon-right",a.name=e.name,a.setAttribute("x",f+(null!=(o=a.attribute.marginLeft)?o:0)),f+=a.AABBBounds.width()+(null!=(r=a.attribute.marginLeft)?r:0)+(null!=(n=a.attribute.marginRight)?n:0),b=Math.max(b,a.AABBBounds.height()),t.appendChild(a)}),u.forEach(e=>{var o,r,n;let a=v(e,void 0,t.col,t.row,i,l);a.role="icon-absolute-left",a.name=e.name,a.setAttribute("x",m+(null!=(o=a.attribute.marginLeft)?o:0)),m+=a.AABBBounds.width()+(null!=(r=a.attribute.marginLeft)?r:0)+(null!=(n=a.attribute.marginRight)?n:0),t.appendChild(a)}),c.forEach(e=>{var o,r,n;let a=v(e,void 0,t.col,t.row,i,l);a.role="icon-absolute-right",a.name=e.name,a.setAttribute("x",C+(null!=(o=a.attribute.marginLeft)?o:0)),C+=a.AABBBounds.width()+(null!=(r=a.attribute.marginLeft)?r:0)+(null!=(n=a.attribute.marginRight)?n:0),t.appendChild(a)}),{leftIcons:o,rightIcons:n,contentLeftIcons:a,contentRightIcons:s,inlineFrontIcons:h,inlineEndIcons:d,absoluteLeftIcons:u,absoluteRightIcons:c,leftIconWidth:g,leftIconHeight:p,rightIconWidth:f,rightIconHeight:b,absoluteLeftIconWidth:m,absoluteRightIconWidth:C}}function S(e,t){if(e.hasOwnProperty("hoverIconId")){if(this.skipMergeUpdate)return;let t=(0,m.J$)(this);if(!t||!t.stage)return;let i=t.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:l,mergeEndCol:o,mergeStartRow:r,mergeEndRow:n}=t;if((0,c.Z)(l)&&(0,c.Z)(o)&&(0,c.Z)(r)&&(0,c.Z)(n)&&(l!==o||r!==n)){for(let a=l;a<=o;a++)for(let l=r;l<=n;l++){if(a===t.col&&l===t.row){if(e.hoverIconId!==this.attribute.hoverIconId){let t=this._frameCache.icons.get(e.hoverIconId);this.updateHoverIconState(t)}continue}let o=i.scenegraph.highPerformanceGetCell(a,l);if("cell"===o.role){let t=o.getChildByName(this.name,!0);if(!t||t.skipAttributeUpdate)continue;e.hoverIconId!==t.attribute.hoverIconId&&(t.setAttribute("hoverIconId",e.hoverIconId),o.addUpdateBoundTag())}}this.skipAttributeUpdate=void 0}}}},85021:function(e,t,i){"use strict";i.d(t,{QC:()=>_,ZP:()=>v,Rc:()=>A,sb:()=>R,fg:()=>S});var l=i(14364),o=i(24053),r=i(59484),n=i(82794),a=i(93279),s=i(29411),h=i(18585),d=i(29753),u=i(58853),c=i(43735);let g=e=>{let t=e.charCodeAt(0),i=2===e.length?e.charCodeAt(1):0,l=t;return 55296<=t&&t<=56319&&56320<=i&&i<=57343&&(t&=1023,i&=1023,l=(t<<10|i)+65536),12288===l||65281<=l&&l<=65376||65504<=l&&l<=65510?"F":8361===l||65377<=l&&l<=65470||65474<=l&&l<=65479||65482<=l&&l<=65487||65490<=l&&l<=65495||65498<=l&&l<=65500||65512<=l&&l<=65518?"H":4352<=l&&l<=4447||4515<=l&&l<=4519||4602<=l&&l<=4607||9001<=l&&l<=9002||11904<=l&&l<=11929||11931<=l&&l<=12019||12032<=l&&l<=12245||12272<=l&&l<=12283||12289<=l&&l<=12350||12353<=l&&l<=12438||12441<=l&&l<=12543||12549<=l&&l<=12589||12593<=l&&l<=12686||12688<=l&&l<=12730||12736<=l&&l<=12771||12784<=l&&l<=12830||12832<=l&&l<=12871||12880<=l&&l<=13054||13056<=l&&l<=19903||19968<=l&&l<=42124||42128<=l&&l<=42182||43360<=l&&l<=43388||44032<=l&&l<=55203||55216<=l&&l<=55238||55243<=l&&l<=55291||63744<=l&&l<=64255||65040<=l&&l<=65049||65072<=l&&l<=65106||65108<=l&&l<=65126||65128<=l&&l<=65131||110592<=l&&l<=110593||127488<=l&&l<=127490||127504<=l&&l<=127546||127552<=l&&l<=127560||127568<=l&&l<=127569||131072<=l&&l<=194367||177984<=l&&l<=196605||196608<=l&&l<=262141?"W":32<=l&&l<=126||162<=l&&l<=163||165<=l&&l<=166||172===l||175===l||10214<=l&&l<=10221||10629<=l&&l<=10630?"Na":161===l||164===l||167<=l&&l<=168||170===l||173<=l&&l<=174||176<=l&&l<=180||182<=l&&l<=186||188<=l&&l<=191||198===l||208===l||215<=l&&l<=216||222<=l&&l<=225||230===l||232<=l&&l<=234||236<=l&&l<=237||240===l||242<=l&&l<=243||247<=l&&l<=250||252===l||254===l||257===l||273===l||275===l||283===l||294<=l&&l<=295||299===l||305<=l&&l<=307||312===l||319<=l&&l<=322||324===l||328<=l&&l<=331||333===l||338<=l&&l<=339||358<=l&&l<=359||363===l||462===l||464===l||466===l||468===l||470===l||472===l||474===l||476===l||593===l||609===l||708===l||711===l||713<=l&&l<=715||717===l||720===l||728<=l&&l<=731||733===l||735===l||768<=l&&l<=879||913<=l&&l<=929||931<=l&&l<=937||945<=l&&l<=961||963<=l&&l<=969||1025===l||1040<=l&&l<=1103||1105===l||8208===l||8211<=l&&l<=8214||8216<=l&&l<=8217||8220<=l&&l<=8221||8224<=l&&l<=8226||8228<=l&&l<=8231||8240===l||8242<=l&&l<=8243||8245===l||8251===l||8254===l||8308===l||8319===l||8321<=l&&l<=8324||8364===l||8451===l||8453===l||8457===l||8467===l||8470===l||8481<=l&&l<=8482||8486===l||8491===l||8531<=l&&l<=8532||8539<=l&&l<=8542||8544<=l&&l<=8555||8560<=l&&l<=8569||8585===l||8592<=l&&l<=8601||8632<=l&&l<=8633||8658===l||8660===l||8679===l||8704===l||8706<=l&&l<=8707||8711<=l&&l<=8712||8715===l||8719===l||8721===l||8725===l||8730===l||8733<=l&&l<=8736||8739===l||8741===l||8743<=l&&l<=8748||8750===l||8756<=l&&l<=8759||8764<=l&&l<=8765||8776===l||8780===l||8786===l||8800<=l&&l<=8801||8804<=l&&l<=8807||8810<=l&&l<=8811||8814<=l&&l<=8815||8834<=l&&l<=8835||8838<=l&&l<=8839||8853===l||8857===l||8869===l||8895===l||8978===l||9312<=l&&l<=9449||9451<=l&&l<=9547||9552<=l&&l<=9587||9600<=l&&l<=9615||9618<=l&&l<=9621||9632<=l&&l<=9633||9635<=l&&l<=9641||9650<=l&&l<=9651||9654<=l&&l<=9655||9660<=l&&l<=9661||9664<=l&&l<=9665||9670<=l&&l<=9672||9675===l||9678<=l&&l<=9681||9698<=l&&l<=9701||9711===l||9733<=l&&l<=9734||9737===l||9742<=l&&l<=9743||9748<=l&&l<=9749||9756===l||9758===l||9792===l||9794===l||9824<=l&&l<=9825||9827<=l&&l<=9829||9831<=l&&l<=9834||9836<=l&&l<=9837||9839===l||9886<=l&&l<=9887||9918<=l&&l<=9919||9924<=l&&l<=9933||9935<=l&&l<=9953||9955===l||9960<=l&&l<=9983||10045===l||10071===l||10102<=l&&l<=10111||11093<=l&&l<=11097||12872<=l&&l<=12879||57344<=l&&l<=63743||65024<=l&&l<=65039||65533===l||127232<=l&&l<=127242||127248<=l&&l<=127277||127280<=l&&l<=127337||127344<=l&&l<=127386||917760<=l&&l<=917999||983040<=l&&l<=1048573||1048576<=l&&l<=1114109?"A":"N"};class p{constructor(e,t){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=e,this._userSpec=null!=t?t:{},this.textSpec=this._initSpec(),(0,h.Z)(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=(0,h.Z)(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if((0,d.Z)(this._canvas)&&((0,h.Z)(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),(0,d.Z)(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&(0,h.Z)(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),(0,d.Z)(this._context)&&(0,h.Z)(this._canvas)){let e=this._canvas.getContext("2d");(0,h.Z)(e)&&(e.save(),e.font=function(e,t={},i){i||(i=1);let{fontStyle:l=t.fontStyle,fontVariant:o=t.fontVariant,fontWeight:r=t.fontWeight,fontSize:n=t.fontSize,fontFamily:a=t.fontFamily}=e;return(l?l+" ":"")+(o?o+" ":"")+(r?r+" ":"")+n*i+"px "+(a||"sans-serif")}(this.textSpec),this._contextSaved=!0,this._context=e)}return!(0,d.Z)(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var e,t,i;let{defaultFontParams:l={}}=this._option,{fontStyle:o=l.fontStyle,fontVariant:r=l.fontVariant,fontWeight:n=null!=(e=l.fontWeight)?e:"normal",fontSize:a=null!=(t=l.fontSize)?t:12,fontFamily:s=null!=(i=l.fontFamily)?i:"sans-serif",align:h,textAlign:d=null!=h?h:"center",baseline:c,textBaseline:g=null!=c?c:"middle",ellipsis:p,limit:f}=this._userSpec,{lineHeight:b=a}=this._userSpec;return(0,u.Z)(b)&&"%"===b[b.length-1]&&(b=a*(Number.parseFloat(b.substring(0,b.length-1))/100)),{fontStyle:o,fontVariant:r,fontFamily:s,fontSize:a,fontWeight:n,textAlign:d,textBaseline:g,ellipsis:p,limit:f,lineHeight:b}}measure(e,t){switch(t){case"vrender":case"canopus":return this.fullMeasure(e);case"canvas":return this.measureWithNaiveCanvas(e);case"simple":return this.quickMeasureWithoutCanvas(e);default:return this.quickMeasure(e)}}fullMeasure(e){let t;if((0,d.Z)(e))return{width:0,height:0};if((0,d.Z)(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(e);let{fontFamily:i,fontSize:l,fontWeight:o,textAlign:r,textBaseline:n,ellipsis:a,limit:s,lineHeight:h}=this.textSpec;try{let d=this._option.getTextBounds({text:e,fontFamily:i,fontSize:l,fontWeight:o,textAlign:r,textBaseline:n,ellipsis:!!a,maxLineWidth:s||1/0,lineHeight:h});t={width:d.width(),height:d.height()}}catch(i){this._notSupportVRender=!0,t=this.measureWithNaiveCanvas(e)}return t}measureWithNaiveCanvas(e){return this._measureReduce(e,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(e){if(!this.initContext())return this._quickMeasureWithoutCanvas(e);let t=this._context.measureText(e),{fontSize:i,lineHeight:l}=this.textSpec;return{width:t.width,height:null!=l?l:i,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}quickMeasure(e){return this._measureReduce(e,this._quickMeasure.bind(this))}_quickMeasure(e){let t={width:0,height:0};for(let i=0;i<e.length;i++){let l=e[i],o=this._measureSpecialChar(l);(0,d.Z)(o)&&p.NUMBERS_CHAR_SET.includes(l)&&(o=this._measureNumberChar()),(0,d.Z)(o)&&["F","W"].includes(g(l))&&(o=this._measureFullSizeChar()),(0,d.Z)(o)&&(o=this._measureLetterChar()),t.width+=o.width,t.height=Math.max(t.height,o.height),(0,d.Z)(o.fontBoundingBoxAscent)||(t.fontBoundingBoxAscent=o.fontBoundingBoxAscent),(0,d.Z)(o.fontBoundingBoxDescent)||(t.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return t}quickMeasureWithoutCanvas(e){return this._measureReduce(e,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(e){let t={width:0,height:0},{fontSize:i,lineHeight:l}=this.textSpec;for(let l=0;l<e.length;l++){let o=["F","W"].includes(g(e[l]))?1:.53;t.width+=o*i}return t.height=null!=l?l:i,t}_measureReduce(e,t){let{fontSize:i,lineHeight:l}=this.textSpec,o={width:0,height:0};if((0,d.Z)(e))return o;if((0,c.Z)(e)){let r=e.filter(h.Z).map(e=>e.toString());return 0===r.length?o:1===r.length?t(r[0]):{width:r.reduce((e,i)=>Math.max(e,t(i).width),0),height:r.length*((null!=l?l:i)+1)+1}}return t(e.toString())}_measureNumberChar(){if((0,d.Z)(this._numberCharSize)){let e=this._standardMethod(p.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/p.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return(0,d.Z)(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(p.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if((0,d.Z)(this._letterCharSize)){let e=this._standardMethod(p.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/p.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(e){return(0,h.Z)(this._specialCharSizeMap[e])?this._specialCharSizeMap[e]:this.specialCharSet.includes(e)?(this._specialCharSizeMap[e]=this._standardMethod(e),this._specialCharSizeMap[e]):null}release(){(0,h.Z)(this._canvas)&&(this._canvas=null),(0,h.Z)(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}p.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",p.NUMBERS_CHAR_SET="0123456789",p.FULL_SIZE_CHAR="字";let f="",b="quick",m=new l.n((e,t,i,l)=>{i(o.j)?l(o.j).to(x).inSingletonScope():e(o.j).to(x).inSingletonScope()}),C=new l.n((e,t,i,l)=>{i(o.j)?l(o.j).to(o.f).inSingletonScope():e(o.j).to(o.f).inSingletonScope()}),v=m,w=new Map;function y(e,t,i,l="normal"){var o,a,s;let h=`${e}-${t}-${i}-${l}`,d=w.get(h);if(d)return d;let u=(o={fontSize:e,fontFamily:i,fontWeight:t,fontStyle:l},new p(Object.assign({defaultFontParams:{fontFamily:r.q9.fontFamily,fontSize:r.q9.fontSize},getTextBounds:s?void 0:n.o,specialCharSet:`{}()//&-/: .,@%'"~…=——${p.ALPHABET_CHAR_SET}${p.ALPHABET_CHAR_SET.toUpperCase()}0123456789${f}`},null!=a?a:{}),o));return w.set(h,u),u}class x extends o.f{_fastMeasure(e,t){let{fontSize:i,fontFamily:l="Arial,sans-serif",fontWeight:o="normal",fontStyle:r="normal"}=t,n=y(i,o,l,r).measure(e,b);if(!(0,h.Z)(n.fontBoundingBoxAscent)&&!(0,h.Z)(n.fontBoundingBoxDescent)){let{ascent:e,descent:i}=this.measureTextBoundADscentEstimate(t);n.fontBoundingBoxAscent=e,n.fontBoundingBoxDescent=i}return n}measureTextWidth(e,t){return this._fastMeasure(e,t).width}measureText(e,t){return this._fastMeasure(e,t)}_measureTextWithoutAlignBaseline(e,t,i){return this._fastMeasure(e,t)}_measureTextWithAlignBaseline(e,t,i){return this._fastMeasure(e,t)}}let _=new class{measureText(e,t){let{fontSize:i,fontFamily:l="Arial,sans-serif",fontWeight:o="normal",fontStyle:r="normal"}=t;return y(i,o,l,r).measure(e,b)}measureTextWidth(e,t){let{fontSize:i,fontFamily:l="Arial,sans-serif",fontWeight:o="normal",fontStyle:r="normal"}=t;return y(i,o,l,r).measure(e,b).width}clipText(e,t,i){if(0===e.length)return{str:"",width:0};let l=this.measureTextWidth(e,t);return l<=i?{str:e,width:l}:(l=this.measureTextWidth(e[0],t))>i?{str:"",width:0}:this._clipText(e,t,i,0,e.length-1)}_clipText(e,t,i,l,o){let r,n=Math.floor((l+o)/2),a=e.substring(0,n+1),s=this.measureTextWidth(a,t);if(s>i){if(a.length<=1)return{str:"",width:0};let o=e.substring(0,n);return(r=this.measureTextWidth(o,t))<=i?{str:o,width:r}:this._clipText(e,t,i,l,n)}if(s<i){if(n>=e.length-1)return{str:e,width:this.measureTextWidth(e,t)};let l=e.substring(0,n+2);return(r=this.measureTextWidth(l,t))>=i?{str:a,width:s}:this._clipText(e,t,i,n,o)}return{str:a,width:s}}clipTextWithSuffix(e,t,i,l){if(""===l)return this.clipText(e,t,i);if(0===e.length)return{str:"",width:0};let o=this.measureTextWidth(e,t);if(o<=i)return{str:e,width:o};let r=this.measureTextWidth(l,t);if(r>i)return{str:"",width:0};i-=r;let n=this._clipText(e,t,i,0,e.length-1);return n.str+=l,n.width+=r,n}};function S(e){f=e,w.clear()}function R(){b="canvas",a.n.load(C)}let H=new s.x({ignoreBuf:!0});function A(e){return H.initAttributes(Object.assign(Object.assign({},e),{ignoreBuf:!0})),H.AABBBounds}},65962:function(e,t,i){"use strict";i.d(t,{Bd:()=>f,GW:()=>c,Jd:()=>b,Pi:()=>p,Vz:()=>u,Y:()=>h,aC:()=>v,gs:()=>g,hR:()=>C,r5:()=>m});var l=i(18585),o=i(70506),r=i(47e3),n=i(58977),a=i(43735),s=i(77597);function h(e,t,i,l,o){let r=o.table.getCellRange(e,t);if(r.start.col!==r.end.col||r.start.row!==r.end.row)for(let e=r.start.col;e<=r.end.col;e++)for(let t=r.start.row;t<=r.end.row;t++)d(e,t,i,l,o);else d(e,t,i,l,o)}function d(e,t,i,l,o){let r=o.table.getRecordShowIndexByCell(e,t);if(r>=0){let e=o.table.dataSource.getIndexKey(r).toString();o.checkedState.get(e)?o.checkedState.get(e)[i]=l:o.checkedState.set(e,{[i]:l})}}function u(e,t,i){var l;i.headerCheckedState[e]=t,i.table.internalProps.enableCheckboxCascade&&(null==(l=i.checkedState)||l.forEach(i=>{i[e]=t}))}function c(e,t,i,o,r){var n,a;if(r.table.isHeader(e,t)){if((0,l.Z)(r.headerCheckedState[i]))return r.headerCheckedState[i];if("function"==typeof o)return;if((0,l.Z)(o))r.headerCheckedState[i]=o;else if((null==(n=r.checkedState)?void 0:n.size)>0)return r.updateHeaderCheckedState(i,e,t);return r.headerCheckedState[i]}let s=r.table.getRecordShowIndexByCell(e,t);if(s>=0){let e=r.table.dataSource.getIndexKey(s).toString();if((0,l.Z)(null==(a=r.checkedState.get(e))?void 0:a[i]))return r.checkedState.get(e)[i];if(r.checkedState.get(e))r.checkedState.get(e)[i]=o;else if(r.table.internalProps.enableCheckboxCascade&&e.includes(",")){let t=e.split(",").slice(0,-1).join(",");r.checkedState.has(t)&&!0===r.checkedState.get(t)[i]?r.checkedState.set(e,{[i]:!0}):r.checkedState.set(e,{[i]:o})}else r.checkedState.set(e,{[i]:o})}return o}function g(e,t){t.checkedState.clear(),t.headerCheckedState={},t.radioState={};let i=!1;if(t._checkboxCellTypeFields=[],t._headerCheckFuncs={},t.table.internalProps.layoutMap.headerObjects.forEach((e,l)=>{if("checkbox"===e.headerType){let l=e.define.checked;null==l||"function"==typeof l?(i=!0,"function"==typeof l&&(t._headerCheckFuncs[e.field]=l)):t.headerCheckedState[e.field]=l,"checkbox"!==e.define.cellType&&!(0,o.Z)(e.define.cellType)||e.fieldFormat||t._checkboxCellTypeFields.push(e.field)}}),1===t.table.leftRowSeriesNumberCount)t.headerCheckedState._vtable_rowSeries_number=!1,t._checkboxCellTypeFields.push("_vtable_rowSeries_number"),i=!0;else if(t.table.leftRowSeriesNumberCount>1){for(let e=0;e<t.table.leftRowSeriesNumberCount;e++)t.headerCheckedState[`_vtable_rowSeries_number_${e}`]=!1,t._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${e}`);i=!0}i&&function(e,t){let i=t.table,l=i.isPivotTable()?0:i.internalProps.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,o=i.isPivotTable()?(0,a.Z)(e)?e.length:0:i.internalProps.transpose?i.colCount:i.rowCount;for(let n=0;n+l<o;n++){let l=i.isPivotTable()?e[n]:i.dataSource.get(n);t._checkboxCellTypeFields.forEach(e=>{let o,a=l&&l[e];if((0,r.Z)(a)?o=a.checked:"boolean"==typeof a&&(o=a),null==o){let i=t._headerCheckFuncs[e];if(i){let l=t.table.getCellAddrByFieldRecord(e,n);o=(0,s.vi)(i,{col:l.col,row:l.row,table:t.table,context:null,value:a})}}let h=i.isPivotTable()?n.toString():t.table.dataSource.getIndexKey(n).toString();t.checkedState.get(h)||t.checkedState.set(h,{}),t.checkedState.get(h)[e]=o})}}(e,t)}function p(e,t,i,l){let o=!0,r=!0,n=!1;return t.checkedState.forEach((a,s)=>{var h;s=s.includes(",")?s.split(",").map(e=>Number(e)):Number(s);let d=t.table.getTableIndexByRecordIndex(s),u=t.table.transpose?t.table.getCustomMerge(d,l):t.table.getCustomMerge(i,d),c=null==(h=t.table.dataSource)?void 0:h.get(s);u||!t.table.internalProps.enableCheckboxCascade&&(null==c?void 0:c.vtableMerge)||(!0!==(null==a?void 0:a[e])?o=!1:(r=!1,n=!0))}),o?(t.headerCheckedState[e]=!0,o):r?(t.headerCheckedState[e]=!1,!1):!!n&&(t.headerCheckedState[e]="indeterminate","indeterminate")}function f(e,t){for(let i=t.checkedState.size;i<e.length;i++){let l=e[i];t._checkboxCellTypeFields.forEach(e=>{let o,n=l[e];(0,r.Z)(n)?o=n.checked:"boolean"==typeof n&&(o=n);let a=i.toString();t.checkedState.get(a)||t.checkedState.set(a,{}),t.checkedState.get(a)[e]=o})}}function b(e,t,i,l){let o=l.scenegraph.getCell(e,t),r=null==o?void 0:o.getChildByName("checkbox");if(!r){let o=l.getHeaderField(e,t);if(l.isHeader(e,t))l.stateManager.setHeaderCheckedState(o,i),"checkbox"===l.getCellType(e,t)&&l.scenegraph.updateCheckboxCellState(e,t,i);else if(l.stateManager.setCheckedState(e,t,o,i),"checkbox"===l.getCellType(e,t)){let i=l.stateManager.headerCheckedState[o],r=l.stateManager.updateHeaderCheckedState(o,e,t);i!==r&&l.scenegraph.updateHeaderCheckboxCellState(e,t,r)}return}let{checked:n,indeterminate:a}=r.attribute;a?(i||r._handlePointerUp(),r._handlePointerUp()):n?i||r._handlePointerUp():i&&r._handlePointerUp()}function m(e,t,i,l){var o,r;let n=l.scenegraph.getCell(e,t),a=(null==n?void 0:n.getChildByName("checkbox"))||(null==(r=null==(o=null==n?void 0:n.getChildByName("checkbox-content"))?void 0:o._checkboxGroup)?void 0:r.getChildByName("checkbox"));a&&("indeterminate"===i?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i)))}function C(e,t,i){let l,o,{checkedState:r,table:s}=i;if(s.internalProps.transpose?(e=s.getRecordShowIndexByCell(e,0),t=s.getRecordShowIndexByCell(t,0)):(l=s.isPivotTable()?void 0:s.getRecordIndexByCell(0,e),o=s.isPivotTable()?void 0:s.getRecordIndexByCell(0,t)),(0,n.Z)(l)&&(0,n.Z)(o)){if((e=l)>(t=o)){let i=r.get(e.toString());for(let i=e;i>t;i--)r.set(i.toString(),r.get((i-1).toString()));r.set(t.toString(),i)}else if(e<t){let i=r.get(e.toString());for(let i=e;i<t;i++)r.set(i.toString(),r.get((i+1).toString()));r.set(t.toString(),i)}}else if((0,a.Z)(l)&&(0,a.Z)(o)){if((e=l[l.length-1])>(t=o[o.length-1])){let i=r.get(l.toString());for(let i=e;i>t;i--){let e=[...l];e[e.length-1]=i;let t=[...l];t[t.length-1]=i-1,r.set(e.toString(),r.get(t.toString()))}r.set(o.toString(),i)}else if(e<t){let i=r.get(l.toString());for(let i=e;i<t;i++){let e=[...l];e[e.length-1]=i;let t=[...l];t[t.length-1]=i+1,r.set(e.toString(),r.get(t.toString()))}r.set(o.toString(),i)}}}function v(e){let t=[],i=e.dataSource,l=i.dataConfig.groupByRules.length+1;return i.currentIndexedData.forEach((o,r)=>{(0,a.Z)(o)&&o.length===l&&(t[i.getOriginRecordIndexForGroup(o)]=e.stateManager.checkedState.get(o.toString()))}),t}},23149:function(e,t,i){"use strict";i.d(t,{J:()=>a});var l=i(60232),o=i(5021),r=i(18585),n=i(96762);function a(e,t){var i,o,a,h,d,u,c,g,p,f,b;let m,C;if("cell"===e.role&&(0,r.Z)(e.mergeStartCol)&&(0,r.Z)(e.mergeStartRow)&&(0,r.Z)(e.mergeEndCol)&&(0,r.Z)(e.mergeEndRow)){let{colStart:i,colEnd:l,rowStart:o,rowEnd:r}=(0,n.e)(e,t.scenegraph);for(let n=i;n<=l;n++)for(let i=o;i<=r;i++){let l=s(t.stateManager,n,i,e);!l||m&&"cellBgColor"!==l||(m=l)}}else"cell"===e.role&&(m=s(t.stateManager,e.col,e.row,e));if(!m)return;let v=t.internalProps.layoutMap;return v.isCornerHeader(e.col,e.row)?C=(null==(i=t.theme.cornerHeaderStyle)?void 0:i.hover)||(null==(o=t.theme.headerStyle)?void 0:o.hover):v.isColumnHeader(e.col,e.row)?C=null==(a=t.theme.headerStyle)?void 0:a.hover:v.isRowHeader(e.col,e.row)?C=null==(h=t.theme.rowHeaderStyle)?void 0:h.hover:v.isBottomFrozenRow(e.col,e.row)?C=(null==(d=t.theme.bottomFrozenStyle)?void 0:d.hover)||(t.isListTable()?null==(u=t.theme.bodyStyle)?void 0:u.hover:null==(c=t.theme.headerStyle)?void 0:c.hover):v.isRightFrozenColumn(e.col,e.row)?C=(null==(g=t.theme.rightFrozenStyle)?void 0:g.hover)||(t.isListTable()?null==(p=t.theme.bodyStyle)?void 0:p.hover:null==(f=t.theme.rowHeaderStyle)?void 0:f.hover):t.isHeader(e.col,e.row)||(C=null==(b=t.theme.bodyStyle)?void 0:b.hover),(0,l.WJ)(m,C,e.col,e.row,t)}function s(e,t,i,l){var r;let n,{highlightScope:a,disableHeader:s,cellPos:h}=e.hover,d=e.table,u=d.isHeader(t,i);if(!u||!s){if(a===o.p.single&&h.col===t&&h.row===i?n="cellBgColor":a===o.p.column&&h.col===t?n=h.col===t&&h.row===i?"cellBgColor":"inlineColumnBgColor":a===o.p.row&&h.row===i?n=h.col===t&&h.row===i?"cellBgColor":"inlineRowBgColor":a===o.p.cross&&(h.col===t&&h.row===i?n="cellBgColor":h.col===t?n="inlineColumnBgColor":h.row===i&&(n="inlineRowBgColor")),n){let e;if(u){let o=d.getHeaderDefine(t,i);e=null==o?void 0:o.disableHeaderHover,l.firstChild&&"axis"===l.firstChild.name&&(null==(r=d.options.hover)?void 0:r.disableAxisHover)&&(e=!0)}else{let l=d.getBodyColumnDefine(t,i);e=null==l?void 0:l.disableHover}e&&(n=void 0)}return n}}},45847:function(e,t,i){"use strict";i.d(t,{Oq:()=>a,Wg:()=>s,fM:()=>h,tO:()=>u,vj:()=>d});var l=i(58977),o=i(18585),r=i(47e3),n=i(47105);function a(e,t,i,o,r,n){let a=n.table.getRecordShowIndexByCell(e,t);if(a>=0){let e=n.table.dataSource.getIndexKey(a);"column"===o?(0,l.Z)(r)?(n.radioState[i]={},n.radioState[i][e]=r):n.radioState[i]=e:(n.radioState[i]||(n.radioState[i]={}),(0,l.Z)(r)?n.radioState[i][e]=r:n.radioState[i][e]=!0)}}function s(e,t,i){var n;let a=i.getBodyColumnDefine(e,t),s=null==a?void 0:a.field,h=i.getCellType(e,t);if((0,o.Z)(s)&&"radio"===h){let o=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(e,t)),a=null==(n=i.stateManager.radioState)?void 0:n[s];if((0,l.Z)(a)){if(a===o)return!0}else if((0,r.Z)(a)){let e=a[o];if((0,l.Z)(e))return e}}return!1}function h(e,t,i,a,s,h,d){var u,c,g,p,f;let b=d.table.getRecordShowIndexByCell(e,t);if(b>=0){let e=d.table.dataSource.getIndexKey(b);if("column"===a){if(!(0,o.Z)(d.radioState[i])&&h)return(0,l.Z)(s)?(d.radioState[i]={},d.radioState[i][e]=s):d.radioState[i]=e,!0;if((0,l.Z)(d.radioState[i])&&!(0,l.Z)(s))return d.radioState[i]===e;if((0,l.Z)(d.radioState[i])&&(0,l.Z)(s)||(0,r.Z)(d.radioState[i])&&!(0,l.Z)(s))return!1;if((0,r.Z)(d.radioState[i])&&(0,l.Z)(s))return d.radioState[i][e]===s}else if("cell"===a){if(!(0,o.Z)(d.radioState[i])&&h)return d.radioState[i]={},(0,l.Z)(s)?d.radioState[i][e]=s:d.radioState[i][e]=!0,!0;if(!(0,o.Z)(null==(u=d.radioState[i])?void 0:u[e])&&h)return(0,l.Z)(s)?d.radioState[i][e]=s:d.radioState[i][e]=!0,!0;if((0,n.Z)(null==(c=d.radioState[i])?void 0:c[e])&&!(0,l.Z)(s))return d.radioState[i][e];if((0,n.Z)(null==(g=d.radioState[i])?void 0:g[e])&&(0,l.Z)(s)||(0,l.Z)(null==(p=d.radioState[i])?void 0:p[e])&&!(0,l.Z)(s))return!1;if((0,l.Z)(null==(f=d.radioState[i])?void 0:f[e])&&(0,l.Z)(s))return d.radioState[i][e]===s}}return h}function d(e,t,i,o){let r=o.scenegraph.getCell(e,t);if(r)if((0,l.Z)(i)){let e=r.getChildAt(i);null==e||e._handlePointerUp()}else{let e=r.getChildByName("radio");null==e||e._handlePointerUp()}}function u(e,t,i){let{radioState:l,table:o}=i;if(o.internalProps.transpose?(e=o.getRecordShowIndexByCell(e,0),t=o.getRecordShowIndexByCell(t,0)):(e=o.getRecordShowIndexByCell(0,e),t=o.getRecordShowIndexByCell(0,t)),e>t){let i=l[e];for(let i=e;i>t;i--)l[i]=l[i-1];l[t]=i}else if(e<t){let i=l[e];for(let i=e;i<t;i++)l[i]=l[i+1];l[t]=i}}},28399:function(e,t,i){"use strict";i.r(t),i.d(t,{DEFAULT:()=>v,SIMPLIFY:()=>w,BRIGHT:()=>m,DARK:()=>b,default:()=>R,ARCO:()=>C,TableTheme:()=>p,get:()=>S,of:()=>_,theme:()=>x});var l=i(77597);let o={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:function(e){let{row:t,table:i}=e;return 1&t-i.frozenRowCount?"#282a2e":"#2d3137"},fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}},r={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:function(e){let{row:t,table:i}=e;return 1&t-i.frozenRowCount?"#FFF":"#F4F8FF"},borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},n={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:function(e){let{row:t,table:i}=e;return 1&t-i.frozenRowCount?"#fbfbfc":"#FFF"},borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},a={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:function(e){let{row:t,table:i}=e;return 1&t-i.frozenRowCount?"#FDFDFD":"#FAF9FB"},hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},s={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:function(e){let{col:t,table:i}=e,{colCount:l,frozenColCount:o}=i,r="#ccc7c7";return o-1===t||l-1===t?[r,"#f2f2f2","#ccc7c7",null]:[r,null,"#ccc7c7",null]},hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:function(e){let{row:t,table:{frozenRowCount:i}}=e;return i-1===t?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};var h=i(88607),d=i(28071),u=i(90251);let c={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function g(e,t,i,o){var r,n,a;return null!=(a=null!=(n=null!=(r=(0,l.TS)(e,...i))?r:(0,l.TS)(t,...i))?n:o&&(0,l.TS)(e,...o))?a:o&&(0,l.TS)(t,...o)}class p{constructor(e,t){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:e,superTheme:t},this.name=g(e,t,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){let{obj:e,superTheme:t}=this.internalTheme;return g(e,t,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){let{obj:e,superTheme:t}=this.internalTheme;return g(e,t,["underlayBackgroundColor"])}get cellInnerBorder(){var e;let{obj:t,superTheme:i}=this.internalTheme;return null==(e=g(t,i,["cellInnerBorder"]))||e}get cellBorderClipDirection(){var e;let{obj:t,superTheme:i}=this.internalTheme;return null!=(e=g(t,i,["cellBorderClipDirection"]))?e:"top-left"}get _contentOffset(){var e;let{obj:t,superTheme:i}=this.internalTheme;return null!=(e=g(t,i,["_contentOffset"]))?e:0}get defaultStyle(){let e=this;if(!this._defaultStyle){let{obj:j,superTheme:U}=this.internalTheme,$=(0,d.je)({},U.defaultStyle,j.defaultStyle);this._defaultStyle={get fontSize(){var t;return null!=(t=$.fontSize)?t:u.ho},get fontFamily(){var i;return null!=(i=$.fontFamily)?i:u.Rk},get fontWeight(){return $.fontWeight},get fontVariant(){return $.fontVariant},get fontStyle(){return $.fontStyle},get bgColor(){var l;return null!=(l=$.bgColor)?l:u.aE},get color(){var o;return null!=(o=$.color)?o:u.yZ},get borderColor(){var r;return null!=(r=$.borderColor)?r:u.cT},get borderLineWidth(){var n;return null!=(n=$.borderLineWidth)?n:u.zY},get borderLineDash(){var a;return null!=(a=$.borderLineDash)?a:u.z8},get hover(){if($.hover)return{get cellBgColor(){var s,h;return null!=(h=null==(s=$.hover)?void 0:s.cellBgColor)?h:void 0},get inlineColumnBgColor(){var c,g,p,f,b,m;return null!=(m=null!=(g=null==(c=$.hover)?void 0:c.inlineColumnBgColor)?g:(null==(p=$.hover)?void 0:p.cellBgColor)&&"string"==typeof(null==(f=$.hover)?void 0:f.cellBgColor)?(0,d.zX)(null==(b=$.hover)?void 0:b.cellBgColor,.1,!1):void 0)?m:void 0},get inlineRowBgColor(){var C,v,w,y,x,_;return null!=(_=null!=(v=null==(C=$.hover)?void 0:C.inlineRowBgColor)?v:(null==(w=$.hover)?void 0:w.cellBgColor)&&"string"==typeof(null==(y=$.hover)?void 0:y.cellBgColor)?(0,d.zX)(null==(x=$.hover)?void 0:x.cellBgColor,.1,!1):void 0)?_:void 0}}},get select(){if($.select)return{get inlineColumnBgColor(){var S,R,H,A,M,F;return null!=(F=null!=(A=null!=(R=null==(S=$.select)?void 0:S.inlineColumnBgColor)?R:null==(H=e.selectionStyle)?void 0:H.inlineColumnBgColor)?A:(null==(M=e.selectionStyle)?void 0:M.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor?(0,d.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?F:void 0},get inlineRowBgColor(){var B,T,z,L,k;return null!=(k=null!=(z=null!=(T=null==(B=$.select)?void 0:B.inlineRowBgColor)?T:e.selectionStyle.inlineRowBgColor)?z:(null==(L=e.selectionStyle)?void 0:L.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor?(0,d.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?k:void 0}}},get padding(){var P;return null!=(P=$.padding)?P:[10,16,10,16]},get textAlign(){var I;return null!=(I=$.textAlign)?I:"left"},get textBaseline(){var E;return null!=(E=$.textBaseline)?E:"middle"},get textOverflow(){var D;return null!=(D=$.textOverflow)?D:"ellipsis"},get lineHeight(){return $.lineHeight},get autoWrapText(){var W;return null!=(W=$.autoWrapText)&&W},get lineClamp(){var O;return null!=(O=$.lineClamp)?O:"auto"},get linkColor(){var G;return null!=(G=$.linkColor)?G:"#3772ff"},get cursor(){var N;return null!=(N=$.cursor)?N:"auto"},get marked(){var Z;return null!=(Z=$.marked)&&Z},get underline(){var K;return null!=(K=$.underline)&&K},get underlineColor(){return $.underlineColor},get underlineDash(){return $.underlineDash},get underlineOffset(){return $.underlineOffset},get lineThrough(){var V;return null!=(V=$.lineThrough)&&V},get lineThroughColor(){return $.lineThroughColor},get lineThroughDash(){return $.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,t.cornerHeaderStyle,e.cornerHeaderStyle);this._cornerHeader=this.getStyle(i)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){let{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerRightTopCellStyle&&!e.cornerRightTopCellStyle)return this._cornerRightTopCell;let i=(0,d.je)({},this.defaultStyle,t.cornerRightTopCellStyle,e.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(i)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){let{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerLeftBottomCellStyle&&!e.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;let i=(0,d.je)({},this.defaultStyle,t.cornerLeftBottomCellStyle,e.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(i)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){let{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerRightBottomCellStyle&&!e.cornerRightBottomCellStyle)return this._cornerRightBottomCell;let i=(0,d.je)({},this.defaultStyle,t.cornerRightBottomCellStyle,e.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(i)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){let{obj:e,superTheme:t}=this.internalTheme;if(!t.rightFrozenStyle&&!e.rightFrozenStyle)return this._rightFrozen;let i=(0,d.je)({},this.defaultStyle,this.rowHeaderStyle,t.rightFrozenStyle,e.rightFrozenStyle);this._rightFrozen=this.getStyle(i)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){let{obj:e,superTheme:t}=this.internalTheme;if(!t.bottomFrozenStyle&&!e.bottomFrozenStyle)return this._bottomFrozen;let i=(0,d.je)({},this.defaultStyle,this.headerStyle,t.bottomFrozenStyle,e.bottomFrozenStyle);this._bottomFrozen=this.getStyle(i)}return this._bottomFrozen}get rowHeaderStyle(){var e;if(!this._rowHeader){let{obj:t,superTheme:i}=this.internalTheme,l=(0,d.je)({},this.defaultStyle,i.rowHeaderStyle,null!=(e=t.rowHeaderStyle)?e:this.isPivot?null:t.headerStyle);this._rowHeader=this.getStyle(l)}return this._rowHeader}get headerStyle(){if(!this._header){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,t.headerStyle,e.headerStyle);this._header=this.getStyle(i)}return this._header}get bodyStyle(){if(!this._body){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,t.bodyStyle,e.bodyStyle);this._body=this.getStyle(i)}return this._body}get groupTitleStyle(){if(!this._groupTitle){let{obj:e,superTheme:t}=this.internalTheme;if(!t.groupTitleStyle&&!e.groupTitleStyle)return this._groupTitle;let i=(0,d.je)({},this.defaultStyle,t.groupTitleStyle,e.groupTitleStyle);this._groupTitle=this.getStyle(i)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.frameStyle,e.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){let{obj:a,superTheme:s}=this.internalTheme,h=(0,d.je)({},s.scrollStyle,a.scrollStyle);this._scroll={get scrollSliderColor(){var e;return null!=(e=h.scrollSliderColor)?e:"#C0C0C0"},get scrollSliderCornerRadius(){return h.scrollSliderCornerRadius},get scrollRailColor(){return h.scrollRailColor},get visible(){var t;return null!=(t=h.visible)?t:"scrolling"},get verticalVisible(){return h.verticalVisible},get horizontalVisible(){return h.horizontalVisible},get width(){var i;return null!=(i=h.width)?i:7},get hoverOn(){var l;return null==(l=h.hoverOn)||l},get barToSide(){var o;return null!=(o=h.barToSide)&&o},get horizontalPadding(){var r;return null!=(r=h.horizontalPadding)?r:0},get verticalPadding(){var n;return null!=(n=h.verticalPadding)?n:0}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){let{obj:r,superTheme:n}=this.internalTheme,a=(0,d.je)({},n.tooltipStyle,r.tooltipStyle);this._tooltip={get fontFamily(){var e;return null!=(e=a.fontFamily)?e:u.Rk},get fontSize(){var t;return null!=(t=a.fontSize)?t:u.ho},get bgColor(){var i;return null!=(i=a.bgColor)?i:"#000"},get padding(){var l;return null!=(l=a.padding)?l:[6,8]},get color(){var o;return null!=(o=a.color)?o:"#FFF"},get maxWidth(){return a.maxWidth},get maxHeight(){return a.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){let{obj:g,superTheme:p}=this.internalTheme,f=(0,d.je)({},p.columnResize,g.columnResize);this._columnResize={get lineColor(){var e;return null!=(e=f.lineColor)?e:"#416EFF"},get bgColor(){var t;return null!=(t=f.bgColor)?t:"#D9E2FF"},get lineWidth(){var i;return null!=(i=f.lineWidth)?i:1},get width(){var l;return null!=(l=f.width)?l:f.lineWidth+2},get resizeHotSpotSize(){var o;return null!=(o=f.resizeHotSpotSize)?o:16},get labelColor(){var r;return null!=(r=f.labelColor)?r:"#FFF"},get labelFontSize(){var n;return null!=(n=f.labelFontSize)?n:10},get labelFontFamily(){var a;return null!=(a=f.labelFontFamily)?a:"sans-serif"},get labelBackgroundFill(){var s;return null!=(s=f.labelBackgroundFill)?s:"#3073F2"},get labelBackgroundCornerRadius(){var h;return null!=(h=f.labelBackgroundCornerRadius)?h:5},get labelVisible(){var u;return null==(u=f.labelVisible)||u},get visibleOnHover(){var c;return null!=(c=f.visibleOnHover)&&c}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){let{obj:l,superTheme:o}=this.internalTheme,r=(0,d.je)({},o.dragHeaderSplitLine,l.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var e;return null!=(e=r.lineColor)?e:"blue"},get lineWidth(){var t;return null!=(t=r.lineWidth)?t:2},get shadowBlockColor(){var i;return null!=(i=r.shadowBlockColor)?i:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){let{obj:y,superTheme:x}=this.internalTheme,_=(0,d.je)({},x.frozenColumnLine,y.frozenColumnLine);this._frozenColumnLine={get shadow(){if(_.shadow)return{get width(){var e,t;return null!=(t=null==(e=_.shadow)?void 0:e.width)?t:24},get startColor(){var i,l;return null!=(l=null==(i=_.shadow)?void 0:i.startColor)?l:"rgba(00, 24, 47, 0.06)"},get endColor(){var o,r;return null!=(r=null==(o=_.shadow)?void 0:o.endColor)?r:"rgba(00, 24, 47, 0)"},get visible(){var n,a;return null!=(a=null==(n=_.shadow)?void 0:n.visible)?a:"always"}}},get border(){if(_.border)return{get lineColor(){var s,h;return null!=(h=null==(s=_.border)?void 0:s.lineColor)?h:"rgba(00, 24, 47, 0.06)"},get bgColor(){var u,c,g,p;return null!=(p=null!=(c=null==(u=_.border)?void 0:u.bgColor)?c:null==(g=_.border)?void 0:g.lineColor)?p:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var f,b;return null!=(b=null==(f=_.border)?void 0:f.lineWidth)?b:4},get width(){var m,C,v,w;return null!=(w=null!=(C=null==(m=_.border)?void 0:m.width)?C:null==(v=_.border)?void 0:v.lineWidth)?w:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){let{obj:r,superTheme:n}=this.internalTheme,a=(0,d.je)({},n.selectionStyle,r.selectionStyle);this._selectionStyle={get cellBgColor(){var e;return null!=(e=null==a?void 0:a.cellBgColor)?e:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var t;return null!=(t=null==a?void 0:a.cellBorderColor)?t:"#3073f2"},get cellBorderLineWidth(){var i;return null!=(i=null==a?void 0:a.cellBorderLineWidth)?i:2},get inlineColumnBgColor(){return null==a?void 0:a.inlineColumnBgColor},get inlineRowBgColor(){return null==a?void 0:a.inlineRowBgColor},get selectionFillMode(){var l;return null!=(l=null==a?void 0:a.selectionFillMode)?l:"overlay"},get dynamicUpdateSelectionSize(){var o;return null!=(o=null==a?void 0:a.dynamicUpdateSelectionSize)&&o}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.axisStyle,e.axisStyle);this._axisStyle={defaultAxisStyle:i.defaultAxisStyle||{},leftAxisStyle:i.leftAxisStyle||{},rightAxisStyle:i.rightAxisStyle||{},topAxisStyle:i.topAxisStyle||{},bottomAxisStyle:i.bottomAxisStyle||{}}}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.checkboxStyle,e.checkboxStyle);this._checkboxStyle=i}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.radioStyle,e.radioStyle);this._radioStyle=i}return this._radioStyle}get switchStyle(){if(!this._switchStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.switchStyle,e.switchStyle);this._switchStyle=i}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.buttonStyle,e.buttonStyle);this._buttonStyle=i}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},c,t.textPopTipStyle,e.textPopTipStyle);this._textPopTipStyle=i}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){let{obj:e,superTheme:t}=this.internalTheme,i=(0,d.je)({},t.functionalIconsStyle,e.functionalIconsStyle);this._internalIconsStyle=i}return this._internalIconsStyle}hasProperty(e){let{obj:t,superTheme:i}=this.internalTheme;return f(t,e)||f(i,e)}extends(e){return new p((0,d.je)({},e),(0,d.je)(this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(e){let t=this;return{get fontSize(){return e.fontSize},get fontFamily(){return e.fontFamily},get fontWeight(){return e.fontWeight},get fontVariant(){return e.fontVariant},get fontStyle(){return e.fontStyle},get bgColor(){return e.bgColor},get color(){return e.color},get strokeColor(){return e.strokeColor},get borderColor(){return e.borderColor},get borderLineWidth(){return e.borderLineWidth},get borderLineDash(){return e.borderLineDash},get hover(){if(e.hover)return{get cellBgColor(){var i,l;return null!=(l=null==(i=e.hover)?void 0:i.cellBgColor)?l:void 0},get inlineColumnBgColor(){var o,r,n,a,s,h;return null!=(h=null!=(r=null==(o=e.hover)?void 0:o.inlineColumnBgColor)?r:(null==(n=e.hover)?void 0:n.cellBgColor)&&"string"==typeof(null==(a=e.hover)?void 0:a.cellBgColor)?(0,d.zX)(null==(s=e.hover)?void 0:s.cellBgColor,.1,!1):void 0)?h:void 0},get inlineRowBgColor(){var u,c,g,p,f,b;return null!=(b=null!=(c=null==(u=e.hover)?void 0:u.inlineRowBgColor)?c:(null==(g=e.hover)?void 0:g.cellBgColor)&&"string"==typeof(null==(p=e.hover)?void 0:p.cellBgColor)?(0,d.zX)(null==(f=e.hover)?void 0:f.cellBgColor,.1,!1):void 0)?b:void 0}}},get select(){return{get inlineColumnBgColor(){var m,C,v,w,y,x;return null!=(x=null!=(w=null!=(C=null==(m=e.select)?void 0:m.inlineColumnBgColor)?C:null==(v=t.selectionStyle)?void 0:v.inlineColumnBgColor)?w:(null==(y=t.selectionStyle)?void 0:y.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor?(0,d.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?x:void 0},get inlineRowBgColor(){var _,S,R,H,A;return null!=(A=null!=(R=null!=(S=null==(_=e.select)?void 0:_.inlineRowBgColor)?S:t.selectionStyle.inlineRowBgColor)?R:(null==(H=t.selectionStyle)?void 0:H.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor?(0,d.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?A:void 0},get cellBgColor(){var M,F,B;if("replace"===t.selectionStyle.selectionFillMode)return null!=(B=null!=(F=null==(M=e.select)?void 0:M.cellBgColor)?F:t.selectionStyle.cellBgColor)?B:void 0}}},get frameStyle(){if(e.frameStyle)return{get borderColor(){var T,z;return null!=(z=null==(T=e.frameStyle)?void 0:T.borderColor)?z:void 0},get borderLineWidth(){var L,k;return null!=(k=null==(L=e.frameStyle)?void 0:L.borderLineWidth)?k:void 0},get borderLineDash(){var P,I;return null!=(I=null==(P=e.frameStyle)?void 0:P.borderLineDash)?I:void 0}}},get padding(){return e.padding},get textAlign(){return e.textAlign},get textBaseline(){return e.textBaseline},get textOverflow(){return e.textOverflow},get lineHeight(){return e.lineHeight},get autoWrapText(){return e.autoWrapText},get lineClamp(){return e.lineClamp},get linkColor(){return e.linkColor},get cursor(){return e.cursor},get textStick(){return e.textStick},get marked(){return e.marked},get underline(){var E;return null!=(E=e.underline)&&E},get underlineColor(){return e.underlineColor},get underlineDash(){return e.underlineDash},get underlineOffset(){return e.underlineOffset},get lineThrough(){var D;return null!=(D=e.lineThrough)&&D},get lineThroughColor(){return e.lineThroughColor},get lineThroughDash(){return e.lineThroughDash}}}}function f(e,t){if(e instanceof p)return e.hasProperty(t);let i=e;if(!i)return!1;for(let e=0;e<t.length;e++)if(!(i=i[t[e]]))return!1;return!!i}let b=new p(o,o),m=new p(r,r),C=new p(n,n),v=new p(a,a),w=new p(s,s),y={DEFAULT:v,SIMPLIFY:w,ARCO:C,DARK:b,BRIGHT:m},x={TableTheme:p};function _(e){if(!e)return null;if("string"==typeof e){let t=(0,l.I0)(S(),e);return t?t instanceof p?t:new p(t,t):null}return e instanceof p?e:new p(e,e)}function S(){return(0,l.l7)(y,h.n)}let R={DARK:b,BRIGHT:m,ARCO:C,DEFAULT:v,SIMPLIFY:w,theme:x,of:_,get:S}},88607:function(e,t,i){"use strict";i.d(t,{n:()=>l});let l={}},89445:function(e,t,i){"use strict";i.d(t,{B:()=>r});var l=i(18585);let o=(e,t)=>{let i=0,l=e.length-1;for(;i<=l;){let o=Math.floor((i+l)/2);if(e[o]===t)return o;e[o]>t?l=o-1:i=o+1}return l<0?0:l};class r{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(e,t,i){let{_keys:l}=this;if(this._sorted||(l.sort((e,t)=>e<t?-1:+(e>t)),this._sorted=!0),e>t){let r=[];for(let n=o(l,e+i-1);n>=0;n--){let o=l[n];if(o>=e)r.push(this.get(o));else if(t<=o&&o<e)this.put(o+i,this.get(o));else if(o<t)break}for(let e=0;e<i;e++)this.put(t+e,r[i-1-e])}let{length:r}=l;if(e<t){let n=[];for(let a=o(l,e);a<r;a++){let o=l[a];if(o>=e&&o<e+i)n.push(this.get(o));else if(e+i<=o&&o<=t)this.put(o-i,this.get(o));else if(o>t)break}for(let e=0;e<i;e++)this.put(t+e,n[e])}}exchangeOrder(e,t,i,l,r){let{_keys:n}=this;if(this._sorted||(n.sort((e,t)=>e<t?-1:+(e>t)),this._sorted=!0),e>i){let l=[],a=[];for(let r=o(n,i);r<o(n,e)+t;r++){let i=n[r];i>=e&&i<e+t?a.push(this.get(i)):l.push(this.get(i))}for(let e=0;e<t;e++)this.put(r+e,a[e]);for(let e=0;e<l.length;e++)this.put(r+t+e,l[e])}else{let a=[],s=[];for(let r=o(n,e);r<o(n,i)+l;r++){let i=n[r];i>=e&&i<e+t?s.push(this.get(i)):a.push(this.get(i))}for(let e=0;e<t;e++)this.put(r+e,s[e]);for(let t=0;t<a.length;t++)this.put(e+t,a[t])}}del(e){delete this._vals[e];let t=this._keys.indexOf(e);-1!==t&&this._keys.splice(t,1)}put(e,t){e in this._vals||(this._keys.push(e),this._sorted=!1),this._vals[e]=t}get(e){return this._vals[e]}has(e){return(0,l.Z)(this._vals[e])}contain(e){return Object.values(this._vals).indexOf(e)>=0}each(e,t,i){let{_keys:l}=this,{length:r}=l;this._sorted||(l.sort((e,t)=>e<t?-1:+(e>t)),this._sorted=!0);for(let n=o(l,e);n<r;n++){let o=l[n];if(e<=o&&o<=t){if(!1===i(this.get(o),o))break}else if(t<o)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){let e=this.getLastIndex();this.del(e)}delAndReorder(e){if(!this.has(e))return;let t=this.getLastIndex();this.adjustOrder(e+1,e,t-e),this.delLast()}addAndReorder(e,t){if((0,l.Z)(t)){let i=this.getLastIndex();this.adjustOrder(e,e+1,i-e),this.put(e,t)}}}},14116:function(e,t,i){"use strict";i.d(t,{U:()=>o});var l=i(22295);class o{constructor(e,t,i,o){this.bounds=new l.YZ,this.bounds.set(e,t,e+i,t+o)}static bounds(e,t,i,l){return new o(e,t,Math.round(i-e),Math.round(l-t))}get left(){return this.bounds.x1}set left(e){this.bounds.x1=e}get top(){return this.bounds.y1}set top(e){this.bounds.y1=e}get right(){return this.bounds.x2}set right(e){this.bounds.x2=e}get bottom(){return this.bounds.y2}set bottom(e){this.bounds.y2=e}get width(){return this.bounds.width()}set width(e){this.bounds.x2=this.bounds.x1+e}get height(){return this.bounds.height()}set height(e){this.bounds.y2=this.bounds.y1+e}offsetLeft(e){this.bounds.translate(e,0)}offsetTop(e){this.bounds.translate(0,e)}copy(){return new o(this.left,this.top,this.width,this.height)}contains(e){return this.bounds.encloses(e.bounds)}inPoint(e,t){return this.bounds.contains(e,t)}}},41253:function(e,t,i){"use strict";i.d(t,{aR:()=>u,hU:()=>c});var l=i(29753),o=i(58977),r=i(58853),n=i(77597);function a(e){return e>=48&&e<=57}function s(e){return e>=97&&e<=122||e>=65&&e<=90||37===e}function h(e){return Error(`calc parse error: ${e}`)}let d={"*":3,"/":3,"+":2,"-":2};function u(e,t){var i;return"string"==typeof e?(i=e.trim(),function e(t,i){if(11===t.nodeType){let l=e(t.left,i),o=e(t.right,i);switch(t.op.value){case"+":return l+o;case"-":return l-o;case"*":return l*o;case"/":return l/o;default:throw Error(`calc error. unknown operator: ${t.op.value}`)}}if(10===t.nodeType)switch(t.unit){case"%":return t.value*i.full/100;case"px":return t.value;default:throw Error(`calc error. unknown unit: ${t.unit}`)}if(12===t.nodeType)return t.value;throw Error("calc error.")}(function e(t,i){function l(e){let t=e.pop(),l=e.pop(),o=e.pop();if(!(o&&o.nodeType&&l&&2===l.type&&t&&t.nodeType))throw h(i);return{nodeType:11,left:o,op:l,right:t}}let o=[];for(;t.length;){let r=t.shift();if(0===r.type&&"("===r.value){let l=0,r=n.IX.findIndex(t,e=>{if(0===e.type&&"("===e.value)l++;else if(0===e.type&&")"===e.value){if(!l)return!0;l--}return!1});if(-1===r)throw h(i);o.push(e(t.splice(0,r),i)),t.shift()}else if(2===r.type){if(o.length>=3){let e=o[o.length-2].value;d[r.value]<=d[e]&&o.push(l(o))}o.push(r)}else if(1===r.type){let{value:e,unit:t}=r;o.push({nodeType:10,value:e,unit:t})}else 3===r.type&&o.push({nodeType:12,value:r.value})}for(;o.length>1;)o.push(l(o));return o[0]}(function(e){let t=e.replace(/calc\(/g,"(").trim(),i=[],l=t.length;for(let r=0;r<l;r++){let n=t[r],s=n.charCodeAt(0);if("("===n||")"===n)i.push({value:n,type:0});else if("*"===n||"/"===n)i.push({value:n,type:2});else if("+"===n||"-"===n)r=function(e,r){if(r<l){let i=t[r],l=i.charCodeAt(0);if(a(l)||46===l)return o(e+i,r+1)}return i.push({value:e,type:2}),r}(n,r+1)-1;else if(a(s)||46===s)r=o(n,r+1)-1;else if(9!==s&&10!==s&&12!==s&&13!==s&&32!==s)throw h(e)}function o(o,r){let n=r;for(;n<l;n++){let r=t[n],d=r.charCodeAt(0);if(a(d))o+=r;else{if("."!==r){if(s(d))return function(e,o,r){let n=r;for(;n<l;n++){let e=t[n];if(!s(e.charCodeAt(0)))break;o+=e}return i.push({value:parseFloat(e),unit:o,type:1}),n}(o,r,n+1);break}if(o.indexOf(".")>=0)throw h(e);o+=r}}if("."===o)throw h(e);return i.push({value:parseFloat(o),type:3}),n}return i}(i),i),t)):e-0}function c(e){var t;return!!(0,r.Z)(e)&&!!e.endsWith("%")&&(t=e.substring(0,e.length-1),!(0,l.Z)(t)&&(!!(0,o.Z)(t)||+t==+t))}},32095:function(e,t,i){"use strict";i.d(t,{D:()=>n});let l=e=>{switch(Object.prototype.toString.call(e)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},o=(e,t)=>l(e)===t,r=e=>o(e,"object");function n(e,t,i){let l,o,n,a,s,h,d=0,u=!1,c=!1,g=!0,p=!t&&0!==t&&"function"==typeof requestAnimationFrame;if("function"!=typeof e)throw TypeError("Expected a function");function f(t){let i=l,r=o;return o=void 0,l=void 0,d=t,a=e.apply(r,i)}function b(e,t){return p?requestAnimationFrame(e):setTimeout(e,t)}function m(e){let i=e-h;return void 0===h||i>=t||i<0||u&&e-d>=n}function C(){let e=Date.now();if(m(e))return s=void 0,g&&l?f(e):(o=void 0,l=void 0,a);s=b(C,function(e){let i=e-d,l=t&&-(e-h);return u?Math.min(l,n-i):l}(e))}return t=+t||0,r(i)&&(c=!!i.leading,(u="maxWait"in i)&&(n=Math.max(+i.maxWait||0,t)),g="trailing"in i?!!i.trailing:g),function(...e){let i=Date.now(),r=m(i);if(l=e,o=this,h=i,r){if(void 0===s){var n;return d=n=h,s=b(C,t),c?f(n):a}if(u)return s=b(C,t),f(h)}return void 0===s&&(s=b(C,t)),a}}},48459:function(e,t,i){"use strict";function l(e,t){let i=document.createElement(e);return t&&i.classList.add(...t),i}i.d(t,{a:()=>l})},27180:function(e,t,i){"use strict";i.d(t,{X:()=>l,u:()=>o});class l{static get mode(){return l._mode||(l._mode=function(){let e="browser";try{"node"===window.type?e="node":"undefined"==typeof window||window.performance?"undefined"==typeof window&&(e="node"):e="miniApp"}catch(t){e="node"}return e}()),l._mode}static set mode(e){l._mode=e}static RegisterCreateCanvas(e){l.CreateCanvas=e}static RegisterLoadImage(e){l.LoadImage=e}static GetCreateCanvasFunc(){return l.CreateCanvas?l.CreateCanvas:"worker"===l.mode?(e=200,t=200)=>new OffscreenCanvas(e,t):void 0}static RegisterRequestAnimationFrame(e){l.RequestAnimationFrame=e()}static GetRequestAnimationFrame(){if(l.RequestAnimationFrame)return l.RequestAnimationFrame}static RegisterCancelAnimationFrame(e){l.CancelAnimationFrame=e()}static GetCancelAnimationFrame(){if(l.CancelAnimationFrame)return l.CancelAnimationFrame}}function o(){try{let e=window.getSelection();if(e){if("function"==typeof e.removeAllRanges)return void e.removeAllRanges();if("function"==typeof e.empty)return void e.empty();if("function"==typeof e.collapse)return void e.collapse(document.body,0)}}catch(e){}}l.dpr=0},90251:function(e,t,i){"use strict";i.d(t,{Rk:()=>o,Zj:()=>g,aE:()=>r,cT:()=>n,ek:()=>u,gm:()=>c,hW:()=>p,ho:()=>l,tP:()=>d,yZ:()=>h,z8:()=>s,zY:()=>a});let l=16,o="Arial,sans-serif",r="#FFF",n="#000",a=1,s=[],h="#000",d=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,u="$$indicator$$",c='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',g='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',p={type:"line"}},77597:function(e,t,i){"use strict";let l,o;i.d(t,{B:()=>M,Bd:()=>A,I0:()=>v,IX:()=>a,JO:()=>w,NC:()=>C,TS:()=>f,UG:()=>n,Xh:()=>R,_Z:()=>y,ib:()=>S,j6:()=>H,l7:()=>g,nO:()=>B,oB:()=>F,tI:()=>m,vi:()=>b,vl:()=>p,yD:()=>x});var r=i(28071);let n="undefined"==typeof window||void 0===window.window,a={get find(){return l||(l=Array.prototype.find?(e,t)=>Array.prototype.find.call(e,t):(e,t)=>{let i=a.findIndex(e,t);return i>=0?e[i]:void 0})},get findIndex(){return o||(o=Array.prototype.findIndex?(e,t)=>Array.prototype.findIndex.call(e,t):(e,t)=>{let{length:i}=e;for(let l=0;l<i;l++)if(t(e[l],l,e))return l;return -1})}},{IE:s,Chrome:h,Firefox:d,Edge:u,Safari:c}=function(){if(n)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};let e=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(e),Edge:e.indexOf("edge")>-1,Chrome:e.indexOf("chrome")>-1&&-1===e.indexOf("edge"),Firefox:e.indexOf("firefox")>-1,Safari:e.indexOf("safari")>-1&&-1===e.indexOf("edge")}}();function g(...e){let t={};return e.forEach(e=>{for(let i in e)Object.defineProperty(t,i,{get:()=>e[i],set(t){e[i]=t},configurable:!0,enumerable:!0})}),t}function p(e,t,...i){let l=e;for(let e=0;e<i.length&&null!=l;e++)l=t(l,i[e]);return l}function f(e,...t){return p(e,(e,t)=>e[t],...t)}function b(e,...t){return"function"==typeof e?e(...t):e}function m(e){return!!(e&&"function"==typeof e.then)}function C(e,t){m(e)?e.then(e=>{t(e)}).catch(e=>{}):t(e)}function v(e,t){if(e[t])return e[t];let i=t.toLowerCase();if(e[i])return e[i];let l=t.toLowerCase();if(e[l])return e[l];for(let t in e)if(t.toLowerCase()===i)return e[t]}function w(e){return Array.isArray(e)?3===e.length?[e[0],e[1],e[2],e[1]]:2===e.length?[e[0],e[1],e[0],e[1]]:1===e.length?[e[0],e[0],e[0],e[0]]:[e[0],e[1],e[2],e[3]]:[e,e,e,e]}function y(e,t,i){return e.start.col<=t&&t<=e.end.col&&e.start.row<=i&&i<=e.end.row||e.end.col<=t&&t<=e.start.col&&e.end.row<=i&&i<=e.start.row||e.end.col<=t&&t<=e.start.col&&e.start.row<=i&&i<=e.end.row||e.start.col<=t&&t<=e.end.col&&e.end.row<=i&&i<=e.start.row}function x(e,t,i){for(let l=0;l<e.length;l++){let o=e[l],r=Math.min(o.start.col,o.end.col),n=Math.max(o.start.col,o.end.col),a=Math.min(o.start.row,o.end.row),s=Math.max(o.start.row,o.end.row);if(r<=t&&t<=n&&a<=i&&i<=s||n<=t&&t<=r&&s<=i&&i<=a)return!0}return!1}function _(e){return{start:{col:Math.min(e.start.col,e.end.col),row:Math.min(e.start.row,e.end.row)},end:{col:Math.max(e.start.col,e.end.col),row:Math.max(e.start.row,e.end.row)}}}function S(e,t){let i=_(e),l=_(t);return!!(Math.max(i.start.col,l.start.col)<=Math.min(i.end.col,l.end.col)&&Math.max(i.start.row,l.start.row)<=Math.min(i.end.row,l.end.row))}let R={IE:s,Edge:u,Chrome:h,Firefox:d,Safari:c,heightLimit:h?0x1ffffff:d?0x11110a4:0xa3d719},H={isObject:function(e){return e===Object(e)}},A={endsWith:function(e,t,i){let l=(0,r.cw)(e);("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>l.length)&&(i=l.length),i-=t.length;let o=l.lastIndexOf(t,i);return -1!==o&&o===i}},M={isTouchEvent:function(e){return!!e.changedTouches}},F={toBoxArray:w},B=Function.prototype},96762:function(e,t,i){"use strict";function l(e,t){if(!t||!t.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};let{mergeStartCol:i,mergeEndCol:l,mergeStartRow:o,mergeEndRow:r,col:n,row:a}=e;return{colStart:i,colEnd:l,rowStart:o,rowEnd:r}}function o(e,t){let i=e.start.col,l=e.end.col,o=e.start.row,r=e.end.row,n=i,a=l,s=o,h=r;for(let e=i;e<=l;e++)for(let i=o;i<=r;i++){let l=t.getCellRange(e,i);l&&(n=Math.min(n,l.start.col),a=Math.max(a,l.end.col),s=Math.min(s,l.start.row),h=Math.max(h,l.end.row))}return e.start.col=n,e.end.col=a,e.start.row=s,e.end.row=h,e}i.d(t,{T:()=>o,e:()=>l})},97811:function(e,t,i){"use strict";i.d(t,{Iv:()=>n,KV:()=>s,vP:()=>r,z5:()=>a});var l=i(18585),o=i(43735);function r(e){var t;return(null==e?void 0:e.hoverOn)||(null==e?void 0:e.horizontalVisible)&&"none"===(null==e?void 0:e.horizontalVisible)||!(null==e?void 0:e.horizontalVisible)&&"none"===(null==e?void 0:e.visible)?0:null!=(t=null==e?void 0:e.width)?t:7}function n(e){var t;return(null==e?void 0:e.hoverOn)||(null==e?void 0:e.verticalVisible)&&"none"===(null==e?void 0:e.verticalVisible)||!(null==e?void 0:e.verticalVisible)&&"none"===(null==e?void 0:e.visible)?0:null!=(t=null==e?void 0:e.width)?t:7}function a(e){return!!(0,l.Z)(e)&&(!(0,o.Z)(e)||e.some(e=>(0,l.Z)(e)))}function s(e){return 0===e||(0,o.Z)(e)&&e.every(e=>0===e)}},28071:function(e,t,i){"use strict";i.d(t,{E5:()=>p,Ed:()=>_,K$:()=>v,MU:()=>w,P2:()=>g,Zf:()=>y,cw:()=>m,je:()=>function e(t,...i){if(!i.length)return t||{};let l=i.shift();if(a(t)&&a(l))for(let i in l)a(l[i])?(t[i]||Object.assign(t,{[i]:{}}),a(t[i])||Object.assign(t,{[i]:l[i]}),e(t[i],l[i])):null!==l[i]&&void 0!==l[i]&&Object.assign(t,{[i]:l[i]});return e(t,...i)},m7:()=>u,oM:()=>x,p4:()=>c,pr:()=>function e(t,i,l){let r=0;if(!i||i===o.g.collapse||i===o.g.none)return r;let n=l.filteredChildren?l.filteredChildren:l.children;if(n)for(let i=0;i<n.length;i++)r+=1,r+=e(Array.isArray(t)?t.concat([i]):[t,i],n[i].hierarchyState,n[i]);return r},tq:()=>C,yW:()=>function e(t,i,l){l(t),(null==t?void 0:t[i])&&Array.isArray(null==t?void 0:t[i])&&t[i].forEach(t=>e(t,i,l))},zX:()=>b});var l=i(18585),o=i(12348);let r=e=>{switch(Object.prototype.toString.call(e)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},n=(e,t)=>r(e)===t,a=e=>n(e,"object"),s=e=>n(e,"string"),h=e=>n(e,"number"),d=e=>n(e,"boolean");function u(e){return"function"==typeof e&&(e=e()),(0,l.Z)(e)?`${e}`:""}function c(e){if((null==e?void 0:e.length)<=0)return e;let t=e.length,i=e[0].length,l=Array(i);for(let o=0;o<t;o++)for(let r=0;r<i;r++)l[r]||(l[r]=Array(t)),l[r][o]=e[o][r];return l}function g(e,t){let i=null;return function(...l){i||(e.apply(this,l),i=setTimeout(()=>{i=null},t))}}function p(e,t){let i=null;return function(...l){i||(i=setTimeout(()=>{e.apply(this,l),i=null},t))}}function f(e,t){for(e=`${e}`;e.length<t;)e="0"+e;return e}function b(e,t,i){e=(e=e.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");let o=Math.round(256*t)*(i?-1:1),r=e.match(RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),n=r&&(0,l.Z)(r[4])?r[4]:null,a=r?[r[1],r[2],r[3]]:e.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return r?`rgb${null!==n?"a":""}(${Math[i?"max":"min"](parseInt(a[0],10)+o,255*!i)}, ${Math[i?"max":"min"](parseInt(a[1],10)+o,255*!i)}, ${Math[i?"max":"min"](parseInt(a[2],10)+o,255*!i)}${null!==n?`, ${n}`:""})`:["#",f(Math[i?"max":"min"](parseInt(a[0],10)+o,255*!i).toString(16),2),f(Math[i?"max":"min"](parseInt(a[1],10)+o,255*!i).toString(16),2),f(Math[i?"max":"min"](parseInt(a[2],10)+o,255*!i).toString(16),2)].join("")}function m(e){return s(e)||h(e)||d(e)?e.toString():""}function C(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function v(e,t,i){return"desc"!==i?e===t?0:e>t?1:-1:e===t?0:e<t?1:-1}function w(e,t){let i,l=e;for(;(i=t.shift())&&(l=l[i]););return l}function y(e){return/^-?\d+(\.\d+)?$/.test(e)}function x(e){let t=[];for(let i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function _(e){let t=window.getSelection();if(t.rangeCount){let i=t.getRangeAt(0);return i.endOffset>i.startOffset&&e.contains(i.commonAncestorContainer)}return!1}},60072:function(e,t,i){"use strict";i.d(t,{n:()=>l});let l=["bgColor","color","strokeColor","borderColor","linkColor"]},5021:function(e,t,i){"use strict";var l,o,r,n;i.d(t,{F:()=>l,p:()=>o}),(r=l||(l={})).default="default",r.grabing="grabing",r.scrolling="scrolling",(n=o||(o={})).single="single",n.column="column",n.row="row",n.cross="cross",n.none="none"},61763:function(e,t,i){"use strict";i.d(t,{Fn:()=>p,Js:()=>h,MR:()=>v,NF:()=>f,SL:()=>C,U4:()=>d,YJ:()=>r,ZP:()=>c,__:()=>u,hT:()=>a,jk:()=>n,ky:()=>g,ld:()=>s,vg:()=>b,y4:()=>m});var l=i(18585),o=i(21264);let r={};class n{constructor(e){var t;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.children=[],this.key=e.key,this.field=e.field,this.formatFun=e.formatFun,this.isRecord=null!=(t=e.isRecord)?t:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(e,t,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),e,t,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.clearCacheValue()}}class a extends n{constructor(){super(...arguments),this.type=o.E.RECORD,this.isRecord=!0}push(e){e&&this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator&&this.children&&this.children.push(e),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e))),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.clearCacheValue())}value(){var e;return null!=(e=this.changedValue)?e:this.records}reset(){this.children=[],this.changedValue=void 0,this.records=[]}recalculate(){}}class s extends n{constructor(){super(...arguments),this.type=o.E.NONE,this.isRecord=!0}push(e){e&&(this.isRecord&&(this.records=[e]),e.isAggregator&&this.children&&(this.children=[e]),this.field&&(this.fieldValue=e[this.field])),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){var e;return null!=(e=this.changedValue)?e:this.fieldValue}reset(){this.children=[],this.changedValue=void 0,this.records=[],this.fieldValue=void 0}recalculate(){}}class h extends n{constructor(e){super(e),this.type=o.E.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=e.aggregationFun}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator&&this.children&&this.children.push(e),this.field&&this.values.push(e[this.field])),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field])),this.clearCacheValue())}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field]))),this.clearCacheValue()}value(){var e,t;return this.fieldValue||(this.fieldValue=null==(e=this.aggregationFun)?void 0:e.call(this,this.values,this.records,this.field)),null!=(t=this.changedValue)?t:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class d extends n{constructor(e){super(e),this.type=o.E.RECALCULATE,this.isRecord=!0,this.calculateFun=e.calculateFun,this.dependAggregators=e.dependAggregators,this.dependIndicatorKeys=e.dependIndicatorKeys}push(e){e&&this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),this.children&&e.isAggregator&&this.children.push(e),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e))),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.clearCacheValue())}value(){var e,t;if(!this.fieldValue){let t=function(e,t){let i={};for(let l=0;l<(null==t?void 0:t.length);l++){let o=e.find(e=>(null==e?void 0:e.key)===t[l]);o&&(i[o.key]=null==o?void 0:o.value())}return i}(this.dependAggregators,this.dependIndicatorKeys);this.fieldValue=null==(e=this.calculateFun)?void 0:e.call(this,t,this.records,this.field)}return null!=(t=this.changedValue)?t:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){}}class u extends n{constructor(e){var t;super(e),this.type=o.E.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=null!=(t=e.needSplitPositiveAndNegative)&&t}push(e){if(e){if(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator&&this.children){this.children.push(e);let t=e.value();this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){let t=parseFloat(e[this.field]);this.sum+=t,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}this.clearCacheValue()}deleteRecord(e){if(e){if(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children){this.children=this.children.filter(t=>t!==e);let t=e.value();this.sum-=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum-=t:t<0&&(this.nagetiveSum-=t))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){let t=parseFloat(e[this.field]);this.sum-=t,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum-=t:t<0&&(this.nagetiveSum-=t))}}this.clearCacheValue()}updateRecord(e,t){if(e&&t){if(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&this.children){let i=e.value();this.children=this.children.filter(t=>t!==e);let l=t.value();this.children.push(t),this.sum+=l-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),l>0?this.positiveSum+=l:l<0&&(this.nagetiveSum+=l))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){let i=parseFloat(e[this.field]),l=parseFloat(t[this.field]);this.sum+=l-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),l>0?this.positiveSum+=l:l<0&&(this.nagetiveSum+=l))}this.clearCacheValue()}}value(){var e,t;return null!=(e=this.changedValue)?e:(null==(t=this.records)?void 0:t.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.isAggregator){let e=t.value();this.sum+=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}else if(this.records)for(let e=0;e<this.records.length;e++){let t=this.records[e];if(t.isAggregator){let e=t.value();this.sum+=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}}}class c extends n{constructor(){super(...arguments),this.type=o.E.COUNT,this.count=0}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?(this.children&&this.children.push(e),this.count+=e.value()):this.count++),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator?(this.children&&(this.children=this.children.filter(t=>t!==e)),this.count-=e.value()):this.count--),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&(this.count+=t.value()-e.value()),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)))}value(){var e;return null!=(e=this.changedValue)?e:this.count}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.isAggregator){let e=t.value();this.count+=null!=e?e:0}else this.count++}else if(this.records)for(let e=0;e<this.records.length;e++){let t=this.records[e];t.isAggregator?this.count+=t.value():this.count++}}}class g extends n{constructor(){super(...arguments),this.type=o.E.AVG,this.sum=0,this.count=0}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator&&e.type===o.E.AVG?(this.children&&this.children.push(e),this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&e.type===o.E.AVG?(this.children&&(this.children=this.children.filter(t=>t!==e)),this.sum-=e.sum,this.count-=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum-=parseFloat(e[this.field]),this.count--)),this.clearCacheValue()}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&e.type===o.E.AVG?(this.children&&t.isAggregator&&(this.children=this.children.map(i=>i===e?t:i)),this.sum+=t.sum-e.sum,this.count+=t.count-e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(t[this.field])-parseFloat(e[this.field])),this.clearCacheValue())}value(){var e,t;return null!=(e=this.changedValue)?e:(null==(t=this.records)?void 0:t.length)>=1?this.sum/this.count:void 0}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.isAggregator&&t.type===o.E.AVG){let e=t.value();this.sum+=e*t.count,this.count+=t.count}}else if(this.records)for(let e=0;e<this.records.length;e++){let t=this.records[e];t.isAggregator&&t.type===o.E.AVG?(this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)}}}class p extends n{constructor(){super(...arguments),this.type=o.E.MAX,this.max=Number.MIN_SAFE_INTEGER}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?(this.children&&this.children.push(e),this.max=e.max>this.max?e.max:this.max):"number"==typeof e?this.max=e>this.max?e:this.max:this.field&&"number"==typeof e[this.field]?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e)),this.recalculate())}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.recalculate())}value(){var e,t;return null!=(e=this.changedValue)?e:(null==(t=this.records)?void 0:t.length)>=1?this.max:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.isAggregator){let e=t.value();this.max=Math.max(this.max,e)}}else if(this.records)for(let e=0;e<this.records.length;e++){let t=this.records[e];t.isAggregator?this.max=t.max>this.max?t.max:this.max:"number"==typeof t?this.max=t>this.max?t:this.max:this.field&&"number"==typeof t[this.field]?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)}}}class f extends n{constructor(){super(...arguments),this.type=o.E.MIN,this.min=Number.MAX_SAFE_INTEGER}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?(this.children&&this.children.push(e),this.min=e.min<this.min?e.min:this.min):"number"==typeof e?this.min=e<this.min?e:this.min:this.field&&"number"==typeof e[this.field]?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)),this.clearCacheValue()}deleteRecord(e){e&&(this.isRecord&&this.records&&(this.records=this.records.filter(t=>t!==e)),e.isAggregator&&this.children&&(this.children=this.children.filter(t=>t!==e)),this.recalculate())}updateRecord(e,t){e&&t&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===e?t:i)),e.isAggregator&&t.isAggregator&&this.children&&(this.children=this.children.map(i=>i===e?t:i)),this.recalculate())}value(){var e,t;return null!=(e=this.changedValue)?e:(null==(t=this.records)?void 0:t.length)>=1?this.min:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.isAggregator){let e=t.value();this.min=Math.min(this.min,e)}}else if(this.records)for(let e=0;e<this.records.length;e++){let t=this.records[e];t.isAggregator?this.min=t.min<this.min?t.min:this.min:"number"==typeof t?this.min=t<this.min?t:this.min:this.field&&"number"==typeof t[this.field]?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)}}}function b(e,t){return e&&t?e.toString().localeCompare(t.toString(),"zh"):e?1:-1}function m(e,t,i){if(i===o.F.NORMAL||i===o.F.normal)return 0;let l=i===o.F.DESC||i===o.F.desc?-1:1;return e&&t?e.toString().localeCompare(t.toString(),"zh")*l:e?+l:-1*l}function C(e,t,i){if(i===o.F.NORMAL||i===o.F.normal)return 0;let l=/(\d+)|(\D+)/g,r=/\d/,n=/^0/,a,s,h,d,u=0,c=0,g=i===o.F.DESC||i===o.F.desc?-1:1;if(null!==t&&null===e)return -1*g;if(null!==e&&null===t)return+g;if("number"==typeof e&&isNaN(e))return -1*g;if("number"==typeof t&&isNaN(t))return+g;if((u=+e)<(c=+t))return -1*g;if(u>c)return+g;if("number"==typeof e&&"number"!=typeof t)return -1*g;if("number"==typeof t&&"number"!=typeof e)return+g;if("number"==typeof e&&"number"==typeof t)return 0;if(isNaN(c)&&!isNaN(u))return -1*g;if(isNaN(u)&&!isNaN(c))return+g;if((a=String(e))===(h=String(t)))return 0;if(!r.test(a)||!r.test(h))return(a>h?1:-1)*g;for(a=a.match(l),h=h.match(l);a.length&&h.length;)if((s=a.shift())!==(d=h.shift()))return r.test(s)&&r.test(d)?(s.replace(n,".0")-d.replace(n,".0"))*g:(s>d?1:-1)*g;return(a.length-h.length)*g}function v(e){let t,i={},r={};for(let l=0;l<e.length;l++)i[t=e[l]]=l,"string"==typeof t&&(r[t.toLowerCase()]=l);return function(e,t,n){let a;if(n===o.F.NORMAL||n===o.F.normal)return 0;let s=n===o.F.DESC||n===o.F.desc?-1:1;return null!==i[e]&&void 0!==i[e]&&null!==i[t]&&void 0!==i[t]?a=i[e]-i[t]:null!==i[e]&&void 0!==i[e]?a=-1:null!==i[t]&&void 0!==i[t]?a=1:null!==r[e]&&void 0!==i[e]&&null!==r[t]&&void 0!==i[t]?a=r[e]-r[t]:null===r[e]||void 0===i[e]||null===r[t]||void 0===i[t]?a=0:null!==r[e]&&void 0!==i[e]?a=-1:null!==r[t]&&void 0!==i[t]&&(a=1),(0,l.Z)(a)?a*s:C(e,t,n)}}},27695:function(e,t,i){"use strict";var l,o,r,n,a,s;i.d(t,{cI:()=>o,q0:()=>l,up:()=>r}),(n=l||(l={})).inlineFront="inlineFront",n.inlineEnd="inlineEnd",n.left="left",n.right="right",n.absoluteRight="absoluteRight",n.contentLeft="contentLeft",n.contentRight="contentRight",n.absolute="absolute",(a=o||(o={})).frozen="frozen",a.sort="sort",a.dropDown="dropDown",a.dropDownState="dropDownState",a.play="play",a.damagePic="damagePic",a.expand="expand",a.collapse="collapse",a.drillDown="drillDown",a.drillUp="drillUp",a.dragReorder="dragReorder",(s=r||(r={})).upwardIconName="sort_upward",s.downwardIconName="sort_downward",s.normalIconName="sort_normal",s.freezeIconName="freeze",s.frozenIconName="frozen",s.frozenCurrentIconName="frozenCurrent",s.dropdownIconName="dropdownIcon",s.expandIconName="expand",s.collapseIconName="collapse",s.dragReorderIconName="dragReorder",s.loadingIconName="loading"},21264:function(e,t,i){"use strict";var l,o,r,n;i.d(t,{E:()=>l,F:()=>o}),(r=l||(l={})).RECORD="RECORD",r.NONE="NONE",r.SUM="SUM",r.MIN="MIN",r.MAX="MAX",r.AVG="AVG",r.COUNT="COUNT",r.CUSTOM="CUSTOM",r.RECALCULATE="RECALCULATE",(n=o||(o={})).ASC="ASC",n.DESC="DESC",n.NORMAL="NORMAL",n.desc="desc",n.asc="asc",n.normal="normal"},53372:function(e,t,i){"use strict";i.d(t,{Z:()=>n,z:()=>r});var l=i(83847),o=i(77597);let r=(0,o.l7)(l.B,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"}),n=(0,o.l7)(l.B,{VCHART_EVENT_TYPE:"vchart_event_type"})},12348:function(e,t,i){"use strict";var l,o,r,n;i.d(t,{g:()=>o,u:()=>l}),(r=l||(l={})).top="top",r.bottom="bottom",r.left="left",r.right="right",(n=o||(o={})).expand="expand",n.collapse="collapse",n.none="none",n.loading="loading"},59480:function(e,t,i){"use strict";i.d(t,{sTO:()=>A});var l=i(89959),o=i(91925),r=i(46710),n=i(93279),a=i(46560),s=i(35437),h=i(76620),d=i(66778);let u=new h.FB;class c{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=s.R.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new h.FB}pauseLayout(e){this.pause=e}tryLayoutChildren(e){e.firstChild&&this.tryLayout(e.firstChild)}tryLayout(e,t=!0){if(this.pause)return;let i=e.parent;if(!(t||i&&e.needUpdateLayout()))return;let l=(0,a.gh)(i).group,{display:o=l.display}=i.attribute;if("flex"!==o)return;let{flexDirection:r=l.flexDirection,flexWrap:n=l.flexWrap,alignItems:s=l.alignItems,clip:h=l.clip}=i.attribute,{alignContent:d=null!=s?s:l.alignContent}=i.attribute,{width:u,height:c,justifyContent:g=l.justifyContent}=i.attribute,p=i.getChildren();if(null==u||null==c){let e=0,t=0,i=0;if(p.forEach(l=>{let o=this.getAABBBounds(l);o.empty()||("column"===r||"column-reverse"===r?(t+=o.height(),e=Math.max(e,o.width())):(e+=o.width(),t=Math.max(t,o.height())),i+=o.x1,i+=o.y1,i+=o.x2,i+=o.y2)}),!isFinite(i))return;u=e,c=t}null==i.attribute.width?i.attribute.width=u:u=i.attribute.width,null==i.attribute.height?i.attribute.height=c:c=i.attribute.height,this.tempBounds.copy(i._AABBBounds);let f={main:{len:u,field:"x"},cross:{len:c,field:"y"}},b=f.main,m=f.cross;"column"!==r&&"column-reverse"!==r||(b.len=c,m.len=u,b.field="y",m.field="x"),"row-reverse"!==r&&"column-reverse"!==r||("flex-start"===g?g="flex-end":"flex-end"===g?g="flex-start":p.reverse());let C=0,v=0,w=[];p.forEach(e=>{let t=this.getAABBBounds(e);if(t.empty())return;let i="x"===b.field?t.width():t.height(),l="x"===m.field?t.width():t.height();w.push({mainLen:i,crossLen:l}),C+=i,v=Math.max(v,l)});let y=[];if(C>b.len&&"wrap"===n){let e=0,t=0;w.forEach(({mainLen:i,crossLen:l},o)=>{e+i>b.len?0===e?(y.push({idx:o,mainLen:e+i,crossLen:l}),e=0,t=0):(y.push({idx:o-1,mainLen:e,crossLen:t}),e=i,t=l):(e+=i,t=Math.max(t,l))}),y.push({idx:w.length-1,mainLen:e,crossLen:t})}else y.push({idx:w.length-1,mainLen:C,crossLen:v});let x=0;if(y.forEach(e=>{this.layoutMain(i,p,g,b,w,x,e),x=e.idx+1}),v=y.reduce((e,t)=>e+t.crossLen,0),1===y.length){let e={"flex-start":0,"flex-end":m.len,center:m.len/2};this.layoutCross(p,s,m,e,w,y[0],0)}else if("flex-start"===d){x=0;let e=0;y.forEach((t,i)=>{let l={"flex-start":e,"flex-end":e+t.crossLen,center:e+t.crossLen/2};this.layoutCross(p,"flex-start",m,l,w,y[i],x),x=t.idx+1,e+=t.crossLen})}else if("center"===d){x=0;let e=Math.max(0,(m.len-v)/2);y.forEach((t,i)=>{let l={"flex-start":e,"flex-end":e+t.crossLen,center:e+t.crossLen/2};this.layoutCross(p,"center",m,l,w,y[i],x),x=t.idx+1,e+=t.crossLen})}else if("space-around"===d){x=0;let e=Math.max(0,(m.len-v)/y.length/2),t=e;y.forEach((i,l)=>{let o={"flex-start":t,"flex-end":t+i.crossLen,center:t+i.crossLen/2};this.layoutCross(p,"flex-start",m,o,w,y[l],x),x=i.idx+1,t+=i.crossLen+2*e})}else if("space-between"===d){x=0;let e=Math.max(0,(m.len-v)/(2*y.length-2)),t=0;y.forEach((i,l)=>{let o={"flex-start":t,"flex-end":t+i.crossLen,center:t+i.crossLen/2};this.layoutCross(p,"flex-start",m,o,w,y[l],x),x=i.idx+1,t+=i.crossLen+2*e})}p.forEach((e,t)=>{e.addUpdateBoundTag(),e.addUpdatePositionTag(),e.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();let _=this.getAABBBounds(i);h||this.tempBounds.equals(_)||this.tryLayout(i,!1)}getAABBBounds(e){this.skipBoundsTrigger=!0;let t=e.AABBBounds;return this.skipBoundsTrigger=!1,t}updateChildPos(e,t,i){return e+(null!=t?t:0)-i}layoutMain(e,t,i,l,o,r,n){var a,s,h,d,u,c,g,p,f,b,m,C,v,w;if("flex-start"===i){let e=0;for(let i=r;i<=n.idx;i++){let r=e+(a=t[i],s=l.field,0),n=this.getAABBBounds(t[i]);n.empty()||(t[i].attribute[l.field]=this.updateChildPos(r,t[i].attribute[l.field],n[`${l.field}1`])),e+=o[i].mainLen}}else if("flex-end"===i){let e=l.len;for(let i=n.idx;i>=r;i--){let r=(e-=o[i].mainLen)+(h=t[i],d=l.field,0),n=this.getAABBBounds(t[i]);n.empty()||(t[i].attribute[l.field]=this.updateChildPos(r,t[i].attribute[l.field],n[`${l.field}1`]))}}else if("space-around"===i)if(n.mainLen>=l.len){let e=0;for(let i=r;i<=n.idx;i++){let r=e+(u=t[i],c=l.field,0),n=this.getAABBBounds(t[i]);n.empty()||(t[i].attribute[l.field]=this.updateChildPos(r,t[i].attribute[l.field],n[`${l.field}1`])),e+=o[i].mainLen}}else{let e=n.idx-r+1,i=(l.len-n.mainLen)/e/2,a=i;for(let e=r;e<=n.idx;e++){let r=a+(g=t[e],p=l.field,0),n=this.getAABBBounds(t[e]);n.empty()||(t[e].attribute[l.field]=this.updateChildPos(r,t[e].attribute[l.field],n[`${l.field}1`])),a+=o[e].mainLen+2*i}}else if("space-between"===i)if(n.mainLen>=l.len){let e=0;for(let i=r;i<=n.idx;i++){let r=e+(f=t[i],b=l.field,0),n=this.getAABBBounds(t[i]);n.empty()||(t[i].attribute[l.field]=this.updateChildPos(r,t[i].attribute[l.field],n[`${l.field}1`])),e+=o[i].mainLen}}else{let e=n.idx-r+1,i=(l.len-n.mainLen)/(2*e-2),a=0;for(let e=r;e<=n.idx;e++){let r=a+(m=t[e],C=l.field,0),n=this.getAABBBounds(t[e]);n.empty()||(t[e].attribute[l.field]=this.updateChildPos(r,t[e].attribute[l.field],n[`${l.field}1`])),a+=o[e].mainLen+2*i}}else if("center"===i){let e=(l.len-n.mainLen)/2;for(let i=r;i<=n.idx;i++){let r=e+(v=t[i],w=l.field,0),n=this.getAABBBounds(t[i]);n.empty()||(t[i].attribute[l.field]=this.updateChildPos(r,t[i].attribute[l.field],n[`${l.field}1`])),e+=o[i].mainLen}}}layoutCross(e,t,i,l,o,r,n){var a,s,h,d,u,c,g;for(let p=n;p<=r.idx;p++){let r=e[p],{alignSelf:n}=r.attribute;n&&"auto"!==n||(n=t);let f=this.getAABBBounds(r),b=null!=(a=l[n])?a:l["flex-start"];"flex-end"===n?f.empty()||(r.attribute[i.field]=this.updateChildPos(b-o[p].crossLen+(s=0,h=i.field,0),r.attribute[i.field],f[`${i.field}1`])):"center"===n?f.empty()||(r.attribute[i.field]=this.updateChildPos(b-o[p].crossLen/2+(d=0,u=i.field,0),r.attribute[i.field],f[`${i.field}1`])):f.empty()||(r.attribute[i.field]=this.updateChildPos(b+(c=0,g=i.field,0),r.attribute[i.field],f[`${i.field}1`]))}}activate(e){this.pluginService=e;let t=this.pluginService.stage;t&&(t.graphicService.hooks.onAttributeUpdate.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),e.stage&&e.stage===this.pluginService.stage&&this.tryLayout(e,!1)}),t.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(e,t,i,l)=>{e.glyphHost&&(e=e.glyphHost),t&&t===this.pluginService.stage&&e.isContainer&&!this.skipBoundsTrigger&&u.copy(l)}),t.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(e,t,i,l,o)=>{t&&t===this.pluginService.stage&&e.isContainer&&!this.skipBoundsTrigger&&(u.equals(i)||this.tryLayout(e,!1))}),t.graphicService.hooks.onSetStage.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),this.tryLayout(e,!1)}))}deactivate(e){let t=this.pluginService.stage;t&&(t.graphicService.hooks.onAttributeUpdate.taps=t.graphicService.hooks.onAttributeUpdate.taps.filter(e=>e.name!==this.key),t.graphicService.hooks.beforeUpdateAABBBounds.taps=t.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(e=>e.name!==this.key),t.graphicService.hooks.afterUpdateAABBBounds.taps=t.graphicService.hooks.afterUpdateAABBBounds.taps.filter(e=>e.name!==this.key),t.graphicService.hooks.onSetStage.taps=t.graphicService.hooks.onSetStage.taps.filter(e=>e.name!==this.key))}}let g=()=>{d.F.registerPlugin("FlexLayoutPlugin",c)};var p=i(54611),f=i(37730),b=i(61226),m=i(2316),C=i(51129),v=i(92875),w=i(89255),y=i(29624),x=i(80523),_=i(43617),S=i(91015),R=i(23112);let H=!1;function A(){H||(H=!0,(0,o.VJ)(),(0,r.kP)()?(0,p.Ns)(n.n):(0,r.KV)()&&(0,f.sn)(n.n),(0,b.x)(),(0,m.f)(),(0,C.M)(),(0,v.i)(),(0,w.N)(),(0,y.k)(),(0,x.v)(),(0,_.W)(),(0,S.k)(),(0,R.g)(),g(),(0,l.C)(),g())}},70656:function(e,t,i){"use strict";i.d(t,{u:()=>function e(t,i=["data"]){let d;if(!(0,l.Z)(t)||"object"!=typeof t||(0,h.vI)(t)||function(e){try{return e instanceof Element}catch(i){let t=Object.keys(e);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every(e=>t.includes(e))}}(t))return t;let u=(0,o.Z)(t),c=t.length;d=u?Array(c):"object"==typeof t?{}:(0,r.Z)(t)||(0,n.Z)(t)||(0,a.Z)(t)?t:(0,s.Z)(t)?new Date(+t):void 0;let g=u?void 0:Object.keys(Object(t)),p=-1;if(d)for(;++p<(g||t).length;){let l=g?g[p]:p,o=t[l];(null==i?void 0:i.includes(l.toString()))?d[l]=o:d[l]=e(o,i)}return d}});var l=i(84148),o=i(19159),r=i(7610),n=i(12709),a=i(6946),s=i(82904),h=i(43286)},16487:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=function(e,t,i){return e<t?t:e>i?i:e}},34638:function(e,t,i){"use strict";function l(e,t){let i;return e>t&&(i=e,e=t,t=i),i=>Math.max(e,Math.min(t,i))}i.d(t,{i:()=>l})},19159:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(84326);let o=e=>Array.isArray?Array.isArray(e):(0,l.Z)(e,"Array")},7610:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(84326);let o=(e,t=!1)=>t?"boolean"==typeof e:!0===e||!1===e||(0,l.Z)(e,"Boolean")},82904:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(84326);let o=e=>(0,l.Z)(e,"Date")},53908:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>null==e},12709:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(84326);let o=(e,t=!1)=>{let i=typeof e;return t?"number"===i:"number"===i||(0,l.Z)(e,"Number")}},6946:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(84326);let o=(e,t=!1)=>{let i=typeof e;return t?"string"===i:"string"===i||(0,l.Z)(e,"String")}},84326:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=(e,t)=>Object.prototype.toString.call(e)===`[object ${t}]`},84148:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>null!=e},94904:function(e,t,i){"use strict";function l(e,t,i=!0){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){let l=Object.getOwnPropertyNames(t);for(let o=0;o<l.length;o++){let r=l[o];"constructor"!==r&&(i?null!=t[r]:null==e[r])&&(e[r]=t[r])}}else{var o=e,r=t,n=i;let l=function(e){if(!e)return[];if(Object.keys)return Object.keys(e);let t=[];for(let i in e)e.hasOwnProperty(i)&&t.push(i);return t}(r);for(let e=0;e<l.length;e++){let t=l[e];(n?null!=r[t]:null==o[t])&&(o[t]=r[t])}}}i.d(t,{jB:()=>l})},6594:function(e,t,i){"use strict";function l(e){return Number(e)}i.d(t,{H:()=>l})},16369:function(e,t,i){"use strict";function l(e){return Math.PI/180*e}i.d(t,{M4:()=>l})},45269:function(e,t,i){"use strict";i.d(t,{CE:()=>n,Z$:()=>r,h6:()=>s,iH:()=>a});var l=i(43735),o=i(84091);function r(e){if((0,o.Z)(e))return e[e.length-1]}let n=(e,t)=>{var i;if(0===e.length)return;let l=e[0];for(let o=1;o<e.length;o++){let r=e[o];(null!=(i=null==t?void 0:t(r,l))?i:r-l)>0&&(l=r)}return l},a=(e,t)=>{var i;if(0===e.length)return;let l=e[0];for(let o=1;o<e.length;o++){let r=e[o];(null!=(i=null==t?void 0:t(r,l))?i:r-l)<0&&(l=r)}return l};function s(e,t){if(!(0,l.Z)(e)||!(0,l.Z)(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}},19465:function(e,t,i){"use strict";i.d(t,{Z:()=>function e(t,i,r){let d;if(!(0,h.Z)(t)||"object"!=typeof t||i&&i(t))return t;let u=(0,l.Z)(t),c=t.length;d=u?Array(c):"object"==typeof t?{}:(0,o.Z)(t)||(0,a.Z)(t)||(0,s.Z)(t)?t:n(t)?new Date(+t):void 0;let g=u?void 0:Object.keys(Object(t)),p=-1;if(d)for(;++p<(g||t).length;){let l=g?g[p]:p,o=t[l];r&&r.includes(l.toString())?d[l]=o:d[l]=e(o,i,r)}return d}});var l=i(43735),o=i(47105),r=i(4453);let n=e=>(0,r.Z)(e,"Date");var a=i(58977),s=i(58853),h=i(18585)},43735:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(4453);let o=e=>Array.isArray?Array.isArray(e):(0,l.Z)(e,"Array")},84091:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=function(e){return null!==e&&"function"!=typeof e&&Number.isFinite(e.length)}},47105:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(4453);let o=(e,t=!1)=>t?"boolean"==typeof e:!0===e||!1===e||(0,l.Z)(e,"Boolean")},43572:function(e,t,i){"use strict";i.d(t,{Z:()=>h});var l=i(29753),o=i(84091);let r=e=>({}).toString.call(e).replace(/^\[object /,"").replace(/]$/,""),n=Object.prototype,a=function(e){let t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)},s=Object.prototype.hasOwnProperty,h=function(e){if((0,l.Z)(e))return!0;if((0,o.Z)(e))return!e.length;let t=r(e);if("Map"===t||"Set"===t)return!e.size;if(a(e))return!Object.keys(e).length;for(let t in e)if(s.call(e,t))return!1;return!0}},8611:function(e,t,i){"use strict";i.d(t,{X:()=>function e(t,i,s){if(t===i)return!0;if(typeof t!=typeof i||null==t||null==i)return!1;if(Number.isNaN(t)&&Number.isNaN(i))return!0;if(n(t)!==n(i))return!1;if((0,o.Z)(t))return!!(null==s?void 0:s.skipFunction);if("object"!=typeof t)return!1;if((0,l.Z)(t)){if(t.length!==i.length)return!1;for(let l=t.length-1;l>=0;l--)if(!e(t[l],i[l],s))return!1;return!0}if(!(0,r.Z)(t))return!1;let h=a(t),d=a(i);if(h.length!==d.length)return!1;h.sort(),d.sort();for(let e=h.length-1;e>=0;e--)if(h[e]!=d[e])return!1;for(let l=h.length-1;l>=0;l--){let o=h[l];if(!e(t[o],i[o],s))return!1}return!0}});var l=i(43735),o=i(70506),r=i(8287);function n(e){return Object.prototype.toString.call(e)}function a(e){return Object.keys(e)}},70506:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>"function"==typeof e},29753:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>null==e},58977:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(4453);let o=(e,t=!1)=>{let i=typeof e;return t?"number"===i:"number"===i||(0,l.Z)(e,"Number")}},47e3:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>{let t=typeof e;return null!==e&&"object"===t||"function"===t}},8287:function(e,t,i){"use strict";i.d(t,{Z:()=>r});let l=e=>"object"==typeof e&&null!==e;var o=i(4453);let r=function(e){if(!l(e)||!(0,o.Z)(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},58853:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(4453);let o=(e,t=!1)=>{let i=typeof e;return t?"string"===i:"string"===i||(0,l.Z)(e,"String")}},4453:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=(e,t)=>Object.prototype.toString.call(e)===`[object ${t}]`},18585:function(e,t,i){"use strict";i.d(t,{Z:()=>l});let l=e=>null!=e},33657:function(e,t,i){"use strict";i.d(t,{Z:()=>o});var l=i(58977);let o=e=>(0,l.Z)(e)&&Number.isFinite(e)},91212:function(e,t,i){"use strict";i.d(t,{Z:()=>s});var l=i(43735),o=i(84091),r=i(8287),n=i(18585);function a(e,t,i){var l,o;(void 0===i||(l=e[t],l===(o=i)||Number.isNaN(l)&&Number.isNaN(o)))&&(void 0!==i||t in e)||(e[t]=i)}function s(e,...t){let i=-1,h=t.length;for(;++i<h;)!function e(t,i,s=!1,h=!1){if(i&&t!==i&&(0,n.Z)(i)&&"object"==typeof i){let d=Object(i),u=[];for(let e in d)u.push(e);let{length:c}=u,g=-1;for(;c--;){let c=u[++g];!(0,n.Z)(d[c])||"object"!=typeof d[c]||h&&(0,l.Z)(t[c])?a(t,c,d[c]):function(t,i,n,s=!1,h=!1){let d=t[n],u=i[n],c=i[n],g=!0;if((0,l.Z)(u)){if(s)c=[];else if((0,l.Z)(d))c=d;else if((0,o.Z)(d)){c=Array(d.length);let e=-1,t=d.length;for(;++e<t;)c[e]=d[e]}}else(0,r.Z)(u)?(c=null!=d?d:{},"function"!=typeof d&&"object"==typeof d||(c={})):g=!1;g&&e(c,u,s,h),a(t,n,c)}(t,i,c,s,h)}}}(e,t[i],!0);return e}},22295:function(e,t,i){"use strict";i.d(t,{FB:()=>a,YZ:()=>n});var l,o,r=i(43735);i(16369),(l=o||(o={}))[l.NONE=0]="NONE",l[l.BBOX1=1]="BBOX1",l[l.BBOX2=2]="BBOX2";class n{constructor(e){e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}clone(){return new n(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}setValue(e=0,t=0,i=0,l=0){return this.x1=e,this.y1=t,this.x2=i,this.y2=l,this}set(e=0,t=0,i=0,l=0){return i<e?(this.x2=e,this.x1=i):(this.x1=e,this.x2=i),l<t?(this.y2=t,this.y1=l):(this.y1=t,this.y2=l),this}add(e=0,t=0){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this}expand(e=0){return(0,r.Z)(e)?(this.y1-=e[0],this.x2+=e[1],this.y2+=e[2],this.x1-=e[3]):(this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(e=0,t=0){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this}rotate(e=0,t=0,i=0){let l=this.rotatedPoints(e,t,i);return this.clear().add(l[0],l[1]).add(l[2],l[3]).add(l[4],l[5]).add(l[6],l[7])}scale(e=0,t=0,i=0,l=0){let o=this.scalePoints(e,t,i,l);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this}intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this}encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2}alignsWith(e){return e&&(this.x1===e.x1||this.x2===e.x2||this.y1===e.y1||this.y2===e.y2)}intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)}contains(e=0,t=0){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)}containsPoint(e){return!(e.x<this.x1||e.x>this.x2||e.y<this.y1||e.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(e=0){return this.x1*=e,this.x2*=e,this}scaleY(e=0){return this.y1*=e,this.y2*=e,this}transformWithMatrix(e){return function(e,t,i){let{x1:l,y1:o,x2:r,y2:n}=t;i.onlyTranslate()?(e!==t&&e.setValue(t.x1,t.y1,t.x2,t.y2),e.translate(i.e,i.f)):(e.clear(),e.add(i.a*l+i.c*o+i.e,i.b*l+i.d*o+i.f),e.add(i.a*r+i.c*o+i.e,i.b*r+i.d*o+i.f),e.add(i.a*r+i.c*n+i.e,i.b*r+i.d*n+i.f),e.add(i.a*l+i.c*n+i.e,i.b*l+i.d*n+i.f))}(this,this,e),this}copy(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this}rotatedPoints(e,t,i){let{x1:l,y1:o,x2:r,y2:n}=this,a=Math.cos(e),s=Math.sin(e),h=t-t*a+i*s,d=i-t*s-i*a;return[a*l-s*o+h,s*l+a*o+d,a*l-s*n+h,s*l+a*n+d,a*r-s*o+h,s*r+a*o+d,a*r-s*n+h,s*r+a*n+d]}scalePoints(e,t,i,l){let{x1:o,y1:r,x2:n,y2:a}=this;return[e*o+(1-e)*i,t*r+(1-t)*l,e*n+(1-e)*i,t*a+(1-t)*l]}}class a extends n{}},78596:function(e){var t={},i=RegExp("^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$","i"),l=["style","variant","weight","size","lineHeight","family"],o=/([\.0-9]+)(.*)/,r=function(e,t,i){var l=e.match(o);if(l){e=parseFloat(l[1]);var r=l[2].toLowerCase().trim(),n=Math.round(e);switch(n===e&&(e=n),r){case"em":if(null===t)return;return e*t;case"px":return e;case"pt":return e/(72/i);case"pc":return e/(6/i);case"mm":return i/25.4*e;case"cm":return i/2.54*e;case"in":return e*i;case"%":if(null===t)return;return e/100*t}}},n={size:r,lineHeight:r},a={serif:1,"sans-serif":1,cursive:1,fantasy:1,monospace:1},s=e.exports=function(e,o,r){var h=e+"-"+(o||"null")+"@"+r;if(r=r||96,void 0!==t[h])return t[h];if(o&&(o=s(o,null,r)),"inherit"===e)return o;var d=i.exec(e);if(!d){t[h]=null;return}d.shift();for(var u={},c=0;c<d.length;c++){var g=l[c],p=d[c];if(n[g]&&p){var f=o&&o[g]||null,b=n[g](p,f,r);p=void 0===b&&"lineHeight"===g&&p?u.size*parseFloat(p):b}if(p&&"normal"!==p){if("inherit"===p){if(!o)return;p=o[g]}p.trim&&(p=p.trim()),u[g]=p}}Object.keys(u).length||(u=null),t[h]=u;var m=[];u.style&&m.push(u.style),u.variant&&m.push(u.variant),u.weight&&"400"!==u.weight&&"normal"!==u.weight&&m.push(u.weight),m.push(u.size+"px"),u.lineHeight&&(m[m.length-1]+="/"+u.lineHeight+"px");var C=u.family.split(",");return u.family=C.map(function(e){return a[(e=e.trim()).toLowerCase()]&&(e=e.toLowerCase()),e}),m.push(u.family),Object.defineProperty(u,"toString",{value:function(){return m.map(function(e){return Array.isArray(e)?e.map(function(e){return e.indexOf(" ")>-1?'"'+e.replace(/["']/g,"")+'"':e}).join(", "):e}).join(" ")}}),u};e.exports.generics=a},50958:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deinterlace=void 0,t.deinterlace=function(e,t){for(var i=Array(e.length),l=e.length/t,o=[0,4,2,1],r=[8,8,4,2],n=0,a=0;a<4;a++)for(var s=o[a];s<l;s+=r[a])!function(l,o){var r=e.slice(o*t,(o+1)*t);i.splice.apply(i,[l*t,t].concat(r))}(s,n),n++;return i}},29216:function(e,t,i){"use strict";t.decompressFrames=t.parseGIF=void 0;var l,o=(l=i(95205))&&l.__esModule?l:{default:l},r=i(74223),n=i(4545),a=i(50958),s=i(11783);t.parseGIF=function(e){var t=new Uint8Array(e);return(0,r.parse)((0,n.buildStream)(t),o.default)};var h=function(e){for(var t=e.pixels.length,i=new Uint8ClampedArray(4*t),l=0;l<t;l++){var o=4*l,r=e.pixels[l],n=e.colorTable[r]||[0,0,0];i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=255*(r!==e.transparentIndex)}return i},d=function(e,t,i){if(!e.image)return void console.warn("gif frame does not have associated image.");var l=e.image,o=l.descriptor.width*l.descriptor.height,r=(0,s.lzw)(l.data.minCodeSize,l.data.blocks,o);l.descriptor.lct.interlaced&&(r=(0,a.deinterlace)(r,l.descriptor.width));var n={pixels:r,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return l.descriptor.lct&&l.descriptor.lct.exists?n.colorTable=l.lct:n.colorTable=t,e.gce&&(n.delay=10*(e.gce.delay||10),n.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(n.transparentIndex=e.gce.transparentColorIndex)),i&&(n.patch=h(n)),n};t.decompressFrames=function(e,t){return e.frames.filter(function(e){return e.image}).map(function(i){return d(i,e.gct,t)})}},11783:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lzw=void 0,t.lzw=function(e,t,i){var l,o,r,n,a,s,h,d,u,c,g,p,f,b,m,C=Array(i),v=Array(4096),w=Array(4096),y=Array(4097);for(d=0,a=(o=1<<e)+1,l=o+2,h=-1,r=(1<<(n=e+1))-1;d<o;d++)v[d]=0,w[d]=d;for(u=0,c=g=p=f=b=m=0;u<i;){if(0===f){if(g<n){c+=t[m]<<g,g+=8,m++;continue}if(d=c&r,c>>=n,g-=n,d>l||d==a)break;if(d==o){r=(1<<(n=e+1))-1,l=o+2,h=-1;continue}if(-1==h){y[f++]=w[d],h=d,p=d;continue}for(s=d,d==l&&(y[f++]=p,d=h);d>o;)y[f++]=w[d],d=v[d];p=255&w[d],y[f++]=p,l<4096&&(v[l]=h,w[l]=p,(++l&r)==0&&l<4096&&(n++,r+=l)),h=s}f--,C[b++]=y[f],u++}for(u=b;u<i;u++)C[u]=0;return C}},74223:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loop=t.conditional=t.parse=void 0,t.parse=function e(t,i){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l;if(Array.isArray(i))i.forEach(function(i){return e(t,i,l,o)});else if("function"==typeof i)i(t,l,o,e);else{var r=Object.keys(i)[0];Array.isArray(i[r])?(o[r]={},e(t,i[r],l,o[r])):o[r]=i[r](t,l,o,e)}return l},t.conditional=function(e,t){return function(i,l,o,r){t(i,l,o)&&r(i,e,l,o)}},t.loop=function(e,t){return function(i,l,o,r){for(var n=[],a=i.pos;t(i,l,o);){var s={};if(r(i,e,l,s),i.pos===a)break;a=i.pos,n.push(s)}return n}}},4545:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readBits=t.readArray=t.readUnsigned=t.readString=t.peekBytes=t.readBytes=t.peekByte=t.readByte=t.buildStream=void 0,t.buildStream=function(e){return{data:e,pos:0}};var i=function(){return function(e){return e.data[e.pos++]}};t.readByte=i,t.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return t.data[t.pos+e]}};var l=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};t.readBytes=l,t.peekBytes=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}},t.readString=function(e){return function(t){return Array.from(l(e)(t)).map(function(e){return String.fromCharCode(e)}).join("")}},t.readUnsigned=function(e){return function(t){var i=l(2)(t);return e?(i[1]<<8)+i[0]:(i[0]<<8)+i[1]}},t.readArray=function(e,t){return function(i,o,r){for(var n="function"==typeof t?t(i,o,r):t,a=l(e),s=Array(n),h=0;h<n;h++)s[h]=a(i);return s}};var o=function(e,t,i){for(var l=0,o=0;o<i;o++)l+=e[t+o]&&Math.pow(2,i-o-1);return l};t.readBits=function(e){return function(t){for(var l=i()(t),r=Array(8),n=0;n<8;n++)r[7-n]=!!(l&1<<n);return Object.keys(e).reduce(function(t,i){var l=e[i];return l.length?t[i]=o(r,l.index,l.length):t[i]=r[l.index],t},{})}}},95205:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(74223),o=i(4545),r={blocks:function(e){for(var t=[],i=e.data.length,l=0,r=(0,o.readByte)()(e);0!==r&&r;r=(0,o.readByte)()(e)){if(e.pos+r>=i){var n=i-e.pos;t.push((0,o.readBytes)(n)(e)),l+=n;break}t.push((0,o.readBytes)(r)(e)),l+=r}for(var a=new Uint8Array(l),s=0,h=0;h<t.length;h++)a.set(t[h],s),s+=t[h].length;return a}},n=(0,l.conditional)({gce:[{codes:(0,o.readBytes)(2)},{byteSize:(0,o.readByte)()},{extras:(0,o.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,o.readUnsigned)(!0)},{transparentColorIndex:(0,o.readByte)()},{terminator:(0,o.readByte)()}]},function(e){var t=(0,o.peekBytes)(2)(e);return 33===t[0]&&249===t[1]}),a=(0,l.conditional)({image:[{code:(0,o.readByte)()},{descriptor:[{left:(0,o.readUnsigned)(!0)},{top:(0,o.readUnsigned)(!0)},{width:(0,o.readUnsigned)(!0)},{height:(0,o.readUnsigned)(!0)},{lct:(0,o.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,l.conditional)({lct:(0,o.readArray)(3,function(e,t,i){return Math.pow(2,i.descriptor.lct.size+1)})},function(e,t,i){return i.descriptor.lct.exists}),{data:[{minCodeSize:(0,o.readByte)()},r]}]},function(e){return 44===(0,o.peekByte)()(e)}),s=(0,l.conditional)({text:[{codes:(0,o.readBytes)(2)},{blockSize:(0,o.readByte)()},{preData:function(e,t,i){return(0,o.readBytes)(i.text.blockSize)(e)}},r]},function(e){var t=(0,o.peekBytes)(2)(e);return 33===t[0]&&1===t[1]}),h=(0,l.conditional)({application:[{codes:(0,o.readBytes)(2)},{blockSize:(0,o.readByte)()},{id:function(e,t,i){return(0,o.readString)(i.blockSize)(e)}},r]},function(e){var t=(0,o.peekBytes)(2)(e);return 33===t[0]&&255===t[1]}),d=(0,l.conditional)({comment:[{codes:(0,o.readBytes)(2)},r]},function(e){var t=(0,o.peekBytes)(2)(e);return 33===t[0]&&254===t[1]});t.default=[{header:[{signature:(0,o.readString)(3)},{version:(0,o.readString)(3)}]},{lsd:[{width:(0,o.readUnsigned)(!0)},{height:(0,o.readUnsigned)(!0)},{gct:(0,o.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,o.readByte)()},{pixelAspectRatio:(0,o.readByte)()}]},(0,l.conditional)({gct:(0,o.readArray)(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},function(e,t){return t.lsd.gct.exists}),{frames:(0,l.loop)([n,h,d,a,s],function(e){var t=(0,o.peekByte)()(e);return 33===t||44===t})}]},85208:function(e,t,i){var l=i(34440),o=i(84108),r=i(61085),n=i(77706),a=i(8636);function s(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}s.prototype.clear=l,s.prototype.delete=o,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,e.exports=s},81998:function(e,t,i){var l=i(90266),o=i(42875),r=i(45828),n=i(24115),a=i(67690);function s(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}s.prototype.clear=l,s.prototype.delete=o,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,e.exports=s},72887:function(e,t,i){e.exports=i(65234)(i(83250),"Map")},95678:function(e,t,i){var l=i(39016),o=i(62363),r=i(64348),n=i(53062),a=i(30262);function s(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}s.prototype.clear=l,s.prototype.delete=o,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,e.exports=s},70861:function(e,t,i){e.exports=i(83250).Symbol},29233:function(e){e.exports=function(e,t){for(var i=-1,l=null==e?0:e.length,o=Array(l);++i<l;)o[i]=t(e[i],i,e);return o}},18498:function(e,t,i){var l=i(58260);e.exports=function(e,t){for(var i=e.length;i--;)if(l(e[i][0],t))return i;return -1}},40548:function(e,t,i){var l=i(24007),o=i(86040);e.exports=function(e,t){t=l(t,e);for(var i=0,r=t.length;null!=e&&i<r;)e=e[o(t[i++])];return i&&i==r?e:void 0}},69823:function(e,t,i){var l=i(70861),o=i(91339),r=i(25151),n=l?l.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":n&&n in Object(e)?o(e):r(e)}},99817:function(e,t,i){var l=i(45563),o=i(28597),r=i(93702),n=i(55784),a=/^\[object .+?Constructor\]$/,s=Object.prototype,h=Function.prototype.toString,d=s.hasOwnProperty,u=RegExp("^"+h.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!r(e)||o(e))&&(l(e)?u:a).test(n(e))}},86245:function(e,t,i){var l=i(70861),o=i(29233),r=i(55589),n=i(52624),a=1/0,s=l?l.prototype:void 0,h=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return o(t,e)+"";if(n(t))return h?h.call(t):"";var i=t+"";return"0"==i&&1/t==-a?"-0":i}},24007:function(e,t,i){var l=i(55589),o=i(5130),r=i(44041),n=i(99835);e.exports=function(e,t){return l(e)?e:o(e,t)?[e]:r(n(e))}},1622:function(e,t,i){e.exports=i(83250)["__core-js_shared__"]},20302:function(e,t,i){e.exports="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g},77570:function(e,t,i){var l=i(58949);e.exports=function(e,t){var i=e.__data__;return l(t)?i["string"==typeof t?"string":"hash"]:i.map}},65234:function(e,t,i){var l=i(99817),o=i(67736);e.exports=function(e,t){var i=o(e,t);return l(i)?i:void 0}},91339:function(e,t,i){var l=i(70861),o=Object.prototype,r=o.hasOwnProperty,n=o.toString,a=l?l.toStringTag:void 0;e.exports=function(e){var t=r.call(e,a),i=e[a];try{e[a]=void 0;var l=!0}catch(e){}var o=n.call(e);return l&&(t?e[a]=i:delete e[a]),o}},67736:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},34440:function(e,t,i){var l=i(24545);e.exports=function(){this.__data__=l?l(null):{},this.size=0}},84108:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t}},61085:function(e,t,i){var l=i(24545),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(l){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return o.call(t,e)?t[e]:void 0}},77706:function(e,t,i){var l=i(24545),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return l?void 0!==t[e]:o.call(t,e)}},8636:function(e,t,i){var l=i(24545);e.exports=function(e,t){var i=this.__data__;return this.size+=+!this.has(e),i[e]=l&&void 0===t?"__lodash_hash_undefined__":t,this}},5130:function(e,t,i){var l=i(55589),o=i(52624),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;e.exports=function(e,t){if(l(e))return!1;var i=typeof e;return!!("number"==i||"symbol"==i||"boolean"==i||null==e||o(e))||n.test(e)||!r.test(e)||null!=t&&e in Object(t)}},58949:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},28597:function(e,t,i){var l,o=i(1622),r=(l=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"";e.exports=function(e){return!!r&&r in e}},90266:function(e){e.exports=function(){this.__data__=[],this.size=0}},42875:function(e,t,i){var l=i(18498),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,i=l(t,e);return!(i<0)&&(i==t.length-1?t.pop():o.call(t,i,1),--this.size,!0)}},45828:function(e,t,i){var l=i(18498);e.exports=function(e){var t=this.__data__,i=l(t,e);return i<0?void 0:t[i][1]}},24115:function(e,t,i){var l=i(18498);e.exports=function(e){return l(this.__data__,e)>-1}},67690:function(e,t,i){var l=i(18498);e.exports=function(e,t){var i=this.__data__,o=l(i,e);return o<0?(++this.size,i.push([e,t])):i[o][1]=t,this}},39016:function(e,t,i){var l=i(85208),o=i(81998),r=i(72887);e.exports=function(){this.size=0,this.__data__={hash:new l,map:new(r||o),string:new l}}},62363:function(e,t,i){var l=i(77570);e.exports=function(e){var t=l(this,e).delete(e);return this.size-=!!t,t}},64348:function(e,t,i){var l=i(77570);e.exports=function(e){return l(this,e).get(e)}},53062:function(e,t,i){var l=i(77570);e.exports=function(e){return l(this,e).has(e)}},30262:function(e,t,i){var l=i(77570);e.exports=function(e,t){var i=l(this,e),o=i.size;return i.set(e,t),this.size+=+(i.size!=o),this}},32924:function(e,t,i){var l=i(67997);e.exports=function(e){var t=l(e,function(e){return 500===i.size&&i.clear(),e}),i=t.cache;return t}},24545:function(e,t,i){e.exports=i(65234)(Object,"create")},25151:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},83250:function(e,t,i){var l=i(20302),o="object"==typeof self&&self&&self.Object===Object&&self;e.exports=l||o||Function("return this")()},44041:function(e,t,i){var l=i(32924),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g;e.exports=l(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,i,l,o){t.push(l?o.replace(r,"$1"):i||e)}),t})},86040:function(e,t,i){var l=i(52624),o=1/0;e.exports=function(e){if("string"==typeof e||l(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},55784:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},58260:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},13546:function(e,t,i){var l=i(40548);e.exports=function(e,t,i){var o=null==e?void 0:l(e,t);return void 0===o?i:o}},55589:function(e){e.exports=Array.isArray},45563:function(e,t,i){var l=i(69823),o=i(93702);e.exports=function(e){if(!o(e))return!1;var t=l(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},93702:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},50440:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},52624:function(e,t,i){var l=i(69823),o=i(50440);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==l(e)}},67997:function(e,t,i){var l=i(95678);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var i=function(){var l=arguments,o=t?t.apply(this,l):l[0],r=i.cache;if(r.has(o))return r.get(o);var n=e.apply(this,l);return i.cache=r.set(o,n)||r,n};return i.cache=new(o.Cache||l),i}o.Cache=l,e.exports=o},99835:function(e,t,i){var l=i(86245);e.exports=function(e){return null==e?"":l(e)}}}]);